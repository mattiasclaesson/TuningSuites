/*
ECUIDCal.ApplicationFileName

FA5B_C_FMEP_46_FIE_82d
<swversion>_<variant>_<programmerid>_<calibrationversion>_<calibrator_id>_<enginevariantcode>

<softwareversion>
1st digit
F=T8/L850T
G=T9/SVC
H=T9/SCC
2nd digit (major variant or model year)
digit3&4 is updated every release

<variant>
C = closed (calibration data in ROM)
O = Open (calibration data in RAM)

<programmer id>
FMEP = official release
Other = test version = f.e. 1EPA = Torkel Wahlberg (FMEPA)

<calibration version>
increasing number - hex

<calibrator id>
EBD = Peder Nordenback (FMEBD)
FME = Official release

<engine variant code>
?
  
Saab

FC0J_C_FMEP_63_FIE_80f = MY2008 1.8t 150bhp manual
FC0J_C_FMEP_63_FIE_82s = MY07 Aero automatic
FC0J_C_FMEP_63_FIE_81j = MY2007 Aero ?
FC0J_C_FMEP_63_FIE_82s = Aero

FA5I_C_FME2_65_FIE_82h = MY05 Aero
FA5B_C_FME4_52_FIE_81b = 1.8t
FC0U_C_FME1_14_FIE_828 = MY10 Aero
FA5B_C_FME6_54_FIE_82b = 2.0T Aero 210bhp
FA5B_C_FME4_52_FIE_82b = 2.0T Aero 210bhp Hirsch modified
FA5I_C_FME2_72_FIE_81d = B207L MY2004
 * 
 * 80 -> 1.8t (150bhp)
 * 81 -> 2.0t (175bhp)
 * 82 -> 2.0T Aero (210bhp)

Opel

FA5B_C_FME3_4M_FME_PI_83f = Opel Signum 2.0t


Opel files only have one engine limiter TrqLimCal.Trq_MaxEngineTab1 en TrqLimCal.Trq_MaxEngineTab2
No difference in Aut/Man
 * 
 * 
 * 
 * TODO: Check flashblocks for changing VIN, ALTERNATE, Use marry process in realtime
 * TODO: Check flashblocks for information that can be written using the 0x3B (writeDataByLocalID) function
 * TODO: Figure out a way to determine which flashblock is the active one (need disassembly for it)
 * TODO: implement additional canbus functions:
 *          Set top speed
 *          Set transmission type
 *          Set ... 
 * TODO: Bitmask display in mapviewer somehow (check EnableDiagCal.*)
 * */

using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Text;
using System.Windows.Forms;
using System.IO;
using T8SuitePro;
using System.Diagnostics;
using DevExpress.XtraBars;
using DevExpress.XtraGrid.Views.Grid.ViewInfo;
using System.Data.OleDb;
using Microsoft.Office.Interop.Excel;
using System.Reflection;
using PSTaskDialog;
using Microsoft.Win32;
using DevExpress.XtraBars.Docking;
using System.Threading;
using RealtimeGraph;
using DevExpress.Skins;
using T7;
using CommonSuite;
using ICSharpCode.SharpZipLib.Core;
using ICSharpCode.SharpZipLib.GZip;

namespace T8SuitePro
{
    public delegate void DelegateStartReleaseNotePanel(string filename, string version);
    public delegate void DelegateUpdateRealTimeValue(string symbolname, float value);

    public enum PanelMode : int
    {
        Day,
        Night
    }

    public enum CANBusAdapter : int
    {
        Lawicel,
        MultiAdapter,
        ELM327,
        Just4Trionic
    }

    public enum MonitorType : int
    {
        Default,
        Dashboard
    }

    public enum AFRViewType : int
    {
        AFRMode,
        LambdaMode
    }

    public partial class Form1 : Form
    {
        private string m_CurrentWorkingProject = string.Empty;
        private TrionicProjectLog m_ProjectLog = new TrionicProjectLog();
        public DelegateUpdateRealTimeValue m_DelegateUpdateRealTimeValue;
        private bool m_WriteLogMarker = false;
        private string m_currentsramfile = string.Empty;

        private TrionicCANLib.Trionic8 t8can = new TrionicCANLib.Trionic8();
        System.Data.DataTable m_realtimeAddresses;
        private Stopwatch _sw = new Stopwatch();
        private EngineStatus _currentEngineStatus = new EngineStatus();
        private AFRViewType AfrViewMode = AFRViewType.AFRMode;

        string m_currentfile = string.Empty;
        AppSettings m_appSettings = new AppSettings();
        SymbolCollection m_symbols = new SymbolCollection();
        int m_currentMapHelperRowHandle = -1;
        private frmMapHelper m_mapHelper = new frmMapHelper();
        private string m_currentMapname = string.Empty;
        private Microsoft.Office.Interop.Excel.Application xla;
        msiupdater m_msiUpdater;
        private bool _isFullScreenEnabled = false;
        private FormWindowState _oldWindowState;
        private System.Drawing.Rectangle _oldDesktopBounds;
        private System.Drawing.Size _oldClientSize;
        System.Data.DataTable resumeTuning = new System.Data.DataTable();
        private bool m_startFromCommandLine = false;
        private string m_commandLineFile = string.Empty;
        public DelegateStartReleaseNotePanel m_DelegateStartReleaseNotePanel;
        private frmProgress frmProgressLogWorks;


        public Form1(string[] args)
        {
            frmSplash splash = new frmSplash();
            splash.Show();
            System.Windows.Forms.Application.DoEvents();
            InitializeComponent();

            try
            {
                RegistryKey TempKeyCM = null;
                TempKeyCM = Registry.ClassesRoot.CreateSubKey(@"SystemFileAssociations\.bin\shell\Edit in T8 Suite\command");
                string StartKey = System.Windows.Forms.Application.ExecutablePath + " \"%1\"";
                TempKeyCM.SetValue("", StartKey);
                TempKeyCM.Close();
            }
            catch (Exception E)
            {
                LogHelper.Log(E.Message);
            }
            try
            {
                RegistryKey TempKeyCM = null;
                TempKeyCM = Registry.ClassesRoot.CreateSubKey(@"SystemFileAssociations\.bin\shell\Auto detect Trionic file type\command");
                string StartKey = System.Windows.Forms.Application.StartupPath + "\\SuiteLauncher.exe" + " \"%1\"";
                TempKeyCM.SetValue("", StartKey);
                TempKeyCM.Close();
            }
            catch (Exception E)
            {
                LogHelper.Log(E.Message);
            }
            if (args.Length > 0)
            {
                if (args[0].ToString().ToUpper().EndsWith(".BIN"))
                {
                    if (File.Exists(args[0].ToString()))
                    {
                        m_startFromCommandLine = true;
                        m_commandLineFile = args[0].ToString();
                    }
                }
            }
            try
            {
                m_DelegateStartReleaseNotePanel = new DelegateStartReleaseNotePanel(this.StartReleaseNotesViewer);
                m_DelegateUpdateRealTimeValue = new DelegateUpdateRealTimeValue(this.UpdateRealtimeInformationValue);

            }
            catch (Exception E)
            {
                LogHelper.Log(E.Message);
            }

            try
            {
                sndplayer = new System.Media.SoundPlayer();
                t8can.onReadProgress += new TrionicCANLib.ITrionic.ReadProgress(t8can_onReadProgress);
                t8can.onWriteProgress += new TrionicCANLib.ITrionic.WriteProgress(t8can_onWriteProgress);
                t8can.onCanInfo += new TrionicCANLib.ITrionic.CanInfo(t8can_onCanInfo);
            }
            catch (Exception E)
            {
                LogHelper.Log(E.Message);
            }


            splash.Close();
        }

        void t8can_onWriteProgress(object sender, TrionicCANLib.ITrionic.WriteProgressEventArgs e)
        {
            SetProgress(String.Format("Sending {0} %", e.Percentage));
            SetProgressPercentage(e.Percentage);
        }


        void t8can_onCanInfo(object sender, TrionicCANLib.ITrionic.CanInfoEventArgs e)
        {
            SetProgress(e.Info);
        }

        void t8can_onReadProgress(object sender, TrionicCANLib.ITrionic.ReadProgressEventArgs e)
        {
            SetProgress(String.Format("Downloading {0} %", e.Percentage));
            SetProgressPercentage(e.Percentage);
        }

        private void UpdateRealtimeInformationValue(string symbolname, float value)
        {
            switch (symbolname)
            {
                case "ActualIn.n_Engine": // rpm
                    //if (m_appSettings.DebugMode) value = 2500; //TODO: <GS-25012011> REMOVE AFTER TESTING
                    digitalDisplayControl1.DigitText = value.ToString("F0");
                    _currentEngineStatus.CurrentRPM = value;
                    break;
                case "ActualIn.T_Engine": // engine temp
                    //if (m_appSettings.DebugMode) value = 85; //TODO: <GS-25012011> REMOVE AFTER TESTING
                    digitalDisplayControl2.DigitText = value.ToString("F0");
                    _currentEngineStatus.CurrentEngineTemp = value;
                    break;
                case "ActualIn.T_AirInlet": // IAT temp
                    digitalDisplayControl3.DigitText = value.ToString("F0");
                    _currentEngineStatus.CurrentIAT = value;
                    //_currentIAT = value;
                    break;
                case "ECMStat.ST_ActiveAirDem": // Airmass limiter ID
                    digitalDisplayControl5.DigitText = value.ToString("F0");
                    //TODO: Adjust for Trionic 8
                    labelControl9.Text = ConvertActiveAirDemand(Convert.ToInt32(value));
                    _currentEngineStatus.CurrentAirmassLimiterID = Convert.ToInt32(value);
                    break;
                case "Lambda.Status": // Lambda status
                    //digitalDisplayControl5.DigitText = value.ToString("F0");
                    labelControl10.Text = ConvertLambdaStatus(Convert.ToInt32(value));
                    //TODO: Adjust for Trionic 8
                    _currentEngineStatus.CurrentLambdaStatus = Convert.ToInt32(value);
                    break;
                case "FCut.CutStatus": // Fuelcut status
                    labelControl12.Text = ConvertFuelcutStatus(Convert.ToInt32(value));
                    //TODO: Adjust for Trionic 8
                    _currentEngineStatus.CurrentFuelcutStatus = Convert.ToInt32(value);
                    break;
                case "IgnMastProt.fi_Offset": // Ioff
                    measurementIgnitionOffset.Value = value;
                    _currentEngineStatus.CurrentIgnitionOffset = value;
                    //TODO: <GS-18102010> ignition offset als knock indicator gebruiken!?
                    UpdateKnockIndicator(value);

                    break;
                case "AirMassMast.m_Request": // drivers airmass request
                    measurementAirmassRequest.Value = value;
                    _currentEngineStatus.CurrentAirmassRequest = value;
                    break;
                case "Out.M_EngTrqAct": // calc. torque
                    measurementCalculatedTorque.Value = value;
                    _currentEngineStatus.CurrentEngineTorque = value;
                    // update Power as well <GS-05042011>
                    //Power (HP) = (Torque (Nm) * rpm) / 7121
                    _currentEngineStatus.CurrentEnginePower = _currentEngineStatus.CurrentRPM * _currentEngineStatus.CurrentEngineTorque / 7121;
                    measurementCalculatedPower.Value = _currentEngineStatus.CurrentEnginePower;
                    break;
                case "ECMStat.P_Engine": // calc. power
                    measurementCalculatedPower.Value = value;
                    _currentEngineStatus.CurrentEnginePower = value;
                    break;
                case "ECMStat.p_Diff": // pressure diff = boost
                case "In.p_AirInlet": // pressure diff = boost
                    measurementBoost.Value = value;
                    _currentEngineStatus.CurrentBoostPressure = value;
                    break;
                case "Out.PWM_BoostCntrl": // duty cycle BCV
                    measurementDutyCycleBCV.Value = value;
                    _currentEngineStatus.CurrentBoostValvePWM = value;
                    break;
                case "Out.fi_Ignition": // Ignition advance
                    measurementIgnitionAdvance.Value = value;
                    _currentEngineStatus.CurrentIgnitionAdvance = value;
                    break;
                case "Out.X_AccPos": // TPS
                    measurementPedalPosition.Value = value;
                    _currentEngineStatus.CurrentThrottlePosition = value;
                    break;
                case "MAF.m_AirInlet": // actual airmass
                    //if (m_appSettings.DebugMode) value = 500; //TODO: <GS-25012011> REMOVE AFTER TESTING
                    linearGauge1.Value = value;
                    _currentEngineStatus.CurrentAirmassPerCombustion = value;
                    break;
                case "DisplProt.LambdaScanner": // AFR through wideband?
                case "DisplProt.AD_Scanner": // AFR through wideband?
                    if (m_appSettings.UseWidebandLambda)
                    {
                        if (symbolname == "DisplProt.AD_Scanner")
                        {
                            // first convert the value to AFR
                            // value to volt first
                            //value = value / 204.6F;
                            //LogHelper.Log("1: " + value.ToString());
                            value = (float)ConvertToWidebandAFR(value);
                            //if (m_appSettings.DebugMode) value = 13; //TODO: <GS-25012011> REMOVE AFTER TESTING
                            //LogHelper.Log("2: " + value.ToString());
                        }

                        float valTextLambda = value / 14.7F;
                        digitalDisplayControl6.DigitText = value.ToString("F1");
                        if (AfrViewMode == AFRViewType.AFRMode)
                        {
                            // value must have been divided by 100 already, so 0.75-1.25 here
                            //value *= 14.7F;
                            linearGauge2.Value = value;
                        }
                        else
                        {
                            // lambda mode
                            linearGauge2.Value = valTextLambda;
                        }
                        if (m_appSettings.MeasureAFRInLambda)
                        {
                            //LogWidebandAFR(value / 14.7F, _currentEngineStatus.CurrentRPM, _currentEngineStatus.CurrentAirmassPerCombustion);
                        }
                        else
                        {
                            //LogWidebandAFR(value, _currentEngineStatus.CurrentRPM, _currentEngineStatus.CurrentAirmassPerCombustion);
                        }
                        //ProcessAutoTuning(value, _currentEngineStatus.CurrentRPM, _currentEngineStatus.CurrentAirmassPerCombustion);
                    }
                    //_currentEngineStatus.CurrentAFR = value;
                    break;
                case "Lambda.LambdaInt": // AFR through narrowband?
                    if (!m_appSettings.UseWidebandLambda)
                    {
                        float valText = value * 14.7F;
                        digitalDisplayControl6.DigitText = value.ToString("F1");
                        if (AfrViewMode == AFRViewType.AFRMode)
                        {
                            // value must have been divided by 100 already, so 0.75-1.25 here
                            value *= 14.7F;
                            linearGauge2.Value = value;
                        }
                        else
                        {
                            // lambda mode
                            linearGauge2.Value = value;
                        }
                    }
                    //_currentEngineStatus.CurrentAFR = value;
                    break;
                case "In.v_Vehicle":
                    measurementSpeed.Value = value;
                    _currentEngineStatus.CurrentVehicleSpeed = value;
                    break;
                case "Exhaust.T_Calc":
                    measurementEGT.DigitText = value.ToString("F0");
                    _currentEngineStatus.CurrentEGT = value;
                    break;
                case "BFuelProt.CurrentFuelCon":
                    digitalDisplayControl4.DigitText = value.ToString("F1");
                    _currentEngineStatus.CurrentConsumption = value;
                    break;
                case "FPSCounter":
                    //label1.Text = value.ToString("F1") + " fps";
                    dockRealtime.Text = "Realtime panel [" + value.ToString("F1") + " fps]";
                    break;
            }
            System.Windows.Forms.Application.DoEvents();
        }

        private double ConvertToWidebandAFR(float value)
        {
            // convert to AFR value using wideband lambda sensor settings
            // ranges 0 - 255 will be default for 0-5 volt
            double retval = 0;
            double voltage = ((value) / 1023) * (m_appSettings.WidebandHighVoltage / 1000 - m_appSettings.WidebandLowVoltage / 1000);
            //LogHelper.Log("Wideband voltage: " + voltage.ToString());
            // now convert to AFR using user settings
            if (voltage < m_appSettings.WidebandLowVoltage / 1000) voltage = m_appSettings.WidebandLowVoltage / 1000;
            if (voltage > m_appSettings.WidebandHighVoltage / 1000) voltage = m_appSettings.WidebandHighVoltage / 1000;
            //LogHelper.Log("Wideband voltage (after clipping): " + voltage.ToString());
            double steepness = ((m_appSettings.WidebandHighAFR / 1000) - (m_appSettings.WidebandLowAFR / 1000)) / ((m_appSettings.WidebandHighVoltage / 1000) - (m_appSettings.WidebandLowVoltage / 1000));
            //LogHelper.Log("Steepness: " + steepness.ToString());
            retval = (m_appSettings.WidebandLowAFR / 1000) + (steepness * (voltage - (m_appSettings.WidebandLowVoltage / 1000)));
            //LogHelper.Log("retval: " + retval.ToString());
            return retval;

        }

        private void UpdateKnockIndicator(float value)
        {
            try
            {
                int ivalue = Convert.ToInt32(value);
                // range -20 / +20
                // multiply with 12
                ivalue *= 12;
                if (ivalue < -255) ivalue = -255;
                if (ivalue > 255) ivalue = 255;
                Color c;
                if (ivalue < 0) // red
                {
                    ivalue = -ivalue;
                    c = Color.FromArgb(ivalue, 0, 0);
                }
                else
                {
                    c = Color.Black;
                    if (m_appSettings.Panelmode == PanelMode.Night) c = Color.FromArgb(234, 77, 0);
                    //c = Color.FromArgb(0, ivalue, 0);
                }
                // set the indicator
                measurementIgnitionOffset.SetDigitColor = c;
            }
            catch (Exception E)
            {
                LogHelper.Log(E.Message);
            }

        }


        private void StartReleaseNotesViewer(string xmlfilename, string version)
        {
            dockManager1.BeginUpdate();
            DockPanel dp = dockManager1.AddPanel(DockingStyle.Right);
            dp.ClosedPanel += new DockPanelEventHandler(dockPanel_ClosedPanel);
            dp.Tag = xmlfilename;
            ctrlReleaseNotes mv = new ctrlReleaseNotes();
            mv.LoadXML(xmlfilename);
            mv.Dock = DockStyle.Fill;
            dp.Width = 500;
            dp.Text = "Release notes: " + version;
            dp.Controls.Add(mv);
            dockManager1.EndUpdate();
        }

        void dockPanel_ClosedPanel(object sender, DockPanelEventArgs e)
        {
            // force close of the file that the hexviewer had open!
            if (sender is DockPanel)
            {
                DockPanel pnl = (DockPanel)sender;

                foreach (Control c in pnl.Controls)
                {
                    if (c is HexViewer)
                    {
                        HexViewer vwr = (HexViewer)c;
                        vwr.CloseFile();
                        //UpdateChecksum(m_currentfile);
                    }
                    else if (c is DockPanel)
                    {
                        DockPanel tpnl = (DockPanel)c;
                        foreach (Control c2 in tpnl.Controls)
                        {
                            if (c2 is HexViewer)
                            {
                                HexViewer vwr2 = (HexViewer)c2;
                                vwr2.CloseFile();
                                //UpdateChecksum(m_currentfile);
                            }
                        }
                    }
                    else if (c is ControlContainer)
                    {
                        ControlContainer cntr = (ControlContainer)c;
                        foreach (Control c3 in cntr.Controls)
                        {
                            if (c3 is HexViewer)
                            {
                                HexViewer vwr3 = (HexViewer)c3;
                                vwr3.CloseFile();
                                //UpdateChecksum(m_currentfile);
                            }
                        }
                    }
                }
                // remove the panel from the dockmanager
                dockManager1.RemovePanel(pnl);
            }
        }

        private void LoadLayoutFiles()
        {
            try
            {
                if (File.Exists(System.Windows.Forms.Application.StartupPath + "\\SymbolViewLayout.xml"))
                {
                    gridViewSymbols.RestoreLayoutFromXml(System.Windows.Forms.Application.StartupPath + "\\SymbolViewLayout.xml");
                }
            }
            catch (Exception E1)
            {
                LogHelper.Log(E1.Message);
            }
        }

        private void SaveLayoutFiles()
        {
            try
            {
                gridViewSymbols.SaveLayoutToXml(System.Windows.Forms.Application.StartupPath + "\\SymbolViewLayout.xml");
            }
            catch (Exception E)
            {
                LogHelper.Log(E.Message);
            }
        }

        private void TryToByteFlipFile(string filename)
        {
            // read the first few bytes and decide!
            // normally 00 10 0C 00... if it is 10 00 00 0C flip the file
            byte b1 = 0;
            byte b2 = 0;
            byte b3 = 0;
            byte b4 = 0;
            FileStream fs = new FileStream(filename, FileMode.Open, FileAccess.Read);
            using (BinaryReader br = new BinaryReader(fs))
            {
                b1 = br.ReadByte();
                b2 = br.ReadByte();
                b3 = br.ReadByte();
                b4 = br.ReadByte();
            }
            fs.Close();
            if (b1 == 0x10 && b2 == 0x00 && b3 == 0x00 && b4 == 0x0C)
            {
                LogHelper.Log("Flipping file");
                string filenamenew = filename + ".tmp";
                FileStream fromfile = new FileStream(filename, FileMode.Open, FileAccess.Read);
                FileStream tofile = new FileStream(filenamenew, FileMode.CreateNew);
                using (BinaryReader brori = new BinaryReader(fromfile))
                {
                    using (BinaryWriter brnew = new BinaryWriter(tofile))
                    {
                        for (int t = 0; t < 0x100000; t += 2)
                        {
                            byte bfirst = brori.ReadByte();
                            byte bsecond = brori.ReadByte();
                            brnew.Write(bsecond);
                            brnew.Write(bfirst);
                        }
                    }
                }
                fromfile.Close();
                tofile.Close();
                CreateBinaryBackup(filename, false);
                File.Delete(filename);
                File.Copy(filenamenew, filename);
                File.Delete(filenamenew);
            }
        }

        private bool ValidateTrionic8File(string filename)
        {
            byte[] testdata = readdatafromfile(filename, 0, 0x10);
            if (testdata[0] == 0x00 && (testdata[1] == 0x10 || testdata[1] == 0x00) && testdata[2] == 0x0C && testdata[3] == 0x00)
            {
                return true;
            }
            return false;
        }

        private void TryToOpenFile(string filename, out SymbolCollection symbol_collection, int filename_size)
        {
            SymbolTranslator translator = new SymbolTranslator();
            string help = string.Empty;
            bool symbolsLoaded = false;
            m_currentsramfile = string.Empty; // geen sramfile erbij
            barStaticItem1.Caption = "";
            barFilenameText.Caption = "";
            bool _hideRealtime = false;
            //XDFCategories category = XDFCategories.Undocumented;
            //XDFSubCategory subcat = XDFSubCategory.Undocumented;
            symbol_collection = new SymbolCollection();
            // check file for real only attributes
            if (filename == string.Empty) return;
            FileInfo fi = new FileInfo(filename);
            fi.IsReadOnly = false;
            if (fi.Length != 0x100000)
            {
                m_currentfile = string.Empty;
                MessageBox.Show("File has incorrect length: " + Path.GetFileName(filename));
                return;
            }
            if (!ValidateTrionic8File(filename))
            {
                TryToByteFlipFile(filename);
                if (!ValidateTrionic8File(filename))
                {
                    m_currentfile = string.Empty;
                    MessageBox.Show("File does not seem to be a Trionic 8 file: " + Path.GetFileName(filename));
                    return;
                }
            }

            try
            {
                //TODO: if the file is byte-swapped, fix that first!
                TryToByteFlipFile(filename);

                SetProgress("Opening " + Path.GetFileName(filename));
                SetProgressPercentage(0);

                System.Windows.Forms.Application.DoEvents();

                int sym_count = 0;
                if (filename != string.Empty)
                {
                    if (File.Exists(filename))
                    {
                        TryToExtractPackedBinary(filename, sym_count, filename_size, out symbol_collection);
                    }
                    // try to load additional symboltranslations that the user entered
                    symbolsLoaded = TryToLoadAdditionalSymbols(filename, true, symbol_collection);

                }
            }
            catch (Exception E)
            {
                LogHelper.Log("TryOpenFile failed: " + filename + " err: " + E.Message);
            }
            foreach (SymbolHelper sh in /*m_symbols*/ symbol_collection)
            {
                if (sh.Varname.Contains("."))
                {
                    try
                    {
                        sh.Category = sh.Varname.Substring(0, sh.Varname.IndexOf("."));
                    }
                    catch (Exception cE)
                    {
                        LogHelper.Log("Failed to assign category to symbol: " + sh.Varname + " err: " + cE.Message);
                    }
                }
                if (sh.Varname.StartsWith("Symbolnumber"))
                {
                    // do not allow realtime interaction with this type of files loaded (no symboltable)
                    _hideRealtime = true;
                }
            }
            try
            {
                if (m_appSettings.MapDetectionActive && !symbolsLoaded)
                {
                    SymbolFiller sf = new SymbolFiller();
                    sf.CheckAndFillCollection(/*m_symbols*/ symbol_collection);
                }

            }
            catch (Exception E)
            {
                LogHelper.Log(E.Message);
            }

            _hideRealtime = false;

            if (_hideRealtime)
            {
                btnToggleRealtime.Enabled = false;
                btnSRAMSnapshot.Enabled = false;
                btnGetECUInfo.Enabled = false;
                btnGetFlashContent.Enabled = false;
                btnWriteLogMarker.Enabled = false;
            }
            else
            {
                btnToggleRealtime.Enabled = true;
                btnSRAMSnapshot.Enabled = true;
                btnGetECUInfo.Enabled = true;
                btnGetFlashContent.Enabled = true;
                btnWriteLogMarker.Enabled = true;
            }
            SetProgress("Loading data into view... ");
            SetProgressPercentage(95);
            System.Windows.Forms.Application.DoEvents();

            //this.Text = "T8Suite Professional [" + Path.GetFileName(m_currentfile) + "]";
            //barFilenameText.Caption = Path.GetFileName(m_currentfile);
            //gridControlSymbols.DataSource = m_symbols;
            //m_appSettings.Lastfilename = m_currentfile;

            //gridViewSymbols.BestFitColumns();

            SetDefaultFilters();

            SetProgressIdle();
            //UpdateChecksum(m_currentfile, m_appSettings.AutoChecksum);
            if (m_currentfile != string.Empty) LoadRealtimeTable();

            IdaProIdcFile.create(m_currentfile, m_symbols);
        }

        private void SetProgressIdle()
        {
            SetProgress("Idle");
            SetProgressPercentage(0);
        }
        private void SetProgressPercentage(int perc)
        {
            try
            {
                if (Convert.ToInt32(barProgress.EditValue) != perc)
                {
                    barProgress.EditValue = perc;
                    System.Windows.Forms.Application.DoEvents();
                }
            }
            catch (Exception E)
            {
                LogHelper.Log(E.Message);
            }
        }

        private void SetProgress(string descr)
        {
            if (barProgress.Caption != descr)
            {
                barProgress.Caption = descr;
                System.Windows.Forms.Application.DoEvents();
            }
        }

        private void SetDefaultFilters()
        {
            DevExpress.XtraGrid.Columns.ColumnFilterInfo fltr = new DevExpress.XtraGrid.Columns.ColumnFilterInfo(@"([Flash_start_address] > 0 AND [Flash_start_address] < 1048576)", "Only symbols within binary");
            gridViewSymbols.ActiveFilter.Clear();
            gridViewSymbols.ActiveFilter.Add(gcSymbolsAddress, fltr);
            /*** set filter ***/
            gridViewSymbols.ActiveFilterEnabled = true;
        }

        private int GetAddrTableOffset(string filename)
        {
            int addrtaboffset = GetStartOfAddressTableOffset(filename);
            LogHelper.Log("addrtaboffset: " + addrtaboffset.ToString("X8"));
            //int NqNqNqOffset = GetNqNqNqStringFromOffset(addrtaboffset - 0x100, filename);
            int NqNqNqOffset = GetLastNqStringFromOffset(addrtaboffset - 0x100, filename);
            LogHelper.Log("NqNqNqOffset: " + NqNqNqOffset.ToString("X8"));

            int symbtaboffset = GetAddressFromOffset(NqNqNqOffset, filename);
            LogHelper.Log("symbtaboffset: " + symbtaboffset.ToString("X8"));
            //int symbtaboffset = GetAddressFromOffset(addrtaboffset - 0x12, filename);
            //                    symbtaboffset = NqNqNqOffset;
            int symbtablength = GetLengthFromOffset(NqNqNqOffset + 4 /*addrtaboffset - 0x0E*/, filename);
            int retval = NqNqNqOffset + 21;
            LogHelper.Log("symbtablength: " + symbtablength.ToString("X8"));
            return retval;
        }

        private int GetAddrTableOffsetBySymbolTable(string filename)
        {
            int addrtaboffset = GetEndOfSymbolTable(filename);
            LogHelper.Log("EndOfSymbolTable: " + addrtaboffset.ToString("X8"));
            //int NqNqNqOffset = GetLastNqStringFromOffset(addrtaboffset - 0x100, filename);
            int NqNqNqOffset = GetFirstNqStringFromOffset(addrtaboffset, filename);
            LogHelper.Log("NqNqNqOffset: " + NqNqNqOffset.ToString("X8"));

            int symbtaboffset = GetAddressFromOffset(NqNqNqOffset, filename);
            LogHelper.Log("symbtaboffset: " + symbtaboffset.ToString("X8"));
            //int symbtaboffset = GetAddressFromOffset(addrtaboffset - 0x12, filename);
            //                    symbtaboffset = NqNqNqOffset;
            int symbtablength = GetLengthFromOffset(NqNqNqOffset + 4 /*addrtaboffset - 0x0E*/, filename);
            int retval = NqNqNqOffset + 21;
            LogHelper.Log("symbtablength: " + symbtablength.ToString("X8"));
            return retval;
        }


        private bool TryToExtractPackedBinary(string filename, int sym_count, int filename_size, out SymbolCollection symbol_collection)
        {
            bool retval = true;
            //Test 15092009
            //int RealAddressTableOffset = GetAddrTableOffset(filename) + 7; // was 17
            int RealAddressTableOffset = GetAddrTableOffsetBySymbolTable(filename) + 7; // was 17 // <GS-22032010>

            //Test 15092009
            LogHelper.Log("Real symboltable offset: " + RealAddressTableOffset.ToString("X8"));

            int symboltableoffset = 0;
            symbol_collection = new SymbolCollection();
            SetProgress("Unpacking file... ");
            SetProgressPercentage(5);
            System.Windows.Forms.Application.DoEvents();

            bool compr_created = UnpackFileUsingDecode(filename, out symboltableoffset);
            sym_count = 0;
            SetProgress("Finding address table... ");
            SetProgressPercentage(15);
            System.Windows.Forms.Application.DoEvents();
            byte[] searchsequence = new byte[9];
            searchsequence.SetValue((byte)0x00, 0);
            searchsequence.SetValue((byte)0x00, 1);
            searchsequence.SetValue((byte)0x00, 2);
            searchsequence.SetValue((byte)0x00, 3);
            searchsequence.SetValue((byte)0x00, 4);
            searchsequence.SetValue((byte)0x00, 5);
            searchsequence.SetValue((byte)0x00, 6);
            searchsequence.SetValue((byte)0x00, 7);
            searchsequence.SetValue((byte)0x20, 8);
            int AddressTableOffset = 0;//GetAddressTableOffset(searchsequence);
            FileStream fsread = new FileStream(filename, FileMode.Open, FileAccess.Read);
            using (BinaryReader br = new BinaryReader(fsread))
            {
                fsread.Seek(symboltableoffset, SeekOrigin.Begin);
                int adr_state = 0;
                while ((fsread.Position < filename_size) && (AddressTableOffset == 0))
                {
                    byte adrb = br.ReadByte();
                    switch (adr_state)
                    {
                        case 0:
                            if (adrb == (byte)searchsequence.GetValue(0))
                            {

                                adr_state++;
                            }
                            break;
                        case 1:
                            if (adrb == (byte)searchsequence.GetValue(1)) adr_state++;
                            else
                            {
                                adr_state = 0;
                                fsread.Position -= 1;
                            }
                            break;
                        case 2:
                            if (adrb == (byte)searchsequence.GetValue(2)) adr_state++;
                            else
                            {
                                adr_state = 0;
                                fsread.Position -= 2;
                            }
                            break;
                        case 3:
                            if (adrb == (byte)searchsequence.GetValue(3)) adr_state++;
                            else
                            {
                                adr_state = 0;
                                fsread.Position -= 3;
                            }
                            break;
                        case 4:
                            if (adrb == (byte)searchsequence.GetValue(4)) adr_state++;
                            else
                            {
                                adr_state = 0;
                                fsread.Position -= 4;
                            }
                            break;
                        case 5:
                            if (adrb == (byte)searchsequence.GetValue(5)) adr_state++;
                            else
                            {
                                adr_state = 0;
                                fsread.Position -= 5;
                            }
                            break;
                        case 6:
                            if (adrb == (byte)searchsequence.GetValue(6)) adr_state++;
                            else
                            {
                                adr_state = 0;
                                fsread.Position -= 6;
                            }
                            break;
                        case 7:
                            if (adrb == (byte)searchsequence.GetValue(7)) adr_state++;
                            else
                            {
                                adr_state = 0;
                                fsread.Position -= 7;
                            }
                            break;
                        case 8:
                            if (adrb == (byte)searchsequence.GetValue(8))
                            {
                                // found it
                                AddressTableOffset = (int)fsread.Position - 1;
                            }
                            else
                            {
                                adr_state = 0;
                                fsread.Position -= 8;
                            }
                            break;
                    }
                }
                if (AddressTableOffset > 0)
                {
                    AddressTableOffset = RealAddressTableOffset; // TEST 15092009
                    SetProgress("Reading address table... ");
                    SetProgressPercentage(25);
                    System.Windows.Forms.Application.DoEvents();

                    fsread.Seek(AddressTableOffset - 17, SeekOrigin.Begin);
                    bool endoftable = false;
                    Int64 internal_address = 0;
                    int sramaddress = 0;
                    int symbollength = 0;
                    int bitmask = 0;
                    int symb_count = 0;
                    symbol_collection = new SymbolCollection();
                    while (!endoftable)
                    {
                        // steeds 10 karaketers
                        try
                        {
                            byte[] bytes = br.ReadBytes(10);
                            if (bytes.Length == 10)
                            {
                                // DumpBytesToConsole(bytes);
                                if ((Convert.ToInt32(bytes.GetValue(9)) != 0x00) /*|| (Convert.ToInt32(bytes.GetValue(6)) != 0x00)*/)
                                {
                                    endoftable = true;
                                    //MessageBox.Show("EOT: " + fsread.Position.ToString("X6"));
                                    LogHelper.Log("EOT: " + fsread.Position.ToString("X6"));
                                }
                                else
                                {
                                    //DumpBytesToConsole(bytes);

                                    internal_address = Convert.ToInt64(bytes.GetValue(0)) * 256 * 256;
                                    internal_address += Convert.ToInt64(bytes.GetValue(1)) * 256;
                                    internal_address += Convert.ToInt64(bytes.GetValue(2));

                                    /* if (bytes[1] == 0x7A && bytes[2] == 0xEE)
                                     {
                                         LogHelper.Log("suspicious");

                                         if (internal_address == 0x7AEE)
                                         {
                                             LogHelper.Log("break: " + fsread.Position.ToString("X8"));
                                         }
                                     }*/
                                    symbollength = Convert.ToInt32(bytes.GetValue(3)) * 256;
                                    symbollength += Convert.ToInt32(bytes.GetValue(4));

                                    bitmask = Convert.ToInt32(bytes.GetValue(5)) * 256;
                                    bitmask += Convert.ToInt32(bytes.GetValue(6));


                                    //                                                sramaddress = Convert.ToInt32(bytes.GetValue(7)) * 256 * 256;
                                    //                                                sramaddress += Convert.ToInt32(bytes.GetValue(8)) * 256;
                                    //                                                sramaddress += Convert.ToInt32(bytes.GetValue(9));
                                    SymbolHelper sh = new SymbolHelper();
                                    sh.Symbol_type = Convert.ToInt32(bytes.GetValue(7));
                                    sh.Varname = "Symbolnumber " + symbol_collection.Count.ToString();
                                    sh.Symbol_number = symbol_collection.Count;
                                    sh.Symbol_number_ECU = symbol_collection.Count;
                                    sh.Flash_start_address = internal_address;
                                    sh.Start_address = internal_address;
                                    sh.Length = symbollength;
                                    sh.BitMask = bitmask;
                                    /*if (internal_address == 0x0AE956)
                                    {
                                        DumpBytesToConsole(bytes);
                                    }*/
                                    //DumpToSymbolFile(sh.Varname + " : " + sh.Flash_start_address.ToString("X6"));

                                    symbol_collection.Add(sh);
                                    symb_count++;
                                    if (symb_count % 500 == 0)
                                    {
                                        SetProgress("Symbol: " + sh.Varname);
                                        SetProgressPercentage(5);
                                        System.Windows.Forms.Application.DoEvents();
                                    }
                                }
                            }
                            else
                            {
                                endoftable = true;
                            }
                        }
                        catch (Exception E)
                        {
                            LogHelper.Log(E.Message);
                            retval = false;
                        }

                    }
                    if (compr_created)
                    {
                        LogHelper.Log("Dumping addresstable");
                        SetProgress("Creating symbol list... ");
                        SetProgressPercentage(50);
                        System.Windows.Forms.Application.DoEvents();

                        DumpSymbolAddressTable(symbol_collection);
                        LogHelper.Log("Decoding packed symbol table");
                        // run decode.exe

                        if (File.Exists(Path.GetTempPath() + "\\COMPR.TXT"))
                        {
                            File.Delete(Path.GetTempPath() + "\\COMPR.TXT");
                        }
                        if (File.Exists(Path.GetTempPath() + "\\COMPR"))
                        {
                            File.Delete(Path.GetTempPath() + "\\COMPR");
                        }
                        if (File.Exists(Path.GetTempPath() + "\\table.tmp"))
                        {
                            File.Delete(Path.GetTempPath() + "\\table.tmp");
                        }
                        //if (File.Exists(Path.GetTempPath() + "\\T8SuitePro.decode.exe"))
                        //{
                        //    File.Delete(Path.GetTempPath() + "\\T8SuitePro.decode.exe");
                        //}
                        //if (File.Exists(System.Windows.Forms.Application.StartupPath + "\\T8SuitePro.decode.exe"))
                        //{
                        //    File.Copy(System.Windows.Forms.Application.StartupPath + "\\T8SuitePro.decode.exe", Path.GetTempPath() + "\\T8SuitePro.decode.exe");
                        //}

                        // <GS-18062012> support for x64
                        //bool x64 = Detectx64Architecture();
                        //if (x64)
                        //{
                        //    mRecreateAllExecutableResources();

                        //    // rename T7.decode.exe to decode.exe
                        //    if (File.Exists(System.Windows.Forms.Application.StartupPath + "\\decode.exe"))
                        //    {
                        //        File.Delete(System.Windows.Forms.Application.StartupPath + "\\decode.exe");
                        //    }
                        //    File.Move(System.Windows.Forms.Application.StartupPath + "\\T8SuitePro.decode.exe", System.Windows.Forms.Application.StartupPath + "\\decode.exe");

                        //    if (File.Exists(System.Windows.Forms.Application.StartupPath + "\\decode.exe"))
                        //    {
                        //        if (File.Exists(Path.GetTempPath() + "\\decode.exe"))
                        //        {
                        //            File.Delete(Path.GetTempPath() + "\\decode.exe");
                        //        }
                        //        File.Copy(System.Windows.Forms.Application.StartupPath + "\\decode.exe", Path.GetTempPath() + "\\decode.exe");
                        //    }
                        //    File.Copy(System.Windows.Forms.Application.StartupPath + "\\COMPR", Path.GetTempPath() + "\\COMPR");
                        //    File.Copy(System.Windows.Forms.Application.StartupPath + "\\table.tmp", Path.GetTempPath() + "\\table.tmp");

                        //    string DosBoxPath = Path.Combine(System.Environment.GetEnvironmentVariable("ProgramFiles(x86)"), "DOSBox-0.74");
                        //    // write a dosbox.conf first
                        //    string confFile = Path.Combine(DosBoxPath, "t8dosb.conf");
                        //    if (!File.Exists(confFile))
                        //    {
                        //        using (StreamWriter sw = new StreamWriter(confFile, false))
                        //        {
                        //            sw.WriteLine("[autoexec]");
                        //            sw.WriteLine("cycles=max");
                        //            sw.WriteLine("mount c \"" + Path.GetTempPath() + "\"");
                        //            sw.WriteLine("c:");
                        //            sw.WriteLine("decode.exe");
                        //            sw.WriteLine("exit");
                        //        }
                        //    }

                        //    string Exename = Path.Combine(DosBoxPath, "DOSBox.exe");
                        //    ProcessStartInfo startinfo = new ProcessStartInfo(Exename);
                        //    startinfo.CreateNoWindow = true; // TRUE
                        //    startinfo.WindowStyle = ProcessWindowStyle.Hidden; // hidden
                        //    startinfo.Arguments = "-noconsole -conf t8dosb.conf";
                        //    startinfo.WorkingDirectory = DosBoxPath;
                        //    System.Diagnostics.Process conv_proc = System.Diagnostics.Process.Start(startinfo);
                        //    conv_proc.WaitForExit(30000);

                        //    if (!conv_proc.HasExited)
                        //    {
                        //        conv_proc.Kill();
                        //        retval = false;
                        //    }
                        //    else
                        //    {
                        //        // nu door compr.txt lopen
                        //        LogHelper.Log("Adding names to symbols");
                        //        if (File.Exists(System.Windows.Forms.Application.StartupPath + "\\COMPR.TXT"))
                        //        {
                        //            File.Delete(System.Windows.Forms.Application.StartupPath + "\\COMPR.TXT");
                        //        }
                        //        if (File.Exists(System.Windows.Forms.Application.StartupPath + "\\XTABLE.TMP"))
                        //        {
                        //            File.Delete(System.Windows.Forms.Application.StartupPath + "\\XTABLE.TMP");
                        //        }
                        //        if (File.Exists(Path.GetTempPath() + "\\COMPR.TXT"))
                        //        {
                        //            File.Copy(Path.GetTempPath() + "\\COMPR.TXT", System.Windows.Forms.Application.StartupPath + "\\COMPR.TXT");
                        //        }
                        //        if (File.Exists(Path.GetTempPath() + "\\XTABLE.TMP"))
                        //        {
                        //            File.Copy(Path.GetTempPath() + "\\XTABLE.TMP", System.Windows.Forms.Application.StartupPath + "\\XTABLE.TMP");
                        //        }
                        //        if (File.Exists(System.Windows.Forms.Application.StartupPath + "\\COMPR.TXT"))
                        //        {
                        //            AddNamesToSymbolsFromTableTmp(symbol_collection);
                        //        }
                        //    }
                        //}
                        //else
                        //{
                        //    mRecreateAllExecutableResources();
                        //    if (File.Exists(System.Windows.Forms.Application.StartupPath + "\\T8SuitePro.decode.exe"))
                        //    {
                        //        if (File.Exists(Path.GetTempPath() + "\\T8SuitePro.decode.exe")) File.Delete(Path.GetTempPath() + "\\T8SuitePro.decode.exe");
                        //        File.Copy(System.Windows.Forms.Application.StartupPath + "\\T8SuitePro.decode.exe", Path.GetTempPath() + "\\T8SuitePro.decode.exe");
                        //    }
                        //    File.Copy(System.Windows.Forms.Application.StartupPath + "\\COMPR", Path.GetTempPath() + "\\COMPR");
                        //    File.Copy(System.Windows.Forms.Application.StartupPath + "\\table.tmp", Path.GetTempPath() + "\\table.tmp");
                        //    string Exename = Path.Combine(Path.GetTempPath(), "T8SuitePro.decode.exe");

                        //    ProcessStartInfo startinfo = new ProcessStartInfo(Exename);
                        //    startinfo.CreateNoWindow = true;
                        //    startinfo.WindowStyle = ProcessWindowStyle.Hidden;
                        //    startinfo.WorkingDirectory = Path.GetTempPath();
                        //    System.Diagnostics.Process conv_proc = System.Diagnostics.Process.Start(startinfo);
                        //    conv_proc.WaitForExit(10000); // wait for 10 seconds max
                        //    if (!conv_proc.HasExited)
                        //    {
                        //        conv_proc.Kill();
                        //        retval = false;
                        //    }
                        //    else
                        //    {
                        //        // nu door compr.txt lopen
                        //        SetProgress("Arranging symbol list... ");
                        //        SetProgressPercentage(70);
                        //        System.Windows.Forms.Application.DoEvents();

                        //        LogHelper.Log("Adding names to symbols");
                        //        if (File.Exists(System.Windows.Forms.Application.StartupPath + "\\COMPR.TXT"))
                        //        {
                        //            File.Delete(System.Windows.Forms.Application.StartupPath + "\\COMPR.TXT");
                        //        }
                        //        if (File.Exists(System.Windows.Forms.Application.StartupPath + "\\XTABLE.TMP"))
                        //        {
                        //            File.Delete(System.Windows.Forms.Application.StartupPath + "\\XTABLE.TMP");
                        //        }
                        //        if (File.Exists(Path.GetTempPath() + "\\COMPR.TXT"))
                        //        {
                        //            File.Copy(Path.GetTempPath() + "\\COMPR.TXT", System.Windows.Forms.Application.StartupPath + "\\COMPR.TXT");
                        //        }
                        //        if (File.Exists(Path.GetTempPath() + "\\XTABLE.TMP"))
                        //        {
                        //            File.Copy(Path.GetTempPath() + "\\XTABLE.TMP", System.Windows.Forms.Application.StartupPath + "\\XTABLE.TMP");
                        //        }
                        //        if (File.Exists(System.Windows.Forms.Application.StartupPath + "\\COMPR.TXT"))
                        //        {
                        //            SetProgress("Finalizing list... ");
                        //            SetProgressPercentage(85);
                        //            System.Windows.Forms.Application.DoEvents();
                        //            AddNamesToSymbolsFromTableTmp(symbol_collection);
                        //        }
                        //    }
                        //}
                        //if (File.Exists(System.Windows.Forms.Application.StartupPath + "\\T8SuitePro.decode.exe"))
                        //{
                        //    File.Delete(System.Windows.Forms.Application.StartupPath + "\\T8SuitePro.decode.exe");
                        //}
                        //if (File.Exists(Path.GetTempPath() + "\\T8SuitePro.decode.exe"))
                        //{
                        //    File.Delete(Path.GetTempPath() + "\\T8SuitePro.decode.exe");
                        //}
                        string comprFilename = System.Windows.Forms.Application.StartupPath + @".\COMPR";
                        string symbolNamesFilename = System.Windows.Forms.Application.StartupPath + @".\COMPR.TXT";
                        string addressTableFilename = System.Windows.Forms.Application.StartupPath + @".\table.tmp";
                        string combinedTableFilename = System.Windows.Forms.Application.StartupPath + @".\XTABLE.TMP";
                        // Delete any files present from previous use
                        if (File.Exists(symbolNamesFilename))
                            File.Delete(symbolNamesFilename);
                        if (File.Exists(combinedTableFilename))
                            File.Delete(combinedTableFilename);
                        // Try to decode compressed symbol table
                        if (File.Exists(comprFilename))
                        {
                            if (File.Exists(addressTableFilename))
                            {
                                SetProgress("Arranging symbol list... ");
                                SetProgressPercentage(70);
                                System.Windows.Forms.Application.DoEvents();
                                // Read the compressed symbol table file
                                byte[] bytes = File.ReadAllBytes(comprFilename);
                                string[] symbols;
                                // Decompress the symbol table
                                TrionicSymbolDecompressor.ExpandComprStream(bytes, out symbols);
                                // Write the symbols to a file. 
                                File.WriteAllLines(symbolNamesFilename, symbols, Encoding.UTF8);
                                // Open the addresses file to read from.
                                string[] addresses = File.ReadAllLines(addressTableFilename, Encoding.UTF8);
                                // Combine symbol names and addresses
                                List<string> addressesAndSymbols = new List<string>();
                                addressesAndSymbols.Add(addresses[0]);
                                for (int i = 0; i < symbols.Length; i++)
                                {
                                    if (i < addresses.Length)
                                        addressesAndSymbols.Add(addresses[i + 1]);
                                    addressesAndSymbols.Add(symbols[i]);
                                }
                                File.WriteAllLines(combinedTableFilename, addressesAndSymbols.ToArray(), Encoding.UTF8);
                            }
                            else
                            {
                                LogHelper.Log("!!! Could not find table.tmp file :-(");
                            }
                        }
                        else
                        {
                            LogHelper.Log("!!! Could not find COMPR file :-(");
                        }
                        if (File.Exists(combinedTableFilename))
                        {
                            SetProgress("Finalizing list... ");
                            SetProgressPercentage(85);
                            System.Windows.Forms.Application.DoEvents();
                            AddNamesToSymbolsFromTableTmp(symbol_collection);
                        }
                    }
                }
                else
                {
                    MessageBox.Show("Could not find address table!");
                    retval = false;
                }
            }
            return retval;
        }

        private void DumpToSymbolFile(string p)
        {
            using (StreamWriter sw = new StreamWriter(@"C:\Documents and Settings\Guido.MOBICOACH\My Documents\Prive\SAAB\Trionic 8\Dev\SymbolAddressIssue\Addresses.txt", true))
            {
                sw.WriteLine(p);
            }
        } 

        private void DumpBytesToConsole(byte[] bytes)
        {
            string line = "symbol bytes: ";
            foreach (byte b in bytes)
            {
                line += b.ToString("X2") + " ";
            }
            LogHelper.Log(line);
        }
        private void DumpSymbolAddressTable(SymbolCollection symbol_collection)
        {
            // export to table.tmp
            //4538 EB0C8P1C.56O F5DB0074
            //05909C 68F5 04 

            using (StreamWriter sw = new StreamWriter(System.Windows.Forms.Application.StartupPath + "\\table.tmp", false))
            {

                sw.WriteLine(symbol_collection.Count.ToString() + " " + "VAGFHGFSD" + " 00000000");
                sw.WriteLine("");
                sw.WriteLine("");
                foreach (SymbolHelper sh in symbol_collection)
                {
                    if (sh.Length < 0x1000)
                    {
                        sw.WriteLine(sh.Flash_start_address.ToString("X6") + " " + sh.Length.ToString("X4") + " " + sh.Symbol_type.ToString("X2"));
                    }
                }
            }
        }
        private void AddNamesToSymbolsFromTableTmp(SymbolCollection symbol_collection)
        {
            SymbolTranslator translator = new SymbolTranslator();
            SetProgress("Loading...");
            string symbolNamesFilename = System.Windows.Forms.Application.StartupPath + @".\COMPR.TXT";
            string combinedTableFilename = System.Windows.Forms.Application.StartupPath + @".\XTABLE.TMP";

            string[] xtablelines = File.ReadAllLines(combinedTableFilename);
            string line = string.Empty;
            int flashaddress = 0;
            int length = 0;
            char[] sep = new char[1];
            sep.SetValue(' ', 0);

            string addresses = string.Empty;
            string symbol = string.Empty;
            for (int i = 4; i < xtablelines.Length; i++)
            {
                line = xtablelines[i];
                try
                {
                    if (line.Length > 2)
                    {
                        if (!line.Contains(" "))
                        {
                            // dan is het een symbool
                            symbol = line.Trim();
                        }
                        else
                        {
                            addresses = line;
                            string[] addvalues = addresses.Split(sep);
                            if (addvalues.Length >= 3)
                            {
                                flashaddress = Convert.ToInt32((string)addvalues.GetValue(0), 16);
                                length = Convert.ToInt32((string)addvalues.GetValue(1), 16);
                                foreach (SymbolHelper sh in symbol_collection)
                                {
                                    if (sh.Flash_start_address == flashaddress)
                                    {
                                        sh.Varname = symbol;
                                        sh.Length = length;
                                        break;
                                    }
                                }
                            }
                        }
                    }
                }
                catch (Exception E)
                {
                    LogHelper.Log("Failed to add symbolnames: " + E.Message);
                    LogHelper.Log("Failed to add symbolnames line: " + line);
                }
            }
            SetProgress("Combining...");

            string[] comprlines = File.ReadAllLines(symbolNamesFilename);
            line = string.Empty;
            flashaddress = 0;
            length = 0;

            addresses = string.Empty;
            symbol = string.Empty;
            int idx = 0;

            for (int i = 1; i < comprlines.Length; i++)
            {
                line = comprlines[i];
                try
                {
                    symbol_collection[idx++].Varname = line;
                }
                catch (Exception E)
                {
                    LogHelper.Log("Failed to add symbolnames: " + E.Message + " line (2): " + line);
                }
            }
            SetProgress("Translating...");

            string help = string.Empty;
            XDFCategories category = XDFCategories.Undocumented;
            XDFSubCategory subcat = XDFSubCategory.Undocumented;
            foreach (SymbolHelper sh in symbol_collection)
            {
                sh.Description = translator.TranslateSymbolToHelpText(sh.Varname, out help, out category, out subcat);
                if (sh.Varname.Contains("."))
                {
                    try
                    {
                        sh.Category = sh.Varname.Substring(0, sh.Varname.IndexOf("."));
                    }
                    catch (Exception cE)
                    {
                        LogHelper.Log("Failed to assign category to symbol: " + sh.Varname + " err: " + cE.Message);
                    }
                }
            }
        }

        private void AddNamesToSymbolsFromTableTmpOld(SymbolCollection symbol_collection)
        {
            SymbolTranslator translator = new SymbolTranslator();
            using (StreamReader sr = new StreamReader(Path.Combine(System.Windows.Forms.Application.StartupPath, "XTABLE.TMP")))
            {
                sr.ReadLine();// header
                sr.ReadLine();//
                sr.ReadLine();//
                sr.ReadLine();//15092009
                string line = string.Empty;
                int flashaddress = 0;
                int length = 0;

                string addresses = string.Empty;
                string symbol = string.Empty;
                while ((line = sr.ReadLine()) != null)
                {
                    try
                    {
                        if (line.Length > 2)
                        {
                            if (!line.Contains(" "))
                            {
                                // dan is het een symbool
                                symbol = line.Trim();

                            }
                            else
                            {
                                addresses = line;
                                char[] sep = new char[1];
                                sep.SetValue(' ', 0);
                                string[] addvalues = addresses.Split(sep);
                                if (addvalues.Length >= 3)
                                {
                                    flashaddress = Convert.ToInt32((string)addvalues.GetValue(0), 16);
                                    length = Convert.ToInt32((string)addvalues.GetValue(1), 16);
                                    foreach (SymbolHelper sh in symbol_collection)
                                    {
                                        if (sh.Flash_start_address == flashaddress)
                                        {
                                            sh.Varname = symbol;
                                            //sh.Flash_start_address = flashaddress;
                                            sh.Length = length;
                                            /*if (symbol.StartsWith("BstKnkCal."))
                                            {
                                                LogHelper.Log("Sym: " + symbol + " addr: " + flashaddress.ToString("X8") + " len: " + length.ToString());
                                            }
                                            if (flashaddress == 0x000ABA38)
                                            {
                                                LogHelper.Log("Address match: " + symbol);
                                            }*/
                                        }
                                    }
                                }
                            }
                        }
                    }
                    catch (Exception E)
                    {
                        LogHelper.Log("Failed to add symbolnames: " + E.Message + " line: " + line);
                    }
                }
            }
            using (StreamReader sr = new StreamReader(Path.Combine(System.Windows.Forms.Application.StartupPath, "COMPR.TXT")))
            {
                string line = string.Empty;
                int flashaddress = 0;
                int length = 0;

                string addresses = string.Empty;
                string symbol = string.Empty;
                int idx = 0;
                sr.ReadLine();
                while ((line = sr.ReadLine()) != null)
                {
                    try
                    {
                        //LogHelper.Log("Current name: " + symbol_collection[idx].Varname);
                        symbol_collection[idx++].Varname = line;

                    }
                    catch (Exception E)
                    {
                        LogHelper.Log("Failed to add symbolnames: " + E.Message + " line (2): " + line);
                    }
                }
            }

            string help = string.Empty;
            XDFCategories category = XDFCategories.Undocumented;
            XDFSubCategory subcat = XDFSubCategory.Undocumented;
            foreach (SymbolHelper sh in symbol_collection)
            {
                sh.Description = translator.TranslateSymbolToHelpText(sh.Varname, out help, out category, out subcat);
                if (sh.Varname.Contains("."))
                {
                    try
                    {
                        sh.Category = sh.Varname.Substring(0, sh.Varname.IndexOf("."));
                    }
                    catch (Exception cE)
                    {
                        LogHelper.Log("Failed to assign category to symbol: " + sh.Varname + " err: " + cE.Message);
                    }
                }
            }
        }

        int m_currentfile_size = 0x100000;

        private int GetStartOfAddressTableOffset(string filename)
        {
            byte[] searchsequence = new byte[9];
            searchsequence.SetValue((byte)0x00, 0);
            searchsequence.SetValue((byte)0x00, 1);
            searchsequence.SetValue((byte)0x00, 2);
            searchsequence.SetValue((byte)0x00, 3);
            searchsequence.SetValue((byte)0x00, 4);
            searchsequence.SetValue((byte)0x00, 5);
            searchsequence.SetValue((byte)0x00, 6);
            searchsequence.SetValue((byte)0x00, 7);
            searchsequence.SetValue((byte)0x20, 8);
            int symboltableoffset = 0x30000;
            int AddressTableOffset = 0;
            FileStream fsread = new FileStream(filename, FileMode.Open, FileAccess.Read);
            using (BinaryReader br = new BinaryReader(fsread))
            {
                fsread.Seek(symboltableoffset, SeekOrigin.Begin);
                int adr_state = 0;
                while ((fsread.Position < 0x100000) && (AddressTableOffset == 0))
                {
                    byte adrb = br.ReadByte();
                    switch (adr_state)
                    {
                        case 0:
                            if (adrb == (byte)searchsequence.GetValue(0))
                            {

                                adr_state++;
                            }
                            break;
                        case 1:
                            if (adrb == (byte)searchsequence.GetValue(1)) adr_state++;
                            else
                            {
                                adr_state = 0;
                                fsread.Position -= 1;
                            }
                            break;
                        case 2:
                            if (adrb == (byte)searchsequence.GetValue(2)) adr_state++;
                            else
                            {
                                adr_state = 0;
                                fsread.Position -= 2;
                            }
                            break;
                        case 3:
                            if (adrb == (byte)searchsequence.GetValue(3)) adr_state++;
                            else
                            {
                                adr_state = 0;
                                fsread.Position -= 3;
                            }
                            break;
                        case 4:
                            if (adrb == (byte)searchsequence.GetValue(4)) adr_state++;
                            else
                            {
                                adr_state = 0;
                                fsread.Position -= 4;
                            }
                            break;
                        case 5:
                            if (adrb == (byte)searchsequence.GetValue(5)) adr_state++;
                            else
                            {
                                adr_state = 0;
                                fsread.Position -= 5;
                            }
                            break;
                        case 6:
                            if (adrb == (byte)searchsequence.GetValue(6)) adr_state++;
                            else
                            {
                                adr_state = 0;
                                fsread.Position -= 6;
                            }
                            break;
                        case 7:
                            if (adrb == (byte)searchsequence.GetValue(7)) adr_state++;
                            else
                            {
                                adr_state = 0;
                                fsread.Position -= 7;
                            }
                            break;
                        case 8:
                            /*if (fsread.Position > 0x5f900)
                            {
                                LogHelper.Log("Hola");
                            }
                            */
                            if (adrb == (byte)searchsequence.GetValue(8))
                            {
                                // found it
                                AddressTableOffset = (int)fsread.Position - 1;
                            }
                            else
                            {
                                adr_state = 0;
                                fsread.Position -= 8;
                            }
                            break;
                    }

                }
            }
            fsread.Close();
            return AddressTableOffset;
        }


        private int GetEndOfSymbolTable(string filename)
        {
            byte[] searchsequence = new byte[11];
            searchsequence.SetValue((byte)0x73, 0);
            searchsequence.SetValue((byte)0x59, 1);
            searchsequence.SetValue((byte)0x4D, 2);
            searchsequence.SetValue((byte)0x42, 3);
            searchsequence.SetValue((byte)0x4F, 4);
            searchsequence.SetValue((byte)0x4C, 5);
            searchsequence.SetValue((byte)0x74, 6);
            searchsequence.SetValue((byte)0x41, 7);
            searchsequence.SetValue((byte)0x42, 8);
            searchsequence.SetValue((byte)0x4C, 9);
            searchsequence.SetValue((byte)0x45, 10);
            int symboltableoffset = 0;
            int AddressTableOffset = 0;
            FileStream fsread = new FileStream(filename, FileMode.Open, FileAccess.Read);
            using (BinaryReader br = new BinaryReader(fsread))
            {
                fsread.Seek(symboltableoffset, SeekOrigin.Begin);
                int adr_state = 0;
                while ((fsread.Position < 0x100000) && (AddressTableOffset == 0))
                {
                    byte adrb = br.ReadByte();
                    switch (adr_state)
                    {
                        case 0:
                            if (adrb == (byte)searchsequence.GetValue(0))
                            {

                                adr_state++;
                            }
                            break;
                        case 1:
                            if (adrb == (byte)searchsequence.GetValue(1)) adr_state++;
                            else
                            {
                                adr_state = 0;
                                fsread.Position -= 1;
                            }
                            break;
                        case 2:
                            if (adrb == (byte)searchsequence.GetValue(2)) adr_state++;
                            else
                            {
                                adr_state = 0;
                                fsread.Position -= 2;
                            }
                            break;
                        case 3:
                            if (adrb == (byte)searchsequence.GetValue(3)) adr_state++;
                            else
                            {
                                adr_state = 0;
                                fsread.Position -= 3;
                            }
                            break;
                        case 4:
                            if (adrb == (byte)searchsequence.GetValue(4)) adr_state++;
                            else
                            {
                                adr_state = 0;
                                fsread.Position -= 4;
                            }
                            break;
                        case 5:
                            if (adrb == (byte)searchsequence.GetValue(5)) adr_state++;
                            else
                            {
                                adr_state = 0;
                                fsread.Position -= 5;
                            }
                            break;
                        case 6:
                            if (adrb == (byte)searchsequence.GetValue(6)) adr_state++;
                            else
                            {
                                adr_state = 0;
                                fsread.Position -= 6;
                            }
                            break;
                        case 7:
                            if (adrb == (byte)searchsequence.GetValue(7)) adr_state++;
                            else
                            {
                                adr_state = 0;
                                fsread.Position -= 7;
                            }
                            break;
                        case 8:
                            if (adrb == (byte)searchsequence.GetValue(8)) adr_state++;
                            else
                            {
                                adr_state = 0;
                                fsread.Position -= 8;
                            }
                            break;
                        case 9:
                            if (adrb == (byte)searchsequence.GetValue(9)) adr_state++;
                            else
                            {
                                adr_state = 0;
                                fsread.Position -= 9;
                            }
                            break;
                        case 10:
                            if (adrb == (byte)searchsequence.GetValue(10))
                            {
                                // found it
                                AddressTableOffset = (int)fsread.Position - 1;
                            }
                            else
                            {
                                adr_state = 0;
                                fsread.Position -= 10;
                            }
                            break;
                    }

                }
            }
            fsread.Close();
            return AddressTableOffset;
        }
        private int GetFirstNqStringFromOffset(int offset, string filename)
        {
            int retval = 0;
            int Nq1 = 0;
            int Nq2 = 0;
            int Nq3 = 0;
            if (filename != string.Empty)
            {
                if (File.Exists(filename))
                {
                    FileStream fs = new FileStream(filename, FileMode.Open, FileAccess.Read);
                    BinaryReader br = new BinaryReader(fs);
                    try
                    {
                        fs.Seek(offset, SeekOrigin.Begin);
                        bool found = false;
                        int state = 0;
                        while (!found && fs.Position < (offset + 0x100))
                        {
                            switch (state)
                            {
                                case 0:
                                    if (br.ReadByte() == 0x4E) state++;
                                    break;
                                case 1:
                                    if (br.ReadByte() == 0x71) state++;
                                    else state = 0;
                                    break;
                                case 2:
                                    Nq1 = (int)fs.Position;
                                    if (br.ReadByte() == 0x4E) state++;
                                    else state = 0;
                                    break;
                                case 3:
                                    if (br.ReadByte() == 0x71) state++;
                                    else state = 0;
                                    break;
                                case 4:
                                    Nq2 = (int)fs.Position;
                                    if (br.ReadByte() == 0x4E) state++;
                                    else state = 0;
                                    break;
                                case 5:
                                    if (br.ReadByte() == 0x71) state++;
                                    else state = 0;
                                    break;
                                case 6:
                                    found = true;
                                    Nq3 = (int)fs.Position;
                                    retval = (int)fs.Position;
                                    break;
                            }
                        }
                    }
                    catch (Exception E)
                    {
                        LogHelper.Log("Failed to retrieve NqNqNq from: " + offset.ToString("X6"));
                    }
                    fs.Close();
                }
            }
            if (Nq3 == 0) retval = Nq2;
            if (retval == 0) retval = Nq1;
            return retval;
        }

        private int GetLastNqStringFromOffset(int offset, string filename)
        {
            int retval = 0;
            int Nq1 = 0;
            int Nq2 = 0;
            int Nq3 = 0;
            if (filename != string.Empty)
            {
                if (File.Exists(filename))
                {
                    FileStream fs = new FileStream(filename, FileMode.Open, FileAccess.Read);
                    BinaryReader br = new BinaryReader(fs);
                    try
                    {
                        fs.Seek(offset, SeekOrigin.Begin);
                        bool found = false;
                        int state = 0;
                        while (!found && fs.Position < (offset + 0x100))
                        {
                            switch (state)
                            {
                                case 0:
                                    if (br.ReadByte() == 0x4E) state++;
                                    break;
                                case 1:
                                    if (br.ReadByte() == 0x71) state++;
                                    else state = 0;
                                    break;
                                case 2:
                                    Nq1 = (int)fs.Position;
                                    if (br.ReadByte() == 0x4E) state++;
                                    else state = 0;
                                    break;
                                case 3:
                                    if (br.ReadByte() == 0x71) state++;
                                    else state = 0;
                                    break;
                                case 4:
                                    Nq2 = (int)fs.Position;
                                    if (br.ReadByte() == 0x4E) state++;
                                    else state = 0;
                                    break;
                                case 5:
                                    if (br.ReadByte() == 0x71) state++;
                                    else state = 0;
                                    break;
                                case 6:
                                    found = true;
                                    Nq3 = (int)fs.Position;
                                    retval = (int)fs.Position;
                                    break;
                            }
                        }
                    }
                    catch (Exception E)
                    {
                        LogHelper.Log("Failed to retrieve NqNqNq from: " + offset.ToString("X6"));
                    }
                    fs.Close();
                }
            }
            if (Nq3 == 0) retval = Nq2;
            if (retval == 0) retval = Nq1;
            return retval;
        }

        private int GetNqNqNqStringFromOffset(int offset, string filename)
        {
            int retval = 0;
            if (filename != string.Empty)
            {
                if (File.Exists(filename))
                {
                    FileStream fs = new FileStream(filename, FileMode.Open, FileAccess.Read);
                    BinaryReader br = new BinaryReader(fs);
                    try
                    {
                        fs.Seek(offset, SeekOrigin.Begin);
                        bool found = false;
                        int state = 0;
                        while (!found && fs.Position < (offset + 0x100))
                        {
                            switch (state)
                            {
                                case 0:
                                    if (br.ReadByte() == 0x4E) state++;
                                    break;
                                case 1:
                                    if (br.ReadByte() == 0x71) state++;
                                    else state = 0;
                                    break;
                                case 2:
                                    if (br.ReadByte() == 0x4E) state++;
                                    else state = 0;
                                    break;
                                case 3:
                                    if (br.ReadByte() == 0x71) state++;
                                    else state = 0;
                                    break;
                                case 4:
                                    if (br.ReadByte() == 0x4E) state++;
                                    else state = 0;
                                    break;
                                case 5:
                                    if (br.ReadByte() == 0x71) state++;
                                    else state = 0;
                                    break;
                                case 6:
                                    found = true;
                                    retval = (int)fs.Position;
                                    break;
                            }
                        }
                    }
                    catch (Exception E)
                    {
                        LogHelper.Log("Failed to retrieve NqNqNq from: " + offset.ToString("X6"));
                    }
                    fs.Close();
                }
            }
            return retval;
        }

        private int GetAddressFromOffset(int offset, string filename)
        {
            int retval = 0;
            if (filename != string.Empty)
            {
                if (File.Exists(filename))
                {
                    // read the file footer
                    //3ff00 - 0x3ffff
                    FileStream fs = new FileStream(filename, FileMode.Open, FileAccess.Read);
                    BinaryReader br = new BinaryReader(fs);
                    try
                    {
                        fs.Seek(offset, SeekOrigin.Begin);
                        retval = Convert.ToInt32(br.ReadByte()) * 256 * 256 * 256;
                        retval += Convert.ToInt32(br.ReadByte()) * 256 * 256;
                        retval += Convert.ToInt32(br.ReadByte()) * 256;
                        retval += Convert.ToInt32(br.ReadByte());
                    }
                    catch (Exception E)
                    {
                        LogHelper.Log("Failed to retrieve address from: " + offset.ToString("X6"));
                    }
                    fs.Close();
                }
            }
            return retval;
        }


        private int GetLengthFromOffset(int offset, string filename)
        {
            int retval = 0;
            if (filename != string.Empty)
            {
                if (File.Exists(filename))
                {
                    // read the file footer
                    //3ff00 - 0x3ffff
                    FileStream fs = new FileStream(filename, FileMode.Open, FileAccess.Read);
                    BinaryReader br = new BinaryReader(fs);
                    try
                    {
                        fs.Seek(offset, SeekOrigin.Begin);
                        retval = Convert.ToInt32(br.ReadByte()) * 256;
                        retval += Convert.ToInt32(br.ReadByte());
                    }
                    catch (Exception E)
                    {
                        LogHelper.Log("Failed to retrieve length from: " + offset.ToString("X6"));
                    }
                    fs.Close();
                }
            }
            return retval;
        }

        public bool UnpackFileUsingDecode(string filename, out int symboltableoffset)
        {
            Int64 UnpackedLength = 0;
            symboltableoffset = 0;
            int len = 0;
            int val = 0;
            //int idx = ReadEndMarker(0x9B);
            try
            {
                //int idx = ReadMarkerAddressContent(filename, 0x9B, out len, out val);
                //if (idx > 0)
                {
                    /* if (val > m_currentfile_size)
                     {
                         // try to find the addresstable offset
                         int addrtaboffset = GetStartOfAddressTableOffset(filename);
                         //TODO: Finish for abused packed files!
                     }*/
                    // FAILSAFE for some files that seem to have protection!
                    /*int addrtaboffset = GetStartOfAddressTableOffset(filename);
                    LogHelper.Log("addrtaboffset: " + addrtaboffset.ToString("X8"));
                    //int NqNqNqOffset = GetNqNqNqStringFromOffset(addrtaboffset - 0x100, filename);
                    int NqNqNqOffset = GetLastNqStringFromOffset(addrtaboffset - 0x100, filename);
                    LogHelper.Log("NqNqNqOffset: " + NqNqNqOffset.ToString("X8"));*/

                    //<GS-22032010>
                    int addrtaboffset = GetEndOfSymbolTable(filename);
                    LogHelper.Log("EndOfSymbolTable: " + addrtaboffset.ToString("X8"));
                    int NqNqNqOffset = GetFirstNqStringFromOffset(addrtaboffset, filename);
                    LogHelper.Log("NqNqNqOffset: " + NqNqNqOffset.ToString("X8"));
                    //<GS-22032010>

                    int symbtaboffset = GetAddressFromOffset(NqNqNqOffset, filename);
                    LogHelper.Log("symbtaboffset: " + symbtaboffset.ToString("X8"));
                    //int symbtaboffset = GetAddressFromOffset(addrtaboffset - 0x12, filename);
                    //                    symbtaboffset = NqNqNqOffset;
                    int symbtablength = GetLengthFromOffset(NqNqNqOffset + 4 /*addrtaboffset - 0x0E*/, filename);
                    LogHelper.Log("symbtablength: " + symbtablength.ToString("X8"));
                    if (symbtablength < 0x1000) return false; // NO SYMBOLTABLE IN FILE
                    //symbtaboffset -= 2;
                    if (symbtaboffset > 0 && symbtaboffset < 0xF0000)
                    {
                        val = symbtaboffset;

                    }
                    symboltableoffset = val;
                    // MessageBox.Show("Packed table index: " + idx.ToString("X6") + " " + val.ToString("X6"));
                    int state = 0;
                    FileStream fsread = new FileStream(filename, FileMode.Open, FileAccess.Read);
                    using (BinaryReader br = new BinaryReader(fsread))
                    {

                        fsread.Seek(val, SeekOrigin.Begin);

                        UnpackedLength = Convert.ToInt64(br.ReadByte());
                        UnpackedLength += Convert.ToInt64(br.ReadByte()) * 256;
                        UnpackedLength += Convert.ToInt64(br.ReadByte()) * 256 * 256;
                        UnpackedLength += Convert.ToInt64(br.ReadByte()) * 256 * 256 * 256;
                        LogHelper.Log("UnpackedLength: " + UnpackedLength.ToString("X8"));
                        fsread.Seek(val, SeekOrigin.Begin);

                        FileStream fswrite = new FileStream(System.Windows.Forms.Application.StartupPath + "\\COMPR", FileMode.Create);
                        using (BinaryWriter bw = new BinaryWriter(fswrite))
                        {
                            for (int bc = 0; bc < /*bytesread-10*/ symbtablength; bc++)
                            {
                                bw.Write(br.ReadByte());
                            }
                        }
                        fswrite.Close();
                        fswrite.Dispose();

                    }
                    fsread.Close();
                    fsread.Dispose();
                }
                if (UnpackedLength > 0x00FFFFFF) return false;
                return true;
            }
            catch (Exception E)
            {
                LogHelper.Log("Error 1: " + E.Message);
            }
            return false;
        }

        private int ReadMarkerAddressContent(string filename, int value, out int length, out int val)
        {
            int retval = 0;
            length = 0;
            val = 0;
            if (filename != string.Empty)
            {
                if (File.Exists(filename))
                {
                    // read the file footer
                    //3ff00 - 0x3ffff
                    FileStream fs = new FileStream(filename, FileMode.Open, FileAccess.Read);
                    BinaryReader br = new BinaryReader(fs);
                    int fileoffset = m_currentfile_size - 0x90;
                    try
                    {

                        fs.Seek(/*0x3FF00*/fileoffset, SeekOrigin.Begin);
                        byte[] inb = br.ReadBytes(0x8F);
                        //int offset = 0;
                        for (int t = 0; t < 0xFF; t++)
                        {
                            if (((byte)inb.GetValue(t) == (byte)value) && ((byte)inb.GetValue(t + 1) < 0x30))
                            {
                                // marker gevonden
                                // lees 6 terug
                                retval = /*0x3FF00*/ fileoffset + t;
                                length = (byte)inb.GetValue(t + 1);
                                break;
                            }
                        }
                        fs.Seek((retval - length), SeekOrigin.Begin);
                        byte[] info = br.ReadBytes(length);
                        for (int bc = info.Length - 1; bc >= 0; bc--)
                        {
                            int temp = Convert.ToInt32(info.GetValue(bc));
                            for (int mt = 0; mt < (3 - bc); mt++)
                            {
                                temp *= 256;
                            }
                            val += temp;
                        }
                    }
                    catch (Exception E)
                    {
                        LogHelper.Log("Error 2: " + E.Message);
                        retval = 0;
                    }
                    fs.Flush();
                    fs.Close();
                    fs.Dispose();

                }
            }

            return retval;

        }

        private int ReadMarkerAddress(string filename, int value, out int length, out string val)
        {
            int retval = 0;
            length = 0;
            val = string.Empty;
            if (filename != string.Empty)
            {
                if (File.Exists(filename))
                {
                    // read the file footer
                    //3ff00 - 0x3ffff
                    FileStream fs = new FileStream(filename, FileMode.Open, FileAccess.Read);
                    BinaryReader br = new BinaryReader(fs);
                    int fileoffset = m_currentfile_size - 0x100;

                    fs.Seek(/*0x3FF00*/fileoffset, SeekOrigin.Begin);
                    byte[] inb = br.ReadBytes(0xFF);
                    //int offset = 0;
                    for (int t = 0; t < 0xFF; t++)
                    {
                        if (((byte)inb.GetValue(t) == (byte)value) && ((byte)inb.GetValue(t + 1) < 0x30))
                        {
                            // marker gevonden
                            // lees 6 terug
                            retval = /*0x3FF00*/ fileoffset + t;
                            length = (byte)inb.GetValue(t + 1);
                            break;
                        }
                    }
                    fs.Seek((retval - length), SeekOrigin.Begin);
                    byte[] info = br.ReadBytes(length);
                    for (int bc = info.Length - 1; bc >= 0; bc--)
                    {
                        val += Convert.ToChar(info.GetValue(bc));
                    }
                    fs.Flush();
                    fs.Close();
                    fs.Dispose();

                }
            }

            return retval;
        }

        private void OpenFile(string filename)
        {
            CloseProject();
            m_currentfile = filename;
            TryToOpenFile(m_currentfile, out m_symbols, m_currentfile_size);

            Text = String.Format("T8SuitePro v{0} [ {1} ]", System.Windows.Forms.Application.ProductVersion, Path.GetFileName(m_currentfile));
            barFilenameText.Caption = Path.GetFileName(m_currentfile);
            gridControlSymbols.DataSource = m_symbols;
            m_appSettings.Lastfilename = m_currentfile;
            gridViewSymbols.BestFitColumns();
            UpdateChecksum(m_currentfile, m_appSettings.AutoChecksum);

            m_appSettings.LastOpenedType = 0;
        }

        private void barButtonItem1_ItemClick(object sender, DevExpress.XtraBars.ItemClickEventArgs e)
        {
            OpenFileDialog ofd = new OpenFileDialog();
            ofd.DefaultExt = "bin";
            ofd.Filter = "Trionic 8 binary files|*.bin;*.s19";
            ofd.Multiselect = false;
            if (ofd.ShowDialog() == DialogResult.OK)
            {
                string filename = string.Empty;
                if (ofd.FileName.ToUpper().EndsWith("S19"))
                {
                    srec2bin cvt = new srec2bin();

                    cvt.ConvertSrecToBin(ofd.FileName, out filename);
                }
                else
                {
                    filename = ofd.FileName;
                }
                OpenFile(filename);
            }
            //if (m_currentfile != string.Empty) LoadRealtimeTable();
        }

        private void gridView1_DoubleClick(object sender, EventArgs e)
        {
            StartTableViewer();
        }
        private void GetAxisDescriptions(string filename, SymbolCollection curSymbols, string symbolname, out string x, out string y, out string z)
        {
            x = "x-axis";
            y = "y-axis";
            z = "z-axis";
            SymbolAxesTranslator axestrans = new SymbolAxesTranslator();
            string x_axis = string.Empty;
            string y_axis = string.Empty;
            string x_axis_descr = string.Empty;
            string y_axis_descr = string.Empty;
            string z_axis_descr = string.Empty;
            axestrans.GetAxisSymbols(symbolname, out x_axis, out y_axis, out x_axis_descr, out y_axis_descr, out z_axis_descr);
            if (x_axis == "BstKnkCal.OffsetXSP")
            {
                if (!SymbolExists(x_axis)) x_axis = "BstKnkCal.fi_offsetXSP";
            }

            x = x_axis_descr;
            y = y_axis_descr;
            z = z_axis_descr;
        }

        private int GetSymbolLength(SymbolCollection curSymbolCollection, string symbolname)
        {
            foreach (SymbolHelper sh in curSymbolCollection)
            {
                if (sh.Varname == symbolname || sh.Userdescription == symbolname)
                {
                    return sh.Length;
                }
            }
            return 0;
        }

        private Int64 GetSymbolAddress(SymbolCollection curSymbolCollection, string symbolname)
        {
            foreach (SymbolHelper sh in curSymbolCollection)
            {
                if (sh.Varname == symbolname || sh.Userdescription == symbolname)
                {
                    return sh.Flash_start_address;
                }
            }
            return 0;
        }

        private int GetSymbolNumber(SymbolCollection curSymbolCollection, string symbolname)
        {
            foreach (SymbolHelper sh in curSymbolCollection)
            {
                if (sh.Varname == symbolname || sh.Userdescription == symbolname)
                {
                    return sh.Symbol_number;
                }
            }
            return 0;
        }

        private Int64 GetSymbolAddressSRAM(SymbolCollection curSymbolCollection, string symbolname)
        {
            foreach (SymbolHelper sh in curSymbolCollection)
            {
                if (sh.Varname == symbolname || sh.Userdescription == symbolname)
                {
                    return sh.Start_address;
                }
            }
            return 0;
        }

        private int GetTableMatrixWitdhByName(string filename, SymbolCollection curSymbols, string symbolname, out int columns, out int rows)
        {

            columns = 1;
            if (symbolname == "MisfCal.m_LoadLevelMAT") columns = 5;
            else if (symbolname == "PedalMapCal.GainFactorMap") columns = 16;
            else if (symbolname == "FrictionLoadCal.Trq_RequestT_EngMAP") columns = 9;
            else if (symbolname == "CatDiagCal.t_Ph3MaxMAT") columns = 7;

            else if (GetSymbolLength(curSymbols, symbolname) == 576) columns = 18;
            else if (GetSymbolLength(curSymbols, symbolname) == 672) columns = 16;
            else if (GetSymbolLength(curSymbols, symbolname) == 512) columns = 16;
            else if (GetSymbolLength(curSymbols, symbolname) == 504) columns = 14;
            else if (GetSymbolLength(curSymbols, symbolname) == 480) columns = 6;
            else if (GetSymbolLength(curSymbols, symbolname) == 416) columns = 16;
            else if (GetSymbolLength(curSymbols, symbolname) == 384) columns = 12;
            else if (GetSymbolLength(curSymbols, symbolname) == 336 && !symbolname.StartsWith("PurgeCal.")) columns = 16;
            else if (GetSymbolLength(curSymbols, symbolname) == 336 && symbolname.StartsWith("PurgeCal.")) columns = 12;
            else if (GetSymbolLength(curSymbols, symbolname) == 320) columns = 10;
            else if (GetSymbolLength(curSymbols, symbolname) == 306) columns = 9;
            else if (GetSymbolLength(curSymbols, symbolname) == 288) columns = 18;
            else if (GetSymbolLength(curSymbols, symbolname) == 256) columns = 8;
            else if (GetSymbolLength(curSymbols, symbolname) == 224) columns = 8;
            else if (GetSymbolLength(curSymbols, symbolname) == 220) columns = 10;
            else if (GetSymbolLength(curSymbols, symbolname) == 208) columns = 13;
            else if (GetSymbolLength(curSymbols, symbolname) == 204) columns = 6;
            else if (GetSymbolLength(curSymbols, symbolname) == 200) columns = 10;
            else if (GetSymbolLength(curSymbols, symbolname) == 192) columns = 8;
            else if (GetSymbolLength(curSymbols, symbolname) == 168) columns = 7;
            else if (GetSymbolLength(curSymbols, symbolname) == 140) columns = 7;
            else if (GetSymbolLength(curSymbols, symbolname) == 130) columns = 1;
            else if (GetSymbolLength(curSymbols, symbolname) == 128) columns = 8;
            else if (GetSymbolLength(curSymbols, symbolname) == 112) columns = 14;
            else if (GetSymbolLength(curSymbols, symbolname) == 100) columns = 10;
            else if (GetSymbolLength(curSymbols, symbolname) == 98) columns = 7;
            else if (GetSymbolLength(curSymbols, symbolname) == 80) columns = 8;
            else if (GetSymbolLength(curSymbols, symbolname) == 60) columns = 5;
            else if (GetSymbolLength(curSymbols, symbolname) == 50) columns = 5;
            else if (GetSymbolLength(curSymbols, symbolname) == 96) columns = 6;
            else if (GetSymbolLength(curSymbols, symbolname) == 64) columns = 4;
            else if (GetSymbolLength(curSymbols, symbolname) == 160) columns = 10;
            else if (GetSymbolLength(curSymbols, symbolname) == 72) columns = 9;
            else if (GetSymbolLength(curSymbols, symbolname) == 42) columns = 7; // testen... 
            if (symbolname.ToUpper().EndsWith("YSP") || symbolname.ToUpper().EndsWith("XSP") || symbolname.ToUpper().EndsWith("TAB")) columns = 1;
            rows = GetSymbolLength(curSymbols, symbolname) / columns;
            return columns;
        }

        private double GetMapCorrectionOffset(string symbolname)
        {
            double returnvalue = 0;
            return returnvalue;
        }

        private bool IsDigit(char c, out bool isdot)
        {
            isdot = false;
            if (c >= 0x30 && c <= 0x39) return true;
            if (c == '.')
            {
                isdot = true;
                return true;
            }
            if (c == ',')
            {
                isdot = true;
                return true;
            }
            return false;
        }

        private string ClearToNumber(string value)
        {
            string retval = string.Empty;
            bool dotseen = false;
            for (int t = 0; t < value.Length; t++)
            {
                bool isdot = false;
                if (IsDigit(value[t], out isdot))
                {
                    if (isdot)
                    {
                        if (!dotseen)
                        {
                            retval += value[t];
                        }
                        dotseen = true;
                    }
                    else
                    {
                        retval += value[t];
                    }
                }
                else
                {
                    return retval;
                }
            }
            return retval;
        }

        private double GetMapCorrectionFactor(string symbolname)
        {
            double returnvalue = 1;
            try
            {
                SymbolTranslator st = new SymbolTranslator();
                string helptext = string.Empty;
                XDFCategories cat = XDFCategories.Undocumented;
                XDFSubCategory subcat = XDFSubCategory.Undocumented;
                string text = st.TranslateSymbolToHelpText(symbolname, out helptext, out cat, out subcat);
                if (helptext.Contains("Resolution is"))
                {
                    int idx = helptext.IndexOf("Resolution is");
                    idx += 14;
                    string value = helptext.Substring(idx).Trim();
                    if (value.Contains(" "))
                    {
                        int idx2 = value.IndexOf(" ");
                        value = value.Substring(0, idx2);
                        value = ClearToNumber(value);
                        returnvalue = ConvertToDouble(value);
                    }
                    else
                    {
                        value = ClearToNumber(value);
                        returnvalue = ConvertToDouble(value);
                    }
                }
            }
            catch (Exception E)
            {
                LogHelper.Log(E.Message);
            }
            if (returnvalue == 0) returnvalue = 1;
            if (symbolname == "KnkSoundRedCal.fi_OffsMa") returnvalue = 0.1;
            else if (symbolname == "IgnE85Cal.fi_AbsMap") returnvalue = 0.1;
            else if (symbolname == "MAFCal.cd_ThrottleMap") returnvalue = 0.0009765625;
            else if (symbolname == "TrqMastCal.Trq_NominalMap") returnvalue = 0.1;
            else if (symbolname == "TrqMastCal.Trq_MBTMAP") returnvalue = 0.1;
            else if (symbolname == "AfterStCal.StartMAP") returnvalue = 0.0009765625; // 1/1024
            else if (symbolname == "KnkFuelCal.EnrichmentMap") returnvalue = 0.0009765625; // 1/1024
            else if (symbolname == "AfterStCal.HotSoakMAP") returnvalue = 0.0009765625; // 1/1024
            else if (symbolname == "MAFCal.NormAdjustFacMap") returnvalue = 0.0078125; // 1/128
            else if (symbolname == "BFuelCal.LambdaOneFacMap") returnvalue = 0.0078125; // 1/128
            else if (symbolname == "BFuelCal.TempEnrichFacMap") returnvalue = 0.0078125; // 1/128
            else if (symbolname == "BFuelCal.E85TempEnrichFacMap") returnvalue = 0.0078125; // 1/128
            else if (symbolname == "AfterStCal.AmbientMAP") returnvalue = 0.0078125; // 1/128
            else if (symbolname == "FFFuelCal.KnkEnrichmentMAP") returnvalue = 0.0078125; // 1/128
            else if (symbolname == "FFFuelCal.TempEnrichFacMAP") returnvalue = 0.0078125; // 1/128


            /** vanaf hier */
            returnvalue = SymbolDictionatry.GetSymbolUnit(symbolname);          
            /** tot hier **/

            //

            //MAFCal.NormAdjustFacMap (correctionfactor = 1/128)
            //BFuelCal.LambdaOneFacMap (correctionfactor = 1/128)
            //BFuelCal.TempEnrichFacMap (correctionfactor = 1/128)
            //AfterStCal.AmbientMAP (correctionfactor = 1/128)


            return returnvalue;
        }


        private double ConvertToDouble(string v)
        {
            double d = 0;
            if (v == "") return d;
            string vs = "";
            vs = v.Replace(System.Threading.Thread.CurrentThread.CurrentCulture.NumberFormat.NumberGroupSeparator, System.Threading.Thread.CurrentThread.CurrentCulture.NumberFormat.NumberDecimalSeparator);
            Double.TryParse(vs, out d);
            return d;
        }

        private bool GetMapUpsideDown(string symbolname)
        {
            return true;
        }

        private bool isSixteenBitTable(string symbolname)
        {
            bool retval = true;
            if (symbolname == "KnkDetCal.RefFactorMap") retval = false;
            else if (symbolname == "BFuelCal.Map") retval = false;
            else if (symbolname == "BFuelCal.StartMap") retval = false;
            else if (symbolname == "TorqueCal.M_IgnInflTorqM") retval = false;
            else if (symbolname == "TCompCal.EnrFacMap") retval = false;
            else if (symbolname == "TCompCal.EnrFacAutMap") retval = false;
            else if (symbolname == "AftSt2ExtraCal.EnrFacMap") retval = false;
            else if (symbolname == "AftSt1ExtraCal.EnrFacMap") retval = false;
            else if (symbolname == "StartCal.HighAltFacMap") retval = false;
            else if (symbolname == "BFuelCal.TempEnrichFacMap") retval = false;
            else if (symbolname == "BFuelCal.E85TempEnrichFacMap") retval = false;
            else if (symbolname == "BFuelCal.LambdaOneFacMap") retval = false;
            else if (symbolname == "MAFCal.NormAdjustFacMap") retval = false;
            else if (symbolname.StartsWith("FuelDynCal.m_FbetaMap")) retval = false;
            else if (symbolname.StartsWith("FuelDynCal.m_FalphaMap")) retval = false;
            else if (symbolname == "CatModCal.TSoakFacMAP") retval = false;
            else if (symbolname == "StartCal.ScaleFacRpmMap") retval = false;
            else if (symbolname == "ECUIDCal.ApplicationFileName") retval = false;
            else if (symbolname == "FFFuelCal.TempEnrichFacMAP") retval = false;
            //else if (symbolname == "PurgeCal.ValveMap16US") retval = false;
            //else if (symbolname == "PurgeCal.ValveMap16EU") retval = false;
            else if (GetSymbolLength(m_symbols, symbolname) % 2 == 1) retval = false;
            else if (GetSymbolLength(m_symbols, symbolname) == 336 && !symbolname.StartsWith("PurgeCal.")) retval = false;
            return retval;
        }

        private byte[] readdatafromfile(string filename, int address, int length)
        {
            if (length <= 0) return new byte[1];
            byte[] retval = new byte[length];
            try
            {
                FileStream fsi1 = File.OpenRead(filename);
                while (address > fsi1.Length) address -= (int)fsi1.Length;
                BinaryReader br1 = new BinaryReader(fsi1);
                fsi1.Position = address;
                string temp = string.Empty;
                for (int i = 0; i < length; i++)
                {
                    retval.SetValue(br1.ReadByte(), i);
                }
                fsi1.Flush();
                br1.Close();
                fsi1.Close();
                fsi1.Dispose();
            }
            catch (Exception E)
            {
                LogHelper.Log(E.Message);
            }
            return retval;
        }

        private int[] GetYaxisValues(string filename, SymbolCollection curSymbols, string symbolname)
        {
            int[] retval = new int[0];
            //retval.SetValue(0, 0);
            int yaxisaddress = 0;
            int yaxislength = 0;
            bool issixteenbit = true;
            int multiplier = 1;
            if (symbolname == "FuelDynCal.FuelModFacTab") issixteenbit = false;

            if (symbolname == "TrqLimCal.Trq_ManGear")
            {
                retval = new int[8];
                retval.SetValue(0, 0);
                retval.SetValue(1, 1);
                retval.SetValue(2, 2);
                retval.SetValue(3, 3);
                retval.SetValue(4, 4);
                retval.SetValue(5, 5);
                retval.SetValue(6, 6);
                retval.SetValue(-1, 7);
                return retval;
            }

            SymbolAxesTranslator axistranslator = new SymbolAxesTranslator();
            string x_axis = string.Empty;
            string y_axis = string.Empty;
            string x_axis_descr = string.Empty;
            string y_axis_descr = string.Empty;
            string z_axis_descr = string.Empty;
            if (axistranslator.GetAxisSymbols(symbolname, out x_axis, out y_axis, out x_axis_descr, out y_axis_descr, out z_axis_descr))
            {
                if (y_axis != "")
                {
                    yaxislength = GetSymbolLength(curSymbols, y_axis);
                    yaxisaddress = (int)GetSymbolAddress(curSymbols, y_axis);
                }
            }

            int number = yaxislength;
            if (yaxislength > 0)
            {
                byte[] axisdata = readdatafromfile(filename, yaxisaddress, yaxislength);
                if (issixteenbit) number /= 2;
                retval = new int[number];
                int offset = 0;
                for (int i = 0; i < yaxislength; i++)
                {

                    if (issixteenbit)
                    {
                        byte val1 = (byte)axisdata.GetValue(i);
                        byte val2 = (byte)axisdata.GetValue(++i);
                        int ival1 = Convert.ToInt32(val1);
                        int ival2 = Convert.ToInt32(val2);
                        int value = (ival1 * 256) + ival2;
                        value *= multiplier;
                        if (value > 0x8000)
                        {
                            value = 0x10000 - value;
                            value = -value;
                        }
                        retval.SetValue(value, offset++);
                    }
                    else
                    {
                        byte val1 = (byte)axisdata.GetValue(i);
                        int ival1 = Convert.ToInt32(val1);
                        ival1 *= multiplier;
                        retval.SetValue(ival1, offset++);
                    }
                }
            }
            return retval;
        }


        private int[] GetXaxisValues(string filename, SymbolCollection curSymbols, string symbolname)
        {
            int[] retval = new int[0];
            //retval.SetValue(0, 0);
            int xaxisaddress = 0;
            int xaxislength = 0;
            bool issixteenbit = true;
            int multiplier = 1;
            if (symbolname == "EvapDiagCal.LeakFacTest2MAT") issixteenbit = false;
            if (symbolname == "EvapDiagCal.LeakFacTest1MAT") issixteenbit = false;
            //      if (symbolname == "FuelDynCal.FuelModFacTab") issixteenbit = false;
            SymbolAxesTranslator axistranslator = new SymbolAxesTranslator();
            string x_axis = string.Empty;
            string y_axis = string.Empty;
            string x_axis_descr = string.Empty;
            string y_axis_descr = string.Empty;
            string z_axis_descr = string.Empty;
            if (axistranslator.GetAxisSymbols(symbolname, out x_axis, out y_axis, out x_axis_descr, out y_axis_descr, out z_axis_descr))
            {
                if (x_axis != "")
                {
                    if (x_axis == "BstKnkCal.OffsetXSP")
                    {
                        if (!SymbolExists(x_axis)) x_axis = "BstKnkCal.fi_offsetXSP";
                    }

                    xaxislength = GetSymbolLength(curSymbols, x_axis);
                    xaxisaddress = (int)GetSymbolAddress(curSymbols, x_axis);
                }
            }


            int number = xaxislength;
            if (xaxislength > 0)
            {
                byte[] axisdata = readdatafromfile(filename, xaxisaddress, xaxislength);
                if (issixteenbit) number /= 2;
                retval = new int[number];
                int offset = 0;
                for (int i = 0; i < xaxislength; i++)
                {

                    if (issixteenbit)
                    {
                        byte val1 = (byte)axisdata.GetValue(i);
                        byte val2 = (byte)axisdata.GetValue(++i);
                        int ival1 = Convert.ToInt32(val1);
                        int ival2 = Convert.ToInt32(val2);
                        int value = (ival1 * 256) + ival2;

                        value *= multiplier;
                        retval.SetValue(value, offset++);
                    }
                    else
                    {
                        byte val1 = (byte)axisdata.GetValue(i);
                        int ival1 = Convert.ToInt32(val1);

                        ival1 *= multiplier;
                        retval.SetValue(ival1, offset++);
                    }
                }
            }
            return retval;
        }

        private void savedatatobinary(int address, int length, byte[] data, string filename, bool DoTransActionEntry)
        {
            if (address > 0 && address < 0x100000)
            {
                try
                {
                    byte[] beforedata = readdatafromfile(filename, address, length);
                    FileStream fsi1 = File.OpenWrite(filename);
                    BinaryWriter bw1 = new BinaryWriter(fsi1);
                    fsi1.Position = address;
                    for (int i = 0; i < length; i++)
                    {
                        bw1.Write((byte)data.GetValue(i));
                    }
                    fsi1.Flush();
                    bw1.Close();
                    fsi1.Close();
                    fsi1.Dispose();

                    if (m_ProjectTransactionLog != null && DoTransActionEntry)
                    {
                        TransactionEntry tentry = new TransactionEntry(DateTime.Now, address, length, beforedata, data, 0, 0, "");
                        m_ProjectTransactionLog.AddToTransactionLog(tentry);
                        SignalTransactionLogChanged(tentry.SymbolAddress, tentry.Note);
                    }

                }
                catch (Exception E)
                {
                    frmInfoBox info = new frmInfoBox("Failed to write to binary. Is it read-only? Details: " + E.Message);
                }
            }
        }

        void tabdet_onSymbolSave(object sender, IMapViewer.SaveSymbolEventArgs e)
        {
            if (sender is IMapViewer)
            {
                // juiste filename kiezen 
                IMapViewer tabdet = (IMapViewer)sender;

                string note = string.Empty;
                if (m_appSettings.RequestProjectNotes && m_CurrentWorkingProject != "")
                {
                    //request a small note from the user in which he/she can denote a description of the change
                    frmChangeNote changenote = new frmChangeNote();
                    changenote.ShowDialog();
                    note = changenote.Note;
                }

                savedatatobinary(e.SymbolAddress, e.SymbolLength, e.SymbolDate, e.Filename, true, note);
                UpdateChecksum(e.Filename, true);
                //tabdet.Map_content = readdatafromfile(e.Filename, e.SymbolAddress, e.SymbolLength);
            }
        }

        private void savedatatobinary(int address, int length, byte[] data, string filename, bool DoTransActionEntry, string note)
        {
            if (address > 0 && address < 0x100000)
            {
                try
                {
                    byte[] beforedata = readdatafromfile(filename, address, length);
                    FileStream fsi1 = File.OpenWrite(filename);
                    BinaryWriter bw1 = new BinaryWriter(fsi1);
                    fsi1.Position = address;



                    for (int i = 0; i < length; i++)
                    {
                        bw1.Write((byte)data.GetValue(i));
                    }
                    fsi1.Flush();
                    bw1.Close();
                    fsi1.Close();
                    fsi1.Dispose();

                    if (m_ProjectTransactionLog != null && DoTransActionEntry)
                    {
                        TransactionEntry tentry = new TransactionEntry(DateTime.Now, address, length, beforedata, data, 0, 0, note);
                        m_ProjectTransactionLog.AddToTransactionLog(tentry);
                        SignalTransactionLogChanged(tentry.SymbolAddress, tentry.Note);
                    }

                }
                catch (Exception E)
                {
                    frmInfoBox info = new frmInfoBox("Failed to write to binary. Is it read-only? Details: " + E.Message);
                }
            }
        }

        void tabdet_onClose(object sender, EventArgs e)
        {
            // close the corresponding dockpanel
            if (sender is IMapViewer)
            {
                IMapViewer tabdet = (IMapViewer)sender;

                string dockpanelname = "Symbol: " + tabdet.Map_name + " [" + Path.GetFileName(tabdet.Filename) + "]";
                string dockpanelname2 = "SRAM Symbol: " + tabdet.Map_name + " [" + Path.GetFileName(tabdet.Filename) + "]";
                string dockpanelname3 = "Symbol difference: " + tabdet.Map_name + " [" + Path.GetFileName(tabdet.Filename) + "]";
                foreach (DockPanel dp in dockManager1.Panels)
                {
                    if (dp.Text == dockpanelname)
                    {
                        dockManager1.RemovePanel(dp);
                        break;
                    }
                    else if (dp.Text == dockpanelname2)
                    {
                        dockManager1.RemovePanel(dp);
                        break;
                    }
                    else if (dp.Text == dockpanelname3)
                    {
                        dockManager1.RemovePanel(dp);
                        break;
                    }

                }
            }
        }

        private void StartTableViewer()
        {
            if (gridViewSymbols.SelectedRowsCount > 0)
            {
                int[] selrows = gridViewSymbols.GetSelectedRows();

                if (selrows.Length > 0)
                {
                    if (gridViewSymbols.GroupCount > 0)
                    {
                        if (gridViewSymbols.GetRowLevel((int)selrows.GetValue(0)) < gridViewSymbols.GroupCount)
                        {
                            return;
                        }
                    }

                    SymbolHelper sh = (SymbolHelper)gridViewSymbols.GetRow((int)selrows.GetValue(0));
                    //DataRowView dr = (DataRowView)gridViewSymbols.GetRow((int)selrows.GetValue(0));


                    if (sh == null) return;

                    string varname = sh.Varname;
                    if (varname.StartsWith("Symbol") && sh.Userdescription != "")
                    {
                        varname = sh.Userdescription;
                    }
                    if (sh.BitMask > 0)
                    {
                        // get all other symbols with the same address
                        StartBitMaskViewer(sh);
                        return;
                    }
                    if (sh.Flash_start_address > m_currentfile_size && !m_connectedToECU)
                    {
                        MessageBox.Show("Symbol outside of flash boundary, probably SRAM only symbol");
                        return;
                    }





                    DockPanel dockPanel;
                    bool pnlfound = false;
                    try
                    {
                        foreach (DockPanel pnl in dockManager1.Panels)
                        {
                            if (pnl.Text == "Symbol: " + varname + " [" + Path.GetFileName(m_currentfile) + "]")
                            {
                                dockPanel = pnl;
                                pnlfound = true;
                                dockPanel.Show();
                            }
                        }
                    }
                    catch (Exception E)
                    {
                        LogHelper.Log(E.Message);
                    }
                    if (!pnlfound)
                    {
                        //dockPanel = dockManager1.AddPanel(new System.Drawing.Point(-500, -500));
                        dockManager1.BeginUpdate();
                        try
                        {


                            IMapViewer tabdet = new MapViewerEx(); //<GS-03012011>
                            tabdet.SetViewSize(m_appSettings.DefaultViewSize);
                            tabdet.Visible = false;
                            tabdet.Filename = m_currentfile;
                            tabdet.GraphVisible = m_appSettings.ShowGraphs;
                            tabdet.Viewtype = m_appSettings.DefaultViewType;
                            tabdet.DisableColors = m_appSettings.DisableMapviewerColors;
                            tabdet.AutoSizeColumns = m_appSettings.AutoSizeColumnsInWindows;
                            tabdet.IsRedWhite = m_appSettings.ShowRedWhite;
                            tabdet.Map_name = varname;
                            tabdet.Map_descr = "";//TranslateSymbolName(tabdet.Map_name);
                            tabdet.Map_cat = XDFCategories.Undocumented; //TranslateSymbolNameToCategory(tabdet.Map_name);

                            SymbolAxesTranslator axestrans = new SymbolAxesTranslator();
                            string x_axis = string.Empty;
                            string y_axis = string.Empty;
                            string x_axis_descr = string.Empty;
                            string y_axis_descr = string.Empty;
                            string z_axis_descr = string.Empty;
                            axestrans.GetAxisSymbols(varname, out x_axis, out y_axis, out x_axis_descr, out y_axis_descr, out z_axis_descr);
                            if (x_axis == "BstKnkCal.OffsetXSP")
                            {
                                if (!SymbolExists(x_axis)) x_axis = "BstKnkCal.fi_offsetXSP";
                            }

                            tabdet.X_axis_name = x_axis_descr;
                            tabdet.Y_axis_name = y_axis_descr;
                            tabdet.Z_axis_name = z_axis_descr;
                            tabdet.X_axisvalues = GetXaxisValues(m_currentfile, m_symbols, tabdet.Map_name);
                            tabdet.Y_axisvalues = GetYaxisValues(m_currentfile, m_symbols, tabdet.Map_name);
                            // z, y and z axis to do
                            if (!m_appSettings.NewPanelsFloating)
                            {
                                dockPanel = dockManager1.AddPanel(DockingStyle.Right);

                                if (m_appSettings.DefaultViewSize == ViewSize.NormalView)
                                {
                                    int dw = 650;
                                    if (tabdet.X_axisvalues.Length > 0)
                                    {
                                        dw = 30 + ((tabdet.X_axisvalues.Length + 1) * 35);
                                    }
                                    if (dw < 400) dw = 400;
                                    if (dw > 800) dw = 800;
                                    if (m_appSettings.ShowGraphs)
                                    {
                                        dockPanel.FloatSize = new Size(dw, 900);
                                    }
                                    else
                                    {
                                        dockPanel.FloatSize = new Size(dw, 500);
                                    }
                                }
                                else if (m_appSettings.DefaultViewSize == ViewSize.SmallView)
                                {
                                    int dw = 550;
                                    if (tabdet.X_axisvalues.Length > 0)
                                    {
                                        dw = 30 + ((tabdet.X_axisvalues.Length + 1) * 35);
                                    }
                                    if (dw < 380) dw = 380;
                                    if (dw > 600) dw = 600;
                                    if (m_appSettings.ShowGraphs)
                                    {
                                        dockPanel.FloatSize = new Size(dw, 850);
                                    }
                                    else
                                    {
                                        dockPanel.FloatSize = new Size(dw, 450);
                                    }
                                }
                                else if (m_appSettings.DefaultViewSize == ViewSize.ExtraSmallView)
                                {
                                    int dw = 450;
                                    if (tabdet.X_axisvalues.Length > 0)
                                    {
                                        dw = 30 + ((tabdet.X_axisvalues.Length + 1) * 30);
                                    }
                                    if (dw < 380) dw = 380;
                                    if (dw > 400) dw = 400;
                                    if (m_appSettings.ShowGraphs)
                                    {
                                        dockPanel.FloatSize = new Size(dw, 700);
                                    }
                                    else
                                    {
                                        dockPanel.FloatSize = new Size(dw, 450);
                                    }
                                }

                            }
                            else
                            {
                                System.Drawing.Point floatpoint = this.PointToClient(new System.Drawing.Point(dockSymbols.Location.X + dockSymbols.Width + 30, dockSymbols.Location.Y + 30));

                                dockPanel = dockManager1.AddPanel(floatpoint);
                                if (m_appSettings.DefaultViewSize == ViewSize.NormalView)
                                {
                                    int dw = 650;
                                    if (tabdet.X_axisvalues.Length > 0)
                                    {
                                        dw = 30 + ((tabdet.X_axisvalues.Length + 1) * 35);
                                    }
                                    if (dw < 400) dw = 400;
                                    if (dw > 800) dw = 800;
                                    if (m_appSettings.ShowGraphs)
                                    {
                                        dockPanel.FloatSize = new Size(dw, 900);
                                        tabdet.SetSplitter(0, 0, 280, false, false);

                                    }
                                    else
                                    {

                                        dockPanel.FloatSize = new Size(dw, 500);
                                    }
                                }
                                else if (m_appSettings.DefaultViewSize == ViewSize.SmallView)
                                {
                                    int dw = 550;
                                    if (tabdet.X_axisvalues.Length > 0)
                                    {
                                        dw = 30 + ((tabdet.X_axisvalues.Length + 1) * 35);
                                    }
                                    if (dw < 380) dw = 380;
                                    if (dw > 600) dw = 600;
                                    if (m_appSettings.ShowGraphs)
                                    {
                                        dockPanel.FloatSize = new Size(dw, 850);
                                        tabdet.SetSplitter(0, 0, 250, false, false);
                                        //tabdet.SetSurfaceGraphZoom(0.4);
                                    }
                                    else
                                    {

                                        dockPanel.FloatSize = new Size(dw, 450);
                                        //dockPanel.FloatSize = new Size(550, 450);
                                    }
                                }
                                else if (m_appSettings.DefaultViewSize == ViewSize.ExtraSmallView)
                                {
                                    int dw = 450;
                                    if (tabdet.X_axisvalues.Length > 0)
                                    {
                                        dw = 30 + ((tabdet.X_axisvalues.Length + 1) * 30);
                                    }
                                    if (dw < 380) dw = 380;
                                    if (dw > 400) dw = 400;
                                    if (m_appSettings.ShowGraphs)
                                    {
                                        dockPanel.FloatSize = new Size(dw, 700);
                                        tabdet.SetSplitter(0, 0, 320, false, false);
                                        // tabdet.SetSurfaceGraphZoom(0.5);
                                    }
                                    else
                                    {
                                        // dockPanel.FloatSize = new Size(450, 450);

                                        dockPanel.FloatSize = new Size(dw, 450);
                                    }
                                }
                                floatpoint = new System.Drawing.Point(Screen.PrimaryScreen.WorkingArea.Size.Width / 2 - dockPanel.FloatSize.Width / 2, Screen.PrimaryScreen.WorkingArea.Size.Height / 2 - dockPanel.FloatSize.Height / 2);
                                while ((floatpoint.X < (dockSymbols.Width + 20)) && ((floatpoint.X + dockSymbols.Width) < Screen.PrimaryScreen.WorkingArea.Size.Width)) floatpoint.X++;
                                dockPanel.FloatLocation = floatpoint;

                            }
                            dockPanel.Tag = m_currentfile;

                            /*string xdescr = string.Empty;
                            string ydescr = string.Empty;
                            string zdescr = string.Empty;
                            GetAxisDescriptions(m_currentfile, m_symbols, tabdet.Map_name, out xdescr, out ydescr, out zdescr);
                            tabdet.X_axis_name = xdescr;
                            tabdet.Y_axis_name = ydescr;
                            tabdet.Z_axis_name = zdescr;*/
                            int columns = 8;
                            int rows = 8;
                            int tablewidth = GetTableMatrixWitdhByName(m_currentfile, m_symbols, tabdet.Map_name, out columns, out rows);
                            int address = Convert.ToInt32(sh.Flash_start_address);

                            if (tabdet.X_axisvalues.Length > 1) columns = tabdet.X_axisvalues.Length;
                            if (tabdet.Y_axisvalues.Length > 1) rows = tabdet.Y_axisvalues.Length;
                            tablewidth = columns;

                            int sramaddress = 0;// Convert.ToInt32(dr.Row["SRAMADDRESS"].ToString());
                            if (address != 0)
                            {

                                while (address > m_currentfile_size) address -= m_currentfile_size;
                                tabdet.Map_address = address;
                                tabdet.Map_sramaddress = sramaddress;
                                int length = Convert.ToInt32(sh.Length);
                                tabdet.Map_length = length;
                                byte[] mapdata = readdatafromfile(m_currentfile, address, length);
                                tabdet.Map_content = mapdata;
                                tabdet.Correction_factor = GetMapCorrectionFactor(tabdet.Map_name);
                                tabdet.Correction_offset = GetMapCorrectionOffset(tabdet.Map_name);
                                tabdet.IsUpsideDown = GetMapUpsideDown(tabdet.Map_name);

                                if (m_connectedToECU)
                                {
                                    tabdet.IsRAMViewer = true;
                                    tabdet.OnlineMode = true;
                                }

                                tabdet.ShowTable(columns, isSixteenBitTable(tabdet.Map_name));
                                tabdet.Dock = DockStyle.Fill;
                                tabdet.onSymbolSave += new IMapViewer.NotifySaveSymbol(tabdet_onSymbolSave);
                                tabdet.onClose += new IMapViewer.ViewerClose(tabdet_onClose);
                                tabdet.onSelectionChanged += new IMapViewer.SelectionChanged(tabdet_onSelectionChanged);
                                tabdet.onSurfaceGraphViewChangedEx += new IMapViewer.SurfaceGraphViewChangedEx(mv_onSurfaceGraphViewChangedEx);
                                tabdet.onSymbolRead += new IMapViewer.NotifyReadSymbol(tabdet_onSymbolRead);

                                //tabdet.onAxisLock += new MapViewer.NotifyAxisLock(tabdet_onAxisLock);
                                //tabdet.onSliderMove += new MapViewer.NotifySliderMove(tabdet_onSliderMove);
                                //tabdet.onSelectionChanged += new MapViewer.SelectionChanged(tabdet_onSelectionChanged);
                                //tabdet.onSplitterMoved += new MapViewer.SplitterMoved(tabdet_onSplitterMoved);
                                //tabdet.onSurfaceGraphViewChanged += new MapViewer.SurfaceGraphViewChanged(tabdet_onSurfaceGraphViewChanged);
                                //tabdet.onGraphSelectionChanged += new MapViewer.GraphSelectionChanged(tabdet_onGraphSelectionChanged);
                                //tabdet.onViewTypeChanged += new MapViewer.ViewTypeChanged(tabdet_onViewTypeChanged);
                                //tabdet.onAxisEditorRequested += new MapViewer.AxisEditorRequested(tabdet_onAxisEditorRequested);
                                bool isDocked = false;
                                dockPanel.Text = "Symbol: " + tabdet.Map_name + " [" + Path.GetFileName(m_currentfile) + "]";
                                if (m_appSettings.AutoDockSameSymbol)
                                {
                                    foreach (DockPanel pnl in dockManager1.Panels)
                                    {
                                        if (pnl.Text.StartsWith("Symbol: " + tabdet.Map_name) && pnl != dockPanel && (pnl.Visibility == DockVisibility.Visible))
                                        {
                                            dockPanel.DockAsTab(pnl, 0);
                                            isDocked = true;
                                            break;
                                        }
                                    }
                                }
                                if (!isDocked)
                                {
                                    if (m_appSettings.AutoDockSameFile)
                                    {
                                        foreach (DockPanel pnl in dockManager1.Panels)
                                        {
                                            if ((string)pnl.Tag == m_currentfile && pnl != dockPanel && (pnl.Visibility == DockVisibility.Visible))
                                            {
                                                dockPanel.DockAsTab(pnl, 0);
                                                isDocked = true;
                                                break;
                                            }
                                        }
                                    }
                                }
                                if (!isDocked)
                                {

                                    //dockPanel.DockAsTab(dockPanel1);
                                    /*dockPanel.Text = "Symbol: " + tabdet.Map_name + " [" + Path.GetFileName(m_currentfile) + "]";
                                    int width = 400;
                                    if (m_appSettings.DefaultViewSize == ViewSize.NormalView)
                                    {
                                        width = 500;
                                    }
                                    if (m_appSettings.AutoSizeNewWindows)
                                    {
                                        //if (m_appSettings.DefaultViewSize == ViewSize.NormalView)
                                        {
                                            if (tabdet.X_axisvalues.Length > 0)
                                            {
                                                width = 30 + ((tabdet.X_axisvalues.Length + 1) * 40);
                                            }
                                            else
                                            {
                                                width = 30 + ((columns + 1) * 40);
                                                //width = this.Width - dockSymbols.Width - 10;
                                            }
                                            if (width < 500) width = 500;
                                            if (width > 800) width = 800;
                                        }
                                    }
                                    dockPanel.Width = width;*/
                                    int width = 400;
                                    if (m_appSettings.DefaultViewSize == ViewSize.NormalView)
                                    {
                                        width = 500;
                                    }
                                    if (m_appSettings.AutoSizeNewWindows)
                                    {
                                        if (m_appSettings.DefaultViewSize == ViewSize.NormalView)
                                        {
                                            if (tabdet.X_axisvalues.Length > 0)
                                            {
                                                width = 30 + ((tabdet.X_axisvalues.Length + 1) * 40);
                                            }
                                            else
                                            {
                                                //width = this.Width - dockSymbols.Width - 10;
                                            }
                                            if (width < 500) width = 500;
                                            if (width > 800) width = 800;
                                        }
                                        else if (m_appSettings.DefaultViewSize == ViewSize.SmallView)
                                        {
                                            if (tabdet.X_axisvalues.Length > 0)
                                            {
                                                width = 30 + ((tabdet.X_axisvalues.Length + 1) * 35);
                                            }
                                            else
                                            {
                                                //width = this.Width - dockSymbols.Width - 10;
                                            }
                                            if (width < 450) width = 450;
                                            if (width > 600) width = 600;

                                        }
                                        else if (m_appSettings.DefaultViewSize == ViewSize.ExtraSmallView)
                                        {
                                            if (tabdet.X_axisvalues.Length > 0)
                                            {
                                                width = 30 + ((tabdet.X_axisvalues.Length + 1) * 30);
                                            }
                                            else
                                            {
                                                //width = this.Width - dockSymbols.Width - 10;
                                            }
                                            if (width < 400) width = 400;
                                            if (width > 600) width = 600;


                                        }
                                    }
                                    dockPanel.Width = width;
                                }
                                dockPanel.Controls.Add(tabdet);
                            }
                            tabdet.Visible = true;
                        }
                        catch (Exception newdockE)
                        {
                            LogHelper.Log(newdockE.Message);
                        }
                        dockManager1.EndUpdate();
                    }
                    System.Windows.Forms.Application.DoEvents();
                }
            }

        }

        void tabdet_onSymbolRead(object sender, IMapViewer.ReadSymbolEventArgs e)
        {
            // reload data from the file
            IMapViewer tabdet = (IMapViewer)sender;
            tabdet.X_axisvalues = GetXaxisValues(m_currentfile, m_symbols, tabdet.Map_name);
            tabdet.Y_axisvalues = GetYaxisValues(m_currentfile, m_symbols, tabdet.Map_name);
            Int64 symaddress = GetSymbolAddress(m_symbols, tabdet.Map_name);
            int symlen = GetSymbolLength(m_symbols, tabdet.Map_name);
            int columns = 8;
            int rows = 8;
            int tablewidth = GetTableMatrixWitdhByName(m_currentfile, m_symbols, tabdet.Map_name, out columns, out rows);
            int address = Convert.ToInt32(symaddress);

            if (tabdet.X_axisvalues.Length > 1) columns = tabdet.X_axisvalues.Length;
            if (tabdet.Y_axisvalues.Length > 1) rows = tabdet.Y_axisvalues.Length;
            tablewidth = columns;

            int sramaddress = 0;// Convert.ToInt32(dr.Row["SRAMADDRESS"].ToString());
            if (address != 0)
            {

                while (address > m_currentfile_size) address -= m_currentfile_size;
                tabdet.Map_address = address;
                tabdet.Map_sramaddress = sramaddress;
                int length = Convert.ToInt32(symlen);
                tabdet.Map_length = length;
                byte[] mapdata = readdatafromfile(m_currentfile, address, length);
                tabdet.Map_content = mapdata;
                tabdet.Correction_factor = GetMapCorrectionFactor(tabdet.Map_name);
                tabdet.Correction_offset = GetMapCorrectionOffset(tabdet.Map_name);
                tabdet.IsUpsideDown = GetMapUpsideDown(tabdet.Map_name);
                tabdet.ShowTable(tablewidth, isSixteenBitTable(tabdet.Map_name));
            }

        }

        private void StartBitMaskViewer(SymbolHelper sh)
        {
            // check for SRAM file and/or connected ECU if symbol is outside flash area
            uint data = 0;
            if (sh.Flash_start_address > m_currentfile_size)
            {
                //TODO: Implement
                if (t8can.isOpen())
                {
                    bool success = false;
                    byte[] bdat = t8can.readMemory((int)sh.Flash_start_address, 2, out success);
                    if (success)
                    {
                        data = Convert.ToUInt32(bdat[0]) * 256;
                        data += Convert.ToUInt32(bdat[1]);
                    }
                    else
                    {
                        MessageBox.Show("Symbol outside of flash boundary and failed to read symbol from ECU");
                        return;
                    }
                }
                else
                {
                    MessageBox.Show("Symbol outside of flash boundary and no connection to ECU available");
                    return;
                }
            }
            else
            {
                byte[] bdat = readdatafromfile(m_currentfile, (int)sh.Flash_start_address, 2);
                data = Convert.ToUInt32(bdat[0]) * 256;
                data += Convert.ToUInt32(bdat[1]);
            }
            // get all other symbols with the same address
            SymbolCollection shview = new SymbolCollection();
            foreach (SymbolHelper shl in m_symbols)
            {
                if (shl.Flash_start_address == sh.Flash_start_address)
                {
                    shview.Add(shl);
                }
            }
            // start a viewer with the collection and the real data 
            frmBitmaskViewer view = new frmBitmaskViewer();
            view.SetInformation(shview, data);
            if (view.ShowDialog() == DialogResult.OK)
            {
                // save the data to the file && update checksum if set to auto
                byte[] bdata = new byte[2];
                byte b1 = Convert.ToByte(view.Data / 256);
                byte b2 = Convert.ToByte(view.Data - (int)b1 * 256);
                bdata.SetValue(b1, 0);
                bdata.SetValue(b2, 1);
                if (sh.Flash_start_address > m_currentfile_size)
                {
                    // save to ECU ... if possible
                }
                else
                {
                    savedatatobinary((int)sh.Flash_start_address, 2, bdata, m_currentfile, true);
                    if (m_appSettings.AutoChecksum) UpdateChecksum(m_currentfile, true);
                }
            }
        }

        void mv_onSurfaceGraphViewChangedEx(object sender, IMapViewer.SurfaceGraphViewChangedEventArgsEx e)
        {
            if (m_appSettings.SynchronizeMapviewers)
            {
                foreach (DockPanel pnl in dockManager1.Panels)
                {
                    foreach (Control c in pnl.Controls)
                    {
                        if (c is IMapViewer)
                        {
                            if (c != sender)
                            {
                                IMapViewer vwr = (IMapViewer)c;
                                if (vwr.Map_name == e.Mapname)
                                {
                                    vwr.SetSurfaceGraphViewEx(e.DepthX, e.DepthY, e.Zoom, e.Rotation, e.Elevation);
                                    vwr.Invalidate();
                                }
                            }
                        }
                        else if (c is DockPanel)
                        {
                            DockPanel tpnl = (DockPanel)c;
                            foreach (Control c2 in tpnl.Controls)
                            {
                                if (c2 is IMapViewer)
                                {
                                    if (c2 != sender)
                                    {
                                        IMapViewer vwr2 = (IMapViewer)c2;
                                        if (vwr2.Map_name == e.Mapname)
                                        {
                                            vwr2.SetSurfaceGraphViewEx(e.DepthX, e.DepthY, e.Zoom, e.Rotation, e.Elevation);
                                            vwr2.Invalidate();
                                        }
                                    }
                                }
                            }
                        }
                        else if (c is ControlContainer)
                        {
                            ControlContainer cntr = (ControlContainer)c;
                            foreach (Control c3 in cntr.Controls)
                            {
                                if (c3 is IMapViewer)
                                {
                                    if (c3 != sender)
                                    {
                                        IMapViewer vwr3 = (IMapViewer)c3;
                                        if (vwr3.Map_name == e.Mapname)
                                        {
                                            vwr3.SetSurfaceGraphViewEx(e.DepthX, e.DepthY, e.Zoom, e.Rotation, e.Elevation);
                                            vwr3.Invalidate();
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }


        void tabdet_onSelectionChanged(object sender, IMapViewer.CellSelectionChangedEventArgs e)
        {
            //<GS-22042010>
            // sync mapviewers maybe?
            if (m_appSettings.SynchronizeMapviewers)
            {
                // andere cell geselecteerd, doe dat ook bij andere viewers met hetzelfde symbool (mapname)
                foreach (DockPanel pnl in dockManager1.Panels)
                {
                    foreach (Control c in pnl.Controls)
                    {
                        if (c is IMapViewer)
                        {
                            if (c != sender)
                            {
                                IMapViewer vwr = (IMapViewer)c;
                                if (vwr.Map_name == e.Mapname)
                                {
                                    vwr.SelectCell(e.Rowhandle, e.Colindex);
                                    vwr.Invalidate();
                                }
                            }
                        }
                        else if (c is DockPanel)
                        {
                            DockPanel tpnl = (DockPanel)c;
                            foreach (Control c2 in tpnl.Controls)
                            {
                                if (c2 is IMapViewer)
                                {
                                    if (c2 != sender)
                                    {
                                        IMapViewer vwr2 = (IMapViewer)c2;
                                        if (vwr2.Map_name == e.Mapname)
                                        {
                                            vwr2.SelectCell(e.Rowhandle, e.Colindex);
                                            vwr2.Invalidate();
                                        }
                                    }
                                }
                            }
                        }
                        else if (c is ControlContainer)
                        {
                            ControlContainer cntr = (ControlContainer)c;
                            foreach (Control c3 in cntr.Controls)
                            {
                                if (c3 is IMapViewer)
                                {
                                    if (c3 != sender)
                                    {
                                        IMapViewer vwr3 = (IMapViewer)c3;
                                        if (vwr3.Map_name == e.Mapname)
                                        {
                                            vwr3.SelectCell(e.Rowhandle, e.Colindex);
                                            vwr3.Invalidate();
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }


        private void CreateRepositoryItem(string filename)
        {
            System.Data.DataTable dt = new System.Data.DataTable(Path.GetFileNameWithoutExtension(filename));
            dt.Columns.Add("Varname");
            dt.Columns.Add("Description");
            dt.Columns.Add("Flash_start_address", Type.GetType("System.Int32"));
            dt.Columns.Add("Internal_address", Type.GetType("System.Int32"));
            dt.Columns.Add("Length", Type.GetType("System.Int32"));
            dt.Columns.Add("Start_address", Type.GetType("System.Int32"));
            dt.Columns.Add("Symbol_number", Type.GetType("System.Int32"));
            dt.Columns.Add("Symbol_number_ECU", Type.GetType("System.Int32"));
            dt.Columns.Add("Userdescription");

            foreach (SymbolHelper sh in m_symbols)
            {
                dt.Rows.Add(sh.Varname, sh.Description, sh.Flash_start_address, sh.Internal_address, sh.Length, sh.Start_address, sh.Symbol_number, sh.Symbol_number_ECU, sh.Userdescription);
            }
            dt.WriteXml(filename);
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            ribbonControl1.Minimized = true;
            try
            {
                IMapViewer mv = new MapViewerEx();
            }
            catch (Exception E)
            {
                LogHelper.Log(E.Message);
            }
            LoadLayoutFiles();
            InitSkins();
            SetFilterMode();
            if (m_startFromCommandLine)
            {
                if (File.Exists(m_commandLineFile))
                {
                    m_currentfile = m_commandLineFile;
                    TryToOpenFile(m_commandLineFile, out m_symbols, m_currentfile_size);

                    Text = String.Format("T8SuitePro v{0} [ {1} ]", System.Windows.Forms.Application.ProductVersion, Path.GetFileName(m_currentfile));
                    barFilenameText.Caption = Path.GetFileName(m_currentfile);
                    gridControlSymbols.DataSource = m_symbols;
                    m_appSettings.Lastfilename = m_currentfile;
                    gridViewSymbols.BestFitColumns();
                    UpdateChecksum(m_currentfile, m_appSettings.AutoChecksum);


                }
            }
            else if (m_appSettings.AutoLoadLastFile)
            {
                if (m_appSettings.LastOpenedType == 0)
                {
                    if (m_appSettings.Lastfilename != "")
                    {
                        if (File.Exists(m_appSettings.Lastfilename))
                        {
                            m_currentfile = m_appSettings.Lastfilename;
                            TryToOpenFile(m_appSettings.Lastfilename, out m_symbols, m_currentfile_size);

                            Text = String.Format("T8SuitePro v{0} [ {1} ]", System.Windows.Forms.Application.ProductVersion, Path.GetFileName(m_currentfile));
                            barFilenameText.Caption = Path.GetFileName(m_currentfile);
                            gridControlSymbols.DataSource = m_symbols;
                            m_appSettings.Lastfilename = m_currentfile;
                            gridViewSymbols.BestFitColumns();
                            UpdateChecksum(m_currentfile, m_appSettings.AutoChecksum);


                        }
                    }
                }
                else if (m_appSettings.Lastprojectname != "")
                {
                    OpenProject(m_appSettings.Lastprojectname);
                }
            }
            if (m_appSettings.ShowMenu)
            {
                ribbonControl1.Minimized = false;
            }
            if (m_appSettings.DebugMode)
            {
                ribbonDebug.Visible = true;
            }

            LoadMyMaps();
        }

        private void StartTableViewer(string symbolname)
        {
            bool _vwrstarted = false;
            if (GetSymbolAddress(m_symbols, symbolname) > 0)
            {
                gridViewSymbols.ActiveFilter.Clear(); // clear filter

                SymbolCollection sc = (SymbolCollection)gridControlSymbols.DataSource;
                int rtel = 0;
                foreach (SymbolHelper sh in sc)
                {
                    if (sh.Varname == symbolname)
                    {
                        try
                        {
                            int rhandle = gridViewSymbols.GetRowHandle(rtel);
                            gridViewSymbols.OptionsSelection.MultiSelect = true;
                            gridViewSymbols.OptionsSelection.MultiSelectMode = DevExpress.XtraGrid.Views.Grid.GridMultiSelectMode.RowSelect;
                            gridViewSymbols.ClearSelection();
                            gridViewSymbols.SelectRow(rhandle);
                            //gridViewSymbols.SelectRows(rhandle, rhandle);
                            gridViewSymbols.MakeRowVisible(rhandle, true);
                            gridViewSymbols.FocusedRowHandle = rhandle;
                            //gridViewSymbols.SelectRange(rhandle, rhandle);
                            _vwrstarted = true;
                            StartTableViewer();
                            break;
                        }
                        catch (Exception E)
                        {
                            MessageBox.Show(E.Message);
                        }
                    }

                    rtel++;
                }
                if (!_vwrstarted)
                {
                    rtel = 0;
                    foreach (SymbolHelper sh in sc)
                    {
                        if (sh.Userdescription == symbolname)
                        {
                            try
                            {
                                int rhandle = gridViewSymbols.GetRowHandle(rtel);
                                gridViewSymbols.OptionsSelection.MultiSelect = true;
                                gridViewSymbols.OptionsSelection.MultiSelectMode = DevExpress.XtraGrid.Views.Grid.GridMultiSelectMode.RowSelect;
                                gridViewSymbols.ClearSelection();
                                gridViewSymbols.SelectRow(rhandle);
                                //gridViewSymbols.SelectRows(rhandle, rhandle);
                                gridViewSymbols.MakeRowVisible(rhandle, true);
                                gridViewSymbols.FocusedRowHandle = rhandle;
                                //gridViewSymbols.SelectRange(rhandle, rhandle);
                                _vwrstarted = true;
                                StartTableViewer();
                                break;
                            }
                            catch (Exception E)
                            {
                                MessageBox.Show(E.Message);
                            }
                        }
                        rtel++;
                    }
                }
            }
            else
            {
                MessageBox.Show("Symbol " + symbolname + " does not exist in this file");
            }
        }

        private string TranslateSymbolName(string symbolname)
        {
            return symbolname;
        }

        private void StartCompareMapViewer(string SymbolName, string Filename, int SymbolAddress, int SymbolLength, SymbolCollection curSymbols)
        {
            try
            {
                DockPanel dockPanel;
                bool pnlfound = false;
                foreach (DockPanel pnl in dockManager1.Panels)
                {

                    if (pnl.Text == "Symbol: " + SymbolName + " [" + Path.GetFileName(Filename) + "]")
                    {
                        dockPanel = pnl;
                        pnlfound = true;
                        dockPanel.Show();
                        // nog data verversen?
                        foreach (Control c in dockPanel.Controls)
                        {
                            /* if (c is MapViewer)
                             {
                                 MapViewer tempviewer = (MapViewer)c;
                                 tempviewer.Map_content
                             }*/
                        }
                    }
                }
                if (!pnlfound)
                {
                    dockManager1.BeginUpdate();
                    try
                    {
                        dockPanel = dockManager1.AddPanel(new System.Drawing.Point(-500, -500));
                        dockPanel.Tag = Filename;// m_currentfile; changed 24/01/2008
                        IMapViewer tabdet = new MapViewerEx(); //<GS-03012011>
                        tabdet.SetViewSize(m_appSettings.DefaultViewSize);

                        //tabdet.IsHexMode = barViewInHex.Checked;
                        tabdet.Viewtype = m_appSettings.DefaultViewType;
                        tabdet.DisableColors = m_appSettings.DisableMapviewerColors;
                        tabdet.AutoSizeColumns = m_appSettings.AutoSizeColumnsInWindows;
                        tabdet.GraphVisible = m_appSettings.ShowGraphs;
                        tabdet.IsRedWhite = m_appSettings.ShowRedWhite;
                        tabdet.Filename = Filename;
                        tabdet.Map_name = SymbolName;
                        tabdet.Map_descr = TranslateSymbolName(tabdet.Map_name);
                        tabdet.Map_cat = XDFCategories.Undocumented;
                        tabdet.X_axisvalues = GetXaxisValues(Filename, curSymbols, tabdet.Map_name);
                        tabdet.Y_axisvalues = GetYaxisValues(Filename, curSymbols, tabdet.Map_name);
                        string xdescr = string.Empty;
                        string ydescr = string.Empty;
                        string zdescr = string.Empty;
                        GetAxisDescriptions(Filename, curSymbols, tabdet.Map_name, out xdescr, out ydescr, out zdescr);
                        tabdet.X_axis_name = xdescr;
                        tabdet.Y_axis_name = ydescr;
                        tabdet.Z_axis_name = zdescr;

                        //tabdet.Map_sramaddress = GetSymbolAddressSRAM(SymbolName);
                        int columns = 8;
                        int rows = 8;
                        int tablewidth = GetTableMatrixWitdhByName(Filename, curSymbols, tabdet.Map_name, out columns, out rows);
                        int address = Convert.ToInt32(SymbolAddress);
                        if (address != 0)
                        {
                            while (address > m_currentfile_size) address -= m_currentfile_size;
                            tabdet.Map_address = address;
                            int length = SymbolLength;
                            tabdet.Map_length = length;
                            byte[] mapdata = readdatafromfile(Filename, address, length);
                            tabdet.Map_content = mapdata;
                            tabdet.Correction_factor = GetMapCorrectionFactor(tabdet.Map_name);
                            tabdet.Correction_offset = GetMapCorrectionOffset(tabdet.Map_name);
                            tabdet.IsUpsideDown = GetMapUpsideDown(tabdet.Map_name);
                            tabdet.ShowTable(columns, isSixteenBitTable(SymbolName));
                            tabdet.Dock = DockStyle.Fill;
                            tabdet.onSymbolSave += new IMapViewer.NotifySaveSymbol(tabdet_onSymbolSave);
                            tabdet.onClose += new IMapViewer.ViewerClose(tabdet_onClose);
                            tabdet.onSelectionChanged += new IMapViewer.SelectionChanged(tabdet_onSelectionChanged);
                            tabdet.onSurfaceGraphViewChangedEx += new IMapViewer.SurfaceGraphViewChangedEx(mv_onSurfaceGraphViewChangedEx);
                            //tabdet.onSymbolRead +=new IMapViewer.NotifyReadSymbol(tabdet_onSymbolRead);
                            //dockPanel.DockAsTab(dockPanel1);
                            dockPanel.Text = "Symbol: " + SymbolName + " [" + Path.GetFileName(Filename) + "]";
                            //dockPanel.DockTo(dockManager1, DevExpress.XtraBars.Docking.DockingStyle.Right, 0);
                            if (tabdet.X_axisvalues.Length > 0)
                            {
                                dockPanel.Width = 30 + ((tabdet.X_axisvalues.Length + 1) * 40);
                            }
                            else
                            {
                                //dockPanel.Width = this.Width - dockSymbols.Width - 10;

                            }
                            if (dockPanel.Width < 400) dockPanel.Width = 400;
                            //                    dockPanel.Width = 400;

                            bool isDocked = false;
                            if (m_appSettings.AutoDockSameSymbol)
                            {
                                foreach (DockPanel pnl in dockManager1.Panels)
                                {
                                    if (pnl.Text.StartsWith("Symbol: " + tabdet.Map_name) && pnl != dockPanel && (pnl.Visibility == DockVisibility.Visible))
                                    {
                                        dockPanel.DockAsTab(pnl, 0);
                                        isDocked = true;
                                        break;
                                    }
                                }
                            }
                            if (!isDocked)
                            {
                                if (m_appSettings.AutoDockSameFile)
                                {
                                    foreach (DockPanel pnl in dockManager1.Panels)
                                    {
                                        if ((string)pnl.Tag == m_currentfile && pnl != dockPanel && (pnl.Visibility == DockVisibility.Visible))
                                        {
                                            dockPanel.DockAsTab(pnl, 0);
                                            isDocked = true;
                                            break;
                                        }
                                    }
                                }
                            }
                            if (!isDocked)
                            {
                                int width = 400;
                                if (m_appSettings.DefaultViewSize == ViewSize.NormalView)
                                {
                                    width = 500;
                                }
                                if (m_appSettings.AutoSizeNewWindows)
                                {
                                    if (m_appSettings.DefaultViewSize == ViewSize.NormalView)
                                    {
                                        if (tabdet.X_axisvalues.Length > 0)
                                        {
                                            width = 30 + ((tabdet.X_axisvalues.Length + 1) * 35);
                                        }
                                        else
                                        {
                                            //width = this.Width - dockSymbols.Width - 10;
                                        }
                                        if (width < 500) width = 500;
                                        if (width > 800) width = 800;
                                    }
                                    else if (m_appSettings.DefaultViewSize == ViewSize.SmallView)
                                    {
                                        if (tabdet.X_axisvalues.Length > 0)
                                        {
                                            width = 30 + ((tabdet.X_axisvalues.Length + 1) * 35);
                                        }
                                        else
                                        {
                                            //width = this.Width - dockSymbols.Width - 10;
                                        }
                                        if (width < 450) width = 450;
                                        if (width > 600) width = 600;

                                    }
                                    else if (m_appSettings.DefaultViewSize == ViewSize.ExtraSmallView)
                                    {
                                        if (tabdet.X_axisvalues.Length > 0)
                                        {
                                            width = 30 + ((tabdet.X_axisvalues.Length + 1) * 30);
                                        }
                                        else
                                        {
                                            //width = this.Width - dockSymbols.Width - 10;
                                        }
                                        if (width < 400) width = 400;
                                        if (width > 600) width = 600;


                                    }
                                }
                                dockPanel.Width = width;
                                dockPanel.DockTo(dockManager1, DockingStyle.Right, 0);
                            }
                            dockPanel.Controls.Add(tabdet);
                            // dock to another panel?
                        }
                    }
                    catch (Exception E)
                    {
                        LogHelper.Log(E.Message);
                    }
                    dockManager1.EndUpdate();
                }
            }
            catch (Exception startnewcompareE)
            {
                LogHelper.Log(startnewcompareE.Message);
            }

        }

        private void StartCompareDifferenceViewer(string SymbolName, string Filename, int SymbolAddress, int SymbolLength)
        {
            DockPanel dockPanel;
            bool pnlfound = false;
            foreach (DockPanel pnl in dockManager1.Panels)
            {

                if (pnl.Text == "Symbol difference: " + SymbolName + " [" + Path.GetFileName(Filename) + "]")
                {
                    dockPanel = pnl;
                    pnlfound = true;
                    dockPanel.Show();
                }
            }
            if (!pnlfound)
            {
                dockManager1.BeginUpdate();
                try
                {
                    dockPanel = dockManager1.AddPanel(new System.Drawing.Point(-500, -500));
                    dockPanel.Tag = Filename;
                    IMapViewer tabdet = new MapViewerEx();
                    //tabdet.IsHexMode = true; // always in hexmode!
                    tabdet.Viewtype = m_appSettings.DefaultViewType;
                    tabdet.DisableColors = m_appSettings.DisableMapviewerColors;
                    tabdet.AutoSizeColumns = m_appSettings.AutoSizeColumnsInWindows;
                    tabdet.GraphVisible = m_appSettings.ShowGraphs;
                    tabdet.IsRedWhite = m_appSettings.ShowRedWhite;
                    tabdet.SetViewSize(m_appSettings.DefaultViewSize);
                    tabdet.Filename = Filename;
                    tabdet.Map_name = SymbolName;
                    //tabdet.Map_descr = TranslateSymbolName(tabdet.Map_name);
                    //tabdet.Map_cat = TranslateSymbolNameToCategory(tabdet.Map_name);
                    tabdet.X_axisvalues = GetXaxisValues(m_currentfile, m_symbols, tabdet.Map_name);
                    tabdet.Y_axisvalues = GetYaxisValues(m_currentfile, m_symbols, tabdet.Map_name);
                    string xdescr = string.Empty;
                    string ydescr = string.Empty;
                    string zdescr = string.Empty;
                    GetAxisDescriptions(m_currentfile, m_symbols, tabdet.Map_name, out xdescr, out ydescr, out zdescr);
                    tabdet.X_axis_name = xdescr;
                    tabdet.Y_axis_name = ydescr;
                    tabdet.Z_axis_name = zdescr;

                    //tabdet.Map_sramaddress = GetSymbolAddressSRAM(SymbolName);
                    int columns = 8;
                    int rows = 8;
                    int tablewidth = GetTableMatrixWitdhByName(m_currentfile, m_symbols, tabdet.Map_name, out columns, out rows);
                    int address = Convert.ToInt32(SymbolAddress);
                    if (address != 0)
                    {
                        while (address > m_currentfile_size) address -= m_currentfile_size;
                        tabdet.Map_address = address;
                        int length = SymbolLength;
                        tabdet.Map_length = length;
                        byte[] mapdata = readdatafromfile(Filename, address, length);
                        byte[] mapdata2 = readdatafromfile(m_currentfile, (int)GetSymbolAddress(m_symbols, SymbolName), GetSymbolLength(m_symbols, SymbolName));
                        byte[] mapdataorig = readdatafromfile(Filename, address, length);

                        tabdet.Map_original_content = mapdataorig;
                        tabdet.Map_compare_content = mapdata2;

                        if (mapdata.Length == mapdata2.Length)
                        {
                            if (isSixteenBitTable(SymbolName))
                            {
                                for (int bt = 0; bt < mapdata2.Length; bt += 2)
                                {
                                    int value1 = Convert.ToInt16(mapdata.GetValue(bt)) * 256 + Convert.ToInt16(mapdata.GetValue(bt + 1));
                                    int value2 = Convert.ToInt16(mapdata2.GetValue(bt)) * 256 + Convert.ToInt16(mapdata2.GetValue(bt + 1));

                                    value1 = Math.Abs((int)value1 - (int)value2);
                                    byte v1 = (byte)(value1 / 256);
                                    byte v2 = (byte)(value1 - (int)v1 * 256);
                                    mapdata.SetValue(v1, bt);
                                    mapdata.SetValue(v2, bt + 1);
                                }
                            }
                            else
                            {
                                for (int bt = 0; bt < mapdata2.Length; bt++)
                                {
                                    LogHelper.Log("Byte diff: " + mapdata.GetValue(bt).ToString() + " - " + mapdata2.GetValue(bt).ToString() + " = " + (byte)Math.Abs(((byte)mapdata.GetValue(bt) - (byte)mapdata2.GetValue(bt))));
                                    mapdata.SetValue((byte)Math.Abs(((byte)mapdata.GetValue(bt) - (byte)mapdata2.GetValue(bt))), bt);
                                }
                            }
                            tabdet.UseNewCompare = true;
                            tabdet.Map_content = mapdata;
                            tabdet.Correction_factor = GetMapCorrectionFactor(tabdet.Map_name);
                            tabdet.Correction_offset = GetMapCorrectionOffset(tabdet.Map_name);
                            tabdet.IsUpsideDown = GetMapUpsideDown(tabdet.Map_name);
                            tabdet.ShowTable(columns, isSixteenBitTable(SymbolName));
                            tabdet.Dock = DockStyle.Fill;
                            tabdet.onSymbolSave += new IMapViewer.NotifySaveSymbol(tabdet_onSymbolSave);
                            tabdet.onClose += new IMapViewer.ViewerClose(tabdet_onClose);
                            tabdet.onSelectionChanged += new IMapViewer.SelectionChanged(tabdet_onSelectionChanged);
                            tabdet.onSurfaceGraphViewChangedEx += new IMapViewer.SurfaceGraphViewChangedEx(mv_onSurfaceGraphViewChangedEx);

                            //tabdet.onAxisLock += new MapViewer.NotifyAxisLock(tabdet_onAxisLock);
                            //tabdet.onSliderMove += new MapViewer.NotifySliderMove(tabdet_onSliderMove);
                            //tabdet.onSelectionChanged += new MapViewer.SelectionChanged(tabdet_onSelectionChanged);
                            //tabdet.onSplitterMoved += new MapViewer.SplitterMoved(tabdet_onSplitterMoved);
                            //tabdet.onSurfaceGraphViewChanged += new MapViewer.SurfaceGraphViewChanged(tabdet_onSurfaceGraphViewChanged);
                            //tabdet.onGraphSelectionChanged += new MapViewer.GraphSelectionChanged(tabdet_onGraphSelectionChanged);
                            //tabdet.onViewTypeChanged += new MapViewer.ViewTypeChanged(tabdet_onViewTypeChanged);


                            //dockPanel.DockAsTab(dockPanel1);
                            dockPanel.Text = "Symbol difference: " + SymbolName + " [" + Path.GetFileName(Filename) + "]";
                            bool isDocked = false;
                            if (m_appSettings.AutoDockSameSymbol)
                            {
                                foreach (DockPanel pnl in dockManager1.Panels)
                                {
                                    if (pnl.Text.StartsWith("Symbol difference: " + SymbolName) && pnl != dockPanel && (pnl.Visibility == DockVisibility.Visible))
                                    {
                                        dockPanel.DockAsTab(pnl, 0);
                                        isDocked = true;
                                        break;
                                    }
                                }
                            }
                            if (!isDocked)
                            {
                                if (m_appSettings.AutoDockSameFile)
                                {
                                    foreach (DockPanel pnl in dockManager1.Panels)
                                    {
                                        if ((string)pnl.Tag == m_currentfile && pnl != dockPanel && (pnl.Visibility == DockVisibility.Visible))
                                        {
                                            dockPanel.DockAsTab(pnl, 0);
                                            isDocked = true;
                                            break;
                                        }
                                    }
                                }
                            }
                            if (!isDocked)
                            {
                                dockPanel.DockTo(dockManager1, DockingStyle.Right, 0);
                                if (m_appSettings.AutoSizeNewWindows)
                                {
                                    if (tabdet.X_axisvalues.Length > 0)
                                    {
                                        dockPanel.Width = 30 + ((tabdet.X_axisvalues.Length + 1) * 40);
                                    }
                                    else
                                    {
                                        //dockPanel.Width = this.Width - dockSymbols.Width - 10;

                                    }
                                }
                                if (dockPanel.Width < 400) dockPanel.Width = 400;

                                //                    dockPanel.Width = 400;
                            }
                            dockPanel.Controls.Add(tabdet);

                        }
                        else
                        {
                            MessageBox.Show("Map lengths don't match...");
                        }
                    }
                }
                catch (Exception E)
                {

                    LogHelper.Log(E.Message);
                }
                dockManager1.EndUpdate();
            }
        }

        void tabdet_onSymbolSelect(object sender, CompareResults.SelectSymbolEventArgs e)
        {
            LogHelper.Log(e.SymbolName);
            if (!e.ShowDiffMap)
            {
                StartTableViewer(e.SymbolName);
                StartCompareMapViewer(e.SymbolName, e.Filename, e.SymbolAddress, e.SymbolLength, e.Symbols);
            }
            else
            {
                // show difference map
                StartCompareDifferenceViewer(e.SymbolName, e.Filename, e.SymbolAddress, e.SymbolLength);
            }
        }

        private bool CompareSymbolToCurrentFile(string symbolname, int address, int length, string filename, out double diffperc, out int diffabs, out double diffavg)
        {
            diffperc = 0;
            diffabs = 0;
            diffavg = 0;

            double totalvalue1 = 0;
            double totalvalue2 = 0;
            bool retval = true;

            if (address > 0)
            {
                while (address > m_currentfile_size) address -= m_currentfile_size;
                int curaddress = (int)GetSymbolAddress(m_symbols, symbolname);
                while (curaddress > m_currentfile_size) curaddress -= m_currentfile_size;
                int curlength = GetSymbolLength(m_symbols, symbolname);
                byte[] curdata = readdatafromfile(m_currentfile, curaddress, curlength);
                byte[] compdata = readdatafromfile(filename, address, length);
                if (curdata.Length != compdata.Length)
                {
                    return false;
                }
                for (int offset = 0; offset < curdata.Length; offset++)
                {
                    if ((byte)curdata.GetValue(offset) != (byte)compdata.GetValue(offset))
                    {
                        retval = false;
                        diffabs++;
                    }
                    totalvalue1 += (byte)curdata.GetValue(offset);
                    totalvalue2 += (byte)compdata.GetValue(offset);
                }
                if (curdata.Length > 0)
                {
                    totalvalue1 /= curdata.Length;
                    totalvalue2 /= compdata.Length;
                }
            }
            diffavg = totalvalue1 - totalvalue2;
            if (isSixteenBitTable(symbolname))
            {
                diffabs /= 2;
            }

            diffperc = (diffabs * 100) / length;

            return retval;
        }

        private void CompareToFile(string filename)
        {
            if (m_currentfile != "")
            {
                if (m_symbols.Count > 0)
                {
                    dockManager1.BeginUpdate();
                    try
                    {
                        DockPanel dockPanel = dockManager1.AddPanel(new System.Drawing.Point(-500, -500));
                        CompareResults tabdet = new CompareResults();
                        tabdet.Dock = DockStyle.Fill;
                        tabdet.Filename = filename;
                        tabdet.onSymbolSelect += new CompareResults.NotifySelectSymbol(tabdet_onSymbolSelect);
                        dockPanel.Controls.Add(tabdet);
                        dockPanel.Text = "Compare results: " + Path.GetFileName(filename);
                        dockPanel.DockTo(dockManager1, DockingStyle.Left, 1);

                        dockPanel.Width = 700;


                        SymbolCollection compare_symbols = new SymbolCollection();
                        FileInfo fi = new FileInfo(filename);
                        LogHelper.Log("Opening compare file");
                        TryToOpenFile(filename, out compare_symbols, (int)fi.Length);
                        System.Windows.Forms.Application.DoEvents();
                        LogHelper.Log("Start compare");
                        SetProgress("Start comparing symbols in files");
                        SetProgressPercentage(0);
                        System.Windows.Forms.Application.DoEvents();
                        System.Data.DataTable dt = new System.Data.DataTable();
                        dt.Columns.Add("SYMBOLNAME");
                        dt.Columns.Add("SRAMADDRESS", Type.GetType("System.Int32"));
                        dt.Columns.Add("FLASHADDRESS", Type.GetType("System.Int32"));
                        dt.Columns.Add("LENGTHBYTES", Type.GetType("System.Int32"));
                        dt.Columns.Add("LENGTHVALUES", Type.GetType("System.Int32"));
                        dt.Columns.Add("DESCRIPTION");
                        dt.Columns.Add("ISCHANGED", Type.GetType("System.Boolean"));
                        dt.Columns.Add("CATEGORY", Type.GetType("System.Int32")); //0
                        dt.Columns.Add("DIFFPERCENTAGE", Type.GetType("System.Double"));
                        dt.Columns.Add("DIFFABSOLUTE", Type.GetType("System.Int32"));
                        dt.Columns.Add("DIFFAVERAGE", Type.GetType("System.Double"));
                        dt.Columns.Add("CATEGORYNAME");
                        dt.Columns.Add("SUBCATEGORYNAME");
                        dt.Columns.Add("SymbolNumber1", Type.GetType("System.Int32"));
                        dt.Columns.Add("SymbolNumber2", Type.GetType("System.Int32"));
                        dt.Columns.Add("Userdescription");
                        dt.Columns.Add("MissingInOriFile", Type.GetType("System.Boolean"));
                        dt.Columns.Add("MissingInCompareFile", Type.GetType("System.Boolean"));

                        string category = "";
                        string ht = string.Empty;
                        double diffperc = 0;
                        int diffabs = 0;
                        double diffavg = 0;
                        int percentageDone = 0;
                        int symNumber = 0;

                        XDFCategories cat = XDFCategories.Undocumented;
                        XDFSubCategory subcat = XDFSubCategory.Undocumented;
                        if (compare_symbols.Count > 0)
                        {
                            CompareResults cr = new CompareResults();
                            cr.ShowAddressesInHex = m_appSettings.ShowAddressesInHex;
                            cr.SetFilterMode(m_appSettings.ShowAddressesInHex);
                            SymbolTranslator st = new SymbolTranslator();

                            foreach (SymbolHelper sh_compare in compare_symbols)
                            {
                                try
                                {
                                    symNumber++;
                                    percentageDone = (symNumber * 50) / compare_symbols.Count;
                                    if (Convert.ToInt32(barProgress.EditValue) != percentageDone)
                                    {
                                        barProgress.EditValue = percentageDone;
                                        System.Windows.Forms.Application.DoEvents();
                                    }
                                }
                                catch (Exception E)
                                {
                                    LogHelper.Log(E.Message);
                                }

                                string compareName = sh_compare.Varname;
                                if (compareName.StartsWith("Symbolnumber")) compareName = sh_compare.Userdescription;

                                foreach (SymbolHelper sh_org in m_symbols)
                                {
                                    string originalName = sh_org.Varname;
                                    if (originalName.StartsWith("Symbolnumber")) originalName = sh_org.Userdescription;

                                    if (compareName.Equals(originalName) && compareName != String.Empty)
                                    {
                                        if (sh_compare.Flash_start_address > 0 && sh_compare.Flash_start_address < 0x100000)
                                        {
                                            if (sh_org.Flash_start_address > 0 && sh_org.Flash_start_address < 0x100000)
                                            {
                                                if (!CompareSymbolToCurrentFile(compareName, (int)sh_compare.Flash_start_address, sh_compare.Length, filename, out diffperc, out diffabs, out diffavg))
                                                {
                                                    category = "";
                                                    if (sh_org.Varname.Contains("."))
                                                    {
                                                        try
                                                        {
                                                            category = sh_org.Varname.Substring(0, sh_org.Varname.IndexOf("."));
                                                        }
                                                        catch (Exception cE)
                                                        {
                                                            LogHelper.Log("Failed to assign category to symbol: " + sh_org.Varname + " err: " + cE.Message);
                                                        }
                                                    }
                                                    else if (sh_org.Userdescription.Contains("."))
                                                    {
                                                        try
                                                        {
                                                            category = sh_org.Userdescription.Substring(0, sh_org.Userdescription.IndexOf("."));
                                                        }
                                                        catch (Exception cE)
                                                        {
                                                            LogHelper.Log("Failed to assign category to symbol: " + sh_org.Userdescription + " err: " + cE.Message);
                                                        }
                                                    }

                                                    dt.Rows.Add(originalName, sh_compare.Start_address, sh_compare.Flash_start_address, sh_compare.Length, sh_compare.Length, st.TranslateSymbolToHelpText(compareName, out ht, out cat, out subcat), false, 0, diffperc, diffabs, diffavg, category, "", sh_org.Symbol_number, sh_compare.Symbol_number, sh_org.Userdescription);
                                                    break;
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                            symNumber = 0;
                            string varnameori = string.Empty;
                            string varnamecomp = string.Empty;
                            foreach (SymbolHelper shtest in compare_symbols)
                            {
                                try
                                {
                                    symNumber++;
                                    percentageDone = 50 + (symNumber * 25) / compare_symbols.Count;
                                    if (Convert.ToInt32(barProgress.EditValue) != percentageDone)
                                    {
                                        barProgress.EditValue = percentageDone;
                                        System.Windows.Forms.Application.DoEvents();
                                    }
                                }
                                catch (Exception E)
                                {
                                    LogHelper.Log(E.Message);
                                }
                                bool _foundSymbol = false;
                                varnamecomp = shtest.Varname;
                                if (varnamecomp.StartsWith("Symbolnumber")) varnamecomp = shtest.Userdescription;
                                if (IsSymbolCalibration(varnamecomp))
                                {
                                    foreach (SymbolHelper shoritest in m_symbols)
                                    {
                                        varnameori = shoritest.Varname;
                                        if (varnameori.StartsWith("Symbolnumber")) varnameori = shoritest.Userdescription;

                                        if (varnamecomp == varnameori)
                                        {
                                            _foundSymbol = true;
                                            break;
                                        }
                                    }
                                    if (!_foundSymbol)
                                    {
                                        // add this symbol to the MissingInOriCollection
                                        dt.Rows.Add(varnamecomp, shtest.Start_address, shtest.Flash_start_address, shtest.Length, shtest.Length, st.TranslateSymbolToHelpText(varnamecomp, out ht, out cat, out subcat), false, 0, 0, 0, 0, "Missing in original", "", 0, shtest.Symbol_number, shtest.Userdescription, true, false);
                                    }
                                }
                            }
                            symNumber = 0;
                            foreach (SymbolHelper shtest in m_symbols)
                            {
                                try
                                {
                                    symNumber++;
                                    percentageDone = 75 + (symNumber * 25) / compare_symbols.Count;
                                    if (Convert.ToInt32(barProgress.EditValue) != percentageDone)
                                    {
                                        barProgress.EditValue = percentageDone;
                                        System.Windows.Forms.Application.DoEvents();
                                    }
                                }
                                catch (Exception E)
                                {
                                    LogHelper.Log(E.Message);
                                }
                                bool _foundSymbol = false;
                                varnamecomp = shtest.Varname;
                                if (varnamecomp.StartsWith("Symbolnumber")) varnamecomp = shtest.Userdescription;
                                if (IsSymbolCalibration(varnamecomp))
                                {
                                    foreach (SymbolHelper shoritest in compare_symbols)
                                    {
                                        varnameori = shoritest.Varname;
                                        if (varnameori.StartsWith("Symbolnumber")) varnameori = shoritest.Userdescription;

                                        if (varnamecomp == varnameori)
                                        {
                                            _foundSymbol = true;
                                            break;
                                        }
                                    }
                                    if (!_foundSymbol)
                                    {
                                        // add this symbol to the MissingInCompCollection
                                        dt.Rows.Add(varnamecomp, shtest.Start_address, shtest.Flash_start_address, shtest.Length, shtest.Length, st.TranslateSymbolToHelpText(varnamecomp, out ht, out cat, out subcat), false, 0, 0, 0, 0, "Missing in compare", "", 0, shtest.Symbol_number, shtest.Userdescription, false, true);
                                    }
                                }
                            }

                            tabdet.OriginalSymbolCollection = m_symbols;
                            tabdet.OriginalFilename = m_currentfile;
                            tabdet.CompareFilename = filename;
                            tabdet.CompareSymbolCollection = compare_symbols;
                            tabdet.OpenGridViewGroups(tabdet.gridControl1, 1);
                            tabdet.gridControl1.DataSource = dt.Copy();
                            SetProgressIdle();
                        }
                    }
                    catch (Exception E)
                    {
                        LogHelper.Log(E.Message);
                    }
                    dockManager1.EndUpdate();
                }
            }
        }

        private void barButtonItem3_ItemClick(object sender, DevExpress.XtraBars.ItemClickEventArgs e)
        {
            // compare current files content to another binaries content
            OpenFileDialog openFileDialog1 = new OpenFileDialog();
            openFileDialog1.Filter = "Trionic 8 binaries|*.bin";
            openFileDialog1.Multiselect = false;
            if (openFileDialog1.ShowDialog() == DialogResult.OK)
            {
                CompareToFile(openFileDialog1.FileName);

            }
        }

        private bool IsSymbolCalibration(string symbolname)
        {
            //<GS-23022011> maybe rewrite for Trionic 8
            if (symbolname.Contains("Cal.")) return true;
            if (symbolname.Contains("Cal1.")) return true;
            if (symbolname.Contains("Cal2.")) return true;
            if (symbolname.Contains("Cal3.")) return true;
            if (symbolname.Contains("Cal4.")) return true;
            if (symbolname.StartsWith("X_Acc")) return true;
            return false;
        }

        private void barButtonItem2_ItemClick(object sender, DevExpress.XtraBars.ItemClickEventArgs e)
        {
            System.Windows.Forms.Application.Exit();
        }

        private void barButtonItem4_ItemClick(object sender, DevExpress.XtraBars.ItemClickEventArgs e)
        {
            // Verify checksums
            if (m_currentfile != string.Empty)
            {
                if (File.Exists(m_currentfile))
                {
                    UpdateChecksum(m_currentfile, m_appSettings.AutoChecksum);
                }
            }

        }

        private Int64 GetInt64FromFile(string filename, int offset)
        {
            Int64 retval = 0;
            FileStream fsread = new FileStream(filename, FileMode.Open, FileAccess.Read);
            using (BinaryReader br = new BinaryReader(fsread))
            {
                fsread.Seek(offset, SeekOrigin.Begin);
                retval = Convert.ToInt64(br.ReadByte()) * 256 * 256 * 256 * 256 * 256 * 256 * 256;
                retval += Convert.ToInt64(br.ReadByte()) * 256 * 256 * 256 * 256 * 256 * 256;
                retval += Convert.ToInt64(br.ReadByte()) * 256 * 256 * 256 * 256 * 256;
                retval += Convert.ToInt64(br.ReadByte()) * 256 * 256 * 256 * 256;
                retval += Convert.ToInt64(br.ReadByte()) * 256 * 256 * 256;
                retval += Convert.ToInt64(br.ReadByte()) * 256 * 256;
                retval += Convert.ToInt64(br.ReadByte()) * 256;
                retval += Convert.ToInt64(br.ReadByte());
            }
            fsread.Close();
            return retval;
        }

        private int GetChecksumAreaOffset(string filename)
        {
            int retval = 0;
            if (filename == "") return retval;
            FileStream fsread = new FileStream(filename, FileMode.Open, FileAccess.Read);
            using (BinaryReader br = new BinaryReader(fsread))
            {
                fsread.Seek(0x20140, SeekOrigin.Begin);
                retval = (int)br.ReadByte() * 256 * 256 * 256;
                retval += (int)br.ReadByte() * 256 * 256;
                retval += (int)br.ReadByte() * 256;
                retval += (int)br.ReadByte();
            }
            fsread.Close();
            return retval;
        }

        int GetChecksumLong(string filename, int offset)
        {
            int retval = 0;
            FileStream fsread = new FileStream(filename, FileMode.Open, FileAccess.Read);
            fsread.Seek(offset, SeekOrigin.Begin);
            using (BinaryReader br = new BinaryReader(fsread))
            {
                retval = (int)br.ReadByte() * 256 * 256 * 256;
                retval += (int)br.ReadByte() * 256 * 256;
                retval += (int)br.ReadByte() * 256;
                retval += (int)br.ReadByte();
            }
            fsread.Close();
            return retval;
        }

        int GetChecksumShort(string filename, int offset)
        {
            int retval = 0;
            FileStream fsread = new FileStream(filename, FileMode.Open, FileAccess.Read);
            fsread.Seek(offset, SeekOrigin.Begin);
            using (BinaryReader br = new BinaryReader(fsread))
            {
                retval = (int)br.ReadByte() * 256;
                retval += (int)br.ReadByte();
            }
            fsread.Close();
            return retval;
        }

        private int CalculateChecksumSmall(string filename, int start, int end)
        {
            int retval = 0;

            FileStream fsread = new FileStream(filename, FileMode.Open, FileAccess.Read);
            fsread.Seek(start, SeekOrigin.Begin);
            using (BinaryReader br = new BinaryReader(fsread))
            {
                for (int i = start; i <= end; i += 2)
                {
                    if (i == end)
                    {
                        int tempvalue = (int)br.ReadByte();
                        retval += tempvalue;
                    }
                    else
                    {
                        int tempvalue = (int)br.ReadByte() * 256;
                        tempvalue += (int)br.ReadByte();
                        retval += tempvalue;
                    }
                }
            }
            fsread.Close();
            //  LogHelper.Log("Checksum 2 byte from " + start.ToString("X6") + " to " + end.ToString("X6") + " = " + retval.ToString("X4"));
            return retval;
        }

        private int CalculateChecksum(string filename, int start, int end)
        {
            int retval = 0;

            FileStream fsread = new FileStream(filename, FileMode.Open, FileAccess.Read);
            fsread.Seek(start, SeekOrigin.Begin);
            using (BinaryReader br = new BinaryReader(fsread))
            {
                for (int i = start; i <= end; i += 4)
                {
                    int tempvalue = (int)br.ReadByte() * 256 * 256 * 256;
                    tempvalue += (int)br.ReadByte() * 256 * 256;
                    tempvalue += (int)br.ReadByte() * 256;
                    tempvalue += (int)br.ReadByte();
                    retval += tempvalue;
                }
            }
            fsread.Close();
            // LogHelper.Log("Checksum 4 byte from " + start.ToString("X6") + " to " + end.ToString("X6") + " = " + retval.ToString("X8"));
            return retval;
        }

        private byte[] CalculateLayer1ChecksumMD5(string filename, int OffsetLayer1, bool forceSilent)
        {
            /*
1.	calculate checksum pointer
2.	Checksum is 2 level based on Message Digest 5 algorithm
3.	Pointer = @ 0x20140 and is a 4 byte pointer
4.	Use MD5 to make 16 bytes digest from any string
5.	name checksum pointer CHPTR
6.	checksum area 1 ranges from 20000h to CHPTR  20000h- 1
7.	Create an MD5 hash from this string (20000h  (CHPTR  20000h  1))
    a.	MD5Init(Context)
    b.	MD5Update(Context, buffer, size)
    c.	MD5Final(Context, Md5Seed)
    d.	sMd5Seed = MD5Print(Md5Seed)
    e.	sMd5Seed = 16 bytes hex, so 32 bytes.
    f.	Now crypt sMd5Seed: xor every byte with 21h, then substract D6h (minus)
    g.	These 16 bytes are from CHPTR + 2 in the bin!!!! This is checksum level 1 !!
             * */
            System.Security.Cryptography.MD5CryptoServiceProvider md5 = new System.Security.Cryptography.MD5CryptoServiceProvider();

            int len = OffsetLayer1 - 0x20000;//- 1;
            md5.Initialize();
            int end = 0x20000 + len;
            LogHelper.Log("Calculating from 0x20000 upto " + end.ToString("X8"));

            byte[] data = readdatafromfile(filename, 0x20000, len);
            byte[] hash = md5.ComputeHash(data);
            /*            foreach (byte b in hash)
                        {
                            byte bcalc = b;
                            Console.Write(" " + b.ToString("X2"));
                        }
                        LogHelper.Log("");*/
            byte[] finalhash = new byte[hash.Length];

            for (int i = 0; i < hash.Length; i++)
            {
                byte bcalc = hash[i];
                bcalc ^= 0x21;
                bcalc -= 0xD6;
                finalhash[i] = bcalc;
            }

            /*foreach (byte b in finalhash)
            {
                Console.Write(" " + b.ToString("X2"));
            }*/
            return finalhash;

        }

        private Int64 CalculateLayer1Checksum(string filename, int OffsetLayer1)
        {
            Int64 chkLayer1 = 0;
            //20000 to B5058 (?)
            FileStream fsread = new FileStream(filename, FileMode.Open, FileAccess.Read);
            int byteCount = OffsetLayer1 - 0x20000;
            using (BinaryReader br = new BinaryReader(fsread))
            {
                fsread.Seek(0x20000, SeekOrigin.Begin);
                // addition
                Int64 _tempValue = 0;
                for (int tel = 0; tel < byteCount; tel += 8)
                {
                    _tempValue = 0;
                    _tempValue = Convert.ToInt64(br.ReadByte()) * 256 * 256 * 256 * 256 * 256 * 256 * 256;
                    _tempValue += Convert.ToInt64(br.ReadByte()) * 256 * 256 * 256 * 256 * 256 * 256;
                    _tempValue += Convert.ToInt64(br.ReadByte()) * 256 * 256 * 256 * 256 * 256;
                    _tempValue += Convert.ToInt64(br.ReadByte()) * 256 * 256 * 256 * 256;
                    _tempValue += Convert.ToInt64(br.ReadByte()) * 256 * 256 * 256;
                    _tempValue += Convert.ToInt64(br.ReadByte()) * 256 * 256;
                    _tempValue += Convert.ToInt64(br.ReadByte()) * 256;
                    _tempValue += Convert.ToInt64(br.ReadByte());
                    chkLayer1 += _tempValue;
                }
            }
            fsread.Close();

            return chkLayer1;
        }

        private bool CompareByteArray(byte[] arr1, byte[] arr2)
        {
            bool retval = true;
            if (arr1.Length != arr2.Length) retval = false;
            else
            {
                for (int t = 0; t < arr1.Length; t++)
                {
                    if (arr1[t] != arr2[t]) retval = false;
                }
            }
            return retval;
        }

        private bool CalculateLayer2Checksum(string filename, int OffsetLayer2, bool forceSilent)
        {
            bool Layer2ChecksumValid = false;
            uint checksum0 = 0;
            uint checksum1 = 0;
            uint sum0 = 0;
            uint matrix_dimension = 0;
            uint partial_address = 0;
            uint x = 0;
            /*
Get 0x100 byte buffer from CHPTR  CHPTR + 0xFF
Because level 1 is in that area level1 must be correct first
Prepare coded_buffer (0x100 buffer from chptr) with loop: coded_buffer(x) = (buffer (x) + 0xD6) xor 0x21 
(add 0xd6 to every byte of buffer, then xor it by 0x21)
[ 1 indexed, not 0 indexed ]
So, 0x101 byte buffer with first byte ignored (convention)
             * */
            byte[] coded_buffer = readdatafromfile(filename, OffsetLayer2, 0x100);

            for (int i = 0; i < coded_buffer.Length; i++)
            {
                byte b = coded_buffer[i];
                b += 0xD6;
                b ^= 0x21;
                coded_buffer[i] = b;
                //Console.Write(b.ToString("X2") + " ");
            }
            //LogHelper.Log("");
            byte[] complete_file = readdatafromfile(filename, 0, m_currentfile_size);
            int index = 0;
            bool chk_found = false;
            while (index < 0x100 && !chk_found)
            {
                if ((coded_buffer[index] == 0xFB) && (coded_buffer[index + 6] == 0xFC) && (coded_buffer[index + 0x0C] == 0xFD))
                {
                    sum0 = ((uint)coded_buffer[index + 1] * 0x01000000 + (uint)coded_buffer[index + 2] * 0x010000 + (uint)coded_buffer[index + 3] * 0x100 + (uint)coded_buffer[index + 4]);
                    matrix_dimension = (uint)coded_buffer[index + 7] * 0x01000000 + (uint)coded_buffer[index + 8] * 0x010000 + (uint)coded_buffer[index + 9] * 0x100 + (uint)coded_buffer[index + 10];
                    partial_address = (uint)coded_buffer[index + 0x0d] * 0x01000000 + (uint)coded_buffer[index + 0x0e] * 0x010000 + (uint)coded_buffer[index + 0x0F] * 0x100 + (uint)coded_buffer[index + 0x10];
                    if (matrix_dimension >= 0x020000)
                    {
                        checksum0 = 0;
                        x = partial_address /*+ 1*/;
                        while (x < (matrix_dimension - 4))
                        {
                            checksum0 = checksum0 + (uint)complete_file[x];
                            x++;
                        }
                        checksum0 = checksum0 + (uint)complete_file[matrix_dimension - 1];
                        checksum1 = 0;
                        x = partial_address /*+ 1*/;
                        while (x < (matrix_dimension - 4))
                        {
                            checksum1 = checksum1 + (uint)complete_file[x] * 0x01000000 + (uint)complete_file[x + 1] * 0x10000 + (uint)complete_file[x + 2] * 0x100 + (uint)complete_file[x + 3];
                            x = x + 4;
                        }
                        if ((checksum0 & 0xFFF00000) != (sum0 & 0xFFF00000))
                        {
                            checksum0 = checksum1;
                        }
                        if (checksum0 != sum0)
                        {
                            //MessageBox.Show("Layer 2 checksum was invalid, should be updated!");
                            if (m_appSettings.AutoChecksum || forceSilent)
                            {
                                byte[] checksum_to_file = new byte[4];
                                checksum_to_file[0] = Convert.ToByte((checksum0 >> 24) & 0x000000FF);
                                checksum_to_file[1] = Convert.ToByte((checksum0 >> 16) & 0x000000FF);
                                checksum_to_file[2] = Convert.ToByte((checksum0 >> 8) & 0x000000FF);
                                checksum_to_file[3] = Convert.ToByte((checksum0) & 0x000000FF);
                                checksum_to_file[0] = Convert.ToByte(((checksum_to_file[0] ^ 0x21) - (byte)0xD6) & 0x000000FF);
                                checksum_to_file[1] = Convert.ToByte(((checksum_to_file[1] ^ 0x21) - (byte)0xD6) & 0x000000FF);
                                checksum_to_file[2] = Convert.ToByte(((checksum_to_file[2] ^ 0x21) - (byte)0xD6) & 0x000000FF);
                                checksum_to_file[3] = Convert.ToByte(((checksum_to_file[3] ^ 0x21) - (byte)0xD6) & 0x000000FF);
                                //CreateBinaryBackup();
                                savedatatobinary(index + OffsetLayer2 + 1, 4, checksum_to_file, filename, false);
                                Layer2ChecksumValid = true;
                            }
                            else
                            {
                                frmChecksum frmchecksum = new frmChecksum();
                                frmchecksum.Layer = "Checksum validation Layer 2";
                                string layer2file = sum0.ToString("X8");
                                string layer2calc = checksum0.ToString("X8");
                                frmchecksum.FileChecksum = layer2file;
                                frmchecksum.RealChecksum = layer2calc;
                                if (frmchecksum.ShowDialog() == DialogResult.OK)
                                {
                                    byte[] checksum_to_file = new byte[4];
                                    checksum_to_file[0] = Convert.ToByte((checksum0 >> 24) & 0x000000FF);
                                    checksum_to_file[1] = Convert.ToByte((checksum0 >> 16) & 0x000000FF);
                                    checksum_to_file[2] = Convert.ToByte((checksum0 >> 8) & 0x000000FF);
                                    checksum_to_file[3] = Convert.ToByte((checksum0) & 0x000000FF);
                                    checksum_to_file[0] = Convert.ToByte(((checksum_to_file[0] ^ 0x21) - (byte)0xD6) & 0x000000FF);
                                    checksum_to_file[1] = Convert.ToByte(((checksum_to_file[1] ^ 0x21) - (byte)0xD6) & 0x000000FF);
                                    checksum_to_file[2] = Convert.ToByte(((checksum_to_file[2] ^ 0x21) - (byte)0xD6) & 0x000000FF);
                                    checksum_to_file[3] = Convert.ToByte(((checksum_to_file[3] ^ 0x21) - (byte)0xD6) & 0x000000FF);
                                    //CreateBinaryBackup();
                                    savedatatobinary(index + OffsetLayer2 + 1, 4, checksum_to_file, filename, true);
                                    Layer2ChecksumValid = true;
                                    coded_buffer[index/* + 1*/] = Convert.ToByte((checksum0 >> 24) & 0x000000FF);
                                    coded_buffer[index/* + 2*/] = Convert.ToByte((checksum0 >> 16) & 0x000000FF);
                                    coded_buffer[index/* + 3*/] = Convert.ToByte((checksum0 >> 8) & 0x000000FF);
                                    coded_buffer[index/* + 4*/] = Convert.ToByte((checksum0) & 0x000000FF);

                                    for (int i = 0; i < 4; i++)
                                    {
                                        //TODO: Actually update the file!!!
                                        //complete_file[i + index + OffsetLayer2] = Convert.ToByte((coded_buffer[index + i] ^ 0x21) - 0xD6);
                                    }
                                    // checksum is ready

                                }
                                else
                                {
                                    Layer2ChecksumValid = false;
                                }
                            }

                        }
                        else
                        {
                            Layer2ChecksumValid = true;
                        }
                        chk_found = true;
                    }
                }
                index++;
            }
            if (!chk_found)
            {
                //MessageBox.Show("Layer 2 checksum could not be calculated [ file incompatible ]");
            }
            return Layer2ChecksumValid;
        }

        private int GetEmptySpaceStartFrom(string filename, int offset)
        {
            int retval = 0;
            FileStream fsread = new FileStream(filename, FileMode.Open, FileAccess.Read);
            using (BinaryReader br = new BinaryReader(fsread))
            {
                fsread.Seek(offset, SeekOrigin.Begin);
                bool found = false;
                while (!found && fsread.Position < offset + 0x1000)
                {
                    retval = (int)fsread.Position;
                    byte b1 = br.ReadByte();
                    if (b1 == 0xFF)
                    {
                        byte b2 = br.ReadByte();
                        if (b2 == 0xFF)
                        {
                            byte b3 = br.ReadByte();
                            if (b3 == 0xFF) found = true;
                        }
                    }
                }
                /*retval = (int)br.ReadByte() * 256 * 256 * 256;
                retval += (int)br.ReadByte() * 256 * 256;
                retval += (int)br.ReadByte() * 256;
                retval += (int)br.ReadByte();*/
            }
            fsread.Close();
            return retval;
        }



        private void UpdateChecksum(string filename, bool forceSilent)
        {

            int m_ChecksumAreaOffset = GetChecksumAreaOffset(filename);
            if (m_ChecksumAreaOffset > m_currentfile_size) return;
            bool do_layer2 = true;
            bool _layer1Valid = false;
            bool _layer2Valid = false;
            barChecksumInfo.Caption = "Checksum: validating...";
            System.Windows.Forms.Application.DoEvents();

            //LogHelper.Log("Checksum area offset: " + m_ChecksumAreaOffset.ToString("X8"));
            byte[] hash = CalculateLayer1ChecksumMD5(filename, m_ChecksumAreaOffset, forceSilent);
            // compare hash to bytes after checksumareaoffset
            byte[] layer1checksuminfile = readdatafromfile(filename, m_ChecksumAreaOffset + 2, 16);
            if (!CompareByteArray(hash, layer1checksuminfile))
            {
                //CreateBinaryBackup();
                //savedatatobinary(m_ChecksumAreaOffset + 2, 16, hash, filename);
                if (m_appSettings.AutoChecksum || forceSilent)
                {
                    savedatatobinary(m_ChecksumAreaOffset + 2, 16, hash, filename, false);
                    _layer1Valid = true;
                    do_layer2 = true;
                }
                else
                {
                    frmChecksum frmchecksum = new frmChecksum();
                    frmchecksum.Layer = "Checksum validation Layer 1";
                    string layer1file = string.Empty;
                    string layer1calc = string.Empty;
                    for (int i = 0; i < layer1checksuminfile.Length; i++)
                    {
                        layer1file += layer1checksuminfile[i].ToString("X2") + " ";
                        layer1calc += hash[i].ToString("X2") + " ";
                    }
                    frmchecksum.FileChecksum = layer1file;
                    frmchecksum.RealChecksum = layer1calc;
                    if (frmchecksum.ShowDialog() == DialogResult.OK)
                    {
                        savedatatobinary(m_ChecksumAreaOffset + 2, 16, hash, filename, false);
                        _layer1Valid = true;
                        do_layer2 = true;
                    }
                    else
                    {
                        do_layer2 = false;
                    }
                }
            }
            else
            {
                _layer1Valid = true;
            }
            if (do_layer2)
            {
                if (CalculateLayer2Checksum(filename, m_ChecksumAreaOffset, forceSilent))
                {
                    _layer2Valid = true;
                }
                else
                {
                    _layer2Valid = false;
                }
            }
            // show result in statusbar
            if (_layer1Valid && _layer2Valid)
            {
                barChecksumInfo.Caption = "Checksum: OK";
            }
            else if (!_layer1Valid)
            {
                barChecksumInfo.Caption = "Checksum: Layer 1 invalid";
            }
            else if (!_layer2Valid)
            {
                barChecksumInfo.Caption = "Checksum: Layer 2 invalid";
            }


        }

        private byte[] ReadChecksumHeader(string filename, int checksumAreaOffset)
        {
            byte[] retval = new byte[1];
            FileStream fsread = new FileStream(filename, FileMode.Open, FileAccess.Read);
            fsread.Seek(checksumAreaOffset, SeekOrigin.Begin);
            using (BinaryReader br = new BinaryReader(fsread))
            {
                retval = br.ReadBytes(0x100);
            }
            fsread.Close();
            return retval;
        }

        private bool ChecksumPresentInChecksumField(string filename, int checksum, int length, int checksumAreaOffset)
        {
            bool retval = false;
            byte[] checksumarea = ReadChecksumHeader(filename, checksumAreaOffset);
            if (length == 2)
            {
                checksum &= 0x0000FFFF;
                for (int i = 0; i < checksumarea.Length; i += 2)
                {
                    byte checksumbyte1 = (byte)((checksum & 0x0000FF00) >> 8);
                    byte checksumbyte2 = (byte)(checksum & 0x000000FF);
                    if (checksumarea[i] == checksumbyte1 && checksumarea[i + 1] == checksumbyte2)
                    {
                        retval = true;
                        break;
                    }
                }

            }
            else if (length == 4)
            {
                for (int i = 0; i < checksumarea.Length - 4; i++)
                {
                    byte checksumbyte1 = (byte)((checksum & 0xFF000000) >> 24);
                    byte checksumbyte2 = (byte)((checksum & 0x00FF0000) >> 16);
                    byte checksumbyte3 = (byte)((checksum & 0x0000FF00) >> 8);
                    byte checksumbyte4 = (byte)(checksum & 0x000000FF);
                    if (checksumarea[i] == checksumbyte1 && checksumarea[i + 1] == checksumbyte2 && checksumarea[i + 2] == checksumbyte3 && checksumarea[i + 4] == checksumbyte4)
                    {
                        retval = true;
                        break;
                    }
                }
            }
            return retval;
        }

        private void DumpFilePart(string filename, int start, int end, string newfilename)
        {
            byte[] bytes;
            using (FileStream fs = new FileStream(filename, FileMode.Open, FileAccess.Read))
            {
                fs.Position = start;
                BinaryReader br = new BinaryReader(fs);
                bytes = br.ReadBytes(end - start);
                br.Close();
            }
            using (FileStream fw = new FileStream(newfilename, FileMode.CreateNew))
            {
                BinaryWriter bw = new BinaryWriter(fw);
                bw.Write(bytes);
                bw.Close();
            }
        }

        private void barButtonItem5_ItemClick(object sender, DevExpress.XtraBars.ItemClickEventArgs e)
        {
            // show firmware information
            if (m_currentfile != string.Empty)
            {
                if (File.Exists(m_currentfile))
                {
                    frmFirmwareInformation frminfo = new frmFirmwareInformation();
                    T8Header t8header = new T8Header();
                    t8header.init(m_currentfile);
                    frminfo.Filename = m_currentfile;
                    frminfo.ProgrammerName = t8header.ProgrammerName;
                    frminfo.ProgrammingDevice = t8header.ProgrammerDevice;
                    frminfo.PartNumber = t8header.PartNumber;
                    frminfo.ReleaseDate = t8header.ReleaseDate;
                    frminfo.SoftwareID = t8header.SoftwareVersion.Trim();
                    // determine engine type / MY by software version
                    // and determine engine type MY by VIN number
                    string engineTypeBySWVersion = string.Empty;
                    string engineTypeByVIN = string.Empty;
                    VINDecoder decoder = new VINDecoder();
                    VINCarInfo carinfo = decoder.DecodeVINNumber(t8header.ChassisID);
                    engineTypeByVIN = carinfo.EngineType + " MY" + carinfo.Makeyear.ToString() + " " + carinfo.GearboxDescription;
                    frminfo.EngineTypeByVIN = engineTypeByVIN;
                    string swversion = t8header.SoftwareVersion.Trim();
                    engineTypeBySWVersion = DetermineCarInfoBySWVersion(swversion);
                    frminfo.ChassisID = t8header.ChassisID;
                    frminfo.EngineTypeBySoftwareVersion = engineTypeBySWVersion;//t8header.CarDescription;
                    frminfo.ImmoID = t8header.ImmobilizerID;
                    frminfo.HardwareID = t8header.HardwareID;
                    frminfo.HardwareType = t8header.DeviceType;
                    frminfo.ECUDescription = t8header.EcuDescription;
                    frminfo.InterfaceDevice = t8header.InterfaceDevice;
                    frminfo.NumberOfFlashBlocks = t8header.NumberOfFlashBlocks.ToString();

                    if (frminfo.ShowDialog() == DialogResult.OK)
                    {
                        t8header.ImmobilizerID = frminfo.ImmoID;
                        t8header.SoftwareVersion = frminfo.SoftwareID;
                        t8header.CarDescription = frminfo.EngineTypeBySoftwareVersion;
                        t8header.ChassisID = frminfo.ChassisID;
                        t8header.ReleaseDate = frminfo.ReleaseDate;
                        t8header.ProgrammerDevice = frminfo.ProgrammingDevice;
                        t8header.ProgrammerName = frminfo.ProgrammerName;
                        t8header.PartNumber = frminfo.PartNumber;
                        t8header.DeviceType = frminfo.HardwareType;
                        t8header.HardwareID = frminfo.HardwareID;
                        t8header.InterfaceDevice = frminfo.InterfaceDevice;
                        t8header.EcuDescription = frminfo.ECUDescription;
                        // only if enabled
                        if (frminfo.ChangeVINAndImmo)
                        {
                            t8header.UpdateVinAndImmoCode();
                        }
                        UpdateChecksum(m_currentfile, m_appSettings.AutoChecksum);
                    }
                }
            }
        }

        private string DetermineCarInfoBySWVersion(string swversion)
        {
            string retval = string.Empty;
            try
            {
                char[] sep = new char[1];
                sep.SetValue('_', 0);
                string[] ids = swversion.Split(sep);
                if (ids.Length > 0)
                {
                    string engineID = ids.GetValue(ids.Length - 1).ToString();
                    if (engineID.Length == 3)
                    {
                        int engineTypeID = Convert.ToInt32(engineID.Substring(0, 2));
                        char engineMY = engineID[2];
                        switch (engineTypeID)
                        {
                            case 80:
                                retval = "B207E";
                                switch (engineMY)
                                {
                                    case 'b':
                                        retval += " MY2003";
                                        break;
                                    case 'c':
                                    case 'd':
                                    case 'e':
                                        retval += " MY2004/2005";
                                        break;
                                    case 'f':
                                    case 'h':
                                        retval += " MY2007/2008";
                                        break;
                                    case 'g':
                                        retval += " MY2007/2008 Biopower";
                                        break;
                                }
                                break;
                            case 81:
                                retval = "B207L";
                                switch (engineMY)
                                {
                                    case 'b':
                                        retval += " MY2003";
                                        break;
                                    case 'c':
                                    case 'd':
                                    case 'e':
                                        retval += " MY2004/2005";
                                        break;
                                    case 'f':
                                    case 'h':
                                        retval += " MY2005";
                                        break;
                                    case 'i':
                                        retval += " MY2006";
                                        break;
                                    case 'j':
                                        retval += " MY2007";
                                        break;
                                    case 'l':
                                        retval += " MY2008 Biopower";
                                        break;
                                    case 'm':
                                        retval += " MY2009";
                                        break;
                                    case 't':
                                        retval = "B207M/F MY2011";
                                        break;
                                }
                                break;
                            case 82:
                                retval = "B207R";
                                switch (engineMY)
                                {
                                    case 'b':
                                        retval += " MY2003";
                                        break;
                                    case 'c':
                                    case 'd':
                                    case 'e':
                                        retval += " MY2004/2005";
                                        break;
                                    case 'f':
                                    case 'h':
                                        retval += " MY2005";
                                        break;
                                    case 'n':
                                        retval += " MY2006";
                                        break;
                                    case 's':
                                        retval += " MY2007";
                                        break;
                                    case 'r':
                                        retval += " MY2007/2008";
                                        break;
                                    case 'x':
                                    case 'v':
                                        retval += " MY2009";
                                        break;
                                    case '6':
                                    case '8':
                                    case 'z':
                                        retval += " MY2010";
                                        break;
                                }
                                break;
                            case 83:
                                retval = "Z20NET";
                                switch (engineMY)
                                {

                                    case 'e':
                                        retval += " MY2003";
                                        break;
                                    case 'f':
                                        retval += " MY2004";
                                        break;
                                    case 'g':
                                        retval += " MY2005";
                                        break;
                                    case 'h':
                                        retval += " MY2006";
                                        break;
                                    case 'i':
                                        retval += " MY2008";
                                        break;

                                }
                                break;
                            case 85:
                                retval = "B207R";
                                switch (engineMY)
                                {
                                    case 'b':
                                        retval = "B207S MY2011";
                                        break;
                                    case 'd':
                                    case 'f':
                                        retval += " MY2011";
                                        break;
                                }
                                break;
                        }

                    }

                    string swLabel = ids.GetValue(0).ToString();
                    if (swLabel.Length == 4)
                    {
                        if (swLabel.StartsWith("FA")) retval += " MY03-06 Gasoline / front wheel drive";
                        if (swLabel.StartsWith("FC")) retval += " MY07-11 Gasoline / front wheel drive";
                        if (swLabel.StartsWith("FD")) retval += " MY07-10 BioPower / front wheel drive";
                        if (swLabel.StartsWith("FE")) retval += " MY09-11 Gasoline / all wheel drive";
                        if (swLabel.StartsWith("FF")) retval += " MY10 BioPower AWD or MY11 Gasoline/BioPower FWD/AWD";
                    }
                }
            }
            catch (Exception)
            {

            }
            return retval;
        }

        private void barButtonItem6_ItemClick(object sender, DevExpress.XtraBars.ItemClickEventArgs e)
        {
            if (m_currentfile != "")
            {
                OpenFileDialog openFileDialog1 = new OpenFileDialog();
                openFileDialog1.Filter = "Trionic 8 binaries|*.bin";
                openFileDialog1.Multiselect = false;
                if (openFileDialog1.ShowDialog() == DialogResult.OK)
                {
                    frmBinCompare bincomp = new frmBinCompare();
                    bincomp.SetCurrentFilename(m_currentfile);
                    bincomp.SetCompareFilename(openFileDialog1.FileName);
                    bincomp.CompareFiles();
                    bincomp.ShowDialog();
                }
            }
            else
            {
                MessageBox.Show("No file is currently opened, you need to open a binary file first to compare it to another one!");
            }
        }

        private void barButtonItem7_ItemClick(object sender, DevExpress.XtraBars.ItemClickEventArgs e)
        {
            frmAbout about = new frmAbout();
            about.ShowDialog();
        }

        private void barButtonItem9_ItemClick(object sender, DevExpress.XtraBars.ItemClickEventArgs e)
        {
            // start user manual PDF file
            try
            {
                if (File.Exists(System.Windows.Forms.Application.StartupPath + "//T8_manual.pdf"))
                {
                    System.Diagnostics.Process.Start(System.Windows.Forms.Application.StartupPath + "//T8_manual.pdf");
                }
                else
                {
                    MessageBox.Show("T8Suite user manual could not be found or opened!");
                }
            }
            catch (Exception E2)
            {
                LogHelper.Log(E2.Message);
            }
        }

        private void barButtonItem10_ItemClick(object sender, DevExpress.XtraBars.ItemClickEventArgs e)
        {
            // start Trionic 8 PDF file
            try
            {
                if (File.Exists(System.Windows.Forms.Application.StartupPath + "//Trionic 8.pdf"))
                {
                    System.Diagnostics.Process.Start(System.Windows.Forms.Application.StartupPath + "//Trionic 8.pdf");
                }
                else
                {
                    MessageBox.Show("Trionic 8 documentation could not be found or opened!");
                }
            }
            catch (Exception E2)
            {
                LogHelper.Log(E2.Message);
            }
        }

        private void barButtonItem8_ItemClick(object sender, DevExpress.XtraBars.ItemClickEventArgs e)
        {
            // check for updates
            try
            {
                if (m_msiUpdater != null)
                {
                    m_msiUpdater.CheckForUpdates("http://develop.trionictuning.com/T8Suite/", "t8suitepro", "T8Suite.msi");
                }
            }
            catch (Exception E)
            {
                LogHelper.Log(E.Message);
            }

        }

        private void barButtonItem11_ItemClick(object sender, DevExpress.XtraBars.ItemClickEventArgs e)
        {
            if (m_currentfile != "")
            {
                OpenFileDialog openFileDialog1 = new OpenFileDialog();
                openFileDialog1.Filter = "Trionic 8 binaries|*.bin";
                openFileDialog1.Multiselect = false;
                if (openFileDialog1.ShowDialog() == DialogResult.OK)
                {
                    frmBinCompare bincomp = new frmBinCompare();
                    bincomp.Symbols = m_symbols;
                    bincomp.OutsideSymbolRangeCheck = true;
                    bincomp.SetCurrentFilename(m_currentfile);
                    bincomp.SetCompareFilename(openFileDialog1.FileName);
                    bincomp.CompareFiles();
                    bincomp.ShowDialog();
                }
            }
            else
            {
                MessageBox.Show("No file is currently opened, you need to open a binary file first to compare it to another one!");
            }
        }

        private void SetToolstripTheme()
        {
            //LogHelper.Log("Rendermode was: " + ToolStripManager.RenderMode.ToString());
            //LogHelper.Log("Visual styles: " + ToolStripManager.VisualStylesEnabled.ToString());
            //LogHelper.Log("Skinname: " + appSettings.SkinName);
            //LogHelper.Log("Backcolor: " + defaultLookAndFeel1.LookAndFeel.Painter.Button.DefaultAppearance.BackColor.ToString());
            //LogHelper.Log("Backcolor2: " + defaultLookAndFeel1.LookAndFeel.Painter.Button.DefaultAppearance.BackColor2.ToString());
            try
            {
                Skin currentSkin = CommonSkins.GetSkin(defaultLookAndFeel1.LookAndFeel);
                Color c = currentSkin.TranslateColor(SystemColors.Control);
                ToolStripManager.RenderMode = ToolStripManagerRenderMode.Professional;
                ProfColorTable profcolortable = new ProfColorTable();
                profcolortable.CustomToolstripGradientBegin = c;
                profcolortable.CustomToolstripGradientMiddle = c;
                profcolortable.CustomToolstripGradientEnd = c;
                ToolStripManager.Renderer = new ToolStripProfessionalRenderer(profcolortable);
            }
            catch (Exception)
            {

            }

        }

        void InitSkins()
        {
            /*
            ribbonControl1.ForceInitialize();
            BarButtonItem item;

            DevExpress.Skins.SkinManager.Default.RegisterAssembly(typeof(DevExpress.UserSkins.BonusSkins).Assembly);
            DevExpress.Skins.SkinManager.Default.RegisterAssembly(typeof(DevExpress.UserSkins.OfficeSkins).Assembly);

            foreach (DevExpress.Skins.SkinContainer cnt in DevExpress.Skins.SkinManager.Default.Skins)
            {
                item = new BarButtonItem();
                item.Caption = cnt.SkinName;
                //iPaintStyle.AddItem(item);
                ribbonPageGroup13.ItemLinks.Add(item);
                item.ItemClick += new ItemClickEventHandler(OnSkinClick);
            }*/

            ribbonControl1.ForceInitialize();
            BarButtonItem item;
            int skinCount = 0;
            DevExpress.Skins.SkinManager.Default.RegisterAssembly(typeof(DevExpress.UserSkins.BonusSkins).Assembly);
            DevExpress.Skins.SkinManager.Default.RegisterAssembly(typeof(DevExpress.UserSkins.OfficeSkins).Assembly);
            SymbolCollection symcol = new SymbolCollection();
            foreach (DevExpress.Skins.SkinContainer cnt in DevExpress.Skins.SkinManager.Default.Skins)
            {
                SymbolHelper sh = new SymbolHelper();
                sh.Varname = cnt.SkinName;
                symcol.Add(sh);
            }
            symcol.SortColumn = "Varname";
            symcol.SortingOrder = GenericComparer.SortOrder.Ascending;
            symcol.Sort();
            foreach (SymbolHelper sh in symcol)
            {
                item = new BarButtonItem();
                item.Caption = sh.Varname;
                BarItemLink il = ribbonPageGroup13.ItemLinks.Add(item);
                if ((skinCount++ % 3) == 0) il.BeginGroup = true;

                item.ItemClick += new ItemClickEventHandler(OnSkinClick);
            }
            try
            {
                if (IsChristmasTime())
                {
                    // set chrismas skin
                    DevExpress.LookAndFeel.UserLookAndFeel.Default.SetSkinStyle("Xmas 2008 Blue"); // don't save
                }
                else if (IsHalloweenTime())
                {
                    // set Halloween skin
                    DevExpress.LookAndFeel.UserLookAndFeel.Default.SetSkinStyle("Pumpkin"); // don't save
                }
                else if (IsValetineTime())
                {
                    DevExpress.LookAndFeel.UserLookAndFeel.Default.SetSkinStyle("Valentine"); // don't save
                }
                else
                {
                    DevExpress.LookAndFeel.UserLookAndFeel.Default.SetSkinStyle(m_appSettings.Skinname);
                }
            }
            catch (Exception E)
            {
                LogHelper.Log(E.Message);
            }
            SetToolstripTheme();
        }

        /// <summary>
        /// OnSkinClick: Als er een skin gekozen wordt door de gebruiker voer deze
        /// dan door in de user interface
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        void OnSkinClick(object sender, DevExpress.XtraBars.ItemClickEventArgs e)
        {
            string skinName = e.Item.Caption;
            DevExpress.LookAndFeel.UserLookAndFeel.Default.SetSkinStyle(skinName);
            m_appSettings.Skinname = skinName;
            SetToolstripTheme();
        }

        private void Form1_FormClosing(object sender, FormClosingEventArgs e)
        {
            m_connectedToECU = false;
            m_prohibitReading = true;
            if (m_CurrentWorkingProject != "")
            {
                CloseProject();
            }
            m_appSettings.ShowMenu = !ribbonControl1.Minimized;
            SaveLayoutFiles();
            SaveRealtimeTable();
            try
            {
                m_mapHelper.Close();
            }
            catch (Exception E)
            {
                LogHelper.Log(E.Message);
            }
            if (t8can.isOpen()) t8can.Cleanup();
            Environment.Exit(0);
        }

        private void gridViewSymbols_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Enter)
            {
                StartTableViewer();
            }
            else if (e.Control && e.KeyCode == Keys.C)
            {
                Clipboard.SetText(gridViewSymbols.GetFocusedDisplayText());
                e.Handled = true;
            }
        }

        private void barButtonItem12_ItemClick(object sender, ItemClickEventArgs e)
        {
            SaveFileDialog sfd1 = new SaveFileDialog();
            sfd1.Filter = "S19 files|*.S19";
            sfd1.AddExtension = true;
            sfd1.DefaultExt = "S19";
            sfd1.OverwritePrompt = true;
            sfd1.Title = "Export file to motorola S19 format...";
            if (sfd1.ShowDialog() == DialogResult.OK)
            {
                srec2bin srec = new srec2bin();
                srec.ConvertBinToSrec(m_currentfile, sfd1.FileName);
            }
        }

        private void gridControlSymbols_MouseMove(object sender, MouseEventArgs e)
        {

            if (e.Button == MouseButtons.Left && _isMouseDown)
            {
                _isMouseDown = false; // try only once
                DevExpress.XtraGrid.Views.Grid.ViewInfo.GridHitInfo hi = gridViewSymbols.CalcHitInfo(e.Location);
                if (!(hi.IsValid && hi.InRowCell)) return;

                if (gridViewSymbols.SelectedRowsCount > 0)
                {
                    int[] selrows = gridViewSymbols.GetSelectedRows();
                    if (selrows.Length > 0)
                    {
                        int row = (int)selrows.GetValue(0);
                        if (row >= 0)
                        {
                            SymbolHelper sh = (SymbolHelper)gridViewSymbols.GetRow((int)selrows.GetValue(0));
                            LogHelper.Log("Symbol dragging: " + sh.Varname);
                            sh.Currentdata = readdatafromfile(m_currentfile, (int)sh.Flash_start_address, sh.Length);
                            gridControlSymbols.DoDragDrop(sh, DragDropEffects.All);

                        }

                    }

                }
            }
            else
            {
                try
                {
                    GridHitInfo ghi = gridViewSymbols.CalcHitInfo(new System.Drawing.Point(e.X, e.Y));
                    if (ghi != null)
                    {
                        ShowSymbolHitInfo(ghi);
                    }
                }
                catch (Exception E)
                {
                    LogHelper.Log("Failed to run hitinfo on gridControlSymbols: " + E.Message);
                }
            }
        }

        private void ShowSymbolHitInfo(DevExpress.XtraGrid.Views.Grid.ViewInfo.GridHitInfo hi)
        {
            if (hi == null)
            {
                return;
            }
            try
            {
                if (hi.InRowCell)
                {
                    if (hi.Column.Name == gcSymbolsName.Name)
                    {

                        if (m_appSettings.ShowMapPreviewPopup)
                        {
                            if (hi.RowHandle < 0) return;

                            if (m_currentMapHelperRowHandle != hi.RowHandle)
                            {
                                m_currentMapHelperRowHandle = hi.RowHandle;

                                if (tmrMapHelper.Enabled)
                                {
                                    m_currentMapHelperRowHandle = hi.RowHandle;
                                }
                                SymbolHelper sh = (SymbolHelper)gridViewSymbols.GetRow(hi.RowHandle);

                                // tot hier
                                m_currentMapname = sh.Varname;
                                LogHelper.Log("Hover above: " + sh.Varname);
                                if (m_mapHelper != null)
                                {
                                    m_mapHelper.SuspendLayout();
                                    System.Drawing.Point p = gridControlSymbols.PointToScreen(hi.HitPoint);
                                    m_mapHelper.Location = new System.Drawing.Point(gridControlSymbols.Location.X + gridControlSymbols.Size.Width + 50, p.Y);
                                    m_mapHelper.ResumeLayout();
                                    if (m_mapHelper.Visible)
                                    {
                                        tmrMapHelper_Tick(this, EventArgs.Empty);
                                    }
                                    else
                                    {
                                        tmrMapHelper.Stop();
                                        tmrMapHelper.Start();
                                        m_mapHelper.Reset();
                                    }
                                }

                            }
                            //AddLogItem("Stop: " + hi.RowHandle.ToString());

                        }

                    }
                    else
                    {
                        try
                        {
                            //AddLogItem("Start (1): " );

                            if (m_appSettings.ShowMapPreviewPopup)
                            {
                                //if (m_mapHelper.Visible)
                                {
                                    tmrMapHelper.Stop();
                                    m_mapHelper.Reset();
                                }
                            }
                            //AddLogItem("Stop (1): ");
                        }
                        catch (Exception E)
                        {
                            LogHelper.Log("Failed to reset mapHelper: " + E.Message);
                        }
                    }
                }
                else
                {
                    try
                    {
                        // AddLogItem("Start (2): ");

                        if (m_appSettings.ShowMapPreviewPopup)
                        {
                            //if (m_mapHelper.Visible)
                            {
                                tmrMapHelper.Stop();

                                m_mapHelper.Reset();
                            }
                        }
                        //AddLogItem("Start (2): ");

                    }
                    catch (Exception mE)
                    {
                        LogHelper.Log("Failed to reset mapHelper (2): " + mE.Message);
                    }
                }
                //if (hi.Column.Name == gcVehID.Name)
                {
                    //svv = new SingleVehicleViewer(appSettings.MapPath, 
                }
                //AddLogItem("Start (3): ");

            }
            catch (Exception E)
            {
                LogHelper.Log(E.Message);
            }
            //AddLogItem("Start (3): ");

        }

        private void tmrMapHelper_Tick(object sender, EventArgs e)
        {
            tmrMapHelper.Enabled = false;
            if (m_mapHelper != null && m_currentMapname != string.Empty)
            {
                //m_mapHelper.Location
                //m_mapHelper.ShowPosition(_helperPositionMercator);
                m_mapHelper.mapViewer1.SetViewSize(m_appSettings.DefaultViewSize);
                m_mapHelper.mapViewer1.Visible = false;
                m_mapHelper.mapViewer1.Filename = m_currentfile;
                //m_mapHelper.mapViewer1.GraphVisible = m_appSettings.ShowGraphs;
                m_mapHelper.mapViewer1.Viewtype = m_appSettings.DefaultViewType;
                m_mapHelper.mapViewer1.DisableColors = m_appSettings.DisableMapviewerColors;
                m_mapHelper.mapViewer1.AutoSizeColumns = m_appSettings.AutoSizeColumnsInWindows;
                m_mapHelper.mapViewer1.IsRedWhite = m_appSettings.ShowRedWhite;
                m_mapHelper.mapViewer1.Map_name = m_currentMapname;
                m_mapHelper.mapViewer1.Map_descr = "";//TranslateSymbolName(m_mapHelper.mapViewer1.Map_name);
                m_mapHelper.mapViewer1.Map_cat = XDFCategories.Undocumented; //TranslateSymbolNameToCategory(m_mapHelper.mapViewer1.Map_name);

                SymbolAxesTranslator axestrans = new SymbolAxesTranslator();
                string x_axis = string.Empty;
                string y_axis = string.Empty;
                string x_axis_descr = string.Empty;
                string y_axis_descr = string.Empty;
                string z_axis_descr = string.Empty;
                axestrans.GetAxisSymbols(m_currentMapname, out x_axis, out y_axis, out x_axis_descr, out y_axis_descr, out z_axis_descr);
                if (x_axis == "BstKnkCal.OffsetXSP")
                {
                    if (!SymbolExists(x_axis)) x_axis = "BstKnkCal.fi_offsetXSP";
                }

                m_mapHelper.mapViewer1.X_axis_name = x_axis_descr;
                m_mapHelper.mapViewer1.Y_axis_name = y_axis_descr;
                m_mapHelper.mapViewer1.Z_axis_name = z_axis_descr;
                m_mapHelper.mapViewer1.X_axisvalues = GetXaxisValues(m_currentfile, m_symbols, m_mapHelper.mapViewer1.Map_name);
                m_mapHelper.mapViewer1.Y_axisvalues = GetYaxisValues(m_currentfile, m_symbols, m_mapHelper.mapViewer1.Map_name);
                int columns = 8;
                int rows = 8;
                int tablewidth = GetTableMatrixWitdhByName(m_currentfile, m_symbols, m_mapHelper.mapViewer1.Map_name, out columns, out rows);
                int address = Convert.ToInt32(GetSymbolAddress(m_symbols, m_mapHelper.mapViewer1.Map_name));
                int sramaddress = 0;// Convert.ToInt32(dr.Row["SRAMADDRESS"].ToString());
                if (address != 0)
                {

                    while (address > m_currentfile_size) address -= m_currentfile_size;
                    m_mapHelper.mapViewer1.Map_address = address;
                    m_mapHelper.mapViewer1.Map_sramaddress = sramaddress;
                    int length = Convert.ToInt32(GetSymbolLength(m_symbols, m_mapHelper.mapViewer1.Map_name));
                    m_mapHelper.mapViewer1.Map_length = length;
                    byte[] mapdata = readdatafromfile(m_currentfile, address, length);
                    m_mapHelper.mapViewer1.Map_content = mapdata;
                    m_mapHelper.mapViewer1.Correction_factor = GetMapCorrectionFactor(m_mapHelper.mapViewer1.Map_name);
                    m_mapHelper.mapViewer1.Correction_offset = GetMapCorrectionOffset(m_mapHelper.mapViewer1.Map_name);
                    m_mapHelper.mapViewer1.IsUpsideDown = GetMapUpsideDown(m_mapHelper.mapViewer1.Map_name);
                    m_mapHelper.mapViewer1.GraphVisible = false;
                    m_mapHelper.mapViewer1.TableVisible = true;
                    m_mapHelper.mapViewer1.Visible = true;
                    m_mapHelper.mapViewer1.ShowTable(columns, isSixteenBitTable(m_mapHelper.mapViewer1.Map_name));
                    m_mapHelper.mapViewer1.SetSurfaceGraphZoom(0.15);
                    //m_mapHelper.mapViewer1.SetSurfaceGraphView(10, 10, 10, 10, 10, 0.2);
                    m_mapHelper.mapViewer1.Update();
                    LogHelper.Log("Showing: " + m_mapHelper.mapViewer1.Map_name);
                    m_mapHelper.SetSize(new Size(tablewidth * 60, rows * 15));
                    m_mapHelper.ShowPosition();
                }
            }
        }

        private void btnNominalTorqueMap_ItemClick(object sender, ItemClickEventArgs e)
        {
            StartTableViewer("TrqMastCal.Trq_NominalMap");
        }

        private void brnAirmassTorqueMap_ItemClick(object sender, ItemClickEventArgs e)
        {
            StartTableViewer("TrqMastCal.m_AirTorqMap");

        }

        private void btnPedalPositionMap_ItemClick(object sender, ItemClickEventArgs e)
        {
            StartTableViewer("TrqMastCal.X_AccPedalMAP");

        }

        private void btnNormalIgnitionMap_ItemClick(object sender, ItemClickEventArgs e)
        {
            StartTableViewer("IgnAbsCal.fi_NormalMAP");
        }

        private void btnHighOctaneIgnitionMap_ItemClick(object sender, ItemClickEventArgs e)
        {
            StartTableViewer("IgnAbsCal.fi_highOctanMAP");
        }

        private void btnLowOctaneIgnitionMap_ItemClick(object sender, ItemClickEventArgs e)
        {
            StartTableViewer("IgnAbsCal.fi_lowOctanMAP");
        }

        private void btnMBTIgnitionMap_ItemClick(object sender, ItemClickEventArgs e)
        {
            StartTableViewer("IgnAbsCal.fi_IgnMBTMAP");
        }

        private void btnFuelcutIgnitionMap_ItemClick(object sender, ItemClickEventArgs e)
        {
            StartTableViewer("IgnAbsCal.fi_FuelCutMAP");
        }

        private void btnStartupIgnitionMap_ItemClick(object sender, ItemClickEventArgs e)
        {
            StartTableViewer("IgnAbsCal.fi_StartMAP");
        }

        private void btnOverboostMAP_ItemClick(object sender, ItemClickEventArgs e)
        {
            StartTableViewer("TrqLimCal.Trq_OverBoostTab");
        }

        private void btnEGTMap_ItemClick(object sender, ItemClickEventArgs e)
        {
            StartTableViewer("ExhaustCal.T_Lambda1Map");
        }

        private void btnFuelKnockMap_ItemClick(object sender, ItemClickEventArgs e)
        {
            StartTableViewer("KnkFuelCal.EnrichmentMap");
        }

        private void btnMaxAirmassMapManual_ItemClick(object sender, ItemClickEventArgs e)
        {
            StartTableViewer("BstKnkCal.MaxAirmass");
        }

        private void btnMaxAirmassMapAuto_ItemClick(object sender, ItemClickEventArgs e)
        {
            StartTableViewer("BstKnkCal.MaxAirmassAu");
        }

        private void btnInjectionEndangleMap_ItemClick(object sender, ItemClickEventArgs e)
        {
            StartTableViewer("InjAnglCal.Map");
        }

        private void btnRequestedTorqueMap_ItemClick(object sender, ItemClickEventArgs e)
        {
            StartTableViewer("PedalMapCal.Trq_RequestMap");
        }

        private void btnMBTAirmass_ItemClick(object sender, ItemClickEventArgs e)
        {
            StartTableViewer("AirMassMastCal.m_AirMBTMAP");
        }

        private void btnFuelCorrectionMap_ItemClick(object sender, ItemClickEventArgs e)
        {
            StartTableViewer("BFuelCal.LambdaOneFacMap");

        }

        private void btnBoostRegulationMap_ItemClick(object sender, ItemClickEventArgs e)
        {
            StartTableViewer("AirCtrlCal.RegMap");
        }

        private void btnAmbientPressureTorqueLimitMap_ItemClick(object sender, ItemClickEventArgs e)
        {
            StartTableViewer("TrqLimCal.Trq_CompressorNoiseRedLimMAP");
        }

        private void barButtonItem14_ItemClick(object sender, ItemClickEventArgs e)
        {
            StartTableViewer("TrqLimCal.Trq_MaxEngineAutTab2");
        }

        private void barButtonItem13_ItemClick(object sender, ItemClickEventArgs e)
        {
            StartTableViewer("TrqLimCal.Trq_MaxEngineAutTab1");

        }

        private void barButtonItem16_ItemClick(object sender, ItemClickEventArgs e)
        {
            StartTableViewer("TrqLimCal.Trq_MaxEngineManTab2");

        }

        private void barButtonItem15_ItemClick(object sender, ItemClickEventArgs e)
        {
            StartTableViewer("TrqLimCal.Trq_MaxEngineManTab1");

        }

        private void barButtonItem17_ItemClick(object sender, ItemClickEventArgs e)
        {
            StartTableViewer("TrqLimCal.Trq_ManGear");

        }

        private void btnPofPIDMap_ItemClick(object sender, ItemClickEventArgs e)
        {
            StartTableViewer("AirCtrlCal.Ppart_BoostMap");
        }

        private void btnIofPIDMap_ItemClick(object sender, ItemClickEventArgs e)
        {
            StartTableViewer("AirCtrlCal.Ipart_BoostMap");

        }

        private void btnDofPIDMap_ItemClick(object sender, ItemClickEventArgs e)
        {
            StartTableViewer("AirCtrlCal.Dpart_BoostMap");

        }

        private SymbolCollection GetRealtimeNotificationSymbols()
        {
            SymbolCollection _symbols = new SymbolCollection();
            if (m_symbols != null)
            {
                foreach (SymbolHelper sh in m_symbols)
                {
                    if (sh.Start_address > 0x0100000)
                    {
                        _symbols.Add(sh);
                    }
                }
            }
            return _symbols;
        }

        private void barButtonItem18_ItemClick(object sender, ItemClickEventArgs e)
        {
            frmSettings set = new frmSettings();
            m_appSettings = new AppSettings();
            set.AppSettings = m_appSettings;
            set.Symbols = GetRealtimeNotificationSymbols();
            set.CANBusAdapterType = m_appSettings.CANBusAdapterType;

            set.InterpolateLogWorksTimescale = m_appSettings.InterpolateLogWorksTimescale;
            //set.AutoGenerateLogWorksFile = m_appSettings.AutoGenerateLogWorks;
            set.OnlyPBus = m_appSettings.OnlyPBus;
            set.ResetRealtimeSymbolOnTabPageSwitch = m_appSettings.ResetRealtimeSymbolOnTabPageSwitch;

            set.AutoSizeNewWindows = m_appSettings.AutoSizeNewWindows;
            set.AutoSizeColumnsInViewer = m_appSettings.AutoSizeColumnsInWindows;
            set.AutoUpdateChecksum = m_appSettings.AutoChecksum;
            set.ShowAddressesInHex = m_appSettings.ShowAddressesInHex;
            set.HideSymbolWindow = m_appSettings.HideSymbolTable;
            set.ShowGraphsInMapViewer = m_appSettings.ShowGraphs;
            set.AutoMapDetectionActive = m_appSettings.MapDetectionActive;
            set.ViewTablesInHex = m_appSettings.Viewinhex;
            set.AutoDockSameFile = m_appSettings.AutoDockSameFile;
            set.AutoDockSameSymbol = m_appSettings.AutoDockSameSymbol;
            set.DisableMapviewerColors = m_appSettings.DisableMapviewerColors;
            set.ShowMapViewersInWindows = m_appSettings.ShowViewerInWindows;
            set.NewPanelsFloating = m_appSettings.NewPanelsFloating;
            set.AutoLoadLastFile = m_appSettings.AutoLoadLastFile;
            set.ShowMapPreviewPopup = m_appSettings.ShowMapPreviewPopup;
            set.DefaultViewType = m_appSettings.DefaultViewType;
            set.DefaultViewSize = m_appSettings.DefaultViewSize;
            set.SynchronizeMapviewers = m_appSettings.SynchronizeMapviewers;
            set.FancyDocking = m_appSettings.FancyDocking;
            set.ShowTablesUpsideDown = m_appSettings.ShowTablesUpsideDown;

            set.RequestProjectNotes = m_appSettings.RequestProjectNotes;
            set.ProjectFolder = m_appSettings.ProjectFolder;

            if (set.ShowDialog() == DialogResult.OK)
            {
                m_appSettings.InterpolateLogWorksTimescale = set.InterpolateLogWorksTimescale;
                m_appSettings.AutoSizeNewWindows = set.AutoSizeNewWindows;
                m_appSettings.AutoSizeColumnsInWindows = set.AutoSizeColumnsInViewer;
                m_appSettings.AutoChecksum = set.AutoUpdateChecksum;
                m_appSettings.ShowAddressesInHex = set.ShowAddressesInHex;
                //m_appSettings.AutoGenerateLogWorks = set.AutoGenerateLogWorksFile;
                m_appSettings.HideSymbolTable = set.HideSymbolWindow;
                m_appSettings.ShowGraphs = set.ShowGraphsInMapViewer;
                m_appSettings.MapDetectionActive = set.AutoMapDetectionActive;
                m_appSettings.Viewinhex = set.ViewTablesInHex;
                m_appSettings.DisableMapviewerColors = set.DisableMapviewerColors;
                m_appSettings.AutoDockSameFile = set.AutoDockSameFile;
                m_appSettings.AutoDockSameSymbol = set.AutoDockSameSymbol;
                m_appSettings.ShowViewerInWindows = set.ShowMapViewersInWindows;
                m_appSettings.NewPanelsFloating = set.NewPanelsFloating;
                m_appSettings.CANBusAdapterType = set.CANBusAdapterType;
                m_appSettings.OnlyPBus = set.OnlyPBus;

                m_appSettings.ResetRealtimeSymbolOnTabPageSwitch = set.ResetRealtimeSymbolOnTabPageSwitch;

                m_appSettings.DefaultViewType = set.DefaultViewType;
                m_appSettings.DefaultViewSize = set.DefaultViewSize;

                m_appSettings.AutoLoadLastFile = set.AutoLoadLastFile;
                m_appSettings.FancyDocking = set.FancyDocking;
                m_appSettings.ShowTablesUpsideDown = set.ShowTablesUpsideDown;
                m_appSettings.ShowMapPreviewPopup = set.ShowMapPreviewPopup;
                m_appSettings.SynchronizeMapviewers = set.SynchronizeMapviewers;
                //UpdateSettingButtons();
                if (!m_appSettings.FancyDocking)
                {
                    dockManager1.DockMode = DevExpress.XtraBars.Docking.Helpers.DockMode.Standard;
                }
                else
                {
                    dockManager1.DockMode = DevExpress.XtraBars.Docking.Helpers.DockMode.VS2005;
                }

                m_appSettings.RequestProjectNotes = set.RequestProjectNotes;
                m_appSettings.ProjectFolder = set.ProjectFolder;
            }
            SetFilterMode();
        }

        private void SetFilterMode()
        {
            if (m_appSettings.ShowAddressesInHex)
            {
                gcSymbolsAddress.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
                gcSymbolsAddress.DisplayFormat.FormatString = "X6";
                gcSymbolsAddress.FilterMode = DevExpress.XtraGrid.ColumnFilterMode.DisplayText;
                gcSymbolsLength.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
                gcSymbolsLength.DisplayFormat.FormatString = "X6";
                gcSymbolsLength.FilterMode = DevExpress.XtraGrid.ColumnFilterMode.DisplayText;

                gcSymbolsBitmask.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
                gcSymbolsBitmask.DisplayFormat.FormatString = "X6";
                gcSymbolsBitmask.FilterMode = DevExpress.XtraGrid.ColumnFilterMode.DisplayText;
            }
            else
            {
                gcSymbolsAddress.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
                gcSymbolsAddress.DisplayFormat.FormatString = "";
                gcSymbolsAddress.FilterMode = DevExpress.XtraGrid.ColumnFilterMode.Value;
                gcSymbolsLength.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
                gcSymbolsLength.DisplayFormat.FormatString = "";
                gcSymbolsLength.FilterMode = DevExpress.XtraGrid.ColumnFilterMode.Value;
                gcSymbolsBitmask.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
                gcSymbolsBitmask.DisplayFormat.FormatString = "";
                gcSymbolsBitmask.FilterMode = DevExpress.XtraGrid.ColumnFilterMode.Value;
            }
        }

        private void barButtonItem19_ItemClick(object sender, ItemClickEventArgs e)
        {
            StartExcelExport();
        }

        private void barButtonItem20_ItemClick(object sender, ItemClickEventArgs e)
        {
            ImportFileInExcelFormat();
        }

        private void StartExcelExport()
        {
            if (gridViewSymbols.SelectedRowsCount > 0)
            {
                int[] selrows = gridViewSymbols.GetSelectedRows();
                if (selrows.Length > 0)
                {
                    SymbolHelper sh = (SymbolHelper)gridViewSymbols.GetRow((int)selrows.GetValue(0));

                    //                    DataRowView dr = (DataRowView)gridViewSymbols.GetRow((int)selrows.GetValue(0));
                    //frmTableDetail tabdet = new frmTableDetail();
                    string Map_name = sh.Varname;
                    if (Map_name.StartsWith("Symbol:") && sh.Userdescription != "") Map_name = sh.Userdescription;
                    int columns = 8;
                    int rows = 8;
                    int tablewidth = GetTableMatrixWitdhByName(m_currentfile, m_symbols, Map_name, out columns, out rows);
                    int address = (int)sh.Flash_start_address;
                    if (address != 0)
                    {
                        while (address > m_currentfile_size) address -= m_currentfile_size;
                        int length = sh.Length;
                        byte[] mapdata = readdatafromfile(m_currentfile, address, length);
                        int[] xaxis = GetXaxisValues(m_currentfile, m_symbols, Map_name);
                        int[] yaxis = GetYaxisValues(m_currentfile, m_symbols, Map_name);
                        ExportToExcel(Map_name, address, length, mapdata, columns, rows, isSixteenBitTable(Map_name), xaxis, yaxis);
                    }
                }
            }
            else
            {
                MessageBox.Show("No symbol selected in the primary symbol list");
            }
        }
        private System.Data.DataTable getDataFromXLS(string strFilePath)
        {
            try
            {
                string strConnectionString = string.Empty;
                strConnectionString = @"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" + strFilePath + @";Extended Properties=""Excel 8.0;HDR=Yes;IMEX=1""";
                //MessageBox.Show(strConnectionString);
                OleDbConnection cnCSV = new OleDbConnection(strConnectionString);
                cnCSV.Open();
                OleDbCommand cmdSelect = new OleDbCommand(@"SELECT * FROM [symboldata$]", cnCSV);
                OleDbDataAdapter daCSV = new OleDbDataAdapter();
                daCSV.SelectCommand = cmdSelect;
                System.Data.DataTable dtCSV = new System.Data.DataTable();
                daCSV.Fill(dtCSV);
                cnCSV.Close();
                daCSV = null;
                return dtCSV;
            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.Message, "Error", MessageBoxButtons.OK);
                return null;
            }
            finally { }
        }

        private void ImportExcelSymbol(string symbolname, string filename)
        {
            bool issixteenbit = false;
            System.Data.DataTable dt = getDataFromXLS(openFileDialog2.FileName);
            if (isSixteenBitTable(symbolname)) issixteenbit = true;
            int symbollength = GetSymbolLength(m_symbols, symbolname);
            int datalength = symbollength;
            if (issixteenbit) datalength /= 2;
            int[] buffer = new int[datalength];
            int bcount = 0;
            for (int rtel = 1; rtel < dt.Rows.Count; rtel++)
            {
                try
                {
                    int idx = 0;
                    foreach (object o in dt.Rows[rtel].ItemArray)
                    {
                        if (idx > 0)
                        {
                            if (o != null)
                            {
                                if (o != DBNull.Value)
                                {
                                    if (bcount < buffer.Length)
                                    {
                                        buffer.SetValue(Convert.ToInt32(o), bcount++);
                                    }
                                    else
                                    {
                                        MessageBox.Show("Too much information in file, abort");
                                        return;
                                    }
                                }
                            }
                        }
                        idx++;
                    }
                }
                catch (Exception E)
                {
                    LogHelper.Log("ImportExcelSymbol: " + E.Message);
                }

            }
            if (bcount >= datalength)
            {
                byte[] data = new byte[symbollength];
                int cellcount = 0;
                if (issixteenbit)
                {
                    for (int dcnt = 0; dcnt < buffer.Length; dcnt++)
                    {
                        string bstr1 = "0";
                        string bstr2 = "0";
                        int cellvalue = Convert.ToInt32(buffer.GetValue(dcnt));
                        bstr1 = cellvalue.ToString("X4").Substring(0, 2);
                        bstr2 = cellvalue.ToString("X4").Substring(2, 2);
                        data.SetValue(Convert.ToByte(bstr1, 16), cellcount++);
                        data.SetValue(Convert.ToByte(bstr2, 16), cellcount++);
                    }
                }
                else
                {
                    for (int dcnt = 0; dcnt < buffer.Length; dcnt++)
                    {
                        int cellvalue = Convert.ToInt32(buffer.GetValue(dcnt));
                        data.SetValue(Convert.ToByte(cellvalue.ToString()), cellcount++);
                    }
                }
                savedatatobinary((int)GetSymbolAddress(m_symbols, symbolname), symbollength, data, m_currentfile, true);
                //verifychecksum(false);
                UpdateChecksum(m_currentfile, m_appSettings.AutoChecksum);
            }

        }

        private void ImportFileInExcelFormat()
        {
            if (openFileDialog2.ShowDialog() == DialogResult.OK)
            {
                try
                {
                    string mapname = string.Empty;
                    int tildeindex = openFileDialog2.FileName.LastIndexOf("~");
                    bool symbolfound = false;
                    if (tildeindex > 0)
                    {
                        tildeindex++;
                        mapname = openFileDialog2.FileName.Substring(tildeindex, openFileDialog2.FileName.Length - tildeindex);
                        mapname = mapname.Replace(".xls", "");
                        mapname = mapname.Replace(".XLS", "");
                        mapname = mapname.Replace(".Xls", "");
                        // look if it is a valid symbolname
                        foreach (SymbolHelper sh in m_symbols)
                        {
                            if (sh.Varname == mapname || sh.Userdescription == mapname)
                            {
                                symbolfound = true;
                                if (MessageBox.Show("Found valid symbol for import: " + mapname + ". Are you sure you want to overwrite the map in the binary?", "Confirmation", MessageBoxButtons.YesNo) == DialogResult.Yes)
                                {
                                    // ok, overwrite info in binary
                                }
                                else
                                {
                                    mapname = string.Empty; // do nothing
                                }
                            }
                        }
                        if (!symbolfound)
                        {
                            // ask user for symbol designation
                            frmSymbolSelect frmselect = new frmSymbolSelect(m_symbols);
                            if (frmselect.ShowDialog() == DialogResult.OK)
                            {
                                mapname = frmselect.SelectedSymbol;
                            }
                        }

                    }
                    else
                    {
                        // ask user for symbol designation
                        frmSymbolSelect frmselect = new frmSymbolSelect(m_symbols);
                        if (frmselect.ShowDialog() == DialogResult.OK)
                        {
                            mapname = frmselect.SelectedSymbol;
                        }

                    }
                    if (mapname != string.Empty)
                    {
                        ImportExcelSymbol(mapname, openFileDialog2.FileName);
                    }

                }
                catch (Exception E)
                {
                    MessageBox.Show("Failed to import map from excel: " + E.Message);
                }
            }
        }

        private System.Data.DataTable getDataFromXLSSymbolHelper(string strFilePath)
        {
            try
            {
                string strConnectionString = string.Empty;
                strConnectionString = @"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" + strFilePath + @";Extended Properties=""Excel 8.0;HDR=Yes;IMEX=1""";
                OleDbConnection cnCSV = new OleDbConnection(strConnectionString);
                cnCSV.Open();
                OleDbCommand cmdSelect = new OleDbCommand(@"SELECT * FROM [Symbols$]", cnCSV);
                OleDbDataAdapter daCSV = new OleDbDataAdapter();
                daCSV.SelectCommand = cmdSelect;
                System.Data.DataTable dtCSV = new System.Data.DataTable();
                daCSV.Fill(dtCSV);
                cnCSV.Close();
                daCSV = null;
                return dtCSV;
            }
            catch (Exception ex)
            {
                LogHelper.Log(ex.Message);
                return null;
            }
            finally { }
        }

        private byte[] TurnMapUpsideDown(byte[] mapdata, int numcolumns, int numrows, bool issixteenbit)
        {
            byte[] mapdatanew = new byte[mapdata.Length];
            if (issixteenbit) numcolumns *= 2;
            int internal_rows = mapdata.Length / numcolumns;
            for (int tel = 0; tel < internal_rows; tel++)
            {
                for (int ctel = 0; ctel < numcolumns; ctel++)
                {
                    int orgoffset = (((internal_rows - 1) - tel) * numcolumns) + ctel;
                    mapdatanew.SetValue(mapdata.GetValue(orgoffset), (tel * numcolumns) + ctel);
                }
            }
            return mapdatanew;
        }
        private void ExportToExcel(string mapname, int address, int length, byte[] mapdata, int cols, int rows, bool isSixteenbit, int[] xaxisvalues, int[] yaxisvalues)
        {
            try
            {
                bool isupsidedown = GetMapUpsideDown(mapname);
                if (xla == null)
                {
                    xla = new Microsoft.Office.Interop.Excel.Application();
                }

                // turn mapdata upside down
                if (isupsidedown)
                {
                    mapdata = TurnMapUpsideDown(mapdata, cols, rows, isSixteenbit);
                }

                xla.Visible = true;
                Microsoft.Office.Interop.Excel.Workbook wb = xla.Workbooks.Add(Microsoft.Office.Interop.Excel.XlSheetType.xlWorksheet);
                Microsoft.Office.Interop.Excel.Worksheet ws = (Microsoft.Office.Interop.Excel.Worksheet)xla.ActiveSheet;
                ws.Name = "symboldata";

                // Now create the chart.
                ChartObjects chartObjs = (ChartObjects)ws.ChartObjects(Type.Missing);
                ChartObject chartObj = chartObjs.Add(100, 400, 400, 300);
                Chart xlChart = chartObj.Chart;

                int nRows = rows;
                if (isSixteenbit) nRows /= 2;
                int nColumns = cols;
                string upperLeftCell = "B3";
                int endRowNumber = System.Int32.Parse(upperLeftCell.Substring(1)) + nRows - 1;
                char endColumnLetter = System.Convert.ToChar(Convert.ToInt32(upperLeftCell[0]) + nColumns - 1);
                string upperRightCell = System.String.Format("{0}{1}", endColumnLetter, System.Int32.Parse(upperLeftCell.Substring(1)));
                string lowerRightCell = System.String.Format("{0}{1}", endColumnLetter, endRowNumber);
                // Send single dimensional array to Excel:
                Range rg1 = ws.get_Range("B2", "Z2");
                double[] xarray = new double[nColumns];
                double[] yarray = new double[nRows];
                ws.Cells[1, 1] = "Data for " + mapname;
                for (int i = 0; i < xarray.Length; i++)
                {
                    if (xaxisvalues.Length > i)
                    {
                        xarray[i] = (int)xaxisvalues.GetValue(i);
                    }
                    else
                    {
                        xarray[i] = i;
                    }
                    //ws.Cells[i + 3, 1] = xarray[i];
                    ws.Cells[2, 2 + i] = xarray[i];
                }
                for (int i = 0; i < yarray.Length; i++)
                {
                    if (yaxisvalues.Length > i)
                    {
                        if (isupsidedown)
                        {
                            yarray[i] = (int)yaxisvalues.GetValue((yarray.Length - 1) - i);
                        }
                        else
                        {
                            yarray[i] = (int)yaxisvalues.GetValue(i);
                        }
                    }
                    else
                    {
                        yarray[i] = i;
                    }
                    ws.Cells[i + 3, 1] = yarray[i];
                    //ws.Cells[2, 2 + i] = yarray[i];
                }

                string xaxisdescr = "x-axis";
                string yaxisdescr = "y-axis";
                string zaxisdescr = "z-axis";
                GetAxisDescriptions(m_currentfile, m_symbols, mapname, out xaxisdescr, out yaxisdescr, out zaxisdescr);
                Range rg = ws.get_Range(upperLeftCell, lowerRightCell);
                rg.Value2 = AddData(nRows, nColumns, mapdata, isSixteenbit);

                Range chartRange = ws.get_Range("A2", lowerRightCell);
                xlChart.SetSourceData(chartRange, Type.Missing);
                if (yarray.Length > 1)
                {
                    xlChart.ChartType = XlChartType.xlSurface;
                }

                // Customize axes:
                Axis xAxis = (Axis)xlChart.Axes(XlAxisType.xlCategory,
                    XlAxisGroup.xlPrimary);
                xAxis.HasTitle = true;
                xAxis.AxisTitle.Text = yaxisdescr;
                try
                {
                    Axis yAxis = (Axis)xlChart.Axes(XlAxisType.xlSeriesAxis,
                        XlAxisGroup.xlPrimary);
                    yAxis.HasTitle = true;
                    yAxis.AxisTitle.Text = xaxisdescr;
                }
                catch (Exception E)
                {
                    LogHelper.Log(E.Message);
                }


                Axis zAxis = (Axis)xlChart.Axes(XlAxisType.xlValue,
                    XlAxisGroup.xlPrimary);
                zAxis.HasTitle = true;
                zAxis.AxisTitle.Text = zaxisdescr;

                // Add title:
                xlChart.HasTitle = true;

                xlChart.ChartTitle.Text = TranslateSymbolName(mapname);

                // Remove legend:
                xlChart.HasLegend = false;
                // add 3d shade
                xlChart.SurfaceGroup.Has3DShading = true;
                /*if (File.Exists(m_currentfile + "~" + mapname + ".xls"))
                {

                }*/
                wb.SaveAs(m_currentfile + "~" + mapname + ".xls", Microsoft.Office.Interop.Excel.XlFileFormat.xlWorkbookNormal, null, null, false, false, Microsoft.Office.Interop.Excel.XlSaveAsAccessMode.xlNoChange, false, null, null, null, null);

                /* This following code is used to create Excel default color indices:
                for (int i = 0; i < 14; i++)
                {
                    string cellString = "A" + (i + 1).ToString();
                    ws.get_Range(cellString, cellString).Interior.ColorIndex = i + 1;
                    ws.get_Range(cellString, cellString).Value2 = i + 1;
                    cellString = "B" + (i + 1).ToString();
                    ws.get_Range(cellString, cellString).Interior.ColorIndex = 14 + i + 1;
                    ws.get_Range(cellString, cellString).Value2 = 14 + i + 1;
                    cellString = "C" + (i + 1).ToString();
                    ws.get_Range(cellString, cellString).Interior.ColorIndex = 2 * 14 + i + 1;
                    ws.get_Range(cellString, cellString).Value2 = 2 * 14 + i + 1;
                    cellString = "D" + (i + 1).ToString();
                    ws.get_Range(cellString, cellString).Interior.ColorIndex = 3 * 14 + i + 1;
                    ws.get_Range(cellString, cellString).Value2 = 3 * 14 + i + 1;
                }*/
            }
            catch (Exception E)
            {
                LogHelper.Log("Failed to export to excel: " + E.Message);
            }

        }

        private double[,] AddData(int nRows, int nColumns, byte[] mapdata, bool isSixteenbit)
        {
            double[,] dataArray = new double[nRows, nColumns];
            double[] xarray = new double[nColumns];
            for (int i = 0; i < xarray.Length; i++)
            {
                xarray[i] = -3.0f + i * 0.25f;
            }
            double[] yarray = xarray;

            int mapindex = 0;
            for (int i = 0; i < dataArray.GetLength(0); i++)
            {
                for (int j = 0; j < dataArray.GetLength(1); j++)
                {
                    if (isSixteenbit)
                    {
                        byte val1 = (byte)mapdata.GetValue(mapindex++);
                        byte val2 = (byte)mapdata.GetValue(mapindex++);
                        if (val1 == 0xff)
                        {
                            val1 = 0;
                            val2 = (byte)(0x100 - val2);
                        }
                        int ival1 = Convert.ToInt32(val1);
                        int ival2 = Convert.ToInt32(val2);
                        double value = (ival1 * 256) + ival2;
                        dataArray[i, j] = value;
                    }
                    else
                    {
                        byte val1 = (byte)mapdata.GetValue(mapindex++);
                        int ival1 = Convert.ToInt32(val1);

                        double value = ival1;
                        dataArray[i, j] = value;
                    }
                }
            }
            return dataArray;
        }

        private void barButtonItem21_ItemClick(object sender, ItemClickEventArgs e)
        {
            m_symbols = new SymbolCollection();
            TryToOpenFile(m_currentfile, out m_symbols, m_currentfile_size);
            m_symbols.SortColumn = "Length";
            m_symbols.SortingOrder = GenericComparer.SortOrder.Descending;
            m_symbols.Sort();
            gridControlSymbols.DataSource = m_symbols;
        }

        private void barButtonItem22_ItemClick(object sender, ItemClickEventArgs e)
        {
            StartHexViewer();
            //StartSRAMHexViewer();
        }

        private void StartHexViewer()
        {
            if (m_currentfile != "")
            {
                dockManager1.BeginUpdate();
                try
                {
                    DockPanel dockPanel;
                    //= dockManager1.AddPanel(DevExpress.XtraBars.Docking.DockingStyle.Right);
                    if (!m_appSettings.NewPanelsFloating)
                    {
                        dockPanel = dockManager1.AddPanel(DockingStyle.Right);
                    }
                    else
                    {
                        System.Drawing.Point floatpoint = this.PointToClient(new System.Drawing.Point(dockSymbols.Location.X + dockSymbols.Width + 30, dockSymbols.Location.Y + 10));
                        dockPanel = dockManager1.AddPanel(floatpoint);
                    }

                    dockPanel.Text = "Hexviewer: " + Path.GetFileName(m_currentfile);
                    HexViewer hv = new HexViewer();
                    hv.Issramviewer = false;
                    hv.Dock = DockStyle.Fill;
                    dockPanel.Width = 580;
                    hv.LoadDataFromFile(m_currentfile, m_symbols);
                    dockPanel.ClosedPanel += new DockPanelEventHandler(dockPanel_ClosedPanel);
                    dockPanel.Controls.Add(hv);
                }
                catch (Exception E)
                {
                    LogHelper.Log(E.Message);
                }
                dockManager1.EndUpdate();
            }
        }

        void tabdet_onSymbolSelectForFind(object sender, CompareResults.SelectSymbolEventArgs e)
        {
            StartTableViewer(e.SymbolName);
        }


        private void barButtonItem23_ItemClick(object sender, ItemClickEventArgs e)
        {
            // ask the user for which value to search and if searching should include symbolnames and/or symbol description
            if (m_currentfile != "")
            {
                SymbolCollection result_Collection = new SymbolCollection();
                frmSearchMaps searchoptions = new frmSearchMaps();
                if (searchoptions.ShowDialog() == DialogResult.OK)
                {

                    SetProgress("Start searching data...");
                    SetProgressPercentage(0);

                    System.Windows.Forms.Application.DoEvents();
                    int cnt = 0;
                    SetProgress("Searching...");
                    foreach (SymbolHelper sh in m_symbols)
                    {

                        SetProgressPercentage((cnt * 100) / m_symbols.Count);
                        bool hit_found = false;
                        if (searchoptions.UseSpecificMapLength)
                        {
                            if (sh.Length != (int)searchoptions.MapLength)
                            {
                                continue;
                            }
                        }
                        if (searchoptions.IncludeSymbolNames)
                        {
                            if (searchoptions.SearchForNumericValues)
                            {
                                if (sh.Varname.Contains(searchoptions.NumericValueToSearchFor.ToString()))
                                {
                                    hit_found = true;
                                }
                            }
                            if (searchoptions.SearchForStringValues)
                            {
                                if (searchoptions.StringValueToSearchFor != string.Empty)
                                {
                                    if (sh.Varname.Contains(searchoptions.StringValueToSearchFor))
                                    {
                                        hit_found = true;
                                    }
                                }
                            }
                        }
                        if (searchoptions.IncludeSymbolDescription)
                        {
                            if (searchoptions.SearchForNumericValues)
                            {
                                if (sh.Description.Contains(searchoptions.NumericValueToSearchFor.ToString()))
                                {
                                    hit_found = true;
                                }
                            }
                            if (searchoptions.SearchForStringValues)
                            {
                                if (searchoptions.StringValueToSearchFor != string.Empty)
                                {
                                    if (sh.Description.Contains(searchoptions.StringValueToSearchFor))
                                    {
                                        hit_found = true;
                                    }
                                }
                            }
                        }
                        // now search the symbol data
                        if (sh.Flash_start_address < m_currentfile_size)
                        {
                            byte[] symboldata = readdatafromfile(m_currentfile, (int)sh.Flash_start_address, sh.Length);
                            if (searchoptions.SearchForNumericValues)
                            {
                                if (isSixteenBitTable(sh.Varname))
                                {
                                    for (int i = 0; i < symboldata.Length / 2; i += 2)
                                    {
                                        float value = Convert.ToInt32(symboldata.GetValue(i)) * 256;
                                        value += Convert.ToInt32(symboldata.GetValue(i + 1));
                                        value *= (float)GetMapCorrectionFactor(sh.Varname);
                                        value += (float)GetMapCorrectionOffset(sh.Varname);
                                        if (value == (float)searchoptions.NumericValueToSearchFor)
                                        {
                                            hit_found = true;
                                        }
                                    }
                                }
                                else
                                {
                                    for (int i = 0; i < symboldata.Length; i++)
                                    {
                                        float value = Convert.ToInt32(symboldata.GetValue(i));
                                        value *= (float)GetMapCorrectionFactor(sh.Varname);
                                        value += (float)GetMapCorrectionOffset(sh.Varname);
                                        if (value == (float)searchoptions.NumericValueToSearchFor)
                                        {
                                            hit_found = true;
                                        }
                                    }
                                }
                            }
                            if (searchoptions.SearchForStringValues)
                            {
                                if (searchoptions.StringValueToSearchFor.Length > symboldata.Length)
                                {
                                    // possible...
                                    string symboldataasstring = System.Text.Encoding.ASCII.GetString(symboldata);
                                    if (symboldataasstring.Contains(searchoptions.StringValueToSearchFor))
                                    {
                                        hit_found = true;
                                    }
                                }
                            }
                        }

                        if (hit_found)
                        {
                            // add to collection
                            result_Collection.Add(sh);
                        }
                        cnt++;
                    }
                    SetProgressIdle();
                    if (result_Collection.Count == 0)
                    {
                        MessageBox.Show("No results found...");
                    }
                    else
                    {
                        // start result screen
                        dockManager1.BeginUpdate();
                        try
                        {
                            SymbolTranslator st = new SymbolTranslator();
                            DockPanel dockPanel = dockManager1.AddPanel(new System.Drawing.Point(-500, -500));
                            CompareResults tabdet = new CompareResults();
                            tabdet.ShowAddressesInHex = m_appSettings.ShowAddressesInHex;
                            tabdet.SetFilterMode(m_appSettings.ShowAddressesInHex);
                            tabdet.Dock = DockStyle.Fill;
                            tabdet.UseForFind = true;
                            tabdet.Filename = openFileDialog1.FileName;
                            tabdet.onSymbolSelect += new CompareResults.NotifySelectSymbol(tabdet_onSymbolSelectForFind);
                            dockPanel.Controls.Add(tabdet);
                            string resultText = "Search results: ";
                            if (searchoptions.SearchForNumericValues)
                            {
                                resultText += " number " + searchoptions.NumericValueToSearchFor.ToString();
                            }
                            if (searchoptions.SearchForStringValues)
                            {
                                resultText += " string " + searchoptions.StringValueToSearchFor;
                            }
                            dockPanel.Text = resultText;

                            dockPanel.DockTo(dockManager1, DockingStyle.Left, 1);

                            dockPanel.Width = 700;

                            System.Data.DataTable dt = new System.Data.DataTable();
                            dt.Columns.Add("SYMBOLNAME");
                            dt.Columns.Add("SRAMADDRESS", Type.GetType("System.Int32"));
                            dt.Columns.Add("FLASHADDRESS", Type.GetType("System.Int32"));
                            dt.Columns.Add("LENGTHBYTES", Type.GetType("System.Int32"));
                            dt.Columns.Add("LENGTHVALUES", Type.GetType("System.Int32"));
                            dt.Columns.Add("DESCRIPTION");
                            dt.Columns.Add("ISCHANGED", Type.GetType("System.Boolean"));
                            dt.Columns.Add("CATEGORY"); //0
                            dt.Columns.Add("DIFFPERCENTAGE", Type.GetType("System.Double"));
                            dt.Columns.Add("DIFFABSOLUTE", Type.GetType("System.Int32"));
                            dt.Columns.Add("DIFFAVERAGE", Type.GetType("System.Double"));
                            dt.Columns.Add("CATEGORYNAME");
                            dt.Columns.Add("SUBCATEGORYNAME");
                            dt.Columns.Add("SymbolNumber1", Type.GetType("System.Int32"));
                            dt.Columns.Add("SymbolNumber2", Type.GetType("System.Int32"));
                            string category = "";
                            string ht = string.Empty;
                            double diffperc = 0;
                            int diffabs = 0;
                            double diffavg = 0;
                            XDFCategories cat = XDFCategories.Undocumented;
                            XDFSubCategory subcat = XDFSubCategory.Undocumented;
                            foreach (SymbolHelper shfound in result_Collection)
                            {
                                string helptext = st.TranslateSymbolToHelpText(shfound.Varname, out ht, out cat, out subcat);
                                if (shfound.Varname.Contains("."))
                                {
                                    try
                                    {
                                        shfound.Category = shfound.Varname.Substring(0, shfound.Varname.IndexOf("."));
                                    }
                                    catch (Exception cE)
                                    {
                                        LogHelper.Log("Failed to assign category to symbol: " + shfound.Varname + " err: " + cE.Message);
                                    }
                                }
                                dt.Rows.Add(shfound.Varname, shfound.Start_address, shfound.Flash_start_address, shfound.Length, shfound.Length, helptext, false, 0, 0, 0, 0, shfound.Category, "", shfound.Symbol_number, shfound.Symbol_number);
                            }
                            tabdet.CompareSymbolCollection = result_Collection;
                            tabdet.OpenGridViewGroups(tabdet.gridControl1, 1);
                            tabdet.gridControl1.DataSource = dt.Copy();

                        }
                        catch (Exception E)
                        {
                            LogHelper.Log(E.Message);
                        }
                        dockManager1.EndUpdate();

                    }


                }
            }
        }

        private bool IsChristmasTime()
        {
            // test, return true
            if (DateTime.Now.Month == 12 && DateTime.Now.Day >= 20 && DateTime.Now.Day <= 26)
            {
                return true;
            }
            return false;
        }

        private bool IsHalloweenTime()
        {
            // test, return true
            if (DateTime.Now.Month == 10 && DateTime.Now.Day >= 30 && DateTime.Now.Day <= 31)
            {
                return true;
            }
            return false;
        }

        private bool IsValetineTime()
        {
            // test, return true
            if (DateTime.Now.Month == 2 && DateTime.Now.Day >= 13 && DateTime.Now.Day <= 14)
            {
                return true;
            }
            return false;
        }


        private void ShowChristmasWish()
        {
            int newyear = DateTime.Now.Year + 1;
            frmInfoBox info = new frmInfoBox("Merry christmas and a happy " + newyear.ToString("D4") + "\rDilemma");
        }

        private void Form1_Shown(object sender, EventArgs e)
        {
            try
            {
                m_msiUpdater = new msiupdater(new Version(System.Windows.Forms.Application.ProductVersion));
                m_msiUpdater.Apppath = System.Windows.Forms.Application.UserAppDataPath;
                m_msiUpdater.onDataPump += new msiupdater.DataPump(m_msiUpdater_onDataPump);
                m_msiUpdater.onUpdateProgressChanged += new msiupdater.UpdateProgressChanged(m_msiUpdater_onUpdateProgressChanged);
                m_msiUpdater.CheckForUpdates("http://develop.trionictuning.com/T8Suite/", "t8suitepro", "T8Suite.msi");
            }
            catch (Exception E)
            {
                LogHelper.Log(E.Message);
            }
            if (IsChristmasTime())
            {
                ShowChristmasWish();
            }
        }

        void m_msiUpdater_onUpdateProgressChanged(msiupdater.MSIUpdateProgressEventArgs e)
        {

        }

        private void SetStatusText(string text)
        {
            barUpdateText.Caption = text;
            System.Windows.Forms.Application.DoEvents();
        }

        void m_msiUpdater_onDataPump(msiupdater.MSIUpdaterEventArgs e)
        {
            SetStatusText(e.Data);
            if (e.UpdateAvailable)
            {
                if (e.XMLFile != "" && e.Version.ToString() != "0.0")
                {
                    if (!this.IsDisposed)
                    {
                        try
                        {
                            this.Invoke(m_DelegateStartReleaseNotePanel, e.XMLFile, e.Version.ToString());
                        }
                        catch (Exception E)
                        {
                            LogHelper.Log(E.Message);
                        }
                    }
                }

                frmUpdateAvailable frmUpdate = new frmUpdateAvailable();
                frmUpdate.SetVersionNumber(e.Version.ToString());
                if (m_msiUpdater != null)
                {
                    m_msiUpdater.Blockauto_updates = false;
                }
                if (frmUpdate.ShowDialog() == DialogResult.OK)
                {
                    if (m_msiUpdater != null)
                    {
                        m_msiUpdater.ExecuteUpdate(e.Version);
                        System.Windows.Forms.Application.Exit();
                    }
                }
                else
                {
                    // user choose "NO", don't bug him again!
                    if (m_msiUpdater != null)
                    {
                        m_msiUpdater.Blockauto_updates = false;
                    }
                }
            }
        }

        private void barUpdateText_ItemDoubleClick(object sender, ItemClickEventArgs e)
        {
            System.Diagnostics.Process.Start("IEXPLORE.EXE", "http://develop.trionictuning.com/T8Suite/Notes.xml");
        }

        /// <summary>
        /// Sets or Unsets Full-Screen mode for this form, saving the old state values. 
        /// Note, the order of calls in this function is important.
        /// </summary>
        /// <param name="bFullScreen">set to fullscreen if true, unset if false</param>
        void SetFullScreenMode(bool bFullScreen)
        {
            // enable full screen mode only if we're NOT in fullscreen
            if (bFullScreen && !_isFullScreenEnabled)
            {
                this.SuspendLayout();

                // get current window state
                _oldWindowState = this.WindowState;

                // get the normal window state so we don't lose those values
                if (this.WindowState == FormWindowState.Maximized)
                    this.WindowState = FormWindowState.Normal;

                // get the normal state values
                _oldClientSize = this.ClientSize;
                _oldDesktopBounds = this.DesktopBounds;

                // jump to full screen
                this.FormBorderStyle = FormBorderStyle.None;
                this.DesktopBounds = Screen.FromControl(this).Bounds;

                _isFullScreenEnabled = true;

                this.ResumeLayout();
            }

            // disable full screen mode only if we're in fullscreen
            if (!bFullScreen && _isFullScreenEnabled)
            {
                this.SuspendLayout();

                // reset the old state
                this.DesktopBounds = _oldDesktopBounds;
                this.ClientSize = _oldClientSize;
                FormBorderStyle = System.Windows.Forms.FormBorderStyle.Sizable;
                this.WindowState = _oldWindowState;

                _isFullScreenEnabled = false;

                this.ResumeLayout();
            }
        }

        private void barButtonItem24_ItemClick(object sender, ItemClickEventArgs e)
        {
            if (!_isFullScreenEnabled)
            {
                SetFullScreenMode(true);
                TopMost = true;
            }
            else
            {
                SetFullScreenMode(false);
                TopMost = false;
            }
        }

        private void CreateBinaryBackup(string filename, bool ShowMessages)
        {
            if (m_currentfile != string.Empty)
            {
                if (File.Exists(filename))
                {
                    if (m_CurrentWorkingProject != "")
                    {
                        if (!Directory.Exists(m_appSettings.ProjectFolder + "\\" + m_CurrentWorkingProject + "\\Backups")) Directory.CreateDirectory(m_appSettings.ProjectFolder + "\\" + m_CurrentWorkingProject + "\\Backups");
                        string newfilename = m_appSettings.ProjectFolder + "\\" + m_CurrentWorkingProject + "\\Backups\\" + Path.GetFileNameWithoutExtension(GetBinaryForProject(m_CurrentWorkingProject)) + "-backup-" + DateTime.Now.ToString("MMddyyyyHHmmss") + ".BIN";
                        File.Copy(GetBinaryForProject(m_CurrentWorkingProject), newfilename);
                    }
                    else
                    {
                        File.Copy(filename, Path.GetDirectoryName(filename) + "\\" + Path.GetFileNameWithoutExtension(filename) + DateTime.Now.ToString("yyyyMMddHHmmss") + ".binarybackup", true);
                        if (ShowMessages)
                        {
                            MessageBox.Show("Backup created: " + Path.GetDirectoryName(filename) + "\\" + Path.GetFileNameWithoutExtension(filename) + DateTime.Now.ToString("yyyyMMddHHmmss") + ".binarybackup");
                        }
                    }

                }
            }

        }

        private void barButtonItem25_ItemClick(object sender, ItemClickEventArgs e)
        {
            CreateBinaryBackup(m_currentfile, true);
        }

        private void barButtonItem26_ItemClick(object sender, ItemClickEventArgs e)
        {
            SaveFileDialog sfd = new SaveFileDialog();
            sfd.Filter = "Binary files|*.bin";
            sfd.Title = "Save current file as... ";
            sfd.CheckFileExists = false;
            sfd.CheckPathExists = true;

            if (sfd.ShowDialog() == DialogResult.OK)
            {
                File.Copy(m_currentfile, sfd.FileName, true);
                if (MessageBox.Show("Do you want to open the newly saved file?", "Question", MessageBoxButtons.YesNo) == DialogResult.Yes)
                {
                    m_currentfile = sfd.FileName;//Application.StartupPath + "\\55559437  81f.bin";
                    CloseProject();
                    m_currentfile = sfd.FileName;//Application.StartupPath + "\\55559437  81f.bin";
                    TryToOpenFile(m_currentfile, out m_symbols, m_currentfile_size);


                    Text = String.Format("T8SuitePro v{0} [ {1} ]", System.Windows.Forms.Application.ProductVersion, Path.GetFileName(m_currentfile));
                    barFilenameText.Caption = Path.GetFileName(m_currentfile);
                    gridControlSymbols.DataSource = m_symbols;
                    m_appSettings.Lastfilename = m_currentfile;
                    gridViewSymbols.BestFitColumns();
                    UpdateChecksum(m_currentfile, m_appSettings.AutoChecksum);

                    m_appSettings.LastOpenedType = 0;
                }
            }
        }
        private void CopySymbol(string symbolname, string fromfilename, int fromflashaddress, int fromlength, string targetfilename, int targetflashaddress, int targetlength)
        {
            if (fromlength != targetlength)
            {
                AddToResumeTable("Unable to transfer symbol " + symbolname + " because source and target lengths don't match!");
            }
            else
            {
                try
                {
                    while (fromflashaddress > m_currentfile_size) fromflashaddress -= m_currentfile_size;
                    FileInfo fi = new FileInfo(targetfilename);
                    while (targetflashaddress > fi.Length) targetflashaddress -= (int)fi.Length;
                    byte[] mapdata = readdatafromfile(fromfilename, fromflashaddress, fromlength);
                    savedatatobinary(targetflashaddress, targetlength, mapdata, targetfilename, true);
                    AddToResumeTable("Transferred symbol " + symbolname + " successfully");
                }
                catch (Exception E)
                {
                    AddToResumeTable("Failed to transfer symbol " + symbolname + ": " + E.Message);
                }
            }
        }

        private bool CanTransfer(SymbolHelper sh)
        {
            // FOR TESTING ONLY
            //return true;
            bool retval = false;
            if (sh.Varname.Contains(".") || sh.Userdescription.Contains(".")) retval = true;
            return retval;
        }

        private void TransferMapsToNewBinary(string filename)
        {
            SymbolCollection curSymbolCollection = new SymbolCollection();
            //AddressLookupCollection curAddressLookupCollection = new AddressLookupCollection();
            resumeTuning = new System.Data.DataTable();
            resumeTuning.Columns.Add("Description");

            if (filename != string.Empty)
            {
                frmTransferSelectionSymbolsSelection frmtransfer = new frmTransferSelectionSymbolsSelection();
                SymbolCollection _onlyFlashSymbols = new SymbolCollection();
                foreach (SymbolHelper shcopy in m_symbols)
                {
                    if (shcopy.Flash_start_address > 0 && GetSymbolAddress(m_symbols, shcopy.Varname) < 1048576 && shcopy.Length > 0 && CanTransfer(shcopy))
                    {
                        _onlyFlashSymbols.Symbols.Add(shcopy);
                    }
                }
                frmtransfer.Symbols = /*m_symbols*/_onlyFlashSymbols;
                if (frmtransfer.ShowDialog() == DialogResult.OK)
                {
                    SetProgress("Initializing");
                    SetProgress("Creating backup file...");
                    File.Copy(filename, Path.GetDirectoryName(filename) + "\\" + Path.GetFileNameWithoutExtension(filename) + DateTime.Now.ToString("yyyyMMddHHmmss") + "beforetransferringmaps.bin", true);
                    AddToResumeTable("Backup file created (" + Path.GetDirectoryName(filename) + "\\" + Path.GetFileNameWithoutExtension(filename) + DateTime.Now.ToString("yyyyMMddHHmmss") + "beforetransferringmaps.bin)");
                    AddToResumeTable("Transferring data from " + Path.GetFileName(m_currentfile) + " to " + filename);



                    bool m_fileparsed = false;

                    //listView1.Items.Clear();
                    SetStatusText("Start symbol parsing");


                    FileInfo fi = new FileInfo(filename);
                    TryToOpenFile(filename, out curSymbolCollection, (int)fi.Length);

                    curSymbolCollection.SortColumn = "Flash_start_address";
                    curSymbolCollection.SortingOrder = GenericComparer.SortOrder.Ascending;
                    curSymbolCollection.Sort();
                    SetProgress("Start transfer");
                    int symidx = 0;
                    foreach (SymbolHelper sh in curSymbolCollection)
                    {
                        if (sh.Flash_start_address > 0 && sh.Flash_start_address < m_currentfile_size && sh.Length < 0x1000)
                        {
                            foreach (SymbolHelper cfsh in m_symbols)
                            {
                                if (CanTransfer(cfsh))
                                {
                                    if (cfsh.Varname == sh.Varname || cfsh.Userdescription == sh.Varname)
                                    {
                                        string symbolname = cfsh.Varname;
                                        if (symbolname.StartsWith("Symbolnumber"))
                                        {
                                            if (!sh.Varname.StartsWith("Symbolnumber")) symbolname = sh.Varname;
                                            else if (sh.Userdescription != "") symbolname = sh.Userdescription;
                                            else if (cfsh.Userdescription != "") symbolname = cfsh.Userdescription;
                                        }
                                        if (SymbolInTransferCollection(frmtransfer.Symbols, symbolname))
                                        {
                                            SetProgress("Transferring: " + sh.Varname);
                                            int percentage = symidx * 100 / curSymbolCollection.Count;
                                            SetProgressPercentage(percentage);
                                            CopySymbol(sh.Varname, m_currentfile, (int)cfsh.Flash_start_address, cfsh.Length, filename, (int)sh.Flash_start_address, sh.Length);
                                        }
                                    }
                                }
                            }
                        }
                        symidx++;
                    }

                    UpdateChecksum(filename, m_appSettings.AutoChecksum);
                    SetStatusText("Idle.");
                    SetProgressIdle();
                }

            }
        }

        private bool SymbolInTransferCollection(SymbolCollection transferCollection, string mapname)
        {
            foreach (SymbolHelper sh_test in transferCollection)
            {
                if (sh_test.Selected && (sh_test.Varname == mapname || sh_test.Userdescription == mapname))
                {
                    return true;
                }
            }
            return false;
        }

        private void AddToResumeTable(string description)
        {
            if (resumeTuning != null)
            {
                if (resumeTuning.Columns.Count == 1)
                {
                    resumeTuning.Rows.Add(description);
                }
            }
        }

        private void barButtonItem27_ItemClick(object sender, ItemClickEventArgs e)
        {
            // ask for another bin file
            if (m_currentfile != string.Empty)
            {

                PSTaskDialog.cTaskDialog.ForceEmulationMode = false;
                PSTaskDialog.cTaskDialog.EmulatedFormWidth = 600;
                PSTaskDialog.cTaskDialog.UseToolWindowOnXP = false;
                PSTaskDialog.cTaskDialog.VerificationChecked = true;
                PSTaskDialog.cTaskDialog.ShowTaskDialogBox("Transfer maps to different binary wizard", "This wizard assists you in transferring map contents from the current file to another binary.", "Make sure engine types and such are equal for both binaries!", "Happy driving!!!\nDilemma  2008", "The author does not take responsibility for any damage done to your car or other objects in any form!", "Show me a summary after transferring data.", "", "Yes, let me select the target binary|No thanks!", eTaskDialogButtons.None, eSysIcons.Information, eSysIcons.Warning);
                switch (PSTaskDialog.cTaskDialog.CommandButtonResult)
                {
                    case 0:
                        if (openFileDialog1.ShowDialog() == DialogResult.OK)
                        {
                            TransferMapsToNewBinary(openFileDialog1.FileName);
                        }
                        else
                        {
                            return;
                        }
                        break;
                    case 1:
                        // cancel
                        break;
                }
                if (PSTaskDialog.cTaskDialog.VerificationChecked && PSTaskDialog.cTaskDialog.CommandButtonResult != 1)
                {
                    TuningReport tuningrep = new TuningReport();
                    tuningrep.ReportTitle = "Data transfer report";
                    tuningrep.DataSource = resumeTuning;
                    tuningrep.CreateReport();
                    tuningrep.ShowPreview(defaultLookAndFeel1.LookAndFeel);
                }
            }
        }

        private int TorqueToAirmass(int torque, bool E85)
        {
            double airmass = Convert.ToDouble(torque) * 3.1;
            if (E85)
            {
                airmass /= 1.07;
            }
            return Convert.ToInt32(airmass);
        }

        private int PowerToTorque(int power, int rpm, bool doCorrection)
        {
            double torque = (power * 7024) / rpm;
            double correction = 1;
            if (rpm >= 6000) correction = 0.88;
            else if (rpm > 5800) correction = 0.90;
            else if (rpm > 5400) correction = 0.92;
            else if (rpm > 5000) correction = 0.95;
            else if (rpm > 4600) correction = 0.98;
            if (doCorrection)
            {
                torque /= correction;
            }
            return Convert.ToInt32(torque);
        }

        private int TorqueToPower(int torque, int rpm)
        {
            double power = (torque * rpm) / 7024;
            return Convert.ToInt32(power);
        }

        private int AirmassToTorque(int airmass, bool E85)
        {
            double tq = Convert.ToDouble(airmass) / 3.1;
            if (E85)
            {
                tq *= 1.07;
            }
            return Convert.ToInt32(tq);
        }

        private byte[] GetPedalMap(int maxairmass, int peakHP, bool E85)
        {
            // PedalMapCal.n_EngineMap is rpm axis
            // 700, 880, 1260, 2020, 2400 etc
            byte[] rpm_axis = readdatafromfile(m_currentfile, (int)GetSymbolAddress(m_symbols, "PedalMapCal.n_EngineMap"), GetSymbolLength(m_symbols, "PedalMapCal.n_EngineMap"));

            int[] airmasspercentage = new int[16 * 16] {96,  97,  99, 100, 100, 100, 100, 100, 100, 100, 99,  98,  95,  90,  85,  83,
                                                        92,  92,  92,  92,  92,  92,  92,  92,  89,  82, 72,  68,  64,  60,  60,  60,
                                                        85,  85,  85,  85,  85,  85,  85,  81,  71,  64, 59,  55,  53,  50,  49,  48,
                                                        79,  79,  79,  79,  79,  77,  75,  69,  59,  54, 50,  47,  45,  43,  42,  42,
                                                        73,  73,  73,  71,  69,  67,  64,  54,  48,  44, 41,  39,  37,  36,  36,  36,
                                                        67,  67,  65,  63,  59,  56,  48,  42,  38,  36, 34,  32,  30,  30,  29,  29,
                                                        59,  59,  55,  50,  46,  40,  34,  31,  29,  27, 26,  25,  25,  24,  24,  24,
                                                        50,  48,  42,  37,  34,  29,  26,  24,  23,  21, 20,  20,  20,  19,  19,  19,
                                                        36,  33,  29,  27,  24,  22,  19,  18,  17,  16, 15,  15,  15,  15,  15,  15,
                                                        24,  23,  21,  19,  18,  16,  15,  12,  11,  10, 10,  10,  10,  10,  10,  10,
                                                        20,  18,  15,  12,   9,   6,   5,   5,   5,   5,  5,   5,   5,   5,   5,  5,
                                                        16,  13,  10,   7,   5,   4,   3,   3,   3,   2,  2,   2,   2,   2,   2,  2,
                                                        10,   8,   5,   4,   3,   2,   2,   2,   2,   2,  2,   2,   2,   2,   2,  2,
                                                         5,   4,   3,   2,   1,   1,   1,   1,   1,   1,  1,   1,   1,   1,   1,  1,
                                                         2,   1,   1,   0,   0,   0,   0,   0,   0,   0,  0,   0,   0,   0,   0,  0,
                                                         0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  0,   0,   0,   0,   0,  0};

            byte[] returnvalue = new byte[16 * 16 * 2]; // in bytes
            int cell = 0;
            for (int column = 0; column < 16; column++)
            {
                // calculate RPM indication

                for (int row = 0; row < 16; row++)
                {
                    int rpm = Convert.ToInt32(rpm_axis[row * 2]) * 256 + Convert.ToInt32(rpm_axis[(row * 2) + 1]);
                    int valueincell = (maxairmass * airmasspercentage[(row) + (16 * (15 - column))]) / 100;

                    //int torqueincell = AirmassToTorque(valueincell, E85);
                    //if (TorqueToPower(torqueincell, rpm) > peakHP)
                    //{
                    // set to max
                    //int maxtorqueforcell = PowerToTorque(peakHP, rpm, false);
                    //int maxairmassforcell = TorqueToAirmass(maxtorqueforcell, E85);
                    //LogHelper.Log("Setting " + valueincell.ToString() + " to " + maxairmassforcell.ToString() + " at " + rpm.ToString() + " rpm");
                    //valueincell *= 10; // T8 has 10 factor
                    valueincell = valueincell;
                    //}


                    byte b1 = Convert.ToByte(valueincell / 256);
                    byte b2 = Convert.ToByte(valueincell - (int)b1 * 256);
                    returnvalue[cell * 2] = b1;
                    returnvalue[(cell * 2) + 1] = b2;
                    cell++;
                }
            }
            return returnvalue;
        }

        private byte[] GetAirTorqueCalibration(int maxairmass)
        {
            int[] airtrqcalib = new int[16 * 16] {      6, 9, 12, 20, 25, 32, 39, 45,51, 58, 65, 73, 81, 87, 93, 100,
                                                        6, 9, 12, 20, 25, 32, 39, 45,51, 58, 65, 73, 81, 87, 93, 100,
                                                        6, 9, 12, 20, 25, 32, 39, 45,51, 58, 65, 73, 81, 87, 93, 100,
                                                        6, 9, 12, 20, 25, 32, 39, 45,51, 58, 65, 73, 81, 87, 93, 100,
                                                        6, 9, 12, 20, 25, 32, 39, 45,51, 58, 65, 73, 81, 87, 93, 100,
                                                        6, 9, 12, 20, 25, 32, 39, 45,51, 58, 65, 73, 81, 87, 93, 100,
                                                        6, 9, 12, 20, 25, 32, 39, 45,51, 58, 65, 73, 81, 87, 93, 100,
                                                        6, 9, 12, 20, 25, 32, 39, 45,51, 58, 65, 73, 81, 87, 93, 100,
                                                        6, 9, 12, 20, 25, 32, 39, 45,51, 58, 65, 73, 81, 87, 93, 100,
                                                        6, 9, 12, 20, 25, 32, 39, 45,51, 58, 65, 73, 81, 87, 93, 100,
                                                        6, 9, 12, 20, 25, 32, 39, 45,51, 58, 65, 73, 81, 87, 93, 100,
                                                        6, 9, 12, 20, 25, 32, 39, 45,51, 58, 65, 73, 81, 87, 93, 100,
                                                        6, 9, 12, 20, 25, 32, 39, 45,51, 58, 65, 73, 81, 87, 93, 100,
                                                        6, 9, 12, 20, 25, 32, 39, 45,51, 58, 65, 73, 81, 87, 93, 100,
                                                        6, 9, 12, 20, 25, 32, 39, 45,51, 58, 65, 73, 81, 87, 93, 100,
                                                        6, 9, 12, 20, 25, 32, 39, 45,51, 58, 65, 73, 81, 87, 93, 100};
            byte[] returnvalue = new byte[16 * 16 * 2]; // in bytes
            int cell = 0;
            for (int column = 0; column < 16; column++)
            {
                for (int row = 0; row < 16; row++)
                {
                    int valueincell = (maxairmass * airtrqcalib[(row) + (16 * (15 - column))]) / 100;
                    byte b1 = Convert.ToByte(valueincell / 256);
                    byte b2 = Convert.ToByte(valueincell - (int)b1 * 256);
                    returnvalue[cell * 2] = b1;
                    returnvalue[(cell * 2) + 1] = b2;
                    cell++;
                }
            }
            return returnvalue;
        }

        private byte[] GetNominalTorqueMap(int maxairmass)
        {
            /*   int[] airtrqcalib = new int[18 * 16] {      0xFFDF, 0xFFEA, 0xFFF2, 0xFFFA, 8, 29, 53, 77, 99,124, 143, 163, 185, 204, 219, 236, 256, 283,
                                                           0xFFE2, 0xFFEC, 0xFFF3, 0xFFFB,10, 32, 56, 77,100,124, 146, 167, 189, 209, 225, 241, 260, 283,
                                                           0xFFE4, 0xFFEE, 0xFFF7, 0xFFFF,12, 32, 58, 78,101,124, 151, 171, 192, 215, 233, 248, 264, 283,
                                                           0xFFE8, 0xFFF2, 0xFFFB,      3,16, 39, 62, 85,107,130, 154, 178, 198, 219, 238, 254, 266, 283,
                                                           0xFFE8, 0xFFF3, 0xFFFE,      5,18, 41, 64, 88,110,132, 154, 179, 203, 223, 242, 258, 272, 288,
                                                           0xFFE8, 0xFFF3, 0xFFFD,      5,18, 42, 66, 92,114,136, 158, 178, 200, 227, 244, 260, 276, 296,
                                                           0xFFE9, 0xFFF3, 0xFFFD,      4,17, 43, 67, 91,116,139, 161, 181, 196, 224, 243, 259, 274, 297,
                                                           0xFFEC, 0xFFF6,      1,      8,23, 45, 69, 93,117,142, 163, 185, 205, 221, 246, 263, 277, 294,
                                                           0xFFEE, 0xFFFB,      4,     11,26, 49, 72, 96,119,143, 167, 187, 206, 225, 247, 263, 278, 294,
                                                           0xFFEE, 0xFFFB,      4,     11,27, 52, 74, 98,121,144, 168, 191, 213, 231, 248, 261, 275, 295,
                                                           0xFFEF, 0xFFFA,      3,     11,27, 53, 74, 98,120,145, 167, 187, 211, 232, 245, 261, 277, 300,
                                                           0xFFEF, 0xFFF9,      2,     10,27, 53, 75, 96,120,143, 166, 185, 203, 226, 244, 257, 269, 290,
                                                           0xFFEF, 0xFFF9,      2,     10,27, 53, 75, 96,120,143, 166, 185, 203, 226, 244, 257, 269, 290,
                                                           0xFFF0, 0xFFFA,      3,     10,27, 51, 75, 97,118,140, 161, 181, 202, 222, 237, 252, 267, 290,
                                                           0xFFEF, 0xFFF7, 0xFFFF,      9,27, 52, 74, 98,120,138, 160, 184, 202, 222, 237, 252, 267, 290,
                                                           0xFFF0, 0xFFF7, 0xFFFF,     11,31, 55, 79,101,122,146, 177, 189, 202, 222, 237, 252, 267, 290};*/
            int[] airtrqcalib = new int[18 * 16] {         0xFFD8, 0xFFFB, 10, 30, 50, 65, 80, 100, 120,140, 160, 180, 195, 210, 230, 250, 275, 300,
                                                           0xFFD8, 0xFFFB, 10, 30, 50, 65, 80, 100, 120,140, 160, 180, 195, 210, 230, 250, 275, 300,
                                                           0xFFD8, 0xFFFB, 10, 30, 50, 65, 80, 100, 120,140, 160, 180, 195, 210, 230, 250, 275, 300,
                                                           0xFFD8, 0xFFFB, 10, 30, 50, 65, 80, 100, 120,140, 160, 180, 195, 210, 230, 250, 275, 300,
                                                           0xFFD8, 0xFFFB, 10, 30, 50, 65, 80, 100, 120,140, 160, 180, 195, 210, 230, 250, 275, 300,
                                                           0xFFD8, 0xFFFB, 10, 30, 50, 65, 80, 100, 120,140, 160, 180, 195, 210, 230, 250, 275, 300,
                                                           0xFFD8, 0xFFFB, 10, 30, 50, 65, 80, 100, 120,140, 160, 180, 195, 210, 230, 250, 275, 300,
                                                           0xFFD8, 0xFFFB, 10, 30, 50, 65, 80, 100, 120,140, 160, 180, 195, 210, 230, 250, 275, 300,
                                                           0xFFD8, 0xFFFB, 10, 30, 50, 65, 80, 100, 120,140, 160, 180, 195, 210, 230, 250, 275, 300,
                                                           0xFFD8, 0xFFFB, 10, 30, 50, 65, 80, 100, 120,140, 160, 180, 195, 210, 230, 250, 275, 300,
                                                           0xFFD8, 0xFFFB, 10, 30, 50, 65, 80, 100, 120,140, 160, 180, 195, 210, 230, 250, 275, 300,
                                                           0xFFD8, 0xFFFB, 10, 30, 50, 65, 80, 100, 120,140, 160, 180, 195, 210, 230, 250, 275, 300,
                                                           0xFFD8, 0xFFFB, 10, 30, 50, 65, 80, 100, 120,140, 160, 180, 195, 210, 230, 250, 275, 300,
                                                           0xFFD8, 0xFFFB, 10, 30, 50, 65, 80, 100, 120,140, 160, 180, 195, 210, 230, 250, 275, 300,
                                                           0xFFD8, 0xFFFB, 10, 30, 50, 65, 80, 100, 120,140, 160, 180, 195, 210, 230, 250, 275, 300,
                                                           0xFFD8, 0xFFFB, 10, 30, 50, 65, 80, 100, 120,140, 160, 180, 195, 210, 230, 250, 275, 300};

            byte[] returnvalue = new byte[18 * 16 * 2]; // in bytes

            int cell = 0;
            for (int column = 0; column < 16; column++)
            {
                for (int row = 0; row < 18; row++)
                {
                    //int valueincell = (airtrqcalib[(row) + (16 * (18 - column) -1)]) / 100;
                    int valueincell = (airtrqcalib[(row) + (18 * (15 - column))]);
                    if (valueincell < 32000)
                    {
                        valueincell *= 10; // T8 has factor 10
                    }
                    byte b1 = Convert.ToByte(valueincell / 256);
                    byte b2 = Convert.ToByte(valueincell - (int)b1 * 256);
                    returnvalue[cell * 2] = b1;
                    returnvalue[(cell * 2) + 1] = b2;
                    cell++;
                }
            }
            return returnvalue;
        }

        private byte[] GetTorqueCalEngineSupportPoints(int maxairmass)
        {
            // 16 hardcoded values
            int[] supportpoints = new int[16] { 0xFF38, 0, 200, 400, 600, 800, 1000, 1200, 1400, 1600, 1800, 2000, 2250, 2500, 2750, 3000 };

            byte[] returnvalue = new byte[32];
            for (int i = 0; i < 16; i++)
            {
                int valueincell = Convert.ToInt32(supportpoints.GetValue(i));
                byte b1 = Convert.ToByte(valueincell / 256);
                byte b2 = Convert.ToByte(valueincell - (int)b1 * 256);
                returnvalue[i * 2] = b1;
                returnvalue[(i * 2) + 1] = b2;
            }
            return returnvalue;
        }

        private byte[] GetTurboSpeedLimiter(int maxairmass, int length)
        {
            byte[] returnvalue = new byte[length * 2];
            for (int i = 0; i < length; i++)
            {
                int valueincell = (maxairmass);
                byte b1 = Convert.ToByte(valueincell / 256);
                byte b2 = Convert.ToByte(valueincell - (int)b1 * 256);
                returnvalue[i * 2] = b1;
                returnvalue[(i * 2) + 1] = b2;
            }
            return returnvalue;

        }


        private byte[] GetAutAccelPedalSupportPoints(int maxairmass)
        {
            // 6 steps from 0 to maxairmass
            byte[] returnvalue = new byte[12];
            int range = maxairmass;
            int airmassperstep = range / 5;
            for (int i = 0; i < 6; i++)
            {
                int valueincell = (airmassperstep * i);
                byte b1 = Convert.ToByte(valueincell / 256);
                byte b2 = Convert.ToByte(valueincell - (int)b1 * 256);
                returnvalue[i * 2] = b1;
                returnvalue[(i * 2) + 1] = b2;
            }
            return returnvalue;
        }


        private byte[] GetTorqueCalSupportPoints(int maxairmass)
        {
            // 17 steps from 80 to maxairmass
            byte[] returnvalue = new byte[36];
            int range = maxairmass - 80;
            int airmassperstep = range / 17;
            for (int i = 0; i < 18; i++)
            {
                int valueincell = 80 + (airmassperstep * i);
                byte b1 = Convert.ToByte(valueincell / 256);
                byte b2 = Convert.ToByte(valueincell - (int)b1 * 256);
                returnvalue[i * 2] = b1;
                returnvalue[(i * 2) + 1] = b2;
            }
            return returnvalue;
        }

        private byte[] GetBoostMapSupportPoints(int maxairmass)
        {
            // 7 steps from 500 to maxairmass
            byte[] returnvalue = new byte[16];
            int range = maxairmass - 500;
            int airmassperstep = range / 7;
            for (int i = 0; i < 8; i++)
            {
                int valueincell = 500 + (airmassperstep * i);
                byte b1 = Convert.ToByte(valueincell / 256);
                byte b2 = Convert.ToByte(valueincell - (int)b1 * 256);
                returnvalue[i * 2] = b1;
                returnvalue[(i * 2) + 1] = b2;
            }
            return returnvalue;
        }

        private byte[] GetBoostRegMap(int maxairmass)
        {
            int[] airtrqcalib = new int[8 * 16] {      0, 140, 200, 280, 450, 630, 730, 900,
                                                       0, 140, 200, 280, 450, 630, 700, 840,
                                                       0, 140, 200, 270, 400, 500, 640, 780,
                                                       0, 140, 170, 220, 370, 450, 580, 720,
                                                       0, 140, 180, 210, 350, 450, 560, 660,
                                                       0, 150, 180, 230, 390, 480, 550, 600,
                                                       0, 170, 210, 240, 300, 400, 530, 610,
                                                       0, 180, 230, 260, 300, 400, 580, 600,
                                                       0, 200, 270, 290, 300, 400, 600, 650,
                                                       0, 200, 280, 300, 300, 400, 600, 650,
                                                       0, 250, 280, 370, 300, 450, 600, 650,
                                                       0, 250, 280, 370, 300, 450, 600, 650,
                                                       0, 250, 280, 370, 300, 450, 600, 650,
                                                       0, 250, 280, 370, 300, 450, 600, 650,
                                                       0, 250, 280, 370, 300, 450, 600, 650,
                                                       0, 250, 280, 370, 300, 450, 600, 650};
            byte[] returnvalue = new byte[8 * 16 * 2]; // in bytes
            int cell = 0;
            for (int column = 0; column < 16; column++)
            {
                for (int row = 0; row < 8; row++)
                {
                    int valueincell = (airtrqcalib[(row) + (8 * (15 - column))]);
                    byte b1 = Convert.ToByte(valueincell / 256);
                    byte b2 = Convert.ToByte(valueincell - (int)b1 * 256);
                    returnvalue[cell * 2] = b1;
                    returnvalue[(cell * 2) + 1] = b2;
                    cell++;
                }
            }
            return returnvalue;
        }

        private byte[] GetAirmassLimiter(int maxairmass)
        {
            int[] airmasslimit = new int[16 * 16] { 40, 40, 40, 44, 45, 47, 49, 53, 55,60, 60, 68, 72, 79, 85, 92,
                                                    41, 42, 43, 46, 49, 52, 54, 58, 60,64, 66, 74, 78, 84, 90, 98,
                                                    44, 44, 46, 50, 54, 57, 60, 62, 65,68, 70, 77, 82, 88, 94, 100,
                                                    46, 46, 48, 56, 60, 62, 64, 66, 69,72, 74, 84, 90, 92, 95, 100,
                                                    47, 47, 49, 58, 62, 66, 68, 70, 77,80, 84, 87, 93, 94, 96, 100,
                                                    47, 47, 50, 60, 64, 70, 72, 74, 81,84, 88, 92, 96, 97, 98, 100,
                                                    48, 48, 52, 61, 66, 71, 74, 76, 83,86, 90, 94, 97, 98, 99, 100,
                                                    49, 50, 53, 62, 67, 72, 75, 77, 83,86, 90, 94, 97, 98, 99, 100,
                                                    49, 50, 53, 62, 67, 72, 75, 77, 83,86, 90, 94, 97, 98, 99, 100,
                                                    48, 48, 52, 61, 66, 71, 74, 76, 83,86, 90, 94, 97, 98, 99, 100,
                                                    47, 47, 50, 60, 64, 70, 72, 74, 81,84, 88, 92, 96, 97, 98, 100,
                                                    47, 47, 49, 58, 62, 66, 68, 70, 77,80, 84, 87, 93, 94, 96, 100,
                                                    46, 46, 48, 51, 52, 53, 54, 59, 60,62, 62, 70, 74, 80, 85, 88,
                                                    44, 44, 46, 50, 50, 50, 50, 50, 51,53, 55, 61, 64, 69, 73, 77,
                                                    41, 42, 43, 46, 46, 46, 46, 46, 46,46, 46, 46, 46, 46, 46, 46,
                                                    41, 42, 43, 46, 46, 46, 46, 46, 46,46, 46, 46, 46, 46, 46, 46};
            byte[] returnvalue = new byte[16 * 16 * 2]; // in bytes
            int cell = 0;
            for (int column = 0; column < 16; column++)
            {
                for (int row = 0; row < 16; row++)
                {
                    int valueincell = (maxairmass * airmasslimit[(row) + (16 * (15 - column))]) / 100;
                    byte b1 = Convert.ToByte(valueincell / 256);
                    byte b2 = Convert.ToByte(valueincell - (int)b1 * 256);
                    returnvalue[cell * 2] = b1;
                    returnvalue[(cell * 2) + 1] = b2;
                    cell++;
                }
            }
            return returnvalue;
        }

        private void barButtonItem28_ItemClick(object sender, ItemClickEventArgs e)
        {
            // tune to stage 1!!!
            if (File.Exists(m_currentfile))
            {
                // read tuned marker to see if binary has been tuned before
                T8Header fh = new T8Header();
                fh.init(m_currentfile);
                PartNumberConverter pnc = new PartNumberConverter();
                ECUInformation ecuinfo = pnc.GetECUInfo(fh.PartNumber, "");


                // start window to ask user for desired horses (depending on E85 usage?)
                frmTuneBinary frmTune = new frmTuneBinary();
                if (frmTune.ShowDialog() == DialogResult.OK)
                {
                    int desiredHP = frmTune.DesiredHP;
                    bool carRunsE85 = frmTune.CarRunsE85;

                    // convert HP to torque and airmass
                    //int torque = PowerToTorque(desiredHP, 6000);
                    //int peaktorque = (110 * torque) / 100;
                    int peaktorque = frmTune.PeakTorque;
                    int maxairmass = TorqueToAirmass(peaktorque, carRunsE85);

                    // give user a warning if airmass/c > 1300 mg/c
                    if (maxairmass > 1300)
                    {
                        MessageBox.Show("Your maximum requested airmass exceeds 1300 mg/c [" + maxairmass.ToString() + " mg/c]. Please make sure all your other maps will support this airflow!", "Warning!", MessageBoxButtons.OK);
                    }

                    string msg = "Partnumber not recognized, tuning will continue anyway, please verify settings afterwards";
                    msg += Environment.NewLine + " desired airmass " + maxairmass.ToString() + " mg/c and peak torque " + peaktorque.ToString() + " Nm";
                    if (ecuinfo.Valid)
                    {
                        msg = "Partnumber " + fh.PartNumber + ", carmodel " + ecuinfo.Carmodel.ToString() + ", engine " + ecuinfo.Enginetype.ToString();
                        msg += Environment.NewLine + " desired airmass " + maxairmass.ToString() + " mg/c and peak torque " + peaktorque.ToString() + " Nm";
                    }
                    PSTaskDialog.cTaskDialog.ForceEmulationMode = false;
                    PSTaskDialog.cTaskDialog.EmulatedFormWidth = 600;
                    PSTaskDialog.cTaskDialog.UseToolWindowOnXP = false;
                    PSTaskDialog.cTaskDialog.VerificationChecked = true;
                    PSTaskDialog.cTaskDialog.ShowTaskDialogBox("Tune me up wizard", "This wizard will tune your binary.", "Several maps will be altered" + Environment.NewLine + msg, "Happy driving!!!\nDilemma  2009", "The author does not take responsibility for any damage done to your car or other objects in any form!", "Show me a summary after tuning", "", "Yes, tune me up!|No thanks!", eTaskDialogButtons.None, eSysIcons.Information, eSysIcons.Warning);
                    switch (PSTaskDialog.cTaskDialog.CommandButtonResult)
                    {
                        case 0:
                            // tune to stage x
                            // must use fixed maps, scaled to be good for the current airmass (e.g. pedalrequest map)
                            //TuneToStageNew(1, maxairmass, peaktorque, desiredHP, ecuinfo.Enginetype, carRunsE85);
                            TuneMeUp(maxairmass, peaktorque, desiredHP, ecuinfo.Enginetype, carRunsE85);
                            break;
                        case 1:
                            // cancel
                            break;
                    }
                    if (PSTaskDialog.cTaskDialog.VerificationChecked && PSTaskDialog.cTaskDialog.CommandButtonResult != 1)
                    {
                        TuningReport tuningrep = new TuningReport();
                        tuningrep.DataSource = resumeTuning;
                        tuningrep.CreateReport();
                        tuningrep.ShowPreview(defaultLookAndFeel1.LookAndFeel);
                    }
                }
            }
        }

        private int GetMaxTorque()
        {
            int retval = 300;
            /*byte[] torquenominalx = readdatafromfile(m_currentfile, (int)GetSymbolAddress(m_symbols, "TorqueCal.M_EngXSP"), GetSymbolLength(m_symbols, "TorqueCal.M_EngXSP"));
            retval = Convert.ToInt32(torquenominalx.GetValue(torquenominalx.Length - 2)) * 256;
            retval += Convert.ToInt32(torquenominalx.GetValue(torquenominalx.Length - 1));
            LogHelper.Log("Max torque from table = " + retval.ToString());*/
            return retval;
        }

        private void TuneNominalTorqueMap(double maxairmass)
        {
            SetProgress("Tuning TrqMastCal.Trq_NominalMap...");
            if ((int)GetSymbolAddress(m_symbols, "TrqMastCal.Trq_NominalMap") > 0)
            {
                byte[] nominalMap = GetNominalTorqueMap(Convert.ToInt32(maxairmass));
                savedatatobinary((int)GetSymbolAddress(m_symbols, "TrqMastCal.Trq_NominalMap"), GetSymbolLength(m_symbols, "TrqMastCal.Trq_NominalMap"), nominalMap, m_currentfile, true);
                AddToResumeTable("Tuned nominal torque map (TrqMastCal.Trq_NominalMap)");
            }

        }

        private void TuneAirTorqueCalibration(double maxairmass)
        {
            SetProgress("Tuning TrqMastCal.m_AirTorqMap...");
            if ((int)GetSymbolAddress(m_symbols, "TrqMastCal.m_AirTorqMap") > 0)
            {
                byte[] AirTorqueCalibration = GetAirTorqueCalibration(Convert.ToInt32(maxairmass));
                savedatatobinary((int)GetSymbolAddress(m_symbols, "TrqMastCal.m_AirTorqMap"), GetSymbolLength(m_symbols, "TrqMastCal.m_AirTorqMap"), AirTorqueCalibration, m_currentfile, true);
                AddToResumeTable("Tuned nominal airmass map (TrqMastCal.m_AirTorqMap)");
            }
        }

        private void TuneAirmassLimiters(double maxairmass)
        {
            //BstKnkCal.MaxAirmass & BstKnkCal.MaxAirmassAu -> MaxAirmassrequest
            SetProgress("Tuning BstKnkCal.MaxAirmass...");
            /********** BstKnkCal.MaxAirmass ***********/
            if ((int)GetSymbolAddress(m_symbols, "BstKnkCal.MaxAirmass") > 0)
            {
                byte[] AirmassLimiter = GetAirmassLimiter(Convert.ToInt32(maxairmass));
                savedatatobinary((int)GetSymbolAddress(m_symbols, "BstKnkCal.MaxAirmass"), GetSymbolLength(m_symbols, "BstKnkCal.MaxAirmass"), AirmassLimiter, m_currentfile, true);
                AddToResumeTable("Tuned airmass limiter for manual transmission (BstKnkCal.MaxAirmass)");
            }
            SetProgress("Tuning BstKnkCal.MaxAirmassAu...");
            if ((int)GetSymbolAddress(m_symbols, "BstKnkCal.MaxAirmassAu") > 0)
            {
                /********** BstKnkCal.MaxAirmassAu ***********/
                byte[] AirmassLimiter = GetAirmassLimiter(Convert.ToInt32(maxairmass));
                savedatatobinary((int)GetSymbolAddress(m_symbols, "BstKnkCal.MaxAirmassAu"), GetSymbolLength(m_symbols, "BstKnkCal.MaxAirmassAu"), AirmassLimiter, m_currentfile, true);
                AddToResumeTable("Tuned airmass limiter for automatic transmission (BstKnkCal.MaxAirmassAu)");
            }
        }

        private void SetTableContentTo(string mapname, int value)
        {
            try
            {
                value *= 10;
                SetProgress("Tuning " + mapname);
                byte[] mapdata = new byte[GetSymbolLength(m_symbols, mapname)];
                for (int i = 0; i < mapdata.Length; i += 2)
                {
                    byte b1 = Convert.ToByte(value / 256);
                    byte b2 = Convert.ToByte(value - (int)b1 * 256);
                    mapdata[i] = b1;
                    mapdata[i + 1] = b2;
                }
                savedatatobinary((int)GetSymbolAddress(m_symbols, mapname), mapdata.Length, mapdata, m_currentfile, true);
            }
            catch (Exception)
            {

            }
        }

        private void TuneTorqueLimiter3d(string limitername, int maxtorque)
        {
            SetProgress("Tuning " + limitername);
            if ((int)GetSymbolAddress(m_symbols, limitername) > 0)
            {
                byte[] maxtorqueaut = readdatafromfile(m_currentfile, (int)GetSymbolAddress(m_symbols, limitername), GetSymbolLength(m_symbols, limitername));
                int cols = 0;
                int rows = 0;

                rows = maxtorqueaut.Length;

                if (isSixteenBitTable(limitername)) rows /= 2;
                for (int rt = 0; rt < rows; rt++)
                {
                    int offset1 = (rt * 2);
                    int offset2 = (rt * 2) + 1;
                    int boostcalvalue = Convert.ToInt32(maxtorqueaut[offset1]) * 256 + Convert.ToInt32(maxtorqueaut[offset2]);
                    boostcalvalue = maxtorque * 10;
                    byte b1 = Convert.ToByte(boostcalvalue / 256);
                    byte b2 = Convert.ToByte(boostcalvalue - (int)b1 * 256);
                    maxtorqueaut[offset1] = b1;
                    maxtorqueaut[offset2] = b2;
                }
                savedatatobinary((int)GetSymbolAddress(m_symbols, limitername), GetSymbolLength(m_symbols, limitername), maxtorqueaut, m_currentfile, true);
                AddToResumeTable("Tuned torque limiter " + limitername);
            }
        }

        private void TuneTorqueLimiter(string limitername, int maxtorque)
        {
            SetProgress("Tuning " + limitername);
            if ((int)GetSymbolAddress(m_symbols, limitername) > 0)
            {
                byte[] maxtorqueaut = readdatafromfile(m_currentfile, (int)GetSymbolAddress(m_symbols, limitername), GetSymbolLength(m_symbols, limitername));
                int cols = 0;
                int rows = 0;

                GetTableMatrixWitdhByName(m_currentfile, m_symbols, limitername, out cols, out rows);
                if (isSixteenBitTable(limitername)) rows /= 2;
                for (int rt = 0; rt < rows; rt++)
                {
                    int offset1 = (rt * cols * 2);
                    int offset2 = (rt * cols * 2) + 1;
                    int boostcalvalue = Convert.ToInt32(maxtorqueaut[offset1]) * 256 + Convert.ToInt32(maxtorqueaut[offset2]);
                    boostcalvalue = maxtorque * 10;
                    byte b1 = Convert.ToByte(boostcalvalue / 256);
                    byte b2 = Convert.ToByte(boostcalvalue - (int)b1 * 256);
                    maxtorqueaut[offset1] = b1;
                    maxtorqueaut[offset2] = b2;
                }
                savedatatobinary((int)GetSymbolAddress(m_symbols, limitername), GetSymbolLength(m_symbols, limitername), maxtorqueaut, m_currentfile, true);
                AddToResumeTable("Tuned torque limiter " + limitername);
            }
        }

        private void TuneTorqueLimiters(int maxtorque)
        {
            foreach (SymbolHelper sh in m_symbols)
            {
                if (sh.Varname.StartsWith("TrqLimCal.Trq_MaxEngine") || sh.Userdescription.StartsWith("TrqLimCal.Trq_MaxEngine"))
                {
                    string limitername = sh.Varname;
                    if (limitername.StartsWith("Symbol")) limitername = sh.Userdescription;
                    TuneTorqueLimiter(limitername, maxtorque);
                }
                else if (sh.Varname.StartsWith("TMCCal.Trq_MaxEngine") || sh.Userdescription.StartsWith("TMCCal.Trq_MaxEngine"))
                {
                    string limitername = sh.Varname;
                    if (limitername.StartsWith("Symbol")) limitername = sh.Userdescription;
                    TuneTorqueLimiter(limitername, maxtorque);
                }
            }
            TuneTorqueLimiter("TrqLimCal.Trq_ManGear", maxtorque);
            TuneTorqueLimiter("TrqLimCal.TrqOverBoostTab", maxtorque);

            TuneTorqueLimiter3d("FFTrqCal.M_maxMAP", maxtorque);

            SetTableContentTo("TrqLimCal.Trq_CompressorNoiseRedLimMAP", maxtorque);
            TuneTorqueLimiter("TrqLimCal.Trq_AutNoiseRedLim", maxtorque);
            TuneTorqueLimiter("TrqLimCal.Trq_NoiseRedLim", maxtorque);
        }

        private void TuneFuelcutLimiter(double maxairmass)
        {
            /********** FCutCal.m_AirInletLimit ***********/

            SetProgress("Tuning FCutCal.m_AirInletLimit...");
            // write xxx to fuelcut limit
            if ((int)GetSymbolAddress(m_symbols, "FCutCal.m_AirInletLimit") > 0)
            {
                byte[] fuelcutmap = readdatafromfile(m_currentfile, (int)GetSymbolAddress(m_symbols, "FCutCal.m_AirInletLimit"), GetSymbolLength(m_symbols, "FCutCal.m_AirInletLimit"));
                if (fuelcutmap.Length == 2)
                {
                    // airmass fuelcut should be ~20% higher than max request
                    double m_AirmassFuelcut = maxairmass * 1.2;
                    int i_AirmassFuelcut = Convert.ToInt32(m_AirmassFuelcut);
                    //if (i_AirmassFuelcut >= 1800) i_AirmassFuelcut = 1800;
                    //TODO: FUELCUT
                    byte b1 = Convert.ToByte(i_AirmassFuelcut / 256);
                    byte b2 = Convert.ToByte(i_AirmassFuelcut - (int)b1 * 256);
                    fuelcutmap[0] = b1;
                    fuelcutmap[1] = b2;
                }
                savedatatobinary((int)GetSymbolAddress(m_symbols, "FCutCal.m_AirInletLimit"), GetSymbolLength(m_symbols, "FCutCal.m_AirInletLimit"), fuelcutmap, m_currentfile, true);
                AddToResumeTable("Tuned fuelcut limiter (FCutCal.m_AirInletLimit)");
            }
        }

        private void TuneMeUp(double maxairmass, double maxtorque, double peakHP, EngineType enginetype, bool E85)
        {
            /*

MaxEngSpdCal.m_EngMin -> 6200
TMCCal.Trq_MaxEngineTab -> MaxTrq 320
TrqLimCal.Trq_MAxEngineMan* -> 320
TrqLimCal.Trq_MAxEngineAut* -> 320
TrqLimCal.TrqOverBoostTab -> 330

TrqMastCal.Trq_NominalMap -> 1050 = 340 Nm
TrqMastCal.m_AirTorqMap -> 325 Nm = 1300 mg/c             * */

            SetProgress("Checking current configuration...");
            resumeTuning = new System.Data.DataTable();
            resumeTuning.Columns.Add("Description");
            AddToResumeTable("Tuning your binary to : " + maxairmass.ToString() + " mg/c");
            SetProgress("Creating backup file...");
            int imaxairmass = Convert.ToInt32(maxairmass);
            File.Copy(m_currentfile, Path.GetDirectoryName(m_currentfile) + "\\" + Path.GetFileNameWithoutExtension(m_currentfile) + "-" + DateTime.Now.ToString("yyyyMMddHHmmss") + "-beforetuningto-" + imaxairmass.ToString() + "-mg.bin", true);
            AddToResumeTable("Backup file created (" + Path.GetDirectoryName(m_currentfile) + "\\" + Path.GetFileNameWithoutExtension(m_currentfile) + "-" + DateTime.Now.ToString("yyyyMMddHHmmss") + "-beforetuningto-" + imaxairmass.ToString() + "-mg.bin" + ")");
            int max_torque = 320;
            TuneNominalTorqueMap(maxairmass);
            TuneAirTorqueCalibration(maxairmass);
            TuneAirmassLimiters(maxairmass);
            TuneTorqueLimiters(max_torque);
            TuneFuelcutLimiter(maxairmass);
            // all done with changes, update the checksum!
            UpdateChecksum(m_currentfile, true);
            SetProgress("Generating report...");
            AddToResumeTable("Updated checksum.");
            SetProgressIdle();

        }

        private void TuneToStageNew(int stage, double maxairmass, double maxtorque, double peakHP, EngineType enginetype, bool E85)
        {
            SetProgress("Checking current configuration...");
            resumeTuning = new System.Data.DataTable();
            resumeTuning.Columns.Add("Description");
            AddToResumeTable("Tuning your binary to stage: " + stage.ToString());

            SetProgress("Creating backup file...");
            int imaxairmass = Convert.ToInt32(maxairmass);
            File.Copy(m_currentfile, Path.GetDirectoryName(m_currentfile) + "\\" + Path.GetFileNameWithoutExtension(m_currentfile) + "-" + DateTime.Now.ToString("yyyyMMddHHmmss") + "-beforetuningto-" + imaxairmass.ToString() + "-mg.bin", true);
            AddToResumeTable("Backup file created (" + Path.GetDirectoryName(m_currentfile) + "\\" + Path.GetFileNameWithoutExtension(m_currentfile) + "-" + DateTime.Now.ToString("yyyyMMddHHmmss") + "-beforetuningto-" + imaxairmass.ToString() + "-mg.bin" + ")");

            // tune maps
            //TorqueCal.M_EngXSP
            SetProgress("Tuning TrqMastCal.Trq_PedYSP...");
            if ((int)GetSymbolAddress(m_symbols, "TrqMastCal.Trq_PedYSP") > 0)
            {
                byte[] TorqCal = GetTorqueCalEngineSupportPoints(Convert.ToInt32(maxairmass));
                savedatatobinary((int)GetSymbolAddress(m_symbols, "TrqMastCal.Trq_PedYSP"), GetSymbolLength(m_symbols, "TrqMastCal.Trq_PedYSP"), TorqCal, m_currentfile, true);
                AddToResumeTable("Tuned y axis for torque pedal map (TrqMastCal.Trq_PedYSP)");
            }

            SetProgress("Tuning TrqMastCal.Trq_EngXSP...");
            if ((int)GetSymbolAddress(m_symbols, "TrqMastCal.Trq_EngXSP") > 0)
            {
                byte[] TorqCal = GetTorqueCalEngineSupportPoints(Convert.ToInt32(maxairmass));
                savedatatobinary((int)GetSymbolAddress(m_symbols, "TrqMastCal.Trq_EngXSP"), GetSymbolLength(m_symbols, "TrqMastCal.Trq_EngXSP"), TorqCal, m_currentfile, true);
                AddToResumeTable("Tuned x axis for torque calibration map (TrqMastCal.Trq_EngXSP)");
            }

            //step 1a) Alter x axis for TorqueCal.M_NominalMap (=TorqueCal.m_AirXSP) so that the airmass 
            // reaches the maximum desired airmass at the last column (e.g. for a stage 4 1400 mg/c)
            SetProgress("Tuning TrqMastCal.m_AirXSP...");
            if ((int)GetSymbolAddress(m_symbols, "TrqMastCal.m_AirXSP") > 0)
            {
                byte[] TorqCal = GetTorqueCalSupportPoints(Convert.ToInt32(maxairmass));
                savedatatobinary((int)GetSymbolAddress(m_symbols, "TrqMastCal.m_AirXSP"), GetSymbolLength(m_symbols, "TrqMastCal.m_AirXSP"), TorqCal, m_currentfile, true);
                AddToResumeTable("Tuned x axis for nominal torquemap (TrqMastCal.m_AirXSP)");
            }

            /*** TorqueCal.M_NominalMap ***/
            /*** Data-matrix for nominal Torque. Engine speed and airmass are used as support points. 
            The value in the matrix will be the engine output torque when inlet airmass (- friction airmass) 
            is used together with actual engine speed as pointers ***/
            // formula = replace last column with estimated values of max_torque (= last column * 1.3)
            int max_torque = GetMaxTorque();

            /*if ((int)GetSymbolAddress(m_symbols, "AirCtrlCal.RegMap") > 0)
            {
                byte[] BoostMap = GetBoostRegMap(Convert.ToInt32(maxairmass));
                savedatatobinary((int)GetSymbolAddress(m_symbols, "AirCtrlCal.RegMap"), GetSymbolLength(m_symbols, "AirCtrlCal.RegMap"), BoostMap, m_currentfile);
                AddToResumeTable("Tuned boost calibration map (AirCtrlCal.RegMap)");
            }*/


            // now also do BoostCal.SetLoadXSP (!!!) mg/c 8 values
            // run from 500 upto maxairmass
            if ((int)GetSymbolAddress(m_symbols, "AirCtrlCal.SetLoadXSP") > 0)
            {
                byte[] BoostMap = GetBoostMapSupportPoints(Convert.ToInt32(maxairmass));
                savedatatobinary((int)GetSymbolAddress(m_symbols, "AirCtrlCal.SetLoadXSP"), GetSymbolLength(m_symbols, "AirCtrlCal.SetLoadXSP"), BoostMap, m_currentfile, true);
                AddToResumeTable("Tuned nominal torque map x axis (AirCtrlCal.SetLoadXSP)");
            }

            if ((int)GetSymbolAddress(m_symbols, "TrqMastCal.Trq_NominalMap") > 0)
            {
                byte[] nominalMap = GetNominalTorqueMap(Convert.ToInt32(maxairmass));
                savedatatobinary((int)GetSymbolAddress(m_symbols, "TrqMastCal.Trq_NominalMap"), GetSymbolLength(m_symbols, "TrqMastCal.Trq_NominalMap"), nominalMap, m_currentfile, true);
                AddToResumeTable("Tuned nominal torque map (TrqMastCal.Trq_NominalMap)");
            }

            // step 1b) Alter TorqueCal.m_AirTorqMap so that the maximum torquecolumn requests the desired airmass.
            /*** TorqueCal.m_AirTorqMap ***/
            /*** Data-matrix for nominal airmass. Engine speed and torque are used as support points. 
            The value in the matrix + friction airmass (idle airmass) will create the pointed torque at the pointed engine speed. 
            Resolution is   1 mg/c. ***/
            SetProgress("Tuning TrqMastCal.m_AirTorqMap...");
            if ((int)GetSymbolAddress(m_symbols, "TrqMastCal.m_AirTorqMap") > 0)
            {
                byte[] AirTorqueCalibration = GetAirTorqueCalibration(Convert.ToInt32(maxairmass));
                savedatatobinary((int)GetSymbolAddress(m_symbols, "TrqMastCal.m_AirTorqMap"), GetSymbolLength(m_symbols, "TrqMastCal.m_AirTorqMap"), AirTorqueCalibration, m_currentfile, true);
                AddToResumeTable("Tuned nominal airmass map (TrqMastCal.m_AirTorqMap)");
            }

            /*progress.SetProgress("Tuning TorqueCal.m_PedYSP...");
            //TODO: PedelMap Y axis with fixed data!
            // step 1c) Alter the pedal request Y axis to meet the airmass request. TorqueCal.m_PedYSP
            
            if ((int)GetSymbolAddress(m_symbols, "TorqueCal.m_PedYSP") > 0)
            {
                byte[] pedalmapysp = readdatafromfile(m_currentfile, (int)GetSymbolAddress(m_symbols, "TorqueCal.m_PedYSP"), GetSymbolLength(m_symbols, "TorqueCal.m_PedYSP"));
                // up the highest three rows with respectively 1.1, 1.2 and 1.3 factor
                int cols = 0;
                int rows = 0;

                GetTableMatrixWitdhByName(m_currentfile, m_symbols, "TorqueCal.m_PedYSP", out cols, out rows);
                if (isSixteenBitTable("TorqueCal.m_PedYSP")) rows /= 2;
                // row > 5 and col > 4
                int ioffset1 = ((rows - 4) * cols * 2);
                int ioffset2 = ((rows - 4) * cols * 2) + 1;
                int pos4value = Convert.ToInt32(pedalmapysp[ioffset1]) * 256 + Convert.ToInt32(pedalmapysp[ioffset2]);

                int airmassperstep = (Convert.ToInt32(maxairmass) - pos4value) / 3;
                int step = 1;
                for (int rt = rows - 3; rt < rows; rt++)
                {
                    int offset1 = (rt * cols * 2);
                    int offset2 = (rt * cols * 2) + 1;
                    int boostcalvalue = Convert.ToInt32(pedalmapysp[offset1]) * 256 + Convert.ToInt32(pedalmapysp[offset2]);
                    boostcalvalue = pos4value + (airmassperstep * step);
                    step++;
                    if (boostcalvalue > maxairmass) boostcalvalue = (int)maxairmass;
                    byte b1 = Convert.ToByte(boostcalvalue / 256);
                    byte b2 = Convert.ToByte(boostcalvalue - (int)b1 * 256);
                    pedalmapysp[offset1] = b1;
                    pedalmapysp[offset2] = b2;

                }
                savedatatobinary((int)GetSymbolAddress(m_symbols, "TorqueCal.m_PedYSP"), GetSymbolLength(m_symbols, "TorqueCal.m_PedYSP"), pedalmapysp, m_currentfile);
                AddToResumeTable("Tuned airmass pedalmap y axis (TorqueCal.m_PedYSP)");
            }*/

            SetProgress("Tuning PedalMapCal.m_RequestMap...");


            // step 1d) Alter the pedal request map to meet the desired airmass in the top 2 rows (90-100%). PedalMapCal.m_RequestMap
            /********** PedalMapCal.m_RequestMap ***********/
            if ((int)GetSymbolAddress(m_symbols, "PedalMapCal.Trq_RequestMap") > 0)
            {
                byte[] ReferencePedalMap = GetPedalMap(Convert.ToInt32(max_torque * 10), Convert.ToInt32(peakHP), E85);
                savedatatobinary((int)GetSymbolAddress(m_symbols, "PedalMapCal.Trq_RequestMap"), GetSymbolLength(m_symbols, "PedalMapCal.Trq_RequestMap"), ReferencePedalMap, m_currentfile, true);
                AddToResumeTable("Tuned airmass request map (PedalMapCal.Trq_RequestMap)");
            }
            SetProgress("Tuning BstKnkCal.MaxAirmass...");
            // step 2) Increase the airmass limit table to allow for more airmass in the desired areas. BstKnkCal.MaxAirmass.
            /********** BstKnkCal.MaxAirmass ***********/
            if ((int)GetSymbolAddress(m_symbols, "BstKnkCal.MaxAirmass") > 0)
            {
                byte[] AirmassLimiter = GetAirmassLimiter(Convert.ToInt32(maxairmass));
                savedatatobinary((int)GetSymbolAddress(m_symbols, "BstKnkCal.MaxAirmass"), GetSymbolLength(m_symbols, "BstKnkCal.MaxAirmass"), AirmassLimiter, m_currentfile, true);
                AddToResumeTable("Tuned airmass limiter for manual transmission (BstKnkCal.MaxAirmass)");
            }
            SetProgress("Tuning BstKnkCal.MaxAirmassAu...");
            if ((int)GetSymbolAddress(m_symbols, "BstKnkCal.MaxAirmassAu") > 0)
            {
                /********** BstKnkCal.MaxAirmassAu ***********/
                byte[] AirmassLimiter = GetAirmassLimiter(Convert.ToInt32(maxairmass));
                savedatatobinary((int)GetSymbolAddress(m_symbols, "BstKnkCal.MaxAirmassAu"), GetSymbolLength(m_symbols, "BstKnkCal.MaxAirmassAu"), AirmassLimiter, m_currentfile, true);
                AddToResumeTable("Tuned airmass limiter for automatic transmission (BstKnkCal.MaxAirmassAu)");
            }

            SetProgress("Tuning TrqLimCal.Trq_MaxEngineAutTab1...");

            // step 3  Increasing engine torque limiters. Up the engine limiters so that the limiter 
            // is higher than the maximum torque in the request maps. 
            // (TorqueCal.M_EngMaxTab, TorqueCal.M_ManGearLim, TorqueCal.M_CabGearLim, TorqueCal.M_5GearLimTab)
            /********** TorqueCal.M_EngMaxAutTab ***********/
            if ((int)GetSymbolAddress(m_symbols, "TrqLimCal.Trq_MaxEngineAutTab1") > 0)
            {
                byte[] maxtorqueaut = readdatafromfile(m_currentfile, (int)GetSymbolAddress(m_symbols, "TrqLimCal.Trq_MaxEngineAutTab1"), GetSymbolLength(m_symbols, "TrqLimCal.Trq_MaxEngineAutTab1"));
                // up with 1.3 factor
                int cols = 0;
                int rows = 0;

                GetTableMatrixWitdhByName(m_currentfile, m_symbols, "TrqLimCal.Trq_MaxEngineAutTab1", out cols, out rows);
                if (isSixteenBitTable("TorqueCal.M_EngMaxAutTab")) rows /= 2;
                // row > 5 and col > 4
                for (int rt = 0; rt < rows; rt++)
                {
                    int offset1 = (rt * cols * 2);
                    int offset2 = (rt * cols * 2) + 1;
                    int boostcalvalue = Convert.ToInt32(maxtorqueaut[offset1]) * 256 + Convert.ToInt32(maxtorqueaut[offset2]);
                    boostcalvalue = 3200;
                    byte b1 = Convert.ToByte(boostcalvalue / 256);
                    byte b2 = Convert.ToByte(boostcalvalue - (int)b1 * 256);
                    maxtorqueaut[offset1] = b1;
                    maxtorqueaut[offset2] = b2;

                }
                savedatatobinary((int)GetSymbolAddress(m_symbols, "TrqLimCal.Trq_MaxEngineAutTab1"), GetSymbolLength(m_symbols, "TrqLimCal.Trq_MaxEngineAutTab1"), maxtorqueaut, m_currentfile, true);
                savedatatobinary((int)GetSymbolAddress(m_symbols, "TrqLimCal.Trq_MaxEngineAutTab2"), GetSymbolLength(m_symbols, "TrqLimCal.Trq_MaxEngineAutTab2"), maxtorqueaut, m_currentfile, true);
                AddToResumeTable("Tuned torque limiter for automatic transmission (TrqLimCal.Trq_MaxEngineAutTab1 & 2)");
            }

            SetProgress("Tuning TrqLimCal.Trq_MaxEngineManTab1...");
            /********** TorqueCal.M_EngMaxTab ***********/
            if ((int)GetSymbolAddress(m_symbols, "TrqLimCal.Trq_MaxEngineManTab1") > 0)
            {
                byte[] maxtorquetab = readdatafromfile(m_currentfile, (int)GetSymbolAddress(m_symbols, "TrqLimCal.Trq_MaxEngineManTab1"), GetSymbolLength(m_symbols, "TrqLimCal.Trq_MaxEngineManTab1"));
                // up with 1.3 factor
                int cols = 0;
                int rows = 0;

                GetTableMatrixWitdhByName(m_currentfile, m_symbols, "TrqLimCal.Trq_MaxEngineManTab1", out cols, out rows);
                if (isSixteenBitTable("TrqLimCal.Trq_MaxEngineManTab1")) rows /= 2;
                // row > 5 and col > 4
                for (int rt = 0; rt < rows; rt++)
                {
                    int offset1 = (rt * cols * 2);
                    int offset2 = (rt * cols * 2) + 1;
                    int boostcalvalue = Convert.ToInt32(maxtorquetab[offset1]) * 256 + Convert.ToInt32(maxtorquetab[offset2]);
                    if (boostcalvalue > maxtorque) boostcalvalue = (int)maxtorque;
                    boostcalvalue = 3200;

                    byte b1 = Convert.ToByte(boostcalvalue / 256);
                    byte b2 = Convert.ToByte(boostcalvalue - (int)b1 * 256);
                    maxtorquetab[offset1] = b1;
                    maxtorquetab[offset2] = b2;
                }
                savedatatobinary((int)GetSymbolAddress(m_symbols, "TrqLimCal.Trq_MaxEngineManTab1"), GetSymbolLength(m_symbols, "TrqLimCal.Trq_MaxEngineManTab1"), maxtorquetab, m_currentfile, true);
                savedatatobinary((int)GetSymbolAddress(m_symbols, "TrqLimCal.Trq_MaxEngineManTab2"), GetSymbolLength(m_symbols, "TrqLimCal.Trq_MaxEngineManTab2"), maxtorquetab, m_currentfile, true);
                AddToResumeTable("Tuned torque limiter for manual transmission (TrqLimCal.Trq_MaxEngineManTab1 & 2)");
            }


            SetProgress("Tuning TrqLimCal.Trq_ManGear...");
            if ((int)GetSymbolAddress(m_symbols, "TrqLimCal.Trq_ManGear") > 0)
            {
                //TorqueCal.M_ManGearLim
                byte[] maxtorquemangear = readdatafromfile(m_currentfile, (int)GetSymbolAddress(m_symbols, "TrqLimCal.Trq_ManGear"), GetSymbolLength(m_symbols, "TrqLimCal.Trq_ManGear"));
                // up with 1.4 factor
                int cols = 0;
                int rows = 0;

                GetTableMatrixWitdhByName(m_currentfile, m_symbols, "TrqLimCal.Trq_ManGear", out cols, out rows);
                if (isSixteenBitTable("TrqLimCal.Trq_ManGear")) rows /= 2;
                // row > 5 and col > 4
                for (int rt = 0; rt < rows; rt++)
                {
                    int offset1 = (rt * cols * 2);
                    int offset2 = (rt * cols * 2) + 1;
                    int boostcalvalue = Convert.ToInt32(maxtorquemangear[offset1]) * 256 + Convert.ToInt32(maxtorquemangear[offset2]);
                    if (boostcalvalue > maxtorque) boostcalvalue = (int)maxtorque;

                    boostcalvalue = 3200;

                    byte b1 = Convert.ToByte(boostcalvalue / 256);
                    byte b2 = Convert.ToByte(boostcalvalue - (int)b1 * 256);
                    maxtorquemangear[offset1] = b1;
                    maxtorquemangear[offset2] = b2;
                }
                savedatatobinary((int)GetSymbolAddress(m_symbols, "TrqLimCal.Trq_ManGear"), GetSymbolLength(m_symbols, "TrqLimCal.Trq_ManGear"), maxtorquemangear, m_currentfile, true);
                AddToResumeTable("Tuned torque limiter for manual transmission gears (TrqLimCal.Trq_ManGear)");
            }

            // step 4  Adapt fuel delivery.
            // step 4a) You should make sure the fuel supply is good in all ranges by recalibrating BFuelCal.Map. Altering the maximum allowed airmass will also require more fuel. Check this with a wideband O2 sensor.
            // step 4b) If you change injectors you should change the injector constant InjCorrCal.InjectorConst and the battery voltage correction table InjCorrCal.BattCorrTab accordingly.

            //Step 5  Increase fuel cur level
            // Increase the fuelcut limit to above the airmass desired. E.g. if you target 1350 mg/c the fuelcut limit should be higher e.g. 1450 or 1500. FCutCal.m_AirInletLimit.

            /********** FCutCal.m_AirInletLimit ***********/

            SetProgress("Tuning FCutCal.m_AirInletLimit...");
            // write xxx to fuelcut limit
            if ((int)GetSymbolAddress(m_symbols, "FCutCal.m_AirInletLimit") > 0)
            {
                byte[] fuelcutmap = readdatafromfile(m_currentfile, (int)GetSymbolAddress(m_symbols, "FCutCal.m_AirInletLimit"), GetSymbolLength(m_symbols, "FCutCal.m_AirInletLimit"));
                if (fuelcutmap.Length == 2)
                {
                    // airmass fuelcut should be ~20% higher than max request
                    double m_AirmassFuelcut = maxairmass * 1.2;
                    int i_AirmassFuelcut = Convert.ToInt32(m_AirmassFuelcut);
                    //if (i_AirmassFuelcut >= 1800) i_AirmassFuelcut = 1800;
                    //TODO: FUELCUT
                    byte b1 = Convert.ToByte(i_AirmassFuelcut / 256);
                    byte b2 = Convert.ToByte(i_AirmassFuelcut - (int)b1 * 256);
                    fuelcutmap[0] = b1;
                    fuelcutmap[1] = b2;
                }
                savedatatobinary((int)GetSymbolAddress(m_symbols, "FCutCal.m_AirInletLimit"), GetSymbolLength(m_symbols, "FCutCal.m_AirInletLimit"), fuelcutmap, m_currentfile, true);
                AddToResumeTable("Tuned fuelcut limiter (FCutCal.m_AirInletLimit)");
            }

            // all done with changes, update the checksum!
            UpdateChecksum(m_currentfile, true);
            SetProgress("Generating report...");
            AddToResumeTable("Updated checksum.");
            SetProgressIdle();
        }

        private void barButtonItem29_ItemClick(object sender, ItemClickEventArgs e)
        {
            // stage II
        }

        private void barButtonItem30_ItemClick(object sender, ItemClickEventArgs e)
        {
            // stage III
        }

        /*private int GetMaxTorque()
        {
            int retval = 300;
            byte[] torquenominalx = readdatafromfile(m_currentfile, (int)GetSymbolAddress(m_symbols, "TrqMastCal.Trq_EngXSP"), GetSymbolLength(m_symbols, "TrqMastCal.Trq_EngXSP"));
            retval = Convert.ToInt32(torquenominalx.GetValue(torquenominalx.Length - 2)) * 256;
            retval += Convert.ToInt32(torquenominalx.GetValue(torquenominalx.Length - 1));
            retval /= 10;
            LogHelper.Log("Max torque from table = " + retval.ToString());
            return retval;
        }*/

        private void TuneToStage(int stage, double maxairmass, double maxtorque, EngineType enginetype)
        {
            SetProgress("Checking current configuration...");
            resumeTuning = new System.Data.DataTable();
            resumeTuning.Columns.Add("Description");
            AddToResumeTable("Tuning your binary to stage: " + stage.ToString());

            SetProgress("Creating backup file...");
            File.Copy(m_currentfile, Path.GetDirectoryName(m_currentfile) + "\\" + Path.GetFileNameWithoutExtension(m_currentfile) + DateTime.Now.ToString("yyyyMMddHHmmss") + "beforetuningtostage" + stage.ToString() + ".bin", true);
            AddToResumeTable("Backup file created (" + Path.GetFileNameWithoutExtension(m_currentfile) + DateTime.Now.ToString("yyyyMMddHHmmss") + "beforetuningtostage" + stage.ToString() + ".bin" + ")");

            // tune maps
            SetProgress("Tuning TrqMastCal.m_AirXSP...");
            int max_airflow_requested = (int)maxairmass;
            if ((int)GetSymbolAddress(m_symbols, "TrqMastCal.m_AirXSP") > 0)
            {
                byte[] torquenominalx = readdatafromfile(m_currentfile, (int)GetSymbolAddress(m_symbols, "TrqMastCal.m_AirXSP"), GetSymbolLength(m_symbols, "TrqMastCal.m_AirXSP"));
                int cols = 0;
                int rows = 0;
                GetTableMatrixWitdhByName(m_currentfile, m_symbols, "TrqMastCal.m_AirXSP", out cols, out rows);
                if (isSixteenBitTable("TrqMastCal.m_AirXSP")) rows /= 2;
                int offset1 = (torquenominalx.Length - 2);
                int offset2 = (torquenominalx.Length - 1);
                int boostcalvalue = Convert.ToInt32(torquenominalx[offset1]) * 256 + Convert.ToInt32(torquenominalx[offset2]);
                boostcalvalue = max_airflow_requested;
                byte b1 = Convert.ToByte(boostcalvalue / 256);
                byte b2 = Convert.ToByte(boostcalvalue - (int)b1 * 256);
                torquenominalx[offset1] = b1;
                torquenominalx[offset2] = b2;
                savedatatobinary((int)GetSymbolAddress(m_symbols, "TrqMastCal.m_AirXSP"), GetSymbolLength(m_symbols, "TrqMastCal.m_AirXSP"), torquenominalx, m_currentfile, true);
                AddToResumeTable("Tuned x axis for nominal torquemap (TrqMastCal.m_AirXSP)");
            }
            UpdateChecksum(m_currentfile, true);

            /*** TorqueCal.M_NominalMap ***/
            /*** Data-matrix for nominal Torque. Engine speed and airmass are used as support points. 
            The value in the matrix will be the engine output torque when inlet airmass (- friction airmass) 
            is used together with actual engine speed as pointers ***/
            // formula = replace last column with estimated values of max_torque (= last column * 1.3)
            int max_torque = GetMaxTorque();

            if ((int)GetSymbolAddress(m_symbols, "TrqMastCal.Trq_NominalMap") > 0)
            {
                byte[] torquemap = readdatafromfile(m_currentfile, (int)GetSymbolAddress(m_symbols, "TrqMastCal.Trq_NominalMap"), GetSymbolLength(m_symbols, "TrqMastCal.Trq_NominalMap"));

                int cols = 0;
                int rows = 0;

                GetTableMatrixWitdhByName(m_currentfile, m_symbols, "TrqMastCal.Trq_NominalMap", out cols, out rows);
                if (isSixteenBitTable("TrqMastCal.Trq_NominalMap")) rows /= 2;

                for (int rt = 0; rt < rows; rt++)
                {
                    for (int ct = cols - 1; ct < cols; ct++)
                    {
                        int offset1 = (rt * cols * 2) + (ct * 2);
                        int offset2 = (rt * cols * 2) + (ct * 2) + 1;
                        int boostcalvalue = Convert.ToInt32(torquemap[offset1]) * 256 + Convert.ToInt32(torquemap[offset2]);
                        boostcalvalue *= 11;
                        boostcalvalue /= 10;
                        if (boostcalvalue > max_torque) boostcalvalue = max_torque;

                        byte b1 = Convert.ToByte(boostcalvalue / 256);
                        byte b2 = Convert.ToByte(boostcalvalue - (int)b1 * 256);
                        torquemap[offset1] = b1;
                        torquemap[offset2] = b2;
                    }
                }
                savedatatobinary((int)GetSymbolAddress(m_symbols, "TrqMastCal.Trq_NominalMap"), GetSymbolLength(m_symbols, "TrqMastCal.Trq_NominalMap"), torquemap, m_currentfile, true);
                AddToResumeTable("Tuned nominal torque map (TrqMastCal.Trq_NominalMap)");
            }
            UpdateChecksum(m_currentfile, true);

            // step 1b) Alter TorqueCal.m_AirTorqMap so that the maximum torquecolumn requests the desired airmass.
            /*** TorqueCal.m_AirTorqMap ***/
            /*** Data-matrix for nominal airmass. Engine speed and torque are used as support points. 
            The value in the matrix + friction airmass (idle airmass) will create the pointed torque at the pointed engine speed. 
            Resolution is   1 mg/c. ***/
            SetProgress("Tuning TrqMastCal.m_AirTorqMap...");
            if ((int)GetSymbolAddress(m_symbols, "TrqMastCal.m_AirTorqMap") > 0)
            {
                byte[] torquemap = readdatafromfile(m_currentfile, (int)GetSymbolAddress(m_symbols, "TrqMastCal.m_AirTorqMap"), GetSymbolLength(m_symbols, "TrqMastCal.m_AirTorqMap"));

                int cols = 0;
                int rows = 0;

                GetTableMatrixWitdhByName(m_currentfile, m_symbols, "TrqMastCal.m_AirTorqMap", out cols, out rows);
                if (isSixteenBitTable("TrqMastCal.m_AirTorqMap")) rows /= 2;
                // row > 5 and col > 4
                for (int rt = 0; rt < rows; rt++)
                {
                    for (int ct = cols - 1; ct < cols; ct++)
                    {
                        int offset1 = (rt * cols * 2) + (ct * 2);
                        int offset2 = (rt * cols * 2) + (ct * 2) + 1;
                        int boostcalvalue = Convert.ToInt32(torquemap[offset1]) * 256 + Convert.ToInt32(torquemap[offset2]);
                        boostcalvalue *= 13;
                        boostcalvalue /= 10;
                        //boostcalvalue = max_airflow_requested;
                        if (boostcalvalue > max_airflow_requested) boostcalvalue = max_airflow_requested;
                        //if (boostcalvalue > max_torque) max_torque = boostcalvalue;

                        byte b1 = Convert.ToByte(boostcalvalue / 256);
                        byte b2 = Convert.ToByte(boostcalvalue - (int)b1 * 256);
                        torquemap[offset1] = b1;
                        torquemap[offset2] = b2;
                    }
                }
                savedatatobinary((int)GetSymbolAddress(m_symbols, "TrqMastCal.m_AirTorqMap"), GetSymbolLength(m_symbols, "TrqMastCal.m_AirTorqMap"), torquemap, m_currentfile, true);
                AddToResumeTable("Tuned nominal airmass map (TrqMastCal.m_AirTorqMap)");
            }
            // update the checksum
            UpdateChecksum(m_currentfile, true);
            SetProgress("Tuning TorqueCal.m_PedYSP...");

            // step 1c) Alter the pedal request Y axis to meet the airmass request. TorqueCal.m_PedYSP
            /********** TorqueCal.m_PedYSP ***********/
            /*if ((int)GetSymbolAddress(m_symbols, "TorqueCal.m_PedYSP") > 0)
            {
                byte[] pedalmapysp = readdatafromfile(m_currentfile, (int)GetSymbolAddress(m_symbols, "TorqueCal.m_PedYSP"), GetSymbolLength(m_symbols, "TorqueCal.m_PedYSP"));
                // up the highest three rows with respectively 1.1, 1.2 and 1.3 factor
                int cols = 0;
                int rows = 0;

                GetTableMatrixWitdhByName(m_currentfile, m_symbols, "TorqueCal.m_PedYSP", out cols, out rows);
                if (isSixteenBitTable("TorqueCal.m_PedYSP")) rows /= 2;
                // row > 5 and col > 4
                for (int rt = rows - 3; rt < rows; rt++)
                {
                    int offset1 = (rt * cols * 2);
                    int offset2 = (rt * cols * 2) + 1;
                    int boostcalvalue = Convert.ToInt32(pedalmapysp[offset1]) * 256 + Convert.ToInt32(pedalmapysp[offset2]);
                    if (rt == rows - 3)
                    {
                        boostcalvalue *= 11;
                        boostcalvalue /= 10;
                    }
                    else if (rt == rows - 2)
                    {
                        boostcalvalue *= 12;
                        boostcalvalue /= 10;
                    }
                    else
                    {
                        boostcalvalue *= 13;
                        boostcalvalue /= 10;
                    }
                    if (boostcalvalue > maxairmass) boostcalvalue = (int)maxairmass;
                    byte b1 = Convert.ToByte(boostcalvalue / 256);
                    byte b2 = Convert.ToByte(boostcalvalue - (int)b1 * 256);
                    pedalmapysp[offset1] = b1;
                    pedalmapysp[offset2] = b2;

                }
                savedatatobinary((int)GetSymbolAddress(m_symbols, "TorqueCal.m_PedYSP"), GetSymbolLength(m_symbols, "TorqueCal.m_PedYSP"), pedalmapysp, m_currentfile);
                AddToResumeTable("Tuned airmass pedalmap y axis (TorqueCal.m_PedYSP)");
            }
            
             */

            /*
            progress.SetProgress("Tuning PedalMapCal.m_RequestMap...");


            // step 1d) Alter the pedal request map to meet the desired airmass in the top 2 rows (90-100%). PedalMapCal.m_RequestMap
            if ((int)GetSymbolAddress(m_symbols, "PedalMapCal.m_RequestMap") > 0)
            {
                byte[] pedalmap = readdatafromfile(m_currentfile, (int)GetSymbolAddress(m_symbols, "PedalMapCal.m_RequestMap"), GetSymbolLength(m_symbols, "PedalMapCal.m_RequestMap"));
                // up the highest three rows with respectively 1.1, 1.2 and 1.3 factor
                int cols = 0;
                int rows = 0;

                GetTableMatrixWitdhByName(m_currentfile, m_symbols, "PedalMapCal.m_RequestMap", out cols, out rows);
                if (isSixteenBitTable("PedalMapCal.m_RequestMap")) rows /= 2;
                // row > 5 and col > 4
                for (int rt = rows - 3; rt < rows; rt++)
                {
                    for (int ct = 0; ct < cols; ct++)
                    {
                        int offset1 = (rt * cols * 2) + (ct * 2);
                        int offset2 = (rt * cols * 2) + (ct * 2) + 1;
                        int boostcalvalue = Convert.ToInt32(pedalmap[offset1]) * 256 + Convert.ToInt32(pedalmap[offset2]);
                        if (rt == rows - 3)
                        {
                            boostcalvalue *= 11;
                            boostcalvalue /= 10;
                        }
                        else if (rt == rows - 2)
                        {
                            boostcalvalue *= 12;
                            boostcalvalue /= 10;
                        }
                        else
                        {
                            boostcalvalue *= 13;
                            boostcalvalue /= 10;
                        }
                        if (boostcalvalue > maxairmass) boostcalvalue = (int)maxairmass;
                        byte b1 = Convert.ToByte(boostcalvalue / 256);
                        byte b2 = Convert.ToByte(boostcalvalue - (int)b1 * 256);
                        pedalmap[offset1] = b1;
                        pedalmap[offset2] = b2;
                    }
                }
                savedatatobinary((int)GetSymbolAddress(m_symbols, "PedalMapCal.m_RequestMap"), GetSymbolLength(m_symbols, "PedalMapCal.m_RequestMap"), pedalmap, m_currentfile);
                AddToResumeTable("Tuned airmass request map (PedalMapCal.m_RequestMap)");
            }
            UpdateChecksum(m_currentfile);
             * */
            SetProgress("Tuning BstKnkCal.MaxAirmass...");

            // step 2) Increase the airmass limit table to allow for more airmass in the desired areas. BstKnkCal.MaxAirmass.
            if ((int)GetSymbolAddress(m_symbols, "BstKnkCal.MaxAirmass") > 0)
            {
                byte[] maxairmasstab = readdatafromfile(m_currentfile, (int)GetSymbolAddress(m_symbols, "BstKnkCal.MaxAirmass"), GetSymbolLength(m_symbols, "BstKnkCal.MaxAirmass"));
                // up the upper right quadrant > 800 mg/c and > 2000 rpm
                // start off with factor 1.3 for stage I
                int cols = 0;
                int rows = 0;

                GetTableMatrixWitdhByName(m_currentfile, m_symbols, "BstKnkCal.MaxAirmass", out cols, out rows);
                if (isSixteenBitTable("BstKnkCal.MaxAirmass")) rows /= 2;
                // row > 5 and col > 4
                for (int rt = 0; rt < rows; rt++)
                {
                    for (int ct = 0; ct < cols; ct++)
                    {
                        int offset1 = (rt * cols * 2) + (ct * 2);
                        int offset2 = (rt * cols * 2) + (ct * 2) + 1;
                        int boostcalvalue = Convert.ToInt32(maxairmasstab[offset1]) * 256 + Convert.ToInt32(maxairmasstab[offset2]);
                        // multiply by 1.3
                        boostcalvalue *= 13;
                        boostcalvalue /= 10;
                        if (boostcalvalue > maxairmass) boostcalvalue = (int)maxairmass;
                        byte b1 = Convert.ToByte(boostcalvalue / 256);
                        byte b2 = Convert.ToByte(boostcalvalue - (int)b1 * 256);
                        maxairmasstab[offset1] = b1;
                        maxairmasstab[offset2] = b2;
                    }
                }
                savedatatobinary((int)GetSymbolAddress(m_symbols, "BstKnkCal.MaxAirmass"), GetSymbolLength(m_symbols, "BstKnkCal.MaxAirmass"), maxairmasstab, m_currentfile, true);
                AddToResumeTable("Tuned airmass limiter for manual transmission (BstKnkCal.MaxAirmass)");
            }
            UpdateChecksum(m_currentfile, true);
            SetProgress("Tuning BstKnkCal.MaxAirmassAu...");
            if ((int)GetSymbolAddress(m_symbols, "BstKnkCal.MaxAirmassAu") > 0)
            {
                /********** BstKnkCal.MaxAirmassAu ***********/
                byte[] maxairmassaut = readdatafromfile(m_currentfile, (int)GetSymbolAddress(m_symbols, "BstKnkCal.MaxAirmassAu"), GetSymbolLength(m_symbols, "BstKnkCal.MaxAirmassAu"));
                // up the upper right quadrant > 800 mg/c and > 2000 rpm
                // start off with factor 1.3 for stage I
                int cols = 0;
                int rows = 0;

                GetTableMatrixWitdhByName(m_currentfile, m_symbols, "BstKnkCal.MaxAirmassAu", out cols, out rows);
                if (isSixteenBitTable("BstKnkCal.MaxAirmassAu")) rows /= 2;
                // row > 5 and col > 4
                for (int rt = 0; rt < rows; rt++)
                {
                    for (int ct = 0; ct < cols; ct++)
                    {
                        int offset1 = (rt * cols * 2) + (ct * 2);
                        int offset2 = (rt * cols * 2) + (ct * 2) + 1;
                        int boostcalvalue = Convert.ToInt32(maxairmassaut[offset1]) * 256 + Convert.ToInt32(maxairmassaut[offset2]);
                        // multiply by 1.3
                        boostcalvalue *= 13;
                        boostcalvalue /= 10;
                        if (boostcalvalue > maxairmass) boostcalvalue = (int)maxairmass;
                        byte b1 = Convert.ToByte(boostcalvalue / 256);
                        byte b2 = Convert.ToByte(boostcalvalue - (int)b1 * 256);
                        maxairmassaut[offset1] = b1;
                        maxairmassaut[offset2] = b2;
                    }
                }
                savedatatobinary((int)GetSymbolAddress(m_symbols, "BstKnkCal.MaxAirmassAu"), GetSymbolLength(m_symbols, "BstKnkCal.MaxAirmassAu"), maxairmassaut, m_currentfile, true);
                AddToResumeTable("Tuned airmass limiter for automatic transmission (BstKnkCal.MaxAirmassAu)");
            }
            UpdateChecksum(m_currentfile, true);
            /*
            progress.SetProgress("Tuning TorqueCal.M_EngMaxAutTab...");

            // step 3  Increasing engine torque limiters. Up the engine limiters so that the limiter 
            // is higher than the maximum torque in the request maps. 
            // (TorqueCal.M_EngMaxTab, TorqueCal.M_ManGearLim, TorqueCal.M_CabGearLim, TorqueCal.M_5GearLimTab)
            if ((int)GetSymbolAddress(m_symbols, "TorqueCal.M_EngMaxAutTab") > 0)
            {
                byte[] maxtorqueaut = readdatafromfile(m_currentfile, (int)GetSymbolAddress(m_symbols, "TorqueCal.M_EngMaxAutTab"), GetSymbolLength(m_symbols, "TorqueCal.M_EngMaxAutTab"));
                // up with 1.3 factor
                int cols = 0;
                int rows = 0;

                GetTableMatrixWitdhByName(m_currentfile, m_symbols, "TorqueCal.M_EngMaxAutTab", out cols, out rows);
                if (isSixteenBitTable("TorqueCal.M_EngMaxAutTab")) rows /= 2;
                // row > 5 and col > 4
                for (int rt = 0; rt < rows; rt++)
                {
                    int offset1 = (rt * cols * 2);
                    int offset2 = (rt * cols * 2) + 1;
                    int boostcalvalue = Convert.ToInt32(maxtorqueaut[offset1]) * 256 + Convert.ToInt32(maxtorqueaut[offset2]);
                    boostcalvalue = 400;
                    byte b1 = Convert.ToByte(boostcalvalue / 256);
                    byte b2 = Convert.ToByte(boostcalvalue - (int)b1 * 256);
                    maxtorqueaut[offset1] = b1;
                    maxtorqueaut[offset2] = b2;

                }
                savedatatobinary((int)GetSymbolAddress(m_symbols, "TorqueCal.M_EngMaxAutTab"), GetSymbolLength(m_symbols, "TorqueCal.M_EngMaxAutTab"), maxtorqueaut, m_currentfile);
                AddToResumeTable("Tuned torque limiter for automatic transmission (TorqueCal.M_EngMaxAutTab)");
            }
            
            progress.SetProgress("Tuning TorqueCal.M_EngMaxTab...");
            if ((int)GetSymbolAddress(m_symbols, "TorqueCal.M_EngMaxTab") > 0)
            {
                byte[] maxtorquetab = readdatafromfile(m_currentfile, (int)GetSymbolAddress(m_symbols, "TorqueCal.M_EngMaxTab"), GetSymbolLength(m_symbols, "TorqueCal.M_EngMaxTab"));
                // up with 1.3 factor
                int cols = 0;
                int rows = 0;

                GetTableMatrixWitdhByName(m_currentfile, m_symbols, "TorqueCal.M_EngMaxTab", out cols, out rows);
                if (isSixteenBitTable("TorqueCal.M_EngMaxTab")) rows /= 2;
                // row > 5 and col > 4
                for (int rt = 0; rt < rows; rt++)
                {
                    int offset1 = (rt * cols * 2);
                    int offset2 = (rt * cols * 2) + 1;
                    int boostcalvalue = Convert.ToInt32(maxtorquetab[offset1]) * 256 + Convert.ToInt32(maxtorquetab[offset2]);
                    if (boostcalvalue > maxtorque) boostcalvalue = (int)maxtorque;
                    boostcalvalue = 400;

                    byte b1 = Convert.ToByte(boostcalvalue / 256);
                    byte b2 = Convert.ToByte(boostcalvalue - (int)b1 * 256);
                    maxtorquetab[offset1] = b1;
                    maxtorquetab[offset2] = b2;
                }
                savedatatobinary((int)GetSymbolAddress(m_symbols, "TorqueCal.M_EngMaxTab"), GetSymbolLength(m_symbols, "TorqueCal.M_EngMaxTab"), maxtorquetab, m_currentfile);
                AddToResumeTable("Tuned torque limiter for manual transmission (TorqueCal.M_EngMaxTab)");
            }
            
            progress.SetProgress("Tuning TorqueCal.M_EngMaxE85Tab...");
            if ((int)GetSymbolAddress(m_symbols, "TorqueCal.M_EngMaxE85Tab") > 0)
            {
                byte[] maxtorquetab = readdatafromfile(m_currentfile, (int)GetSymbolAddress(m_symbols, "TorqueCal.M_EngMaxE85Tab"), GetSymbolLength(m_symbols, "TorqueCal.M_EngMaxE85Tab"));
                // up with 1.3 factor
                int cols = 0;
                int rows = 0;

                GetTableMatrixWitdhByName(m_currentfile, m_symbols, "TorqueCal.M_EngMaxE85Tab", out cols, out rows);
                if (isSixteenBitTable("TorqueCal.M_EngMaxE85Tab")) rows /= 2;
                // row > 5 and col > 4
                for (int rt = 0; rt < rows; rt++)
                {
                    int offset1 = (rt * cols * 2);
                    int offset2 = (rt * cols * 2) + 1;
                    int boostcalvalue = Convert.ToInt32(maxtorquetab[offset1]) * 256 + Convert.ToInt32(maxtorquetab[offset2]);
                    if (boostcalvalue > maxtorque) boostcalvalue = (int)maxtorque;
                    boostcalvalue = 400;

                    byte b1 = Convert.ToByte(boostcalvalue / 256);
                    byte b2 = Convert.ToByte(boostcalvalue - (int)b1 * 256);
                    maxtorquetab[offset1] = b1;
                    maxtorquetab[offset2] = b2;
                }
                savedatatobinary((int)GetSymbolAddress(m_symbols, "TorqueCal.M_EngMaxE85Tab"), GetSymbolLength(m_symbols, "TorqueCal.M_EngMaxE85Tab"), maxtorquetab, m_currentfile);
                AddToResumeTable("Tuned torque limiter for manual transmission on E85 fuel (TorqueCal.M_EngMaxE85Tab)");
            }
            
            progress.SetProgress("Tuning TorqueCal.M_ManGearLim...");
            if ((int)GetSymbolAddress(m_symbols, "TorqueCal.M_ManGearLim") > 0)
            {
                //TorqueCal.M_ManGearLim
                byte[] maxtorquemangear = readdatafromfile(m_currentfile, (int)GetSymbolAddress(m_symbols, "TorqueCal.M_ManGearLim"), GetSymbolLength(m_symbols, "TorqueCal.M_ManGearLim"));
                // up with 1.4 factor
                int cols = 0;
                int rows = 0;

                GetTableMatrixWitdhByName(m_currentfile, m_symbols, "TorqueCal.M_ManGearLim", out cols, out rows);
                if (isSixteenBitTable("TorqueCal.M_ManGearLim")) rows /= 2;
                // row > 5 and col > 4
                for (int rt = 0; rt < rows; rt++)
                {
                    int offset1 = (rt * cols * 2);
                    int offset2 = (rt * cols * 2) + 1;
                    int boostcalvalue = Convert.ToInt32(maxtorquemangear[offset1]) * 256 + Convert.ToInt32(maxtorquemangear[offset2]);
                    if (boostcalvalue > maxtorque) boostcalvalue = (int)maxtorque;
                    boostcalvalue = 400;

                    byte b1 = Convert.ToByte(boostcalvalue / 256);
                    byte b2 = Convert.ToByte(boostcalvalue - (int)b1 * 256);
                    maxtorquemangear[offset1] = b1;
                    maxtorquemangear[offset2] = b2;
                }
                savedatatobinary((int)GetSymbolAddress(m_symbols, "TorqueCal.M_ManGearLim"), GetSymbolLength(m_symbols, "TorqueCal.M_ManGearLim"), maxtorquemangear, m_currentfile);
                AddToResumeTable("Tuned torque limiter for manual transmission gears (TorqueCal.M_ManGearLim)");
            }
            progress.SetProgress("Tuning TorqueCal.M_CabGearLim...");
            if ((int)GetSymbolAddress(m_symbols, "TorqueCal.M_CabGearLim") > 0)
            {
                //TorqueCal.M_ManGearLim
                byte[] maxtorquemangear = readdatafromfile(m_currentfile, (int)GetSymbolAddress(m_symbols, "TorqueCal.M_CabGearLim"), GetSymbolLength(m_symbols, "TorqueCal.M_CabGearLim"));
                // up with 1.4 factor
                int cols = 0;
                int rows = 0;

                GetTableMatrixWitdhByName(m_currentfile, m_symbols, "TorqueCal.M_CabGearLim", out cols, out rows);
                if (isSixteenBitTable("TorqueCal.M_CabGearLim")) rows /= 2;
                // row > 5 and col > 4
                for (int rt = 0; rt < rows; rt++)
                {
                    int offset1 = (rt * cols * 2);
                    int offset2 = (rt * cols * 2) + 1;
                    int boostcalvalue = Convert.ToInt32(maxtorquemangear[offset1]) * 256 + Convert.ToInt32(maxtorquemangear[offset2]);
                    if (boostcalvalue > maxtorque) boostcalvalue = (int)maxtorque;
                    boostcalvalue = 400;

                    byte b1 = Convert.ToByte(boostcalvalue / 256);
                    byte b2 = Convert.ToByte(boostcalvalue - (int)b1 * 256);
                    maxtorquemangear[offset1] = b1;
                    maxtorquemangear[offset2] = b2;
                }
                savedatatobinary((int)GetSymbolAddress(m_symbols, "TorqueCal.M_CabGearLim"), GetSymbolLength(m_symbols, "TorqueCal.M_CabGearLim"), maxtorquemangear, m_currentfile);
                AddToResumeTable("Tuned torque limiter for cabrialet cars (TorqueCal.M_CabGearLim)");
            }
            progress.SetProgress("Tuning TorqueCal.M_5GearLimTab...");

            if ((int)GetSymbolAddress(m_symbols, "TorqueCal.M_5GearLimTab") > 0)
            {
                //TorqueCal.M_ManGearLim
                byte[] maxtorquemangear = readdatafromfile(m_currentfile, (int)GetSymbolAddress(m_symbols, "TorqueCal.M_5GearLimTab"), GetSymbolLength(m_symbols, "TorqueCal.M_5GearLimTab"));
                // up with 1.4 factor
                int cols = 0;
                int rows = 0;

                GetTableMatrixWitdhByName(m_currentfile, m_symbols, "TorqueCal.M_5GearLimTab", out cols, out rows);
                if (isSixteenBitTable("TorqueCal.M_5GearLimTab")) rows /= 2;
                // row > 5 and col > 4
                for (int rt = 0; rt < rows; rt++)
                {
                    int offset1 = (rt * cols * 2);
                    int offset2 = (rt * cols * 2) + 1;
                    int boostcalvalue = Convert.ToInt32(maxtorquemangear[offset1]) * 256 + Convert.ToInt32(maxtorquemangear[offset2]);
                    if (boostcalvalue > maxtorque) boostcalvalue = (int)maxtorque;
                    boostcalvalue = 400;

                    byte b1 = Convert.ToByte(boostcalvalue / 256);
                    byte b2 = Convert.ToByte(boostcalvalue - (int)b1 * 256);
                    maxtorquemangear[offset1] = b1;
                    maxtorquemangear[offset2] = b2;
                }
                savedatatobinary((int)GetSymbolAddress(m_symbols, "TorqueCal.M_5GearLimTab"), GetSymbolLength(m_symbols, "TorqueCal.M_5GearLimTab"), maxtorquemangear, m_currentfile);
                AddToResumeTable("Tuned torque limiter for manual transmission in 5th gear (TorqueCal.M_5GearLimTab)");
            }
            */
            // step 4  Adapt fuel delivery.
            // step 4a) You should make sure the fuel supply is good in all ranges by recalibrating BFuelCal.Map. Altering the maximum allowed airmass will also require more fuel. Check this with a wideband O2 sensor.
            // step 4b) If you change injectors you should change the injector constant InjCorrCal.InjectorConst and the battery voltage correction table InjCorrCal.BattCorrTab accordingly.

            //Step 5  Increase fuel cur level
            // Increase the fuelcut limit to above the airmass desired. E.g. if you target 1350 mg/c the fuelcut limit should be higher e.g. 1450 or 1500. FCutCal.m_AirInletLimit.

            /********** FCutCal.m_AirInletLimit ***********/

            SetProgress("Tuning FCutCal.m_AirInletLimit...");
            // write 1450 to fuelcut limit
            if ((int)GetSymbolAddress(m_symbols, "FCutCal.m_AirInletLimit") > 0)
            {
                byte[] fuelcutmap = readdatafromfile(m_currentfile, (int)GetSymbolAddress(m_symbols, "FCutCal.m_AirInletLimit"), GetSymbolLength(m_symbols, "FCutCal.m_AirInletLimit"));
                if (fuelcutmap.Length == 2)
                {
                    fuelcutmap[0] = 0x05;
                    fuelcutmap[1] = 0xAA;
                }
                savedatatobinary((int)GetSymbolAddress(m_symbols, "FCutCal.m_AirInletLimit"), GetSymbolLength(m_symbols, "FCutCal.m_AirInletLimit"), fuelcutmap, m_currentfile, true);
                AddToResumeTable("Tuned fuelcut limiter (FCutCal.m_AirInletLimit)");
            }
            UpdateChecksum(m_currentfile, true);

            // mark binary as tuned to stage I

            //AddToResumeTable("Updated binary description with tuned stage");
            SetProgress("Generating report...");


            AddToResumeTable("Updated checksum.");

            SetProgressIdle();

            // refresh open viewers

        }

        private void browseAxisInfoToolStripMenuItem_Click(object sender, EventArgs e)
        {
            string symbolname = string.Empty;
            if (gridViewSymbols.SelectedRowsCount > 0)
            {
                int[] selrows = gridViewSymbols.GetSelectedRows();
                if (selrows.Length > 0)
                {
                    SymbolHelper dr = (SymbolHelper)gridViewSymbols.GetRow((int)selrows.GetValue(0));
                    symbolname = dr.Varname;
                }
            }
            DockPanel dockPanel = dockManager1.AddPanel(new System.Drawing.Point(-500, -500));
            AxisBrowser tabdet = new AxisBrowser();
            tabdet.onStartSymbolViewer += new AxisBrowser.StartSymbolViewer(tabdet_onStartSymbolViewer);
            tabdet.Dock = DockStyle.Fill;
            dockPanel.Controls.Add(tabdet);
            tabdet.ShowSymbolCollection(m_symbols);
            tabdet.SetCurrentSymbol(symbolname);
            dockPanel.Text = "Axis browser: " + Path.GetFileName(m_currentfile);
            bool isDocked = false;
            foreach (DockPanel pnl in dockManager1.Panels)
            {
                if (pnl.Text.StartsWith("Axis browser: ") && pnl != dockPanel && (pnl.Visibility == DockVisibility.Visible))
                {
                    dockPanel.DockAsTab(pnl, 0);
                    isDocked = true;
                    break;
                }
            }
            if (!isDocked)
            {
                dockPanel.DockTo(dockManager1, DockingStyle.Left, 1);
                dockPanel.Width = 700;
            }
        }

        void tabdet_onStartSymbolViewer(object sender, AxisBrowser.SymbolViewerRequestedEventArgs e)
        {
            StartTableViewer(e.Mapname);
        }

        private void barButtonItem31_ItemClick(object sender, ItemClickEventArgs e)
        {
            DockPanel dockPanel = dockManager1.AddPanel(new System.Drawing.Point(-500, -500));
            AxisBrowser tabdet = new AxisBrowser();
            tabdet.onStartSymbolViewer += new AxisBrowser.StartSymbolViewer(tabdet_onStartSymbolViewer);
            tabdet.Dock = DockStyle.Fill;
            dockPanel.Controls.Add(tabdet);
            tabdet.ShowSymbolCollection(m_symbols);
            dockPanel.Text = "Axis browser: " + Path.GetFileName(m_currentfile);
            bool isDocked = false;
            foreach (DockPanel pnl in dockManager1.Panels)
            {
                if (pnl.Text.StartsWith("Axis browser: ") && pnl != dockPanel && (pnl.Visibility == DockVisibility.Visible))
                {
                    dockPanel.DockAsTab(pnl, 0);
                    isDocked = true;
                    break;
                }
            }
            if (!isDocked)
            {
                dockPanel.DockTo(dockManager1, DockingStyle.Left, 1);
                dockPanel.Width = 700;
            }
        }

        private void showDisassemblyToolStripMenuItem_Click(object sender, EventArgs e)
        {
            if (m_currentfile != null)
            {
                string outputfile = Path.GetDirectoryName(m_currentfile);
                outputfile = Path.Combine(outputfile, Path.GetFileNameWithoutExtension(m_currentfile) + ".asm");
                System.Windows.Forms.Application.DoEvents();
                DockPanel panel = dockManager1.AddPanel(DockingStyle.Right);
                ctrlDisassembler disasmcontrol = new ctrlDisassembler() { Filename = m_currentfile, Symbols = m_symbols, Dock = DockStyle.Fill };
                panel.Controls.Add(disasmcontrol);
                panel.Text = "T8Suite Disassembler";
                panel.Width = this.ClientSize.Width - dockSymbols.Width;
                System.Windows.Forms.Application.DoEvents();
                disasmcontrol.DisassembleFile(outputfile);
                SetProgressIdle();
            }
        }

        private bool AssemblerViewerActive(bool ShowIfActive, string filename)
        {
            bool retval = false;
            foreach (DockPanel pnl in dockManager1.Panels)
            {
                if (pnl.Text.StartsWith("Assembler: " + Path.GetFileName(filename)))
                {
                    retval = true;
                    if (ShowIfActive)
                    {
                        pnl.Show();
                        dockManager1.ActivePanel = pnl;
                    }
                }
                else
                {
                    foreach (Control c in pnl.Controls)
                    {
                        if (c is DockPanel)
                        {
                            DockPanel tpnl = (DockPanel)c;
                            if (tpnl.Text.StartsWith("Assembler: " + Path.GetFileName(filename)))
                            {
                                retval = true;
                                if (ShowIfActive)
                                {
                                    tpnl.Show();
                                    dockManager1.ActivePanel = tpnl;
                                }
                            }
                        }
                    }
                }
            }
            return retval;

        }

        private void StartAssemblerViewer(string filename, frmProgress progress)
        {
            if (m_currentfile != "")
            {
                dockManager1.BeginUpdate();
                try
                {
                    DockPanel dockPanel = dockManager1.AddPanel(DockingStyle.Right);
                    dockPanel.Text = "Assembler: " + Path.GetFileName(filename);
                    AsmViewer av = new AsmViewer() { Dock = DockStyle.Fill };
                    dockPanel.Width = 800;
                    dockPanel.Controls.Add(av);
                    progress.SetProgress("Loading assembler file ...");
                    av.LoadDataFromFile(filename, m_symbols);
                    progress.SetProgress("Finding starting address in file");
                    av.FindStartAddress(m_currentfile);
                }
                catch (Exception E)
                {
                    LogHelper.Log(E.Message);
                }
                dockManager1.EndUpdate();
            }
        }

        private void showFullDisassemblyToolStripMenuItem_Click(object sender, EventArgs e)
        {
            string outputfile = Path.GetDirectoryName(m_currentfile);
            outputfile = Path.Combine(outputfile, Path.GetFileNameWithoutExtension(m_currentfile) + "_full.asm");
            if (!AssemblerViewerActive(true, outputfile))
            {
                frmProgress progress = new frmProgress();
                progress.Show();
                progress.SetProgress("Start disassembler");
                if (!File.Exists(outputfile))
                {
                    progress.SetProgress("Disassembler running...");
                    Disassembler dis = new Disassembler();
                    dis.DisassembleFileRtf(m_currentfile, outputfile, m_currentfile_size, m_symbols);
                    progress.SetProgress("Disassembler done...");
                }
                progress.SetProgress("Loading assembler file");
                StartAssemblerViewer(outputfile, progress);
                progress.Close();
            }
        }

        private void barButtonItem32_ItemClick(object sender, ItemClickEventArgs e)
        {
            // save as a byte flipped file
            if (m_currentfile != "")
            {
                SaveFileDialog sfd = new SaveFileDialog();
                sfd.Filter = "Binary files|*.bin";
                if (sfd.ShowDialog() == DialogResult.OK)
                {
                    LogHelper.Log("Flipping file");
                    string filenamenew = sfd.FileName;
                    FileStream fromfile = new FileStream(m_currentfile, FileMode.Open, FileAccess.Read);
                    FileStream tofile = new FileStream(filenamenew, FileMode.CreateNew);
                    using (BinaryReader brori = new BinaryReader(fromfile))
                    {
                        using (BinaryWriter brnew = new BinaryWriter(tofile))
                        {
                            for (int t = 0; t < 0x100000; t += 2)
                            {
                                byte bfirst = brori.ReadByte();
                                byte bsecond = brori.ReadByte();
                                brnew.Write(bsecond);
                                brnew.Write(bfirst);
                            }
                        }
                    }
                    fromfile.Close();
                    tofile.Close();
                }
            }


        }

        private string GetFileDescriptionFromFile(string file)
        {
            string retval = string.Empty;
            try
            {
                using (StreamReader sr = new StreamReader(file))
                {
                    sr.ReadLine();
                    sr.ReadLine();
                    string name = sr.ReadLine();
                    name = name.Trim();
                    name = name.Replace("<", "");
                    name = name.Replace(">", "");
                    //name = name.Replace("x0020", " ");
                    name = name.Replace("_x0020_", " ");
                    for (int i = 0; i <= 9; i++)
                    {
                        name = name.Replace("_x003" + i.ToString() + "_", i.ToString());
                    }
                    retval = name;
                }
            }
            catch (Exception E)
            {
                LogHelper.Log(E.Message);
            }
            return retval;
        }

        private bool TryToLoadAdditionalSymbols(string filename, bool ImportFromRepository, SymbolCollection coll2load)
        {
            bool retval = false;
            SymbolTranslator st = new SymbolTranslator();
            System.Data.DataTable dt = new System.Data.DataTable(Path.GetFileNameWithoutExtension(filename));
            dt.Columns.Add("SYMBOLNAME");
            dt.Columns.Add("SYMBOLNUMBER", Type.GetType("System.Int32"));
            dt.Columns.Add("FLASHADDRESS", Type.GetType("System.Int32"));
            dt.Columns.Add("DESCRIPTION");
            T8Header fh = new T8Header();
            if (ImportFromRepository)
            {
                fh.init(filename);
                string checkstring = fh.PartNumber + fh.SoftwareVersion;
                string xmlfilename = System.Windows.Forms.Application.StartupPath + "\\repository\\" + Path.GetFileNameWithoutExtension(filename) + File.GetCreationTime(filename).ToString("yyyyMMddHHmmss") + checkstring + ".xml";
                if (!Directory.Exists(System.Windows.Forms.Application.StartupPath + "\\repository"))
                {
                    Directory.CreateDirectory(System.Windows.Forms.Application.StartupPath + "\\repository");
                }
                if (File.Exists(xmlfilename))
                {
                    dt.ReadXml(xmlfilename);
                    retval = true;
                }
            }
            else
            {
                string binname = GetFileDescriptionFromFile(filename);
                if (binname != string.Empty)
                {
                    dt = new System.Data.DataTable(binname);
                    dt.Columns.Add("SYMBOLNAME");
                    dt.Columns.Add("SYMBOLNUMBER", Type.GetType("System.Int32"));
                    dt.Columns.Add("FLASHADDRESS", Type.GetType("System.Int32"));
                    dt.Columns.Add("DESCRIPTION");
                    if (File.Exists(filename))
                    {
                        dt.ReadXml(filename);
                        retval = true;
                    }
                }
            }

            bool createRepositoryFile = false;
            string[,] SymbolFiles = new string[,] {{"FD0M", "{0}\\FD0M_C.xml"},
                                                   {"FD0I", "{0}\\FD0I_C.xml"},
                                                   {"FC0N", "{0}\\FC0N_C.xml"},
                                                   {"FC0U", "{0}\\FC0U_C.xml"},
                                                   {"FD0F", "{0}\\FD0F_C.xml"},
                                                   {"FF0L", "{0}\\FF0L_C.xml"},
                                                   {"FD0G", "{0}\\FD0G_C.xml"}};
            if (dt.Rows.Count == 0)
            {
                fh.init(filename);
                for (int i = 0; i < SymbolFiles.GetLength(0); i++) 
                {
                    if (fh.SoftwareVersion.Trim().StartsWith(SymbolFiles[i, 0].ToString(), StringComparison.OrdinalIgnoreCase))
                    {
                        string BioPowerXmlFile = String.Format(SymbolFiles[i, 1], System.Windows.Forms.Application.StartupPath);
                        if (File.Exists(BioPowerXmlFile))
                        {
                            string binname = GetFileDescriptionFromFile(BioPowerXmlFile);
                            if (binname != string.Empty)
                            {
                                dt = new System.Data.DataTable(binname);
                                dt.Columns.Add("SYMBOLNAME");
                                dt.Columns.Add("SYMBOLNUMBER", Type.GetType("System.Int32"));
                                dt.Columns.Add("FLASHADDRESS", Type.GetType("System.Int32"));
                                dt.Columns.Add("DESCRIPTION");
                                dt.ReadXml(BioPowerXmlFile);
                                createRepositoryFile = false;
                            }
                        }
                    }
                }
            }
            foreach (SymbolHelper sh in coll2load)
            {
                foreach (DataRow dr in dt.Rows)
                {
                    try
                    {
                        if (dr["SYMBOLNAME"].ToString() == sh.Varname)
                        {
                            //if (sh.Symbol_number == Convert.ToInt32(dr["SYMBOLNUMBER"]))
                            {
                                if (sh.Flash_start_address == Convert.ToInt32(dr["FLASHADDRESS"]))
                                {
                                    sh.Userdescription = dr["DESCRIPTION"].ToString();
                                    string helptext = string.Empty;
                                    XDFCategories cat = XDFCategories.Undocumented;
                                    XDFSubCategory sub = XDFSubCategory.Undocumented;
                                    sh.Description = st.TranslateSymbolToHelpText(sh.Userdescription, out helptext, out cat, out sub);

                                    //if(sh.Category == 
                                    if (sh.Category == "Undocumented" || sh.Category == "")
                                    {
                                        if (sh.Userdescription.Contains("."))
                                        {
                                            try
                                            {
                                                sh.Category = sh.Userdescription.Substring(0, sh.Userdescription.IndexOf("."));
                                                //LogHelper.Log("Set cat to " + sh.Category + " for " + sh.Userdescription);
                                            }
                                            catch (Exception cE)
                                            {
                                                LogHelper.Log("Failed to assign category to symbol: " + sh.Userdescription + " err: " + cE.Message);
                                            }
                                        }

                                    }

                                    break;
                                }
                            }
                        }
                    }
                    catch (Exception E)
                    {
                        LogHelper.Log(E.Message);
                    }
                }
            }
            if (createRepositoryFile)
            {
                SaveAdditionalSymbols();
            }
            return retval;
        }

        private bool SymbolExists(string symbolname)
        {
            foreach (SymbolHelper sh in m_symbols)
            {
                if (sh.Varname == symbolname || sh.Userdescription == symbolname) return true;
            }
            return false;
        }

        private bool CheckAllTablesAvailable()
        {
            bool retval = true;
            if (m_currentfile != "")
            {
                if (File.Exists(m_currentfile))
                {
                    if (!SymbolExists("PedalMapCal.Trq_RequestMap")) retval = false;
                    if (!SymbolExists("TrqMastCal.m_AirTorqMap")) retval = false;
                    if (!SymbolExists("TrqMastCal.Trq_NominalMap")) retval = false;
                    if (!SymbolExists("BstKnkCal.MaxAirmass")) retval = false;
                    if (!SymbolExists("FCutCal.m_AirInletLimit")) retval = false;
                    if (!SymbolExists("TrqLimCal.Trq_MaxEngineManTab1") && !SymbolExists("TrqLimCal.Trq_MaxEngineTab1")) retval = false;
                    if (!SymbolExists("TrqLimCal.Trq_MaxEngineAutTab1") && !SymbolExists("TrqLimCal.Trq_MaxEngineTab1")) retval = false;
                    // if (!SymbolExists("TrqLimCal.Trq_MaxEngineManTab2")) retval = false;
                    //if (!SymbolExists("TrqLimCal.Trq_MaxEngineAutTab2")) retval = false;
                    if (!SymbolExists("TrqLimCal.Trq_ManGear")) retval = false;
                }
                else retval = false;
            }
            else retval = false;
            return retval;
        }

        private void btnAirmassResult_ItemClick(object sender, ItemClickEventArgs e)
        {
            System.Windows.Forms.Application.DoEvents();
            if (CheckAllTablesAvailable())
            {
                // build a table that shows the maximum allowed airmass depending on the current limiters
                // table show be the same size as the pedalrequest map
                frmAirmassResult airmassresult = new frmAirmassResult();
                airmassresult.onStartTableViewer += new frmAirmassResult.StartTableViewer(airmassresult_onStartTableViewer);
                airmassresult.Currentfile = m_currentfile;
                airmassresult.Symbols = m_symbols;
                airmassresult.Calculate();
                airmassresult.Show(); // not dialog?
            }
        }

        void airmassresult_onStartTableViewer(object sender, frmAirmassResult.StartTableViewerEventArgs e)
        {
            // start the table viewer
            StartTableViewer(e.SymbolName);
        }

        private void barButtonItem33_ItemClick(object sender, ItemClickEventArgs e)
        {
            // ask which file
            OpenFileDialog ofd = new OpenFileDialog();
            ofd.Multiselect = false;
            ofd.Filter = "Binary files|*.bin";
            if (ofd.ShowDialog() == DialogResult.OK)
            {
                byte[] file = readdatafromfile(ofd.FileName, 0, 0x100000);
                for (int i = 0; i < file.Length; i++)
                {
                    file[i] += 0xD6;
                    file[i] ^= 0x21;
                }

                string outputfilename = Path.Combine(Path.GetDirectoryName(ofd.FileName), Path.GetFileNameWithoutExtension(ofd.FileName) + "-decodedD621.bin");
                FileStream fs = new FileStream(outputfilename, FileMode.OpenOrCreate);
                using (BinaryWriter bw = new BinaryWriter(fs))
                {
                    bw.Write(file);
                }
                fs.Close();
            }
        }

        private void barButtonItem34_ItemClick(object sender, ItemClickEventArgs e)
        {
            // ask which file
            OpenFileDialog ofd = new OpenFileDialog();
            ofd.Multiselect = false;
            ofd.Filter = "Binary files|*.bin";
            if (ofd.ShowDialog() == DialogResult.OK)
            {
                byte[] file = readdatafromfile(ofd.FileName, 0, 0x100000);
                for (int i = 0; i < file.Length; i++)
                {
                    file[i] += 0x53;
                    file[i] ^= 0xA4;
                }
                string outputfilename = Path.Combine(Path.GetDirectoryName(ofd.FileName), Path.GetFileNameWithoutExtension(ofd.FileName) + "-decoded53A4.bin");
                FileStream fs = new FileStream(outputfilename, FileMode.OpenOrCreate);
                using (BinaryWriter bw = new BinaryWriter(fs))
                {
                    bw.Write(file);
                }
                fs.Close();
            }
        }

        private void barButtonItem35_ItemClick(object sender, ItemClickEventArgs e)
        {
            // ask which file
            OpenFileDialog ofd = new OpenFileDialog();
            ofd.Multiselect = false;
            ofd.Filter = "Binary files|*.bin";
            if (ofd.ShowDialog() == DialogResult.OK)
            {
                byte[] file = readdatafromfile(ofd.FileName, 0, 0x100000);
                for (int i = 0; i < file.Length; i++)
                {
                    file[i] ^= 0x21;
                    file[i] -= 0xD6;
                }

                string outputfilename = Path.Combine(Path.GetDirectoryName(ofd.FileName), Path.GetFileNameWithoutExtension(ofd.FileName) + "-ecodedD621.bin");
                FileStream fs = new FileStream(outputfilename, FileMode.OpenOrCreate);
                using (BinaryWriter bw = new BinaryWriter(fs))
                {
                    bw.Write(file);
                }
                fs.Close();
            }
        }

        private void barButtonItem36_ItemClick(object sender, ItemClickEventArgs e)
        {
            // ask which file
            OpenFileDialog ofd = new OpenFileDialog();
            ofd.Multiselect = false;
            ofd.Filter = "Binary files|*.bin";
            if (ofd.ShowDialog() == DialogResult.OK)
            {
                byte[] file = readdatafromfile(ofd.FileName, 0, 0x100000);
                for (int i = 0; i < file.Length; i++)
                {
                    file[i] ^= 0xA4;
                    file[i] -= 0x53;
                }

                string outputfilename = Path.Combine(Path.GetDirectoryName(ofd.FileName), Path.GetFileNameWithoutExtension(ofd.FileName) + "-ecoded53A4.bin");
                FileStream fs = new FileStream(outputfilename, FileMode.OpenOrCreate);
                using (BinaryWriter bw = new BinaryWriter(fs))
                {
                    bw.Write(file);
                }
                fs.Close();
            }
        }

        /*
        private void AddToSourceFile(string symbolname, string description, string resolution, string interval)
        {
            if (description == "") return;
            if (description.StartsWith("No info text")) return;
            description = description.Replace("\"", "\\\"");
            if (resolution != "") description += " Resolution is " + resolution + ".";
            if (interval != "") description += " Interval is " + interval + ".";
            using (StreamWriter sw = new StreamWriter(@"C:\T8Source2Copy.cs", true, System.Text.Encoding.Default))
            {
                sw.WriteLine("          case \"" + symbolname + "\":");
                sw.WriteLine("              description = helptext = \"" + description + "\";");
                sw.WriteLine("              category = XDFCategories.Undocumented;");
                sw.WriteLine("              subcategory = XDFSubCategory.Undocumented;");
                sw.WriteLine("              break;");
            }
        }*/

        private string GetFullDescription(string[] lines, int fromindex)
        {
            bool endFound = false;
            string retval = string.Empty;
            //retval = lines[fromindex];
            int cnt = 0;
            while (!endFound)
            {
                string line = lines[fromindex + cnt];
                if (line.Contains("\"]"))
                {
                    // laatste regel
                    line = line.Replace("\x0d", " ");
                    line = line.Replace("\x0a", " ");
                    line = line.Replace("\"", " ");
                    line = line.Replace("'", " ");
                    line = line.Replace("Description:[", "");
                    line = line.Replace("DESCRIPTION:", "");
                    while (line.Contains("  ")) line = line.Replace("  ", " ");
                    while (line.Contains("**")) line = line.Replace("**", "*");
                    line.Trim();
                    endFound = true;
                    retval += line;
                }
                else if (line.StartsWith("*") && !line.StartsWith("**"))
                {
                    endFound = true;
                }
                else
                {
                    line = line.Replace("\x0d", " ");
                    line = line.Replace("\x0a", " ");
                    line = line.Replace("\"", " ");
                    line = line.Replace("'", " ");
                    line = line.Replace("Description:[", "");
                    line = line.Replace("DESCRIPTION:", "");
                    while (line.Contains("  ")) line = line.Replace("  ", " ");
                    while (line.Contains("**")) line = line.Replace("**", "*");
                    line.Trim();
                    retval += line;
                }
                if (cnt++ > 15)
                {
                    endFound = true;
                    LogHelper.Log("More than 10 lines!");
                }
            }
            return retval;
        }


        private void SaveAdditionalSymbols()
        {
            System.Data.DataTable dt = new System.Data.DataTable(Path.GetFileNameWithoutExtension(m_currentfile));
            dt.Columns.Add("SYMBOLNAME");
            dt.Columns.Add("SYMBOLNUMBER", Type.GetType("System.Int32"));
            dt.Columns.Add("FLASHADDRESS", Type.GetType("System.Int32"));
            dt.Columns.Add("DESCRIPTION");

            T8Header fh = new T8Header();
            fh.init(m_currentfile);
            string checkstring = fh.PartNumber + fh.SoftwareVersion;
            string xmlfilename = System.Windows.Forms.Application.StartupPath + "\\repository\\" + Path.GetFileNameWithoutExtension(m_currentfile) + File.GetCreationTime(m_currentfile).ToString("yyyyMMddHHmmss") + checkstring + ".xml";
            if (!Directory.Exists(System.Windows.Forms.Application.StartupPath + "\\repository"))
            {
                Directory.CreateDirectory(System.Windows.Forms.Application.StartupPath + "\\repository");
            }
            if (File.Exists(xmlfilename))
            {
                File.Delete(xmlfilename);
            }
            foreach (SymbolHelper sh in m_symbols)
            {
                if (sh.Userdescription != "")
                {
                    dt.Rows.Add(sh.Varname, sh.Symbol_number, sh.Flash_start_address, sh.Userdescription);
                }
            }
            dt.WriteXml(xmlfilename);
        }

        private void btnImportXML_ItemClick(object sender, ItemClickEventArgs e)
        {
            ImportXMLDescriptorFile();
        }



        private void gridViewSymbols_CellValueChanged(object sender, DevExpress.XtraGrid.Views.Base.CellValueChangedEventArgs e)
        {
            if (e.Column.Name == gcSymbolsUserDescription.Name)
            {
                // save a new repository item
                SaveAdditionalSymbols();

            }
        }

        private void btnShowVectors_ItemClick(object sender, ItemClickEventArgs e)
        {
            using (frmVectorlist vectorlist = new frmVectorlist())
            {
                System.Data.DataTable dt = new System.Data.DataTable();
                dt.Columns.Add("Vector");
                dt.Columns.Add("Address", System.Type.GetType("System.Int64"));

                long[] adresses = TrionicFile.GetVectorAddresses(m_currentfile);
                string[] names = TrionicFile.GetVectorNames();
                for (int i = 0; i < adresses.Length; i++)
                {
                    dt.Rows.Add(names[i].Replace("_", " "), Convert.ToInt64(adresses.GetValue(i)));
                }
                vectorlist.SetDataTable(dt);
                vectorlist.ShowDialog();
            }
        }

        private void DumpThisData(byte[] data, string filename)
        {
            FileStream fs = new FileStream(filename, FileMode.Create);
            using (BinaryWriter bw = new BinaryWriter(fs))
            {
                bw.Write(data);
            }
            fs.Close();
        }

        //
        //        file_data[t] += 0x53;
        //        file_data[t] ^= 0xA4;
        //
        private void btnTestMFSBlocks_ItemClick(object sender, ItemClickEventArgs e)
        {
            // search file for "MFS*" indicator
            if (m_currentfile != string.Empty)
            {
                byte[] entirefile = File.ReadAllBytes(m_currentfile);
                int fileCount = 0;
                for (int i = 0; i < entirefile.Length - 4; i++)
                {
                    if (entirefile[i] == 'M' && entirefile[i + 1] == 'F' && entirefile[i + 2] == 'S' && entirefile[i + 3] == '*')
                    {
                        // get 0x100 bytes to start with
                        LogHelper.Log("Block at " + i.ToString("X8"));
                        byte[] btodump = new byte[0x1000];
                        for (int j = 0; j < 0x1000; j++)
                        {
                            btodump[j] = entirefile[i + j];
                            btodump[j] += 0x53;
                            btodump[j] ^= 0xA4;
                        }
                        //DumpThisData(btodump, @"C:\T8Decode\MFSBlock-A-" + fileCount.ToString() + "-" + i.ToString("X8") + ".mfs");
                        fileCount++;
                        for (int j = 0; j < 0x1000; j++)
                        {
                            btodump[j] = entirefile[i + j];
                            btodump[j] ^= 0xA4;
                            btodump[j] -= 0x53;
                        }
                        //DumpThisData(btodump, @"C:\T8Decode\MFSBlock-B-" + fileCount.ToString() + "-" + i.ToString("X8") + ".mfs");
                        fileCount++;
                        for (int j = 0; j < 0x1000; j++)
                        {
                            btodump[j] = entirefile[i + j];
                            btodump[j] += 0xD6;
                            btodump[j] ^= 0x21;
                        }
                        //DumpThisData(btodump, @"C:\T8Decode\MFSBlock-C-" + fileCount.ToString() + "-" + i.ToString("X8") + ".mfs");
                        fileCount++;
                        for (int j = 0; j < 0x1000; j++)
                        {
                            btodump[j] = entirefile[i + j];
                            btodump[j] ^= 0x21;
                            btodump[j] -= 0xD6;
                        }
                        //DumpThisData(btodump, @"C:\T8Decode\MFSBlock-D-" + fileCount.ToString() + "-" + i.ToString("X8") + ".mfs");
                        fileCount++;
                    }
                }
                // dump piarea but larger
                byte[] bpitodump = new byte[0x1000];
                int jx = 0;
                for (int i = 0xBAF06; i < 0xBBF06; i++)
                {
                    bpitodump[jx] = entirefile[i];
                    bpitodump[jx] += 0xD6;
                    bpitodump[jx] ^= 0x21;
                    jx++;
                }
                //DumpThisData(bpitodump, @"C:\T8Decode\piarea.mfs");

            }
        }

        private void btnConvertOriFiles_ItemClick(object sender, ItemClickEventArgs e)
        {
            // get all files in subfolder Binaries\Ori and convert the filenames
            string[] files = Directory.GetFiles(System.Windows.Forms.Application.StartupPath + "\\Binaries\\Ori", "*.bin");
            foreach (string file in files)
            {
                LogHelper.Log("Handling: " + Path.GetFileName(file));
                m_currentfile = file;
                TryToOpenFile(m_currentfile, out m_symbols, m_currentfile_size);
                // now get the details
                if (m_currentfile != "")
                {
                    T8Header t8header = new T8Header();

                    t8header.init(m_currentfile);
                    frmAirmassResult res = new frmAirmassResult();
                    res.Currentfile = m_currentfile;
                    res.Symbols = m_symbols;
                    res.Calculate();
                    int peak_airmass = res.PeakAirmass;
                    string newFilename = t8header.PartNumber.Trim() + "_" + t8header.SoftwareVersion.Trim() /*+ "_" + t8header.HardwareID.Trim() + "_" + t8header.DeviceType.Trim() + "_" + peak_airmass.ToString() + "mgc.bin"*/ + ".BIN";

                    if (!File.Exists(System.Windows.Forms.Application.StartupPath + "\\Binaries\\" + newFilename))
                    {
                        File.Copy(file, System.Windows.Forms.Application.StartupPath + "\\Binaries\\" + newFilename);

                        // test
                        VINDecoder dec = new VINDecoder();
                        VINCarInfo info = dec.DecodeVINNumber(t8header.ChassisID);
                        AddToPartnumberCollectionFile(t8header.PartNumber.Trim(), info.Makeyear, t8header.SoftwareVersion.Trim());
                        AddToPartnumberConverterFile(t8header.PartNumber.Trim(), info.EngineType, info.CarModel, t8header.SoftwareVersion.Trim());
                        // test

                    }
                    else
                    {
                        LogHelper.Log("File already existed: " + newFilename);
                    }
                    /*frminfo.ProgrammerName = t8header.ProgrammerName;
                    frminfo.ProgrammingDevice = t8header.ProgrammerDevice;
                    frminfo.PartNumber = t8header.PartNumber;
                    frminfo.ReleaseDate = t8header.ReleaseDate;
                    frminfo.SoftwareID = t8header.SoftwareVersion;
                    frminfo.ChassisID = t8header.ChassisID;
                    frminfo.EngineType = t8header.CarDescription;
                    frminfo.ImmoID = t8header.ImmobilizerID;
                    frminfo.HardwareID = t8header.HardwareID;
                    frminfo.HardwareType = t8header.DeviceType;
                    frminfo.ECUDescription = t8header.EcuDescription;
                    frminfo.InterfaceDevice = t8header.InterfaceDevice;
                    frminfo.NumberOfFlashBlocks = t8header.NumberOfFlashBlocks.ToString();*/
                }
            }
            LogHelper.Log("All done");
        }

        private void AddToPartnumberConverterFile(string partnumber, VINEngineType vINEngineType, VINCarModel vINCarModel, string swversion)
        {
            using (StreamWriter sw = new StreamWriter(@"C:\T8PartnumberConverter.cs", true, System.Text.Encoding.Default))
            {
                sw.WriteLine("\t\tcase \"" + partnumber + "_" + swversion + "\":");
                sw.WriteLine("\t\t\treturnvalue.Enginetype = EngineType." + vINEngineType.ToString() + ";");
                sw.WriteLine("\t\t\treturnvalue.Carmodel = CarModel.Saab93;");
                sw.WriteLine("\t\t\treturnvalue.Softwareversion = \"" + swversion.Trim() + "\";");
                sw.WriteLine("\t\t\tbreak;");
                /*
                case "5380480":
                    returnvalue.Enginetype = EngineType.B207R;
                    returnvalue.Carmodel = CarModel.Saab93;
                    returnvalue.Softwareversion = "";
                    break;
                 * */
            }
        }

        private void AddToPartnumberCollectionFile(string partnumber, int my, string swversion)
        {
            using (StreamWriter sw = new StreamWriter(@"C:\T8PartnumberCollection.cs", true, System.Text.Encoding.Default))
            {
                sw.WriteLine("\t\tAddPartNumber(\"" + partnumber + "_" + swversion + "\", \"" + my.ToString() + "\");");
            }
        }

        private void btnVINDecoder_ItemClick(object sender, ItemClickEventArgs e)
        {
            frmDecodeVIN decode = new frmDecodeVIN();
            if (m_currentfile != string.Empty)
            {
                T8Header header = new T8Header();
                header.init(m_currentfile);
                decode.SetVinNumber(header.ChassisID);
            }
            decode.ShowDialog();
        }

        private void contextMenuStrip1_Opening(object sender, CancelEventArgs e)
        {
            if (gridViewSymbols.SelectedRowsCount > 0)
            {
                exportAsTuningPackageToolStripMenuItem.Enabled = true;
            }
            else
            {
                exportAsTuningPackageToolStripMenuItem.Enabled = false;
            }
            if (m_currentsramfile != "")
            {
                if (File.Exists(m_currentsramfile))
                {
                    readFromSRAMFileToolStripMenuItem.Enabled = true;
                }
                else
                {
                    readFromSRAMFileToolStripMenuItem.Enabled = false;
                }
            }
            else
            {
                readFromSRAMFileToolStripMenuItem.Enabled = false;
            }

        }

        private void exportAsTuningPackageToolStripMenuItem_Click(object sender, EventArgs e)
        {
            // export selected maps as tuning package (name the file t8p)
            // get selected rows
            int[] selectedrows = gridViewSymbols.GetSelectedRows();
            SymbolCollection scToExport = new SymbolCollection();
            if (selectedrows.Length > 0)
            {
                SaveFileDialog sfd = new SaveFileDialog();
                sfd.Filter = "Trionic 8 packages|*.t8p";
                if (sfd.ShowDialog() == DialogResult.OK)
                {
                    int grouplevel = gridViewSymbols.GetRowLevel((int)selectedrows.GetValue(0));
                    if (grouplevel >= gridViewSymbols.GroupCount)
                    {
                        int[] selrows = gridViewSymbols.GetSelectedRows();
                        if (selrows.Length > 0)
                        {
                            for (int i = 0; i < selrows.Length; i++)
                            {
                                SymbolHelper sh = (SymbolHelper)gridViewSymbols.GetRow((int)selrows.GetValue(i));
                                // make a copy?
                                scToExport.Add(sh);
                            }
                            PackageExporter pe = new PackageExporter();
                            pe.ExportPackage(scToExport, m_currentfile, sfd.FileName);
                        }

                    }
                }

            }
        }

        private void ImportTuningPackage()
        {
            OpenFileDialog ofd = new OpenFileDialog();
            ofd.Filter = "Trionic 8 packages|*.t8p";
            ofd.Multiselect = false;
            char[] sep = new char[1];
            sep.SetValue(',', 0);

            SymbolCollection scToImport = new SymbolCollection();
            System.Data.DataTable dt = new System.Data.DataTable();
            dt.Columns.Add("Map");
            dt.Columns.Add("Result");

            if (ofd.ShowDialog() == DialogResult.OK)
            {
                //TODO: create a list of maps to import .. maybe?
                using (StreamReader sr = new StreamReader(ofd.FileName))
                {
                    string line = string.Empty;
                    SymbolHelper sh_Import = new SymbolHelper();
                    while ((line = sr.ReadLine()) != null)
                    {
                        if (line.StartsWith("symbol="))
                        {
                            //
                            sh_Import = new SymbolHelper();
                            sh_Import.Varname = line.Replace("symbol=", "");
                        }
                        else if (line.StartsWith("length="))
                        {
                            sh_Import.Length = Convert.ToInt32(line.Replace("length=", ""));
                        }
                        else if (line.StartsWith("data="))
                        {
                            //
                            try
                            {
                                string dataBytes = line.Replace("data=", "");
                                // split using ','
                                string[] bytesInStrings = dataBytes.Split(sep);
                                byte[] dataToInsert = new byte[sh_Import.Length];
                                for (int t = 0; t < sh_Import.Length; t++)
                                {
                                    byte b = Convert.ToByte(bytesInStrings[t], 16);
                                    dataToInsert.SetValue(b, t);
                                }
                                int addressInFile = (int)GetSymbolAddress(m_symbols, sh_Import.Varname);
                                if (addressInFile > 0)
                                {
                                    savedatatobinary(addressInFile, sh_Import.Length, dataToInsert, m_currentfile, true);
                                    // add successful
                                    dt.Rows.Add(sh_Import.Varname, "Success");
                                }
                                else
                                {
                                    // add failure
                                    dt.Rows.Add(sh_Import.Varname, "Fail");
                                }
                            }
                            catch (Exception E)
                            {
                                // add failure
                                dt.Rows.Add(sh_Import.Varname, "Fail");
                                LogHelper.Log(E.Message);
                            }
                        }
                    }
                }
                UpdateChecksum(m_currentfile, true);
                frmImportResults res = new frmImportResults();
                res.SetDataTable(dt);
                res.ShowDialog();

            }
        }

        private void toolStripMenuItem2_Click(object sender, EventArgs e)
        {
            SymbolCollection scToExport = new SymbolCollection();
            SaveFileDialog sfd = new SaveFileDialog();
            sfd.Filter = "Trionic 8 packages|*.t8p";
            if (sfd.ShowDialog() == DialogResult.OK)
            {

                // add all relevant symbols to the export collection
                //SymbolHelper sh = new SymbolHelper();
                // must contain Varname, FlashAddress, Length, Userdescription

                AddToSymbolCollection(scToExport, "AirCtrlCal.PRatioMaxTab");
                AddToSymbolCollection(scToExport, "BstKnkCal.MaxAirmass");
                AddToSymbolCollection(scToExport, "BstKnkCal.MaxAirmassAu");
                AddToSymbolCollection(scToExport, "BFuelCal.TempEnrichFacMap");
                AddToSymbolCollection(scToExport, "BFuelCal.E85TempEnrichFacMap");
                AddToSymbolCollection(scToExport, "KnkFuelCal.EnrichmentMap");
                AddToSymbolCollection(scToExport, "KnkFuelCal.fi_OffsetEnrichEnable");
                AddToSymbolCollection(scToExport, "KnkFuelCal.fi_MaxOffsetMap");
                AddToSymbolCollection(scToExport, "IgnAbsCal.fi_highOctanMAP");
                AddToSymbolCollection(scToExport, "IgnAbsCal.fi_lowOctanMAP");
                AddToSymbolCollection(scToExport, "IgnAbsCal.fi_NormalMAP");
                AddToSymbolCollection(scToExport, "IgnAbsCal.fi_StartMAP");
                AddToSymbolCollection(scToExport, "DNCompCal.SlowDriveRelTAB");
                AddToSymbolCollection(scToExport, "TrqLimCal.Trq_ManGear");
                AddToSymbolCollection(scToExport, "TrqLimCal.Trq_MaxEngineManTab1");
                AddToSymbolCollection(scToExport, "TrqLimCal.Trq_MaxEngineAutTab1");
                AddToSymbolCollection(scToExport, "TrqLimCal.Trq_MaxEngineManTab2");
                AddToSymbolCollection(scToExport, "TrqLimCal.Trq_MaxEngineAutTab2");
                AddToSymbolCollection(scToExport, "TrqLimCal.Trq_OverBoostTab");
                AddToSymbolCollection(scToExport, "MaxEngSpdCal.n_EngMin");
                AddToSymbolCollection(scToExport, "TrqMastCal.Trq_NominalMap");
                AddToSymbolCollection(scToExport, "TrqMastCal.m_AirTorqMap");
                AddToSymbolCollection(scToExport, "TMCCal.Trq_MaxEngineTab");
                AddToSymbolCollection(scToExport, "TMCCal.Trq_MaxEngineLowTab");
                PackageExporter pe = new PackageExporter();
                pe.ExportPackage(scToExport, m_currentfile, sfd.FileName);
            }
        }
        private void AddToSymbolCollection(SymbolCollection scToExport, string symbolName)
        {
            foreach (SymbolHelper sh in m_symbols)
            {
                if (sh.Varname == symbolName || sh.Userdescription == symbolName)
                {
                    SymbolHelper shNew = new SymbolHelper();
                    shNew.Start_address = sh.Start_address;
                    shNew.Symbol_number = sh.Symbol_number;
                    shNew.Symbol_number_ECU = sh.Symbol_number_ECU;
                    shNew.Internal_address = sh.Internal_address;
                    shNew.Varname = symbolName;
                    shNew.Flash_start_address = sh.Flash_start_address;
                    shNew.Length = sh.Length;
                    shNew.Userdescription = symbolName;
                    scToExport.Add(shNew);
                    break;
                }
            }
        }

        private void EditTuningPackage()
        {
            OpenFileDialog ofd = new OpenFileDialog();
            ofd.Filter = "Trionic 8 packages|*.t8p";
            ofd.Multiselect = false;
            char[] sep = new char[1];
            sep.SetValue(',', 0);

            SymbolCollection scToImport = new SymbolCollection();
            System.Data.DataTable dt = new System.Data.DataTable();
            dt.Columns.Add("Map");
            dt.Columns.Add("Length");
            dt.Columns.Add("Data");

            if (ofd.ShowDialog() == DialogResult.OK)
            {
                //TODO: create a list of maps to import .. maybe?
                using (StreamReader sr = new StreamReader(ofd.FileName))
                {
                    string line = string.Empty;
                    SymbolHelper sh_Import = new SymbolHelper();
                    while ((line = sr.ReadLine()) != null)
                    {
                        if (line.StartsWith("symbol="))
                        {
                            //
                            sh_Import = new SymbolHelper();
                            sh_Import.Varname = line.Replace("symbol=", "");
                        }
                        else if (line.StartsWith("length="))
                        {
                            sh_Import.Length = Convert.ToInt32(line.Replace("length=", ""));
                        }
                        else if (line.StartsWith("data="))
                        {
                            //
                            try
                            {
                                string dataBytes = line.Replace("data=", "");
                                // split using ','
                                string[] bytesInStrings = dataBytes.Split(sep);
                                byte[] dataToInsert = new byte[sh_Import.Length];
                                for (int t = 0; t < sh_Import.Length; t++)
                                {
                                    byte b = Convert.ToByte(bytesInStrings[t], 16);
                                    dataToInsert.SetValue(b, t);
                                }
                                int addressInFile = (int)GetSymbolAddress(m_symbols, sh_Import.Varname);
                                if (addressInFile > 0)
                                {
                                    //savedatatobinary(addressInFile, sh_Import.Length, dataToInsert, m_currentfile, true);
                                    // add successful
                                    dt.Rows.Add(sh_Import.Varname, sh_Import.Length.ToString(), dataBytes);
                                }
                                else
                                {
                                    // add failure
                                    dt.Rows.Add(sh_Import.Varname, sh_Import.Length.ToString(), dataBytes);
                                }
                            }
                            catch (Exception E)
                            {
                                // add failure
                                dt.Rows.Add(sh_Import.Varname, sh_Import.Length.ToString(), "");
                                LogHelper.Log(E.Message);
                            }
                        }
                    }
                }
                frmEditTuningPackage edit = new frmEditTuningPackage();
                edit.FormClosed += new FormClosedEventHandler(edit_FormClosed);
                edit.SetDataTable(dt);
                edit.Show();

            }
        }
        void edit_FormClosed(object sender, FormClosedEventArgs e)
        {
            if (sender is frmEditTuningPackage)
            {
                frmEditTuningPackage edit = (frmEditTuningPackage)sender;
                if (edit.WriteData)
                {
                    // save the package again with altered settings probably.
                    //LogHelper.Log("We should write the tuning package here!");
                    SaveFileDialog sfd = new SaveFileDialog();
                    sfd.Filter = "Trionic 8 packages|*.t8p";
                    if (sfd.ShowDialog() == DialogResult.OK)
                    {
                        System.Data.DataTable dt = edit.GetDataTable();
                        SymbolCollection scToExport = new SymbolCollection();
                        foreach (DataRow dr in dt.Rows)
                        {
                            SymbolHelper sh = new SymbolHelper();
                            sh.Varname = dr["Map"].ToString();
                            sh.Flash_start_address = GetSymbolAddress(m_symbols, sh.Varname);
                            sh.Userdescription = GetUserDescription(m_symbols, sh.Varname);
                            sh.Length = GetSymbolLength(m_symbols, sh.Varname);
                            scToExport.Add(sh);

                        }
                        PackageExporter pe = new PackageExporter();
                        pe.ExportPackage(scToExport, m_currentfile, sfd.FileName);
                    }
                }
            }
        }
        private string GetUserDescription(SymbolCollection curSymbolCollection, string symbolname)
        {
            foreach (SymbolHelper sh in curSymbolCollection)
            {
                if (sh.Varname == symbolname || sh.Userdescription == symbolname)
                {
                    return sh.Userdescription;
                }
            }
            return symbolname;
        }

        private void toolStripMenuItem3_Click(object sender, EventArgs e)
        {
            EditTuningPackage();
        }

        private void btnImportTuningPackage_ItemClick(object sender, ItemClickEventArgs e)
        {
            ImportTuningPackage();
        }

        private void btnEditTuningPackage_ItemClick(object sender, ItemClickEventArgs e)
        {
            EditTuningPackage();
        }

        private string MakeDirName(string dirname)
        {
            string retval = dirname;
            retval = retval.Replace(@"\", "");
            retval = retval.Replace(@"/", "");
            retval = retval.Replace(@":", "");
            retval = retval.Replace(@"*", "");
            retval = retval.Replace(@"?", "");
            retval = retval.Replace(@">", "");
            retval = retval.Replace(@"<", "");
            retval = retval.Replace(@"|", "");
            return retval;
        }

        private TrionicTransactionLog m_ProjectTransactionLog;

        private void OpenProject(string projectname)
        {
            //TODO: Are there pending changes in the optionally currently opened binary file / project?

            //TODO: open a selected project
            //frmInfoBox info = new frmInfoBox("Opening project: " + projectname);
            if (Directory.Exists(m_appSettings.ProjectFolder + "\\" + projectname))
            {
                m_appSettings.LastOpenedType = 1;
                m_CurrentWorkingProject = projectname;
                m_ProjectLog.OpenProjectLog(m_appSettings.ProjectFolder + "\\" + projectname);
                //Load the binary file that comes with this project
                LoadBinaryForProject(projectname);
                if (m_currentfile != string.Empty)
                {
                    // transaction log <GS-15032010>
                    m_ProjectTransactionLog = new TrionicTransactionLog();
                    if (m_ProjectTransactionLog.OpenTransActionLog(m_appSettings.ProjectFolder, projectname))
                    {
                        m_ProjectTransactionLog.ReadTransactionFile();
                        //m_trionicFile.SetTransactionLog(m_ProjectTransactionLog);
                        if (m_ProjectTransactionLog.TransCollection.Count > 2000)
                        {
                            frmProjectTransactionPurge frmPurge = new frmProjectTransactionPurge();
                            frmPurge.SetNumberOfTransactions(m_ProjectTransactionLog.TransCollection.Count);
                            if (frmPurge.ShowDialog() == DialogResult.OK)
                            {
                                m_ProjectTransactionLog.Purge();
                            }
                        }
                    }
                    // transaction log <GS-15032010>
                    btnCloseProject.Enabled = true;
                    btnAddNoteToProjectLog.Enabled = true;
                    btnEditProject.Enabled = true;
                    btnShowProjectLogbook.Enabled = true;
                    btnProduceLatestBinary.Enabled = true;
                    //btncreateb                    
                    btnRebuildFile.Enabled = true;
                    CreateProjectBackupFile();
                    UpdateRollbackForwardControls();
                    m_appSettings.Lastprojectname = m_CurrentWorkingProject;
                    this.Text = "T8SuitePro [Project: " + projectname + "]";
                }
            }
        }

        private void UpdateRollbackForwardControls()
        {
            btnRollback.Enabled = false;
            btnRollforward.Enabled = false;
            btnShowTransactionLog.Enabled = false;

            for (int t = m_ProjectTransactionLog.TransCollection.Count - 1; t >= 0; t--)
            {
                if (!btnShowTransactionLog.Enabled) btnShowTransactionLog.Enabled = true;
                if (m_ProjectTransactionLog.TransCollection[t].IsRolledBack)
                {
                    btnRollforward.Enabled = true;
                }
                else
                {
                    btnRollback.Enabled = true;
                }
            }
        }

        private void CreateProjectBackupFile()
        {
            // create a backup file automatically! <GS-16032010>
            if (!Directory.Exists(m_appSettings.ProjectFolder + "\\" + m_CurrentWorkingProject + "\\Backups")) Directory.CreateDirectory(m_appSettings.ProjectFolder + "\\" + m_CurrentWorkingProject + "\\Backups");
            string filename = m_appSettings.ProjectFolder + "\\" + m_CurrentWorkingProject + "\\Backups\\" + Path.GetFileNameWithoutExtension(GetBinaryForProject(m_CurrentWorkingProject)) + "-backup-" + DateTime.Now.ToString("MMddyyyyHHmmss") + ".BIN";
            File.Copy(GetBinaryForProject(m_CurrentWorkingProject), filename);
            if (m_CurrentWorkingProject != string.Empty)
            {
                m_ProjectLog.WriteLogbookEntry(LogbookEntryType.BackupfileCreated, filename);
            }


        }


        private void LoadBinaryForProject(string projectname)
        {
            if (File.Exists(m_appSettings.ProjectFolder + "\\" + projectname + "\\projectproperties.xml"))
            {
                System.Data.DataTable projectprops = new System.Data.DataTable("T5PROJECT");
                projectprops.Columns.Add("CARMAKE");
                projectprops.Columns.Add("CARMODEL");
                projectprops.Columns.Add("CARMY");
                projectprops.Columns.Add("CARVIN");
                projectprops.Columns.Add("NAME");
                projectprops.Columns.Add("BINFILE");
                projectprops.Columns.Add("VERSION");
                projectprops.ReadXml(m_appSettings.ProjectFolder + "\\" + projectname + "\\projectproperties.xml");
                // valid project, add it to the list
                if (projectprops.Rows.Count > 0)
                {
                    m_currentfile = projectprops.Rows[0]["BINFILE"].ToString();//Application.StartupPath + "\\55559437  81f.bin";
                    int symboltableoffset = 0;

                    TryToOpenFile(projectprops.Rows[0]["BINFILE"].ToString(), out m_symbols, m_currentfile_size);

                    Text = String.Format("T8SuitePro v{0} [ {1} ]", System.Windows.Forms.Application.ProductVersion, Path.GetFileName(m_currentfile));
                    barFilenameText.Caption = Path.GetFileName(m_currentfile);
                    gridControlSymbols.DataSource = m_symbols;
                    m_appSettings.Lastfilename = m_currentfile;
                    gridViewSymbols.BestFitColumns();
                    UpdateChecksum(m_currentfile, m_appSettings.AutoChecksum);

                    //OpenWorkingFile(projectprops.Rows[0]["BINFILE"].ToString());
                }
            }
        }

        private string GetBinaryForProject(string projectname)
        {
            string retval = m_currentfile;
            if (File.Exists(m_appSettings.ProjectFolder + "\\" + projectname + "\\projectproperties.xml"))
            {
                System.Data.DataTable projectprops = new System.Data.DataTable("T5PROJECT");
                projectprops.Columns.Add("CARMAKE");
                projectprops.Columns.Add("CARMODEL");
                projectprops.Columns.Add("CARMY");
                projectprops.Columns.Add("CARVIN");
                projectprops.Columns.Add("NAME");
                projectprops.Columns.Add("BINFILE");
                projectprops.Columns.Add("VERSION");
                projectprops.ReadXml(m_appSettings.ProjectFolder + "\\" + projectname + "\\projectproperties.xml");
                // valid project, add it to the list
                if (projectprops.Rows.Count > 0)
                {
                    retval = projectprops.Rows[0]["BINFILE"].ToString();
                }
            }
            return retval;
        }

        private string GetBackupOlderThanDateTime(string project, DateTime mileDT)
        {
            string retval = m_currentfile; // default = current file
            string BackupPath = m_appSettings.ProjectFolder + "\\" + project + "\\Backups";
            DateTime MaxDateTime = DateTime.MinValue;
            string foundBackupfile = string.Empty;
            if (Directory.Exists(BackupPath))
            {
                string[] backupfiles = Directory.GetFiles(BackupPath, "*.bin");
                foreach (string backupfile in backupfiles)
                {
                    FileInfo fi = new FileInfo(backupfile);
                    if (fi.LastAccessTime > MaxDateTime && fi.LastAccessTime <= mileDT)
                    {
                        MaxDateTime = fi.LastAccessTime;
                        foundBackupfile = backupfile;
                    }
                }
            }
            if (foundBackupfile != string.Empty)
            {
                retval = foundBackupfile;
            }
            return retval;
        }

        private void btnCreateNewProject_ItemClick(object sender, ItemClickEventArgs e)
        {
            // show the project properties screen for the user to fill in
            // if a bin file is loaded, ask the user whether this should be the new projects binary file
            // the project XML should contain a reference to this binfile as well as a lot of other stuff
            frmProjectProperties projectprops = new frmProjectProperties();
            if (m_currentfile != string.Empty)
            {
                projectprops.BinaryFile = m_currentfile;
                T8Header fileheader = new T8Header();
                fileheader.init(m_currentfile);
                projectprops.CarModel = fileheader.CarDescription.Trim();

                projectprops.ProjectName = fileheader.PartNumber.Trim() + " " + fileheader.SoftwareVersion.Trim();
            }
            if (projectprops.ShowDialog() == DialogResult.OK)
            {
                if (!Directory.Exists(m_appSettings.ProjectFolder)) Directory.CreateDirectory(m_appSettings.ProjectFolder);
                // create a new folder with these project properties.
                // also copy the binary file into the subfolder for this project
                if (Directory.Exists(m_appSettings.ProjectFolder + "\\" + MakeDirName(projectprops.ProjectName)))
                {
                    frmInfoBox info = new frmInfoBox("The chosen projectname already exists, please choose another one");
                    //TODO: reshow the dialog
                }
                else
                {
                    // create the project
                    Directory.CreateDirectory(m_appSettings.ProjectFolder + "\\" + MakeDirName(projectprops.ProjectName));
                    // copy the selected binary file to this folder
                    string binfilename = m_appSettings.ProjectFolder + "\\" + MakeDirName(projectprops.ProjectName) + "\\" + Path.GetFileName(projectprops.BinaryFile);
                    File.Copy(projectprops.BinaryFile, binfilename);
                    // now create the projectproperties.xml in this new folder
                    System.Data.DataTable dtProps = new System.Data.DataTable("T5PROJECT");
                    dtProps.Columns.Add("CARMAKE");
                    dtProps.Columns.Add("CARMODEL");
                    dtProps.Columns.Add("CARMY");
                    dtProps.Columns.Add("CARVIN");
                    dtProps.Columns.Add("NAME");
                    dtProps.Columns.Add("BINFILE");
                    dtProps.Columns.Add("VERSION");
                    dtProps.Rows.Add(projectprops.CarMake, projectprops.CarModel, projectprops.CarMY, projectprops.CarVIN, MakeDirName(projectprops.ProjectName), binfilename, projectprops.Version);
                    dtProps.WriteXml(m_appSettings.ProjectFolder + "\\" + MakeDirName(projectprops.ProjectName) + "\\projectproperties.xml");
                    OpenProject(projectprops.ProjectName); //?
                }
            }
        }

        private void btnOpenProject_ItemClick(object sender, ItemClickEventArgs e)
        {
            //TODO let the user select a project from the Project folder. If none are present, let the user know
            if (!Directory.Exists(m_appSettings.ProjectFolder)) Directory.CreateDirectory(m_appSettings.ProjectFolder);
            System.Data.DataTable ValidProjects = new System.Data.DataTable();
            ValidProjects.Columns.Add("Projectname");
            ValidProjects.Columns.Add("NumberBackups");
            ValidProjects.Columns.Add("NumberTransactions");
            ValidProjects.Columns.Add("DateTimeModified");
            ValidProjects.Columns.Add("Version");
            string[] projects = Directory.GetDirectories(m_appSettings.ProjectFolder);
            // filter for folders with a projectproperties.xml file
            foreach (string project in projects)
            {
                string[] projectfiles = Directory.GetFiles(project, "projectproperties.xml");

                if (projectfiles.Length > 0)
                {
                    System.Data.DataTable projectprops = new System.Data.DataTable("T5PROJECT");
                    projectprops.Columns.Add("CARMAKE");
                    projectprops.Columns.Add("CARMODEL");
                    projectprops.Columns.Add("CARMY");
                    projectprops.Columns.Add("CARVIN");
                    projectprops.Columns.Add("NAME");
                    projectprops.Columns.Add("BINFILE");
                    projectprops.Columns.Add("VERSION");
                    projectprops.ReadXml((string)projectfiles.GetValue(0));
                    // valid project, add it to the list
                    if (projectprops.Rows.Count > 0)
                    {
                        string projectName = projectprops.Rows[0]["NAME"].ToString();
                        ValidProjects.Rows.Add(projectName, GetNumberOfBackups(projectName), GetNumberOfTransactions(projectName), GetLastAccessTime(projectprops.Rows[0]["BINFILE"].ToString()), projectprops.Rows[0]["VERSION"].ToString());
                    }
                }
            }
            if (ValidProjects.Rows.Count > 0)
            {
                frmProjectSelection projselection = new frmProjectSelection();
                projselection.SetDataSource(ValidProjects);
                if (projselection.ShowDialog() == DialogResult.OK)
                {
                    string selectedproject = projselection.GetProjectName();
                    if (selectedproject != "")
                    {
                        OpenProject(selectedproject);
                    }

                }
            }
            else
            {
                frmInfoBox info = new frmInfoBox("No projects were found, please create one first!");
            }
        }

        private int GetNumberOfBackups(string project)
        {
            int retval = 0;
            string dirname = m_appSettings.ProjectFolder + "\\" + project + "\\Backups";
            if (!Directory.Exists(dirname)) Directory.CreateDirectory(dirname);
            string[] backupfiles = Directory.GetFiles(dirname, "*.bin");
            retval = backupfiles.Length;
            return retval;
        }

        private int GetNumberOfTransactions(string project)
        {
            int retval = 0;
            string filename = m_appSettings.ProjectFolder + "\\" + project + "\\TransActionLogV2.ttl";
            if (File.Exists(filename))
            {
                TrionicTransactionLog translog = new TrionicTransactionLog();
                translog.OpenTransActionLog(m_appSettings.ProjectFolder, project);
                translog.ReadTransactionFile();
                retval = translog.TransCollection.Count;
            }
            return retval;
        }

        private DateTime GetLastAccessTime(string filename)
        {
            DateTime retval = DateTime.MinValue;
            if (File.Exists(filename))
            {
                FileInfo fi = new FileInfo(filename);
                retval = fi.LastAccessTime;
            }
            return retval;
        }

        private void CloseProject()
        {
            /*if (_ecuConnection.Opened) StopOnlineMode();// StopECUConnection();
            if (m_CurrentWorkingProject != "")
            {
                if (m_AFRMaps != null)
                {
                    m_AFRMaps.SaveMaps();
                }
            }*/

            m_CurrentWorkingProject = string.Empty;
            // unload the current file
            m_currentfile = string.Empty;
            gridControlSymbols.DataSource = null;
            barFilenameText.Caption = "No file";
            //barButtonItem4.Enabled = false;
            m_appSettings.Lastfilename = string.Empty;
            btnCloseProject.Enabled = false;
            btnShowProjectLogbook.Enabled = false;
            btnProduceLatestBinary.Enabled = false;
            btnAddNoteToProjectLog.Enabled = false;
            btnEditProject.Enabled = false;

            btnRebuildFile.Enabled = false;
            btnRollback.Enabled = false;
            btnRollforward.Enabled = false;
            btnShowTransactionLog.Enabled = false;
            this.Text = "T8SuitePro";
        }

        private void btnCloseProject_ItemClick(object sender, ItemClickEventArgs e)
        {
            CloseProject();
            m_appSettings.Lastprojectname = "";
        }

        private void btnShowTransactionLog_ItemClick(object sender, ItemClickEventArgs e)
        {
            // show new form
            if (m_CurrentWorkingProject != string.Empty)
            {
                frmTransactionLog translog = new frmTransactionLog();
                translog.onRollBack += new frmTransactionLog.RollBack(translog_onRollBack);
                translog.onRollForward += new frmTransactionLog.RollForward(translog_onRollForward);
                translog.onNoteChanged += new frmTransactionLog.NoteChanged(translog_onNoteChanged);
                foreach (TransactionEntry entry in m_ProjectTransactionLog.TransCollection)
                {
                    entry.SymbolName = GetSymbolNameByAddress(entry.SymbolAddress);

                }
                translog.SetTransactionLog(m_ProjectTransactionLog);
                translog.Show();
            }
        }

        void translog_onNoteChanged(object sender, frmTransactionLog.RollInformationEventArgs e)
        {
            m_ProjectTransactionLog.SetEntryNote(e.Entry);
        }

        void translog_onRollForward(object sender, frmTransactionLog.RollInformationEventArgs e)
        {
            // alter the log!
            // rollback the transaction
            // now reload the list
            RollForward(e.Entry);
            if (sender is frmTransactionLog)
            {
                frmTransactionLog logfrm = (frmTransactionLog)sender;
                logfrm.SetTransactionLog(m_ProjectTransactionLog);
            }
        }

        private void RollForward(TransactionEntry entry)
        {
            int addressToWrite = entry.SymbolAddress;
            while (addressToWrite > m_currentfile_size) addressToWrite -= m_currentfile_size;
            savedatatobinary(addressToWrite, entry.SymbolLength, entry.DataAfter, m_currentfile, false);
            UpdateChecksum(m_currentfile, true);
            //m_trionicFile.WriteDataNoLog(entry.DataAfter, (uint)addressToWrite);
            m_ProjectTransactionLog.SetEntryRolledForward(entry.TransactionNumber);
            if (m_CurrentWorkingProject != string.Empty)
            {

                m_ProjectLog.WriteLogbookEntry(LogbookEntryType.TransactionRolledforward, GetSymbolNameByAddress(entry.SymbolAddress) + " " + entry.Note + " " + entry.TransactionNumber.ToString());
            }

            UpdateRollbackForwardControls();
        }

        void translog_onRollBack(object sender, frmTransactionLog.RollInformationEventArgs e)
        {
            // alter the log!
            // rollback the transaction
            RollBack(e.Entry);
            // now reload the list
            if (sender is frmTransactionLog)
            {
                frmTransactionLog logfrm = (frmTransactionLog)sender;
                logfrm.SetTransactionLog(m_ProjectTransactionLog);
            }
        }

        private void SignalTransactionLogChanged(int SymbolAddress, string Note)
        {
            UpdateRollbackForwardControls();
            // should contain the new info as well
            // <GS-18032010> insert logbook entry here if project is opened
            if (m_CurrentWorkingProject != string.Empty)
            {
                m_ProjectLog.WriteLogbookEntry(LogbookEntryType.TransactionExecuted, GetSymbolNameByAddress(SymbolAddress) + " " + Note);
            }
        }

        private string GetSymbolNameByAddress(Int32 address)
        {
            foreach (SymbolHelper sh in m_symbols)
            {
                if (sh.Flash_start_address == address) return sh.Varname;
            }
            return address.ToString();
        }

        private void RollBack(TransactionEntry entry)
        {
            int addressToWrite = entry.SymbolAddress;
            while (addressToWrite > m_currentfile_size) addressToWrite -= m_currentfile_size;
            //m_trionicFile.WriteDataNoLog(entry.DataBefore, (uint)addressToWrite);
            savedatatobinary(addressToWrite, entry.SymbolLength, entry.DataBefore, m_currentfile, false);
            UpdateChecksum(m_currentfile, true);
            m_ProjectTransactionLog.SetEntryRolledBack(entry.TransactionNumber);
            if (m_CurrentWorkingProject != string.Empty)
            {
                m_ProjectLog.WriteLogbookEntry(LogbookEntryType.TransactionRolledback, GetSymbolNameByAddress(entry.SymbolAddress) + " " + entry.Note + " " + entry.TransactionNumber.ToString());
            }

            UpdateRollbackForwardControls();
        }

        private void btnRollback_ItemClick(object sender, ItemClickEventArgs e)
        {
            //roll back last entry in the log that has not been rolled back
            for (int t = m_ProjectTransactionLog.TransCollection.Count - 1; t >= 0; t--)
            {
                if (!m_ProjectTransactionLog.TransCollection[t].IsRolledBack)
                {
                    RollBack(m_ProjectTransactionLog.TransCollection[t]);

                    break;
                }
            }
        }

        private void btnRollforward_ItemClick(object sender, ItemClickEventArgs e)
        {
            //roll back last entry in the log that has not been rolled back
            for (int t = 0; t < m_ProjectTransactionLog.TransCollection.Count; t++)
            {
                if (m_ProjectTransactionLog.TransCollection[t].IsRolledBack)
                {
                    RollForward(m_ProjectTransactionLog.TransCollection[t]);

                    break;
                }
            }
        }

        private void btnRebuildFile_ItemClick(object sender, ItemClickEventArgs e)
        {
            // show the transactionlog again and ask the user upto what datetime he wants to rebuild the file
            // first ask a datetime
            frmRebuildFileParameters filepar = new frmRebuildFileParameters();
            if (filepar.ShowDialog() == DialogResult.OK)
            {

                // get the last backup that is older than the selected datetime
                string file2Process = GetBackupOlderThanDateTime(m_CurrentWorkingProject, filepar.SelectedDateTime);
                // now rebuild the file
                // first create a copy of this file
                string tempRebuildFile = m_appSettings.ProjectFolder + "\\" + m_CurrentWorkingProject + "rebuild.bin";
                if (File.Exists(tempRebuildFile))
                {
                    File.Delete(tempRebuildFile);
                }
                // CREATE A BACKUP FILE HERE
                CreateProjectBackupFile();
                File.Copy(file2Process, tempRebuildFile);
                // now do all the transactions newer than this file and older than the selected date time
                //IECUFile m_RebuildFile = new Trionic5File();
                //m_RebuildFile.LibraryPath = Application.StartupPath + "\\Binaries";

                //IECUFileInformation m_RebuildFileInformation = new Trionic5FileInformation();

                //m_RebuildFile.SelectFile(tempRebuildFile);
                //m_RebuildFileInformation = m_RebuildFile.ParseFile();
                FileInfo fi = new FileInfo(file2Process);
                foreach (TransactionEntry te in m_ProjectTransactionLog.TransCollection)
                {
                    if (te.EntryDateTime >= fi.LastAccessTime && te.EntryDateTime <= filepar.SelectedDateTime)
                    {
                        // apply this change
                        RollForwardOnFile(tempRebuildFile, te);
                    }
                }
                // rename/copy file
                if (filepar.UseAsNewProjectFile)
                {
                    // just delete the current file
                    File.Delete(m_currentfile);
                    File.Copy(tempRebuildFile, m_currentfile);
                    File.Delete(tempRebuildFile);
                    // done
                }
                else
                {
                    // ask for destination file
                    SaveFileDialog sfd = new SaveFileDialog();
                    sfd.Title = "Save rebuild file as...";
                    sfd.Filter = "Binary files|*.bin";
                    if (sfd.ShowDialog() == DialogResult.OK)
                    {
                        if (File.Exists(sfd.FileName)) File.Delete(sfd.FileName);
                        File.Copy(tempRebuildFile, sfd.FileName);
                        File.Delete(tempRebuildFile);
                    }
                }
                if (m_CurrentWorkingProject != string.Empty)
                {
                    m_ProjectLog.WriteLogbookEntry(LogbookEntryType.ProjectFileRecreated, "Reconstruct upto " + filepar.SelectedDateTime.ToString("dd/MM/yyyy") + " selected file " + file2Process);
                }
                UpdateRollbackForwardControls();
            }
        }

        private void RollForwardOnFile(string file2Rollback, TransactionEntry entry)
        {
            FileInfo fi = new FileInfo(file2Rollback);
            int addressToWrite = entry.SymbolAddress;
            while (addressToWrite > fi.Length) addressToWrite -= (int)fi.Length;
            savedatatobinary(addressToWrite, entry.SymbolLength, entry.DataAfter, file2Rollback, false);
            UpdateChecksum(m_currentfile, true);
        }

        private void btnEditProject_ItemClick(object sender, ItemClickEventArgs e)
        {
            if (m_CurrentWorkingProject != string.Empty)
            {
                EditProjectProperties(m_CurrentWorkingProject);
            }
        }

        private void EditProjectProperties(string project)
        {
            // edit current project properties
            System.Data.DataTable projectprops = new System.Data.DataTable("T5PROJECT");
            projectprops.Columns.Add("CARMAKE");
            projectprops.Columns.Add("CARMODEL");
            projectprops.Columns.Add("CARMY");
            projectprops.Columns.Add("CARVIN");
            projectprops.Columns.Add("NAME");
            projectprops.Columns.Add("BINFILE");
            projectprops.Columns.Add("VERSION");
            projectprops.ReadXml(m_appSettings.ProjectFolder + "\\" + project + "\\projectproperties.xml");

            frmProjectProperties projectproperties = new frmProjectProperties();
            projectproperties.Version = projectprops.Rows[0]["VERSION"].ToString();
            projectproperties.ProjectName = projectprops.Rows[0]["NAME"].ToString();
            projectproperties.CarMake = projectprops.Rows[0]["CARMAKE"].ToString();
            projectproperties.CarModel = projectprops.Rows[0]["CARMODEL"].ToString();
            projectproperties.CarVIN = projectprops.Rows[0]["CARVIN"].ToString();
            projectproperties.CarMY = projectprops.Rows[0]["CARMY"].ToString();
            projectproperties.BinaryFile = projectprops.Rows[0]["BINFILE"].ToString();
            bool _reopenProject = false;
            if (projectproperties.ShowDialog() == DialogResult.OK)
            {
                // delete the original XML file
                if (project != projectproperties.ProjectName)
                {
                    Directory.Move(m_appSettings.ProjectFolder + "\\" + project, m_appSettings.ProjectFolder + "\\" + projectproperties.ProjectName);
                    project = projectproperties.ProjectName;
                    m_CurrentWorkingProject = project;
                    // set the working file to the correct folder
                    projectproperties.BinaryFile = Path.Combine(m_appSettings.ProjectFolder + "\\" + project, Path.GetFileName(projectprops.Rows[0]["BINFILE"].ToString()));
                    _reopenProject = true;
                    // open this project

                }

                File.Delete(m_appSettings.ProjectFolder + "\\" + project + "\\projectproperties.xml");
                System.Data.DataTable dtProps = new System.Data.DataTable("T5PROJECT");
                dtProps.Columns.Add("CARMAKE");
                dtProps.Columns.Add("CARMODEL");
                dtProps.Columns.Add("CARMY");
                dtProps.Columns.Add("CARVIN");
                dtProps.Columns.Add("NAME");
                dtProps.Columns.Add("BINFILE");
                dtProps.Columns.Add("VERSION");
                dtProps.Rows.Add(projectproperties.CarMake, projectproperties.CarModel, projectproperties.CarMY, projectproperties.CarVIN, MakeDirName(projectproperties.ProjectName), projectproperties.BinaryFile, projectproperties.Version);
                dtProps.WriteXml(m_appSettings.ProjectFolder + "\\" + MakeDirName(projectproperties.ProjectName) + "\\projectproperties.xml");
                if (_reopenProject)
                {
                    OpenProject(m_CurrentWorkingProject);
                }
                m_ProjectLog.WriteLogbookEntry(LogbookEntryType.PropertiesEdited, projectproperties.Version);

            }

        }

        private void btnAddNoteToProjectLog_ItemClick(object sender, ItemClickEventArgs e)
        {
            frmChangeNote newNote = new frmChangeNote();
            newNote.ShowDialog();
            if (newNote.Note != string.Empty)
            {
                if (m_CurrentWorkingProject != string.Empty)
                {
                    m_ProjectLog.WriteLogbookEntry(LogbookEntryType.Note, newNote.Note);
                }
            }
        }

        private void btnShowProjectLogbook_ItemClick(object sender, ItemClickEventArgs e)
        {
            if (m_CurrentWorkingProject != string.Empty)
            {
                frmProjectLogbook logb = new frmProjectLogbook();

                logb.LoadLogbookForProject(m_appSettings.ProjectFolder, m_CurrentWorkingProject);
                logb.Show();
            }
        }

        private void btnProduceLatestBinary_ItemClick(object sender, ItemClickEventArgs e)
        {
            // save binary as
            SaveFileDialog sfd = new SaveFileDialog();
            sfd.Filter = "Binary files|*.bin";
            if (sfd.ShowDialog() == DialogResult.OK)
            {
                // copy the current project file to the selected destination
                File.Copy(m_currentfile, sfd.FileName, true);
            }
        }

        private bool _isMouseDown = false;

        private void gridViewSymbols_DragObjectStart(object sender, DevExpress.XtraGrid.Views.Base.DragObjectStartEventArgs e)
        {
            LogHelper.Log("Start dragging: " + e.DragObject.ToString());
            _isMouseDown = true;
        }

        private void gridControlSymbols_MouseDown(object sender, MouseEventArgs e)
        {
            _isMouseDown = true;
        }

        private void gridControlSymbols_MouseUp(object sender, MouseEventArgs e)
        {
            _isMouseDown = false;
        }

        private void gridControlSymbols_MouseLeave(object sender, EventArgs e)
        {
            _isMouseDown = false;
        }

        private void btnReleaseNotes_ItemClick(object sender, ItemClickEventArgs e)
        {
            StartReleaseNotesViewer(m_msiUpdater.GetReleaseNotes(), System.Windows.Forms.Application.ProductVersion.ToString());
        }

        private string m_swversion = string.Empty;

        private void btnToggleRealtime_ItemClick(object sender, ItemClickEventArgs e)
        {
            // start realtime mode
            if (dockRealtime.Visibility == DockVisibility.Visible)
            {
                dockRealtime.Visibility = DockVisibility.Hidden;
                tmrRealtime.Enabled = false;
                m_enableRealtimeTimer = false;
                barConnectedECUName.Caption = string.Empty;
                if (t8can.isOpen())
                    t8can.Cleanup();
            }
            else
            {
                SetCanAdapter();
                #if (DEBUG)
                t8can.EnableLog = true;
                #endif
                if (!t8can.isOpen())
                {
                    t8can.openDevice(true);
                }
                if (t8can.isOpen())
                {
                    // whatever
                    // get the software version from the ECU
                    if (m_swversion == string.Empty) // not yet connected
                    {
                        m_realtimeAddresses = new System.Data.DataTable();
                        m_realtimeAddresses.Columns.Add("SymbolName");
                        m_realtimeAddresses.Columns.Add("SymbolNumber", System.Type.GetType("System.Int32"));
                        m_realtimeAddresses.Columns.Add("VarName");

                        m_swversion = t8can.GetSoftwareVersion();
                        //LogHelper.Log("Version: " + m_swversion);
                        LogHelper.Log("***");
                        for (int i = 0; i < m_swversion.Length; i++)
                        {
                            Console.Write(Convert.ToByte(m_swversion[i]).ToString("X2") + " ");
                        }
                        LogHelper.Log("***");
                        barConnectedECUName.Caption = m_swversion;

                        // fill realtime table
                    }
                    if (m_appSettings.ResetRealtimeSymbolOnTabPageSwitch)
                    {
                        FillRealtimeTable(MonitorType.Dashboard); // default
                    }
                    dockRealtime.Visibility = DockVisibility.Visible;
                    int width = dockManager1.Form.ClientSize.Width - dockSymbols.Width;
                    int height = dockManager1.Form.ClientSize.Height;
                    if (width > 660) width = 660;

                    dockRealtime.Dock = DockingStyle.Left;
                    dockRealtime.Width = width;
                    // set default skin
                    SwitchRealtimePanelMode(m_appSettings.Panelmode);
                    m_connectedToECU = true;
                    tmrRealtime.Enabled = true;
                    m_enableRealtimeTimer = true;
                }
            }
        }

        private void btnSRAMSnapshot_ItemClick(object sender, ItemClickEventArgs e)
        {
            SaveFileDialog sfd = new SaveFileDialog();
            sfd.Filter = "Snapshots|*.RAM";
            if (sfd.ShowDialog() == DialogResult.OK)
            {
                SetCanAdapter();
                SetProgress("Starting snapshot download");
                if (!t8can.isOpen())
                {
                    t8can.openDevice(false);
                }
                if (t8can.isOpen())
                {

                    m_prohibitReading = true;
                    byte[] snapshot = t8can.ReadSRAMSnapshot();
                    File.WriteAllBytes(sfd.FileName, snapshot);
                    frmInfoBox info = new frmInfoBox("Snapshot done");
                    m_prohibitReading = false;
                    SetProgressIdle();
                }
            }
        }

        private void SetCanAdapter()
        {
            t8can.OnlyPBus = m_appSettings.OnlyPBus;
            if (m_appSettings.CANBusAdapterType == CANBusAdapter.Lawicel)
            {
                t8can.setCANDevice(TrionicCANLib.CANBusAdapter.LAWICEL);
            }
            else if (m_appSettings.CANBusAdapterType == CANBusAdapter.MultiAdapter)
            {
                t8can.setCANDevice(TrionicCANLib.CANBusAdapter.COMBI);
            }
            else if (m_appSettings.CANBusAdapterType == CANBusAdapter.ELM327)
            {
                t8can.ForcedComport = m_appSettings.ELM327Port;
                t8can.ForcedBaudrate = m_appSettings.Baudrate;
                t8can.setCANDevice(TrionicCANLib.CANBusAdapter.ELM327);
            }
            else if (m_appSettings.CANBusAdapterType == CANBusAdapter.Just4Trionic)
            {
                t8can.setCANDevice(TrionicCANLib.CANBusAdapter.JUST4TRIONIC);
            }
        }

        private string GetLogWorksFromRegistry()
        {
            RegistryKey TempKey = null;
            string foundvalue = string.Empty;
            TempKey = Registry.LocalMachine;

            using (RegistryKey Settings = TempKey.OpenSubKey("SOFTWARE\\Classes\\d32FileHandler\\Shell\\Open\\Command"))
            {
                if (Settings != null)
                {
                    string[] vals = Settings.GetValueNames();
                    foreach (string a in vals)
                    {
                        try
                        {
                            foundvalue = Settings.GetValue(a).ToString();
                        }
                        catch (Exception E)
                        {
                            LogHelper.Log(E.Message);
                        }
                    }
                }
            }

            if (foundvalue == string.Empty)
            {
                using (RegistryKey Settings = TempKey.OpenSubKey("SOFTWARE\\Classes\\Applications\\LogWorks2.exe\\shell\\Open\\Command"))
                {
                    if (Settings != null)
                    {
                        string[] vals = Settings.GetValueNames();
                        foreach (string a in vals)
                        {
                            try
                            {
                                foundvalue = Settings.GetValue(a).ToString();
                            }
                            catch (Exception E)
                            {
                                LogHelper.Log(E.Message);
                            }
                        }
                    }
                }
            }
            return foundvalue;
        }

        private void btnExportToLogWorks_ItemClick(object sender, ItemClickEventArgs e)
        {

            OpenFileDialog ofd = new OpenFileDialog();
            ofd.Filter = "Trionic 8 logfiles|*.t8l";
            ofd.Title = "Open CAN bus logfile";
            ofd.Multiselect = false;
            string logworksstring = GetLogWorksFromRegistry();
            if (logworksstring == string.Empty)
            {
                if (MessageBox.Show("Logworks is not installed on this computer, do you wish to install it now?", "Question", MessageBoxButtons.YesNo) == DialogResult.Yes)
                {
                    Process.Start(System.Windows.Forms.Application.StartupPath + "\\LogWorks\\LogWorks3Setup.exe");
                }
            }
            else if (ofd.ShowDialog() == DialogResult.OK)
            {
                //                OpenAndDisplayLogFile(ofd.FileName);
                ConvertFileToDif(ofd.FileName, false); // TEST

            }

        }

        private void ConvertFileToDif(string filename, bool AutoExport)
        {
            System.Windows.Forms.Application.DoEvents();
            DateTime startDate = DateTime.MaxValue;
            DateTime endDate = DateTime.MinValue;
            try
            {
                SymbolCollection sc = new SymbolCollection();
                string[] alllines = File.ReadAllLines(filename);
                //using (StreamReader sr = new StreamReader(filename))
                {
                    //string line = string.Empty;
                    char[] sep = new char[1];
                    char[] sep2 = new char[1];
                    //int linecount = 0;
                    sep.SetValue('|', 0);
                    sep2.SetValue('=', 0);
                    //while ((line = sr.ReadLine()) != null)

                    foreach (string line in alllines)
                    {
                        string[] values = line.Split(sep);
                        if (values.Length > 0)
                        {
                            try
                            {
                                //dd/MM/yyyy HH:mm:ss
                                //string logline = DateTime.Now.ToString("dd/MM/yyyy HH:mm:ss") + "|";

                                string dtstring = (string)values.GetValue(0);
                                DateTime dt = new DateTime(Convert.ToInt32(dtstring.Substring(6, 4)), Convert.ToInt32(dtstring.Substring(3, 2)), Convert.ToInt32(dtstring.Substring(0, 2)), Convert.ToInt32(dtstring.Substring(11, 2)), Convert.ToInt32(dtstring.Substring(14, 2)), Convert.ToInt32(dtstring.Substring(17, 2)));
                                if (dt > endDate) endDate = dt;
                                if (dt < startDate) startDate = dt;
                                for (int t = 1; t < values.Length; t++)
                                {
                                    string subvalue = (string)values.GetValue(t);
                                    string[] subvals = subvalue.Split(sep2);
                                    if (subvals.Length == 2)
                                    {
                                        string varname = (string)subvals.GetValue(0);
                                        bool sfound = false;
                                        foreach (SymbolHelper sh in sc)
                                        {
                                            if (sh.Varname == varname || sh.Userdescription == varname)
                                            {
                                                sfound = true;
                                            }
                                        }
                                        SymbolHelper nsh = new SymbolHelper();
                                        nsh.Varname = varname;
                                        if (!sfound) sc.Add(nsh);
                                    }
                                }
                            }
                            catch (Exception pE)
                            {
                                LogHelper.Log(pE.Message);
                            }
                        }
                    }
                }

                if (AutoExport)
                {
                    foreach (SymbolHelper sh in sc)
                    {
                        sh.Color = GetColorFromRegistry(sh.Varname);
                    }
                    DifGenerator difgen = new DifGenerator();
                    difgen.AppSettings = m_appSettings;

                    difgen.WidebandSymbol = "";// m_appSettings.WideBandSymbol;
                    difgen.UseWidebandInput = false;
                    difgen.onExportProgress += new DifGenerator.ExportProgress(difgen_onExportProgress);
                    frmProgressLogWorks = new frmProgress();
                    frmProgressLogWorks.SetProgress("Exporting to LogWorks");
                    frmProgressLogWorks.Show();
                    System.Windows.Forms.Application.DoEvents();
                    try
                    {
                        difgen.ConvertFileToDif(filename, sc, startDate, endDate, m_appSettings.InterpolateLogWorksTimescale, m_appSettings.InterpolateLogWorksTimescale);
                    }
                    catch (Exception expE1)
                    {
                        LogHelper.Log(expE1.Message);
                    }
                    frmProgressLogWorks.Close();
                }
                else
                {

                    // show selection screen
                    frmPlotSelection plotsel = new frmPlotSelection();
                    foreach (SymbolHelper sh in sc)
                    {
                        plotsel.AddItemToList(sh.Varname);
                    }
                    plotsel.Startdate = startDate;
                    plotsel.Enddate = endDate;
                    plotsel.SelectAllSymbols();
                    if (plotsel.ShowDialog() == DialogResult.OK)
                    {
                        sc = plotsel.Sc;
                        endDate = plotsel.Enddate;
                        startDate = plotsel.Startdate;
                        DifGenerator difgen = new DifGenerator();
                        LogFilters filterhelper = new LogFilters();
                        difgen.SetFilters(filterhelper.GetFiltersFromRegistry());
                        difgen.AppSettings = m_appSettings;
                        //difgen.LowAFR = m_appSettings.WidebandLowAFR;
                        //difgen.HighAFR = m_appSettings.WidebandHighAFR;
                        //difgen.MaximumVoltageWideband = m_appSettings.WidebandHighVoltage;
                        //difgen.MinimumVoltageWideband = m_appSettings.WidebandLowVoltage;
                        difgen.WidebandSymbol = ""; //m_appSettings.WideBandSymbol;
                        //difgen.UseWidebandInput = m_appSettings.UseWidebandLambdaThroughSymbol;
                        difgen.UseWidebandInput = false;

                        difgen.onExportProgress += new DifGenerator.ExportProgress(difgen_onExportProgress);
                        frmProgressLogWorks = new frmProgress();
                        frmProgressLogWorks.SetProgress("Exporting to LogWorks");
                        frmProgressLogWorks.Show();
                        System.Windows.Forms.Application.DoEvents();
                        try
                        {
                            if (difgen.ConvertFileToDif(filename, sc, startDate, endDate, m_appSettings.InterpolateLogWorksTimescale, m_appSettings.InterpolateLogWorksTimescale))
                            {
                                StartLogWorksWithCurrentFile(Path.GetDirectoryName(filename) + "\\" + Path.GetFileNameWithoutExtension(filename) + ".dif");
                            }
                            else
                            {
                                frmInfoBox info = new frmInfoBox("No data was found to export!");
                            }
                        }
                        catch (Exception expE2)
                        {
                            LogHelper.Log(expE2.Message);
                        }
                        frmProgressLogWorks.Close();
                    }
                    TimeSpan ts = new TimeSpan(endDate.Ticks - startDate.Ticks);
                    //MessageBox.Show("LogFile should be " + ts.ToString());
                }
            }
            catch (Exception E)
            {
                LogHelper.Log(E.Message);
            }
        }

        private void StartLogWorksWithCurrentFile(string filename)
        {
            try
            {
                string logworksstring = GetLogWorksFromRegistry();
                if (logworksstring != string.Empty)
                {
                    logworksstring = logworksstring.Substring(1, logworksstring.Length - 1);
                    int idx = logworksstring.IndexOf('\"');
                    if (idx > 0)
                    {
                        logworksstring = logworksstring.Substring(0, idx);
                        //string parameterstring = "\"" + Path.GetDirectoryName(m_currentfile) + "\\" + DateTime.Now.ToString("yyyyMMdd") + "-CanTraceExt.dif" + "\"";
                        //                        LogHelper.Log(logworksstring);
                        //LogHelper.Log(parameterstring);

                        System.Diagnostics.Process.Start(logworksstring, "\"" + filename + "\"");
                    }
                }
            }
            catch (Exception E)
            {
                LogHelper.Log(E.Message);
            }
        }

        void difgen_onExportProgress(object sender, DifGenerator.ProgressEventArgs e)
        {
            frmProgressLogWorks.SetProgressPercentage(e.Percentage);
        }

        private Color GetColorFromRegistry(string symbolname)
        {
            Color c = Color.Black;
            Int32 win32color = GetValueFromRegistry(symbolname);
            c = Color.FromArgb((int)win32color);
            //c = System.Drawing.ColorTranslator.FromWin32(win32color);
            return c;
        }


        private Int32 GetValueFromRegistry(string symbolname)
        {
            RegistryKey TempKey = null;
            Int32 win32color = 0;
            TempKey = Registry.CurrentUser.CreateSubKey("Software");
            using (RegistryKey Settings = TempKey.CreateSubKey("T8SuitePro\\SymbolColors"))
            {
                if (Settings != null)
                {
                    string[] vals = Settings.GetValueNames();
                    foreach (string a in vals)
                    {
                        try
                        {
                            if (a == symbolname)
                            {
                                string value = Settings.GetValue(a).ToString();
                                win32color = Convert.ToInt32(value);
                            }
                        }
                        catch (Exception E)
                        {
                            LogHelper.Log(E.Message);
                        }
                    }
                }
            }
            return win32color;
        }

        private void SaveRegistryColor(string key, int value)
        {
            RegistryKey TempKey = null;
            TempKey = Registry.CurrentUser.CreateSubKey("Software");

            using (RegistryKey saveSettings = TempKey.CreateSubKey("T8SuitePro\\SymbolColors"))
            {
                saveSettings.SetValue(key, value.ToString(), RegistryValueKind.String);
            }
        }

        private void CheckDefaultSymbolColors()
        {
            if (GetValueFromRegistry("ActualIn.n_Engine") == 0) SaveRegistryColor("ActualIn.n_Engine", ColorTranslator.ToWin32(Color.LightCyan));
            if (GetValueFromRegistry("ActualIn.T_Engine") == 0) SaveRegistryColor("ActualIn.T_Engine", ColorTranslator.ToWin32(Color.LightSalmon));
            if (GetValueFromRegistry("ActualIn.T_AirInlet") == 0) SaveRegistryColor("ActualIn.T_AirInlet", ColorTranslator.ToWin32(Color.LightBlue));
            if (GetValueFromRegistry("ECMStat.ST_ActiveAirDem") == 0) SaveRegistryColor("ECMStat.ST_ActiveAirDem", ColorTranslator.ToWin32(Color.Lime));
            if (GetValueFromRegistry("Lambda.Status") == 0) SaveRegistryColor("Lambda.Status", ColorTranslator.ToWin32(Color.Azure));
            if (GetValueFromRegistry("IgnMastProt.fi_Offset") == 0) SaveRegistryColor("IgnMastProt.fi_Offset", ColorTranslator.ToWin32(Color.Pink));
            if (GetValueFromRegistry("AirMassMast.m_Request") == 0) SaveRegistryColor("AirMassMast.m_Request", ColorTranslator.ToWin32(Color.Orange));
            if (GetValueFromRegistry("Out.M_EngTrqAct") == 0) SaveRegistryColor("Out.M_EngTrqAct", ColorTranslator.ToWin32(Color.DarkGray));
            if (GetValueFromRegistry("ECMStat.P_Engine") == 0) SaveRegistryColor("ECMStat.P_Engine", ColorTranslator.ToWin32(Color.LightSlateGray));
            if (GetValueFromRegistry("In.p_AirInlet") == 0) SaveRegistryColor("In.p_AirInlet", ColorTranslator.ToWin32(Color.Red));
            if (GetValueFromRegistry("ECMStat.p_Diff") == 0) SaveRegistryColor("ECMStat.p_Diff", ColorTranslator.ToWin32(Color.Red));
            if (GetValueFromRegistry("Out.PWM_BoostCntrl") == 0) SaveRegistryColor("Out.PWM_BoostCntrl", ColorTranslator.ToWin32(Color.Wheat));
            if (GetValueFromRegistry("Out.fi_Ignition") == 0) SaveRegistryColor("Out.fi_Ignition", ColorTranslator.ToWin32(Color.LightGoldenrodYellow));
            if (GetValueFromRegistry("Out.X_AccPos") == 0) SaveRegistryColor("Out.X_AccPos", ColorTranslator.ToWin32(Color.Crimson));
            if (GetValueFromRegistry("MAF.m_AirInlet") == 0) SaveRegistryColor("MAF.m_AirInlet", ColorTranslator.ToWin32(Color.OrangeRed));
            if (GetValueFromRegistry("In.v_Vehicle") == 0) SaveRegistryColor("In.v_Vehicle", ColorTranslator.ToWin32(Color.Green));
            if (GetValueFromRegistry("Exhaust.T_Calc") == 0) SaveRegistryColor("Exhaust.T_Calc", ColorTranslator.ToWin32(Color.Goldenrod));
            if (GetValueFromRegistry("BFuelProt.CurrentFuelCon") == 0) SaveRegistryColor("BFuelProt.CurrentFuelCon", ColorTranslator.ToWin32(Color.White));
        }

        private void SwitchRealtimePanelMode(PanelMode panelMode)
        {
            m_appSettings.Panelmode = panelMode;
            Color backColor = Color.FromArgb(232, 232, 232);
            Color foreColor = Color.Black;
            Color labelColor = Color.Black;
            switch (panelMode)
            {
                case PanelMode.Day:
                    // set colorscheme to day, brighter colors
                    backColor = Color.Transparent;//Color.FromArgb(232, 232, 232);
                    foreColor = Color.Black;
                    labelColor = Color.Black;
                    simpleButton1.Text = "Night";
                    break;
                case PanelMode.Night:
                    // set colorscheme to day, darker colors
                    backColor = Color.Black;
                    foreColor = Color.FromArgb(234, 77, 0);
                    labelColor = Color.FromArgb(0, 192, 0);
                    simpleButton1.Text = "Day";
                    break;
            }
            SetTabControlView(xtraTabControl1, panelMode, backColor, labelColor);
            SwitchButtons(panelMode, backColor, labelColor);

            SetColorForMeasurement(measurementAirmassRequest, backColor, foreColor, labelColor);
            SetColorForMeasurement(measurementBoost, backColor, foreColor, labelColor);
            SetColorForMeasurement(measurementCalculatedPower, backColor, foreColor, labelColor);
            SetColorForMeasurement(measurementCalculatedTorque, backColor, foreColor, labelColor);
            SetColorForMeasurement(measurementDutyCycleBCV, backColor, foreColor, labelColor);
            //SetColorForMeasurement(measurementEGT, backColor, foreColor);
            SetColorForMeasurement(measurementIgnitionAdvance, backColor, foreColor, labelColor);
            SetColorForMeasurement(measurementIgnitionOffset, backColor, foreColor, labelColor);
            SetColorForMeasurement(measurementPedalPosition, backColor, foreColor, labelColor);
            SetColorForMeasurement(measurementSpeed, backColor, foreColor, labelColor);

            foreach (Control c in panelBottom.Controls)
            {
                if (c is Owf.Controls.DigitalDisplayControl)
                {
                    Owf.Controls.DigitalDisplayControl ctrl = (Owf.Controls.DigitalDisplayControl)c;
                    ctrl.DigitColor = foreColor;
                    ctrl.BackColor = backColor;
                }
                else if (c is DevExpress.XtraEditors.LabelControl)
                {
                    DevExpress.XtraEditors.LabelControl lbl = (DevExpress.XtraEditors.LabelControl)c;
                    lbl.BackColor = backColor;
                    if (panelMode == PanelMode.Night)
                    {
                        lbl.ForeColor = labelColor;
                    }
                    else
                    {
                        if (lbl.Name == "labelControl9")
                        {
                            lbl.ForeColor = Color.DarkGreen;
                        }
                        else if (lbl.Name == "labelControl10")
                        {
                            lbl.ForeColor = Color.DarkBlue;
                        }
                        else if (lbl.Name == "labelControl12")
                        {
                            lbl.ForeColor = Color.Maroon;
                        }
                        else
                        {
                            lbl.ForeColor = labelColor;
                        }
                    }
                }
            }
            foreach (Control c in dockRealtime.Controls)
            {
                c.BackColor = backColor;
                c.ForeColor = foreColor;
            }
            if (backColor == Color.Black)
            {
                toolStrip2.BackColor = backColor;
                toolStrip2.GripStyle = ToolStripGripStyle.Hidden;
            }
            else
            {
                toolStrip2.GripStyle = ToolStripGripStyle.Visible;
                toolStrip2.BackColor = Color.Empty;
            }
            gridRealtime.BackColor = backColor;
            gridRealtime.ForeColor = foreColor;
            tableLayoutPanel1.BackColor = backColor;
            tableLayoutPanel1.ForeColor = foreColor;
            linearGauge1.BackColor = backColor;
            linearGauge1.ForeColor = foreColor;
            linearGauge1.TextColor = foreColor;
            linearGauge1.TickColor = foreColor;
            linearGauge2.BackColor = backColor;
            linearGauge2.ForeColor = foreColor;
            linearGauge2.TextColor = foreColor;
            linearGauge2.TickColor = foreColor;
            if (backColor == Color.Black)
            {
                linearGauge1.BevelLineColor = backColor;
                linearGauge2.BevelLineColor = backColor;
            }
            else
            {
                linearGauge1.BevelLineColor = Color.DimGray;
                linearGauge2.BevelLineColor = Color.DimGray;
            }
            SetViewRealtime(panelMode);
            System.Windows.Forms.Application.DoEvents();
        }

        private void SwitchButtons(PanelMode panelMode, Color backColor, Color labelColor)
        {
            //SetButtonStyle(btnEconomyMode, panelMode, backColor, labelColor);
            //SetButtonStyle(btnNormalMode, panelMode, backColor, labelColor);
            //SetButtonStyle(btnSportMode, panelMode, backColor, labelColor);
            SetButtonStyle(simpleButton1, panelMode, backColor, labelColor);
        }

        private void SetButtonStyle(DevExpress.XtraEditors.SimpleButton btn, PanelMode panelMode, Color backColor, Color labelColor)
        {
            if (panelMode == PanelMode.Day)
            {
                btn.LookAndFeel.UseDefaultLookAndFeel = true;
                btn.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.Default;
                btn.Appearance.BorderColor = Color.Empty;
                btn.Appearance.BackColor = Color.Empty;
                btn.Appearance.BackColor2 = Color.Empty;
                btn.BackColor = Color.Empty;
                btn.ForeColor = Color.Empty;
            }
            else
            {
                btn.LookAndFeel.UseDefaultLookAndFeel = false;

                btn.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.NoBorder;
                btn.Appearance.BorderColor = backColor;
                btn.Appearance.BackColor = backColor;
                btn.Appearance.BackColor2 = backColor;
                btn.BackColor = backColor;
                btn.ForeColor = labelColor;

            }
        }

        private void SetTabControlView(DevExpress.XtraTab.XtraTabControl tabcontrol, PanelMode panelMode, Color nightColor, Color labelColor)
        {
            //LogHelper.Log("Switching tab control!");
            if (panelMode == PanelMode.Day)
            {
                tabcontrol.LookAndFeel.UseDefaultLookAndFeel = true;
                tabcontrol.LookAndFeel.Style = DevExpress.LookAndFeel.LookAndFeelStyle.Skin;
                tabcontrol.LookAndFeel.SkinName = defaultLookAndFeel1.LookAndFeel.SkinName;

                tabcontrol.HeaderAutoFill = DevExpress.Utils.DefaultBoolean.True;
                tabcontrol.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.Default;
                tabcontrol.BorderStylePage = DevExpress.XtraEditors.Controls.BorderStyles.Default;
                tabcontrol.Appearance.BackColor = Color.Empty;
                tabcontrol.Appearance.BackColor2 = Color.Empty;
                tabcontrol.Appearance.BorderColor = Color.Empty;
                tabcontrol.Appearance.ForeColor = Color.Empty;
                tabcontrol.AppearancePage.Header.BorderColor = Color.Empty;
                tabcontrol.AppearancePage.Header.BackColor = Color.Empty;
                tabcontrol.AppearancePage.Header.BackColor2 = Color.Empty;
                tabcontrol.AppearancePage.Header.ForeColor = Color.Empty;
                tabcontrol.AppearancePage.HeaderActive.BorderColor = Color.Empty;
                tabcontrol.AppearancePage.HeaderActive.BackColor = Color.Empty;
                tabcontrol.AppearancePage.HeaderActive.BackColor2 = Color.Empty;
                tabcontrol.AppearancePage.HeaderActive.ForeColor = Color.Empty;
                tabcontrol.AppearancePage.HeaderDisabled.BorderColor = Color.Empty;
                tabcontrol.AppearancePage.HeaderDisabled.BackColor = Color.Empty;
                tabcontrol.AppearancePage.HeaderDisabled.BackColor2 = Color.Empty;
                tabcontrol.AppearancePage.HeaderDisabled.ForeColor = Color.Empty;
                tabcontrol.AppearancePage.HeaderHotTracked.BorderColor = Color.Empty;
                tabcontrol.AppearancePage.HeaderHotTracked.BackColor = Color.Empty;
                tabcontrol.AppearancePage.HeaderHotTracked.BackColor2 = Color.Empty;
                tabcontrol.AppearancePage.HeaderHotTracked.ForeColor = Color.Empty;
                tabcontrol.AppearancePage.PageClient.BackColor = Color.Empty;
                tabcontrol.AppearancePage.PageClient.BackColor2 = Color.Empty;
                tabcontrol.AppearancePage.PageClient.ForeColor = Color.Empty;

            }
            else
            {
                tabcontrol.LookAndFeel.UseDefaultLookAndFeel = false;
                tabcontrol.LookAndFeel.Style = DevExpress.LookAndFeel.LookAndFeelStyle.Flat;
                //tabcontrol.LookAndFeel.SkinName = "Dark Side"; 

                tabcontrol.HeaderAutoFill = DevExpress.Utils.DefaultBoolean.True;
                tabcontrol.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.NoBorder;
                tabcontrol.BorderStylePage = DevExpress.XtraEditors.Controls.BorderStyles.NoBorder;
                tabcontrol.Appearance.BackColor = nightColor;
                tabcontrol.Appearance.BackColor2 = nightColor;
                tabcontrol.Appearance.BorderColor = nightColor;
                tabcontrol.BackColor = nightColor;
                tabcontrol.Appearance.ForeColor = labelColor;
                tabcontrol.AppearancePage.Header.BorderColor = Color.OrangeRed;
                tabcontrol.AppearancePage.Header.BackColor = nightColor;
                tabcontrol.AppearancePage.Header.BackColor2 = nightColor;
                tabcontrol.AppearancePage.Header.ForeColor = Color.FromArgb(48, 148, 48);
                tabcontrol.AppearancePage.HeaderActive.BorderColor = Color.OrangeRed;
                tabcontrol.AppearancePage.HeaderActive.BackColor = nightColor;
                tabcontrol.AppearancePage.HeaderActive.BackColor2 = nightColor;
                tabcontrol.AppearancePage.HeaderActive.ForeColor = Color.FromArgb(0, 192, 0);
                tabcontrol.AppearancePage.HeaderDisabled.BorderColor = Color.OrangeRed;
                tabcontrol.AppearancePage.HeaderDisabled.BackColor = nightColor;
                tabcontrol.AppearancePage.HeaderDisabled.BackColor2 = nightColor;
                tabcontrol.AppearancePage.HeaderDisabled.ForeColor = Color.FromArgb(0, 192, 0);
                tabcontrol.AppearancePage.HeaderHotTracked.BorderColor = Color.OrangeRed;
                tabcontrol.AppearancePage.HeaderHotTracked.BackColor = nightColor;
                tabcontrol.AppearancePage.HeaderHotTracked.BackColor2 = nightColor;
                tabcontrol.AppearancePage.HeaderHotTracked.ForeColor = Color.FromArgb(0, 192, 0);

                tabcontrol.AppearancePage.PageClient.BackColor = nightColor;
                tabcontrol.AppearancePage.PageClient.BackColor2 = nightColor;
                tabcontrol.AppearancePage.PageClient.ForeColor = Color.FromArgb(0, 192, 0);
            }
            foreach (DevExpress.XtraTab.XtraTabPage page in tabcontrol.TabPages)
            {
                //LogHelper.Log("Switching tab page: " + page.Name);
                SetTabPageView(page, panelMode, nightColor);
            }


        }

        private void SetTabPageView(DevExpress.XtraTab.XtraTabPage page, PanelMode panelMode, Color nightColor)
        {
            if (panelMode == PanelMode.Day)
            {
                page.BackColor = Color.Empty;
                page.Appearance.Header.BackColor = Color.Empty;
                page.Appearance.Header.BackColor2 = Color.Empty;
                page.Appearance.Header.BorderColor = Color.Empty;
                page.Appearance.PageClient.BackColor = Color.Empty;
                page.Appearance.PageClient.BackColor2 = Color.Empty;
                page.Appearance.PageClient.BorderColor = Color.Empty;
            }
            else
            {
                page.BackColor = nightColor;
                page.Appearance.Header.BackColor = nightColor;
                page.Appearance.Header.BackColor2 = nightColor;
                page.Appearance.Header.BorderColor = nightColor;
                page.Appearance.PageClient.BackColor = nightColor;
                page.Appearance.PageClient.BackColor2 = nightColor;
                page.Appearance.PageClient.BorderColor = nightColor;
            }
        }

        private void SetViewRealtime(PanelMode panelMode)
        {
            if (panelMode == PanelMode.Night)
            {
                ViewRealtime.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.NoBorder;
                ViewRealtime.Appearance.Empty.BackColor = Color.Black;
                ViewRealtime.Appearance.Empty.BackColor2 = Color.Black;
                ViewRealtime.Appearance.Empty.ForeColor = Color.FromArgb(0, 192, 0);
                ViewRealtime.Appearance.FocusedCell.BackColor = Color.Black;
                ViewRealtime.Appearance.FocusedCell.BackColor2 = Color.Black;
                ViewRealtime.Appearance.FocusedCell.ForeColor = Color.FromArgb(0, 192, 0);
                ViewRealtime.Appearance.FocusedRow.BackColor = Color.Black;
                ViewRealtime.Appearance.FocusedRow.BackColor2 = Color.Black;
                ViewRealtime.Appearance.FocusedRow.ForeColor = Color.FromArgb(0, 192, 0);
                ViewRealtime.Appearance.Row.BackColor = Color.Black;
                ViewRealtime.Appearance.Row.BackColor2 = Color.Black;
                ViewRealtime.Appearance.Row.ForeColor = Color.FromArgb(0, 192, 0);
                ViewRealtime.Appearance.SelectedRow.BackColor = Color.Black;
                ViewRealtime.Appearance.SelectedRow.BackColor2 = Color.Black;
                ViewRealtime.Appearance.SelectedRow.ForeColor = Color.FromArgb(0, 192, 0);
                ViewRealtime.OptionsView.ShowColumnHeaders = false;
                ViewRealtime.OptionsView.ShowHorzLines = false;
                ViewRealtime.OptionsView.ShowVertLines = false;
                ViewRealtime.OptionsBehavior.Editable = false;
            }
            else
            {
                ViewRealtime.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.Default;
                ViewRealtime.Appearance.Empty.BackColor = Color.Empty;
                ViewRealtime.Appearance.Empty.BackColor2 = Color.Empty;
                ViewRealtime.Appearance.Empty.ForeColor = Color.Empty;
                ViewRealtime.Appearance.FocusedCell.BackColor = Color.Empty;
                ViewRealtime.Appearance.FocusedCell.BackColor2 = Color.Empty;
                ViewRealtime.Appearance.FocusedCell.ForeColor = Color.Empty;
                ViewRealtime.Appearance.FocusedRow.BackColor = Color.Empty;
                ViewRealtime.Appearance.FocusedRow.BackColor2 = Color.Empty;
                ViewRealtime.Appearance.FocusedRow.ForeColor = Color.Empty;
                ViewRealtime.Appearance.Row.BackColor = Color.Empty;
                ViewRealtime.Appearance.Row.BackColor2 = Color.Empty;
                ViewRealtime.Appearance.Row.ForeColor = Color.Empty;
                ViewRealtime.Appearance.SelectedRow.BackColor = Color.Empty;
                ViewRealtime.Appearance.SelectedRow.BackColor2 = Color.Empty;
                ViewRealtime.Appearance.SelectedRow.ForeColor = Color.Empty;
                ViewRealtime.OptionsView.ShowColumnHeaders = true;
                ViewRealtime.OptionsView.ShowHorzLines = true;
                ViewRealtime.OptionsView.ShowVertLines = true;
                ViewRealtime.OptionsBehavior.Editable = false;
            }

        }


        private void SetColorForMeasurement(Measurement measurement, Color backColor, Color foreColor, Color labelColor)
        {
            measurement.LookAndFeel.SkinName = "";
            measurement.SetDigitColor = foreColor;
            measurement.SetBackColor = backColor;
            measurement.SetLabelColor = labelColor;
            if (backColor == Color.Black)
            {
                measurement.BorderStyle = BorderStyle.None;
            }
            else
            {
                measurement.BorderStyle = BorderStyle.Fixed3D;
            }
            //measurement.BackColor = backColor;
            //measurement.ForeColor = foreColor;
        }

        private void simpleButton1_Click(object sender, EventArgs e)
        {
            if (simpleButton1.Text == "Night")
            {
                SwitchRealtimePanelMode(PanelMode.Night);

            }
            else
            {
                SwitchRealtimePanelMode(PanelMode.Day);

            }
            System.Windows.Forms.Application.DoEvents();
        }

        private void SaveRealtimeTable()
        {
            try
            {
                if (gridRealtime.DataSource != null)
                {
                    System.Data.DataTable dt = (System.Data.DataTable)gridRealtime.DataSource;
                    //dt.WriteXml(System.Windows.Forms.Application.StartupPath + "\\RealtimeTable.xml", XmlWriteMode.WriteSchema);
                    // save the user defined symbols
                    //<GS-24062010>
                    using (StreamWriter sw = new StreamWriter(System.Windows.Forms.Application.StartupPath + "\\rtsymbols.txt"))
                    {
                        foreach (DataRow dr in dt.Rows)
                        {
                            //if (Convert.ToInt32(dr["UserDefined"]) == 1)
                            {
                                sw.WriteLine(dr["SymbolName"].ToString() + "|" + dr["Symbolnumber"].ToString() + "|" + dr["Minimum"].ToString() + "|" + dr["Maximum"].ToString() + "|" + dr["Offset"].ToString() + "|" + dr["Correction"].ToString() + "|" + dr["ConvertedSymbolnumber"].ToString() + "|" + dr["SRAMAddress"].ToString() + "|" + dr["Length"].ToString() + "|" + dr["Description"].ToString().Replace("|", ""));
                            }
                        }
                    }
                }
            }
            catch (Exception E)
            {
                LogHelper.Log("Failed to write realtime datatable: " + E.Message);
            }
        }

        private void SaveRealtimeTable(string filename)
        {
            try
            {
                if (gridRealtime.DataSource != null)
                {
                    System.Data.DataTable dt = (System.Data.DataTable)gridRealtime.DataSource;
                    //dt.WriteXml(System.Windows.Forms.Application.StartupPath + "\\RealtimeTable.xml", XmlWriteMode.WriteSchema);
                    // save the user defined symbols
                    //<GS-24062010>
                    using (StreamWriter sw = new StreamWriter(filename))
                    {
                        foreach (DataRow dr in dt.Rows)
                        {
                            //if (Convert.ToInt32(dr["UserDefined"]) == 1)
                            {
                                sw.WriteLine(dr["SymbolName"].ToString() + "|" + dr["Symbolnumber"].ToString() + "|" + dr["Minimum"].ToString() + "|" + dr["Maximum"].ToString() + "|" + dr["Offset"].ToString() + "|" + dr["Correction"].ToString() + "|" + dr["ConvertedSymbolnumber"].ToString() + "|" + dr["SRAMAddress"].ToString() + "|" + dr["Length"].ToString());
                            }
                        }
                    }
                }
            }
            catch (Exception E)
            {
                LogHelper.Log("Failed to write realtime datatable: " + E.Message);
            }
        }

        private void btnSaveRealtimeLayout_Click(object sender, EventArgs e)
        {
            // save the user defined symbols in the list
            SaveFileDialog sfd = new SaveFileDialog();
            sfd.Filter = "Realtime layout files|*.t8rtl";
            if (sfd.ShowDialog() == DialogResult.OK)
            {
                SaveRealtimeTable(sfd.FileName);
            }
        }

        private int GetSymbolNumberFromRealtimeList(int number, string symbolname)
        {
            int retval = number;

            if (m_realtimeAddresses != null)
            {
                foreach (DataRow dr in m_realtimeAddresses.Rows)
                {
                    if (dr["VarName"] != null)
                    {
                        if (dr["VarName"] != DBNull.Value)
                        {
                            if (symbolname == dr["VarName"].ToString())
                            {
                                retval = Convert.ToInt32(dr["SymbolNumber"]);
                                if (number != retval)
                                {
                                    //LogHelper.Log("Fetched (" + symbolname + ") number from realtime list: " + retval.ToString());
                                }
                                break;
                            }
                        }
                    }
                }
            }

            return retval;

        }

        private void AddSymbolToRealTimeList(string symbolname, int symbolnumber, double minvalue, double maxvalue, double offset, double correction, string description, uint sramaddress, bool isUserDefined)
        {
            try
            {
                if (gridRealtime.DataSource != null)
                {
                    int userdef = 0;
                    if (isUserDefined) userdef = 1;
                    System.Data.DataTable dt = (System.Data.DataTable)gridRealtime.DataSource;
                    bool symbolfound = false;
                    foreach (DataRow dr in dt.Rows)
                    {
                        if (dr["SymbolName"].ToString() == symbolname)
                        {
                            symbolfound = true;
                            // overwrite other  values
                            dr["Description"] = description;
                            dr["Symbolnumber"] = symbolnumber;
                            dr["Minimum"] = minvalue;
                            dr["Maximum"] = maxvalue;
                            dr["Offset"] = offset;
                            dr["Correction"] = correction;
                            dr["Value"] = 0;
                            dr["Peak"] = minvalue;
                            dr["ConvertedSymbolNumber"] = GetSymbolNumberFromRealtimeList(symbolnumber, symbolname);
                            dr["SRAMAddress"] = sramaddress;
                            dr["Length"] = GetSymbolLength(m_symbols, symbolname);
                            dr["UserDefined"] = userdef;
                            dr["Delay"] = 1;
                            dr["Reload"] = 1;
                        }
                    }
                    if (!symbolfound)
                    {
                        // create new one
                        dt.Rows.Add(symbolname, description, symbolnumber, 0, offset, correction, minvalue, minvalue, maxvalue, GetSymbolNumberFromRealtimeList(symbolnumber, symbolname), sramaddress, GetSymbolLength(m_symbols, symbolname), userdef, 1, 1);
                    }
                }
            }
            catch (Exception E)
            {
                LogHelper.Log("Failed to add symbol to realtime list: " + E.Message);
            }
        }

        private void LoadRealtimeTable()
        {
            try
            {
                // create a tabel from scratch
                System.Data.DataTable dt = new System.Data.DataTable();
                dt.TableName = "RTSymbols";
                dt.Columns.Add("SymbolName");
                dt.Columns.Add("Description");
                dt.Columns.Add("Symbolnumber", Type.GetType("System.Int32"));
                dt.Columns.Add("Value", Type.GetType("System.Double"));
                dt.Columns.Add("Offset", Type.GetType("System.Double"));
                dt.Columns.Add("Correction", Type.GetType("System.Double"));
                dt.Columns.Add("Peak", Type.GetType("System.Double"));
                dt.Columns.Add("Minimum", Type.GetType("System.Double"));
                dt.Columns.Add("Maximum", Type.GetType("System.Double"));
                dt.Columns.Add("ConvertedSymbolnumber", Type.GetType("System.Int32"));
                dt.Columns.Add("SRAMAddress", Type.GetType("System.Int32"));
                dt.Columns.Add("Length", Type.GetType("System.Int32"));
                dt.Columns.Add("UserDefined", Type.GetType("System.Int32"));
                dt.Columns.Add("Delay", Type.GetType("System.Int32"));
                dt.Columns.Add("Reload", Type.GetType("System.Int32"));
                gridRealtime.DataSource = dt;

                if (File.Exists(System.Windows.Forms.Application.StartupPath + "\\rtsymbols.txt"))
                {
                    using (StreamReader sr = new StreamReader(System.Windows.Forms.Application.StartupPath + "\\rtsymbols.txt"))
                    {
                        string line = string.Empty;
                        char[] sep = new char[1];
                        sep.SetValue('|', 0);
                        while ((line = sr.ReadLine()) != null)
                        {
                            string[] values = line.Split(sep);
                            if (values.Length == 9)
                            {
                                string symbolname = (string)values.GetValue(0);
                                AddSymbolToRealTimeList(symbolname, GetSymbolNumber(m_symbols, symbolname), ConvertToDouble((string)values.GetValue(2)), ConvertToDouble((string)values.GetValue(3)), ConvertToDouble((string)values.GetValue(4)), ConvertToDouble((string)values.GetValue(5)), symbolname, Convert.ToUInt32((string)values.GetValue(7)), true);
                            }
                            else if (values.Length == 10) // we added the description, so now there are 10 fields.
                            {
                                string symbolname = (string)values.GetValue(0);
                                string description = (string)values.GetValue(9);
                                AddSymbolToRealTimeList(symbolname, GetSymbolNumber(m_symbols, symbolname), ConvertToDouble((string)values.GetValue(2)), ConvertToDouble((string)values.GetValue(3)), ConvertToDouble((string)values.GetValue(4)), ConvertToDouble((string)values.GetValue(5)), description, Convert.ToUInt32((string)values.GetValue(7)), true);
                            }
                        }
                    }
                }

            }
            catch (Exception E)
            {
                LogHelper.Log("Failed to load realtime symbol table: " + E.Message);
            }
        }

        private void LoadRealtimeTable(string filename)
        {
            try
            {
                // create a tabel from scratch
                System.Data.DataTable dt = new System.Data.DataTable();
                dt.TableName = "RTSymbols";
                dt.Columns.Add("SymbolName");
                dt.Columns.Add("Description");
                dt.Columns.Add("Symbolnumber", Type.GetType("System.Int32"));
                dt.Columns.Add("Value", Type.GetType("System.Double"));
                dt.Columns.Add("Offset", Type.GetType("System.Double"));
                dt.Columns.Add("Correction", Type.GetType("System.Double"));
                dt.Columns.Add("Peak", Type.GetType("System.Double"));
                dt.Columns.Add("Minimum", Type.GetType("System.Double"));
                dt.Columns.Add("Maximum", Type.GetType("System.Double"));
                dt.Columns.Add("ConvertedSymbolnumber", Type.GetType("System.Int32"));
                dt.Columns.Add("SRAMAddress", Type.GetType("System.Int32"));
                dt.Columns.Add("Length", Type.GetType("System.Int32"));
                dt.Columns.Add("UserDefined", Type.GetType("System.Int32"));
                dt.Columns.Add("Delay", Type.GetType("System.Int32"));
                dt.Columns.Add("Reload", Type.GetType("System.Int32"));
                gridRealtime.DataSource = dt;

                if (File.Exists(filename))
                {
                    using (StreamReader sr = new StreamReader(filename))
                    {
                        string line = string.Empty;
                        char[] sep = new char[1];
                        sep.SetValue('|', 0);
                        while ((line = sr.ReadLine()) != null)
                        {
                            string[] values = line.Split(sep);
                            if (values.Length == 9)
                            {
                                string symbolname = (string)values.GetValue(0);
                                AddSymbolToRealTimeList(symbolname, GetSymbolNumber(m_symbols, symbolname), ConvertToDouble((string)values.GetValue(2)), ConvertToDouble((string)values.GetValue(3)), ConvertToDouble((string)values.GetValue(4)), ConvertToDouble((string)values.GetValue(5)), symbolname, Convert.ToUInt32((string)values.GetValue(7)), true);
                            }
                        }
                    }
                }

            }
            catch (Exception E)
            {
                LogHelper.Log("Failed to load realtime symbol table: " + E.Message);
            }
        }

        private void btnLoadRealtimeLayout_Click(object sender, EventArgs e)
        {
            // load user defined symbols
            OpenFileDialog ofd = new OpenFileDialog();
            ofd.Multiselect = false;
            ofd.Filter = "Realtime layout files|*.t8rtl";
            if (ofd.ShowDialog() == DialogResult.OK)
            {
                LoadRealtimeTable(ofd.FileName);
            }
        }

        private void btnAddSymbol_Click(object sender, EventArgs e)
        {
            // add a user defined symbol
            frmEditRealtimeSymbol frmeditsymbol = new frmEditRealtimeSymbol();
            frmeditsymbol.Symbols = m_symbols;
            if (frmeditsymbol.ShowDialog() == DialogResult.OK)
            {
                AddSymbolToRealTimeList(frmeditsymbol.Varname, frmeditsymbol.Symbolnumber, frmeditsymbol.MinimumValue, frmeditsymbol.MaximumValue, frmeditsymbol.OffsetValue, frmeditsymbol.CorrectionValue, frmeditsymbol.Description, (uint)GetSymbolAddressSRAM(m_symbols, frmeditsymbol.Varname), true);
            }
        }

        private void btnRemoveSymbolFromList_Click(object sender, EventArgs e)
        {
            // delete a symbol
            //TODO: add delete key as well
            int[] selrows = ViewRealtime.GetSelectedRows();
            if (selrows.Length > 0)
            {
                foreach (int rowhandle in selrows)
                {
                    ViewRealtime.DeleteRow(rowhandle);
                }
            }
        }

        private void EditSelectedSymbol()
        {
            //TODO: edit symbol parameters
            int[] selrows = ViewRealtime.GetSelectedRows();
            if (selrows.Length == 1)
            {
                DataRow dr = ViewRealtime.GetDataRow(Convert.ToInt32(selrows.GetValue(0)));
                frmEditRealtimeSymbol frmeditsymbol = new frmEditRealtimeSymbol();
                frmeditsymbol.Symbols = m_symbols;
                frmeditsymbol.Symbolname = dr["SymbolName"].ToString();
                frmeditsymbol.Varname = dr["SymbolName"].ToString();
                frmeditsymbol.Description = dr["Description"].ToString();
                frmeditsymbol.MinimumValue = Convert.ToDouble(dr["Minimum"]);
                frmeditsymbol.MaximumValue = Convert.ToDouble(dr["Maximum"]);
                frmeditsymbol.OffsetValue = Convert.ToDouble(dr["Offset"]);
                frmeditsymbol.CorrectionValue = Convert.ToDouble(dr["Correction"]);

                if (frmeditsymbol.ShowDialog() == DialogResult.OK)
                {
                    // UPDATE the edited symbol
                    AddSymbolToRealTimeList(frmeditsymbol.Varname, frmeditsymbol.Symbolnumber, frmeditsymbol.MinimumValue, frmeditsymbol.MaximumValue, frmeditsymbol.OffsetValue, frmeditsymbol.CorrectionValue, frmeditsymbol.Description, (uint)GetSymbolAddressSRAM(m_symbols, frmeditsymbol.Varname), true);
                }
            }
        }

        private void btnEditSymbol_Click(object sender, EventArgs e)
        {
            EditSelectedSymbol();
        }

        private void xtraTabControl2_SelectedPageChanged(object sender, DevExpress.XtraTab.TabPageChangedEventArgs e)
        {
            // fill realtime table with other values to be able to fill the dashboard
            if (e.Page == xtraTabPage1)
            {
                if (m_appSettings.ResetRealtimeSymbolOnTabPageSwitch)
                {
                    FillRealtimeTable(MonitorType.Dashboard);
                }
            }
            else
            {
                // remove the symbols again ??
            }

            panelBottom.Visible = (e.Page != xtraTabPageEmpty);
        }


        private void ViewRealtime_DoubleClick(object sender, EventArgs e)
        {
            EditSelectedSymbol();
        }

        private void ViewRealtime_CustomDrawCell(object sender, DevExpress.XtraGrid.Views.Base.RowCellCustomDrawEventArgs e)
        {
            if (e.Column.Name == gcRealtimeValue.Name)
            {
                // get maximum and minumum  value
                try
                {

                    DataRow dr = ViewRealtime.GetDataRow(e.RowHandle);
                    if (dr != null && e.DisplayText != null)
                    {
                        /*if (dr["SYMBOLNAME"].ToString() == "Rpm")
                        {
                            LogHelper.Log("break");
                        }*/


                        double maximum = Convert.ToDouble(dr["Maximum"]);
                        double minimum = Convert.ToDouble(dr["Minimum"]);
                        double actualvalue = Convert.ToDouble(dr["Value"]);
                        double range = maximum - minimum;

                        double percentage = (actualvalue - minimum) / range;
                        if (percentage < 0) percentage = 0;
                        if (percentage > 1) percentage = 1;
                        double xwidth = percentage * (double)(e.Bounds.Width - 2);
                        if (xwidth > 0)
                        {
                            System.Drawing.Rectangle rect = new System.Drawing.Rectangle(e.Bounds.X - 1, e.Bounds.Y, e.Bounds.Width + 1, e.Bounds.Height);
                            Brush brush = new System.Drawing.Drawing2D.LinearGradientBrush(rect, Color.LightGreen, Color.OrangeRed, System.Drawing.Drawing2D.LinearGradientMode.Horizontal);
                            e.Graphics.FillRectangle(brush, e.Bounds.X + 1, e.Bounds.Y + 1, (float)xwidth, e.Bounds.Height - 2);
                        }
                        //percentage *= 100;
                        //e.DisplayText = percentage.ToString("F0") + @" %";
                    }
                }
                catch (Exception E)
                {
                    LogHelper.Log(E.Message);
                }
            }

        }

        private void ViewRealtime_KeyDown(object sender, KeyEventArgs e)
        {
            // control arrow UP = move UP
            // control arrow DOWN = move down
            if (e.Control)
            {
                if (e.KeyCode == Keys.Up)
                {
                    // move the selected row up
                }
                else if (e.KeyCode == Keys.Down)
                {
                    // move the selected row down
                }
            }
        }

        private void gridRealtime_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Delete)
            {
                btnRemoveSymbolFromList_Click(this, EventArgs.Empty);
            }
            else if (e.Control)
            {
                if (e.KeyCode == Keys.Up)
                {
                    /***
                dt.Columns.Add("SymbolName");
                dt.Columns.Add("Description");
                dt.Columns.Add("Symbolnumber", Type.GetType("System.Int32"));
                dt.Columns.Add("Value", Type.GetType("System.Double"));
                dt.Columns.Add("Offset", Type.GetType("System.Double"));
                dt.Columns.Add("Correction", Type.GetType("System.Double"));
                dt.Columns.Add("Peak", Type.GetType("System.Double"));
                dt.Columns.Add("Minimum", Type.GetType("System.Double"));
                dt.Columns.Add("Maximum", Type.GetType("System.Double"));
                dt.Columns.Add("ConvertedSymbolnumber", Type.GetType("System.Int32"));
                dt.Columns.Add("SRAMAddress", Type.GetType("System.Int32"));
                dt.Columns.Add("Length", Type.GetType("System.Int32"));
                dt.Columns.Add("UserDefined", Type.GetType("System.Int32"));
                dt.Columns.Add("Delay", Type.GetType("System.Int32"));
                dt.Columns.Add("Reload", Type.GetType("System.Int32"));                     * */
                    // move current row up
                    if (ViewRealtime.FocusedRowHandle >= 1)
                    {
                        DataRow dr1 = ViewRealtime.GetDataRow(ViewRealtime.FocusedRowHandle);
                        DataRow dr2 = ViewRealtime.GetDataRow(ViewRealtime.FocusedRowHandle - 1);
                        //DataRow drtemp = ViewRealtime.GetDataRow(ViewRealtime.FocusedRowHandle - 1);
                        string descr = dr2["Description"].ToString();
                        string symbolname = dr2["SymbolName"].ToString();
                        int symbolnumber = Convert.ToInt32(dr2["Symbolnumber"]);
                        double value = Convert.ToDouble(dr2["Value"]);
                        double offset = Convert.ToDouble(dr2["Offset"]);
                        double correction = Convert.ToDouble(dr2["Correction"]);
                        double peak = Convert.ToDouble(dr2["Peak"]);
                        double minimum = Convert.ToDouble(dr2["Minimum"]);
                        double maximum = Convert.ToDouble(dr2["Maximum"]);
                        int convertedsymbolnumber = Convert.ToInt32(dr2["ConvertedSymbolnumber"]);
                        int sramaddress = Convert.ToInt32(dr2["SRAMAddress"]);
                        int Length = Convert.ToInt32(dr2["Length"]);
                        int UserDefined = Convert.ToInt32(dr2["UserDefined"]);
                        int Delay = Convert.ToInt32(dr2["Delay"]);
                        int Reload = Convert.ToInt32(dr2["Reload"]);

                        dr2["SymbolName"] = dr1["SymbolName"];
                        dr2["Description"] = dr1["Description"];
                        dr2["Symbolnumber"] = dr1["Symbolnumber"];
                        dr2["Value"] = dr1["Value"];
                        dr2["Offset"] = dr1["Offset"];
                        dr2["Correction"] = dr1["Correction"];
                        dr2["Peak"] = dr1["Peak"];
                        dr2["Minimum"] = dr1["Minimum"];
                        dr2["Maximum"] = dr1["Maximum"];
                        dr2["ConvertedSymbolnumber"] = dr1["ConvertedSymbolnumber"];
                        dr2["SRAMAddress"] = dr1["SRAMAddress"];
                        dr2["Length"] = dr1["Length"];
                        dr2["UserDefined"] = dr1["UserDefined"];
                        dr2["Delay"] = dr1["Delay"];
                        dr2["Reload"] = dr1["Reload"];

                        dr1["SymbolName"] = symbolname;
                        dr1["Description"] = descr;
                        dr1["Symbolnumber"] = symbolnumber;
                        dr1["Value"] = value;
                        dr1["Offset"] = offset;
                        dr1["Correction"] = correction;
                        dr1["Peak"] = peak;
                        dr1["Minimum"] = minimum;
                        dr1["Maximum"] = maximum;
                        dr1["ConvertedSymbolnumber"] = convertedsymbolnumber;
                        dr1["SRAMAddress"] = sramaddress;
                        dr1["Length"] = Length;
                        dr1["UserDefined"] = UserDefined;
                        dr1["Delay"] = Delay;
                        dr1["Reload"] = Reload;

                    }

                }
                else if (e.KeyCode == Keys.Down)
                {
                    if (ViewRealtime.FocusedRowHandle < ViewRealtime.RowCount - 1)
                    {
                        DataRow dr1 = ViewRealtime.GetDataRow(ViewRealtime.FocusedRowHandle);
                        DataRow dr2 = ViewRealtime.GetDataRow(ViewRealtime.FocusedRowHandle + 1);

                        string descr = dr2["Description"].ToString();
                        string symbolname = dr2["SymbolName"].ToString();
                        int symbolnumber = Convert.ToInt32(dr2["Symbolnumber"]);
                        double value = Convert.ToDouble(dr2["Value"]);
                        double offset = Convert.ToDouble(dr2["Offset"]);
                        double correction = Convert.ToDouble(dr2["Correction"]);
                        double peak = Convert.ToDouble(dr2["Peak"]);
                        double minimum = Convert.ToDouble(dr2["Minimum"]);
                        double maximum = Convert.ToDouble(dr2["Maximum"]);
                        int convertedsymbolnumber = Convert.ToInt32(dr2["ConvertedSymbolnumber"]);
                        int sramaddress = Convert.ToInt32(dr2["SRAMAddress"]);
                        int Length = Convert.ToInt32(dr2["Length"]);
                        int UserDefined = Convert.ToInt32(dr2["UserDefined"]);
                        int Delay = Convert.ToInt32(dr2["Delay"]);
                        int Reload = Convert.ToInt32(dr2["Reload"]);

                        dr2["SymbolName"] = dr1["SymbolName"];
                        dr2["Description"] = dr1["Description"];
                        dr2["Symbolnumber"] = dr1["Symbolnumber"];
                        dr2["Value"] = dr1["Value"];
                        dr2["Offset"] = dr1["Offset"];
                        dr2["Correction"] = dr1["Correction"];
                        dr2["Peak"] = dr1["Peak"];
                        dr2["Minimum"] = dr1["Minimum"];
                        dr2["Maximum"] = dr1["Maximum"];
                        dr2["ConvertedSymbolnumber"] = dr1["ConvertedSymbolnumber"];
                        dr2["SRAMAddress"] = dr1["SRAMAddress"];
                        dr2["Length"] = dr1["Length"];
                        dr2["UserDefined"] = dr1["UserDefined"];
                        dr2["Delay"] = dr1["Delay"];
                        dr2["Reload"] = dr1["Reload"];

                        dr1["SymbolName"] = symbolname;
                        dr1["Description"] = descr;
                        dr1["Symbolnumber"] = symbolnumber;
                        dr1["Value"] = value;
                        dr1["Offset"] = offset;
                        dr1["Correction"] = correction;
                        dr1["Peak"] = peak;
                        dr1["Minimum"] = minimum;
                        dr1["Maximum"] = maximum;
                        dr1["ConvertedSymbolnumber"] = convertedsymbolnumber;
                        dr1["SRAMAddress"] = sramaddress;
                        dr1["Length"] = Length;
                        dr1["UserDefined"] = UserDefined;
                        dr1["Delay"] = Delay;
                        dr1["Reload"] = Reload;

                    }
                }
            }
        }

        private void AddToRealtimeTable(System.Data.DataTable dt, string varname, string description, int symbolnumber, double value, double offset, double correction, double peak, double minimum, double maximum, int convertedSymbolnumber, uint sramaddress, int length, int delay)
        {
            bool fnd = false;
            foreach (DataRow dr in dt.Rows)
            {
                if (dr["SymbolName"] != DBNull.Value)
                {
                    if (dr["SymbolName"].ToString() == varname)
                    {
                        fnd = true;
                        dr["Symbolnumber"] = symbolnumber;
                        dr["ConvertedSymbolnumber"] = symbolnumber;
                        dr["SRAMAddress"] = sramaddress;
                        dr["Length"] = length;
                        dr["UserDefined"] = 0;
                        dr["Delay"] = delay;
                        dr["Reload"] = delay;
                        if (symbolnumber == 0 && sramaddress == 0)
                        {
                            // This is used to update the peak value for combiadapter channels+EGT
                            dr["Value"] = value;
                            try
                            {
                                if (Convert.ToDouble(dr["Peak"]) < value) dr["Peak"] = value;
                            }
                            catch (Exception peakE)
                            {
                                LogHelper.Log("Failed to set peak: " + peakE.Message);
                            }
                        }
                        else
                        {
                            // Cannot overwrite the last peakvalue until we know its not needed for combiadapter channels+EGT
                            dr["Peak"] = peak;
                        }
                        break;
                    }
                }
            }
            if (!fnd)
            {
                dt.Rows.Add(varname, description, symbolnumber, value, offset, correction, peak, minimum, maximum, convertedSymbolnumber, sramaddress, length, 0, delay, delay);
            }
        }

        private void FillRealtimeTable(MonitorType type)
        {
            if (gridRealtime.DataSource == null)
            {
                System.Data.DataTable dt = new System.Data.DataTable();
                dt.TableName = "RTSymbols";
                dt.Columns.Add("SymbolName");
                dt.Columns.Add("Description");
                dt.Columns.Add("Symbolnumber", Type.GetType("System.Int32"));
                dt.Columns.Add("Value", Type.GetType("System.Double"));
                dt.Columns.Add("Offset", Type.GetType("System.Double"));
                dt.Columns.Add("Correction", Type.GetType("System.Double"));
                dt.Columns.Add("Peak", Type.GetType("System.Double"));
                dt.Columns.Add("Minimum", Type.GetType("System.Double"));
                dt.Columns.Add("Maximum", Type.GetType("System.Double"));
                dt.Columns.Add("ConvertedSymbolnumber", Type.GetType("System.Int32"));
                dt.Columns.Add("SRAMAddress", Type.GetType("System.Int32"));
                dt.Columns.Add("Length", Type.GetType("System.Int32"));
                dt.Columns.Add("UserDefined", Type.GetType("System.Int32"));
                dt.Columns.Add("Delay", Type.GetType("System.Int32"));
                dt.Columns.Add("Reload", Type.GetType("System.Int32"));
                gridRealtime.DataSource = dt;
            }
            // fill values
            try
            {
                System.Data.DataTable dt = (System.Data.DataTable)gridRealtime.DataSource;

                if (SymbolExists("ActualIn.U_Battery")) AddToRealtimeTable(dt, "ActualIn.U_Battery", "Battery voltage", GetSymbolNumber(m_symbols, "ActualIn.U_Battery"), 0, 0, 0.1, 0, 0, 16, GetSymbolNumber(m_symbols, "ActualIn.U_Battery"), (uint)GetSymbolAddressSRAM(m_symbols, "ActualIn.U_Battery"), GetSymbolLength(m_symbols, "ActualIn.U_Battery"), 1);


                // rpm should always be present
                if (SymbolExists("ActualIn.n_Engine")) AddToRealtimeTable(dt, "ActualIn.n_Engine", "Engine speed", GetSymbolNumber(m_symbols, "ActualIn.n_Engine"), 0, 0, 1, 0, 0, 8000, GetSymbolNumber(m_symbols, "ActualIn.n_Engine"), (uint)GetSymbolAddressSRAM(m_symbols, "ActualIn.n_Engine"), GetSymbolLength(m_symbols, "ActualIn.n_Engine"), 1);
                if (SymbolExists("In.v_Vehicle")) AddToRealtimeTable(dt, "In.v_Vehicle", "Vehicle speed", GetSymbolNumber(m_symbols, "In.v_Vehicle"), 0, 0, 0.1, 0, 0, 300, GetSymbolNumber(m_symbols, "In.v_Vehicle"), (uint)GetSymbolAddressSRAM(m_symbols, "In.v_Vehicle"), GetSymbolLength(m_symbols, "In.v_Vehicle"), 3);
                if (SymbolExists("Out.X_AccPos")) AddToRealtimeTable(dt, "Out.X_AccPos", "TPS %", GetSymbolNumber(m_symbols, "Out.X_AccPos"), 0, 0, 0.1, 0, 0, 100, GetSymbolNumber(m_symbols, "Out.X_AccPos"), (uint)GetSymbolAddressSRAM(m_symbols, "Out.X_AccPos"), GetSymbolLength(m_symbols, "Out.X_AccPos"), 1);
                if (SymbolExists("ActualIn.T_Engine")) AddToRealtimeTable(dt, "ActualIn.T_Engine", "Engine temperature", GetSymbolNumber(m_symbols, "ActualIn.T_Engine"), 0, 0, 1, 0, -20, 120, GetSymbolNumber(m_symbols, "ActualIn.T_Engine"), (uint)GetSymbolAddressSRAM(m_symbols, "ActualIn.T_Engine"), GetSymbolLength(m_symbols, "ActualIn.T_Engine"), 5);
                if (SymbolExists("ActualIn.T_AirInlet")) AddToRealtimeTable(dt, "ActualIn.T_AirInlet", "Intake air temperature", GetSymbolNumber(m_symbols, "ActualIn.T_AirInlet"), 0, 0, 1, 0, -20, 120, GetSymbolNumber(m_symbols, "ActualIn.T_AirInlet"), (uint)GetSymbolAddressSRAM(m_symbols, "ActualIn.T_AirInlet"), GetSymbolLength(m_symbols, "ActualIn.T_AirInlet"), 3);
                if (SymbolExists("ECMStat.ST_ActiveAirDem")) AddToRealtimeTable(dt, "ECMStat.ST_ActiveAirDem", "Active air demand map", GetSymbolNumber(m_symbols, "ECMStat.ST_ActiveAirDem"), 0, 0, 1, 0, 0, 255, GetSymbolNumber(m_symbols, "ECMStat.ST_ActiveAirDem"), (uint)GetSymbolAddressSRAM(m_symbols, "ECMStat.ST_ActiveAirDem"), GetSymbolLength(m_symbols, "ECMStat.ST_ActiveAirDem"), 1);
                if (SymbolExists("Lambda.Status")) AddToRealtimeTable(dt, "Lambda.Status", "Lambda status", GetSymbolNumber(m_symbols, "Lambda.Status"), 0, 0, 1, 0, 0, 255, GetSymbolNumber(m_symbols, "Lambda.Status"), (uint)GetSymbolAddressSRAM(m_symbols, "Lambda.Status"), GetSymbolLength(m_symbols, "Lambda.Status"), 1);
                if (SymbolExists("FCut.CutStatus")) AddToRealtimeTable(dt, "FCut.CutStatus", "Fuelcut status", GetSymbolNumber(m_symbols, "FCut.CutStatus"), 0, 0, 1, 0, 0, 255, GetSymbolNumber(m_symbols, "FCut.CutStatus"), (uint)GetSymbolAddressSRAM(m_symbols, "FCut.CutStatus"), GetSymbolLength(m_symbols, "FCut.CutStatus"), 1);
                if (SymbolExists("IgnMastProt.fi_Offset")) AddToRealtimeTable(dt, "IgnMastProt.fi_Offset", "Ignition offset", GetSymbolNumber(m_symbols, "IgnMastProt.fi_Offset"), 0, 0, 0.1, 0, -20, 20, GetSymbolNumber(m_symbols, "IgnMastProt.fi_Offset"), (uint)GetSymbolAddressSRAM(m_symbols, "IgnMastProt.fi_Offset"), GetSymbolLength(m_symbols, "IgnMastProt.fi_Offset"), 1);
                if (SymbolExists("AirMassMast.m_Request")) AddToRealtimeTable(dt, "AirMassMast.m_Request", "Requested airmass", GetSymbolNumber(m_symbols, "AirMassMast.m_Request"), 0, 0, 1, 0, 0, 600, GetSymbolNumber(m_symbols, "AirMassMast.m_Request"), (uint)GetSymbolAddressSRAM(m_symbols, "AirMassMast.m_Request"), GetSymbolLength(m_symbols, "AirMassMast.m_Request"), 1);
                if (SymbolExists("Out.M_EngTrqAct")) AddToRealtimeTable(dt, "Out.M_EngTrqAct", "Calculated torque", GetSymbolNumber(m_symbols, "Out.M_EngTrqAct"), 0, 0, 1, 0, 0, 600, GetSymbolNumber(m_symbols, "Out.M_EngTrqAct"), (uint)GetSymbolAddressSRAM(m_symbols, "Out.M_EngTrqAct"), GetSymbolLength(m_symbols, "Out.M_EngTrqAct"), 1);

                //<GS-05042011> P_Engine is not needed, we can calculate that from torque and RPM
                //if (SymbolExists("ECMStat.P_Engine")) AddToRealtimeTable(dt, "ECMStat.P_Engine", "Calculated power", GetSymbolNumber(m_symbols, "ECMStat.P_Engine"), 0, 0, 1, 0, 0, 600, GetSymbolNumber(m_symbols, "ECMStat.P_Engine"), (uint)GetSymbolAddressSRAM(m_symbols, "ECMStat.P_Engine"), GetSymbolLength(m_symbols, "ECMStat.P_Engine"), 1);

                //if (SymbolExists("ECMStat.p_Diff")) AddToRealtimeTable(dt, "ECMStat.p_Diff", "Boost", GetSymbolNumber(m_symbols, "ECMStat.p_Diff"), 0, 0, 0.01, 0, -1, 3, GetSymbolNumber(m_symbols, "ECMStat.p_Diff"), (uint)GetSymbolAddressSRAM(m_symbols, "ECMStat.p_Diff"), GetSymbolLength(m_symbols, "ECMStat.p_Diff"));
                if (SymbolExists("In.p_AirInlet")) AddToRealtimeTable(dt, "In.p_AirInlet", "Boost", GetSymbolNumber(m_symbols, "In.p_AirInlet"), 0, -1, 0.001, 0, -1, 3, GetSymbolNumber(m_symbols, "In.p_AirInlet"), (uint)GetSymbolAddressSRAM(m_symbols, "In.p_AirInlet"), GetSymbolLength(m_symbols, "In.p_AirInlet"), 1);
                if (SymbolExists("Out.PWM_BoostCntrl")) AddToRealtimeTable(dt, "Out.PWM_BoostCntrl", "Duty cycle BCV", GetSymbolNumber(m_symbols, "Out.PWM_BoostCntrl"), 0, 0, 0.1, 0, 0, 100, GetSymbolNumber(m_symbols, "Out.PWM_BoostCntrl"), (uint)GetSymbolAddressSRAM(m_symbols, "Out.PWM_BoostCntrl"), GetSymbolLength(m_symbols, "Out.PWM_BoostCntrl"), 1);
                if (SymbolExists("Out.fi_Ignition")) AddToRealtimeTable(dt, "Out.fi_Ignition", "Ignition advance", GetSymbolNumber(m_symbols, "Out.fi_Ignition"), 0, 0, 0.1, 0, -10, 50, GetSymbolNumber(m_symbols, "Out.fi_Ignition"), (uint)GetSymbolAddressSRAM(m_symbols, "Out.fi_Ignition"), GetSymbolLength(m_symbols, "Out.fi_Ignition"), 1);
                if (SymbolExists("MAF.m_AirInlet")) AddToRealtimeTable(dt, "MAF.m_AirInlet", "Actual airmass", GetSymbolNumber(m_symbols, "MAF.m_AirInlet"), 0, 0, 1, 0, 0, 1600, GetSymbolNumber(m_symbols, "MAF.m_AirInlet"), (uint)GetSymbolAddressSRAM(m_symbols, "MAF.m_AirInlet"), GetSymbolLength(m_symbols, "MAF.m_AirInlet"), 1);

                //<GS-05042011> Only add Exhaust.T_Calc when this function is active in the opened binary file
                if (HasExhaustGasTemperatureCalculation())
                {
                    if (SymbolExists("Exhaust.T_Calc")) AddToRealtimeTable(dt, "Exhaust.T_Calc", "Calculated EGT temperature", GetSymbolNumber(m_symbols, "Exhaust.T_Calc"), 0, 0, 1, 0, 0, 1200, GetSymbolNumber(m_symbols, "Exhaust.T_Calc"), (uint)GetSymbolAddressSRAM(m_symbols, "Exhaust.T_Calc"), GetSymbolLength(m_symbols, "Exhaust.T_Calc"), 2);
                    // enable the realtime symbol for exhaust gas temperature
                    measurementEGT.Enabled = true;
                    labelControl4.Enabled = true;
                }
                else
                {
                    // disable the realtime symbol for exhaust gas temperature
                    measurementEGT.Enabled = false;
                    labelControl4.Enabled = false;
                }
                //TODO: Fix for Trionic 8 
                //if (SymbolExists("BFuelProt.CurrentFuelCon")) AddToRealtimeTable(dt, "BFuelProt.CurrentFuelCon", "Fuel consumption", GetSymbolNumber(m_symbols, "BFuelProt.CurrentFuelCon"), 0, 0, 0.1, 0, 0, 50, GetSymbolNumber(m_symbols, "BFuelProt.CurrentFuelCon"), (uint)GetSymbolAddressSRAM(m_symbols, "BFuelProt.CurrentFuelCon"), GetSymbolLength(m_symbols, "BFuelProt.CurrentFuelCon"), 2);
                // only if use wideband selected
                if (m_appSettings.UseWidebandLambda)
                {

                    if (SymbolExists(m_appSettings.WideBandSymbol))
                    {
                        double corr = 0.1;
                        if (m_appSettings.WideBandSymbol == "DisplProt.AD_Scanner") corr = 1;
                        AddToRealtimeTable(dt, m_appSettings.WideBandSymbol, "Lambda value (wbO2)", GetSymbolNumber(m_symbols, m_appSettings.WideBandSymbol), 0, 0, corr, 0, 10, 20, GetSymbolNumber(m_symbols, m_appSettings.WideBandSymbol), (uint)GetSymbolAddressSRAM(m_symbols, m_appSettings.WideBandSymbol), GetSymbolLength(m_symbols, m_appSettings.WideBandSymbol), 1);
                        // AFR feedback map initialiseren // <GS-19042010>
                        int _width = 18;
                        int _height = 16;
                    }
                }
                else
                {
                    if (SymbolExists("Lambda.LambdaInt")) AddToRealtimeTable(dt, "Lambda.LambdaInt", "Lambda value (nbO2)", GetSymbolNumber(m_symbols, "Lambda.LambdaInt"), 0, 1, 0.0001, 0, 0, 2, GetSymbolNumber(m_symbols, "Lambda.LambdaInt"), (uint)GetSymbolAddressSRAM(m_symbols, "Lambda.LambdaInt"), GetSymbolLength(m_symbols, "Lambda.LambdaInt"), 1);
                }

            }
            catch (Exception E)
            {
                LogHelper.Log(E.Message);
            }
        }

        private bool HasExhaustGasTemperatureCalculation()
        {
            foreach (SymbolHelper sh in m_symbols)
            {
                if (sh.Varname == "ExhaustCal.ST_Enable" || sh.Userdescription == "ExhaustCal.ST_Enable")
                {
                    byte[] toqruelimdata = readdatafromfile(m_currentfile, (int)GetSymbolAddress(m_symbols, sh.Varname), sh.Length);
                    if (sh.Length == 1)
                    {
                        if ((byte)toqruelimdata.GetValue(0) != 0x00)
                        {
                            return true;
                        }
                    }
                }
            }
            return false;
        }

        private bool m_connectedToECU = false;
        private bool m_prohibitReading = false;
        private bool m_enableRealtimeTimer = false;
        private bool _soundAllowed = true;
        private System.Media.SoundPlayer sndplayer;



        private void tmrRealtime_Tick(object sender, EventArgs e)
        {
            tmrRealtime.Enabled = false;
            try
            {
                if (m_connectedToECU)
                {
                    if (!m_prohibitReading)
                    {
                        t8can.StallKeepAlive = true;
                        GetSRAMVarsFromTable();
                        Debug.WriteLine("Getting data pack: "+DateTime.Now.Ticks);
                        // t8can.StallKeepAlive = false;
                        // keep alive every time? ... ?
                    }
                    else
                    {
                        LogHelper.Log("Not reading from SRAM because we're doing something else");
                    }
                }
            }
            catch (Exception E)
            {
                LogHelper.Log("Failed to run realtime timer code: " + E.Message);
            }
            tmrRealtime.Enabled = m_enableRealtimeTimer;
        }

        //TODO: Adjust for Trionic 8
        private void GetSRAMVarsFromTable()
        {
            //LogHelper.Log("GetSRAMVarsFromTable started");
            if (gridRealtime.DataSource != null)
            {
                _sw.Reset();
                _sw.Start();
                System.Data.DataTable dt = (System.Data.DataTable)gridRealtime.DataSource;
                dt.BeginLoadData();
                //LogHelper.Log("Fetch the datatable: " + dt.Rows.Count.ToString() + " rows");
                foreach (DataRow dr in dt.Rows)
                {
                    //Debug.WriteLine("loop: "+_sw.ElapsedMilliseconds);
                    double value = 0;
                    if (m_prohibitReading) return;
                    try
                    {
                        if (dr["Delay"] != DBNull.Value)
                        {
                            int dly = Convert.ToInt32(dr["Delay"]);
                            dly--;
                            if (dly > 0)
                            {
                                dr["Delay"] = dly;
                                continue;
                            }
                            else
                            {
                                dr["Delay"] = dr["Reload"];
                            }
                        }
                        else
                        {
                            LogHelper.Log("Delay value was null for : " + dr["SymbolName"].ToString());
                        }
                    }
                    catch (Exception E)
                    {
                        LogHelper.Log("Failed to reload: " + E.Message);
                    }
                    //int symbolnumber = Convert.ToInt32(dr["ConvertedSymbolnumber"]);
                    string symbolName = dr["SymbolName"].ToString();

                    if (symbolName == "KnockCyl1" ||
                        symbolName == "KnockCyl2" ||
                        symbolName == "KnockCyl3" ||
                        symbolName == "KnockCyl4" ||
                        symbolName == "KnkCntCyl1" ||
                        symbolName == "KnkCntCyl2" ||
                        symbolName == "KnkCntCyl3" ||
                        symbolName == "KnkCntCyl4" ||
                        symbolName == "MisfCyl11" ||
                        symbolName == "MisfCyl12" ||
                        symbolName == "MisfCyl13" ||
                        symbolName == "MisfCyl14")
                    {
                        break;
                    }

                    //LogHelper.Log("Start reading " + symbolName + " at address: " + Convert.ToInt32(dr["SRAMAddress"]).ToString("X8"));
                    //if (symbolnumber > 0)
                    {
                        byte[] buffer = new byte[1];

                        bool _success = false;
                        //buffer = ReadSymbolFromSRAM((uint)symbolnumber, symbolName, Convert.ToUInt32(dr["SRAMAddress"]), Convert.ToInt32(dr["Length"]), out _success);
                        if (Convert.ToInt32(dr["SRAMAddress"]) > 0)
                        {
                            buffer = t8can.readMemory(Convert.ToInt32(dr["SRAMAddress"]), Convert.ToInt32(dr["Length"]), out _success);
                        }
                        else
                        {
                            LogHelper.Log("Symbol: " + symbolName + " has address 0");
                        }

                        /* string dbg = string.Empty;
                         for (int i = 0; i < buffer.Length; i++)
                         {
                             dbg += buffer[i].ToString("X2") + " ";
                         }
                         LogHelper.Log(symbolName + " = " + dbg + "buflen: " + buffer.Length.ToString() + " " + _success.ToString());
                         */
                        if (_success)
                        {


                            if (buffer.Length == 1)
                            {
                                //LogHelper.Log("Buffer received: " + buffer[0].ToString("X2"));
                                value = Convert.ToInt32(buffer.GetValue(0));
                            }
                            else if (buffer.Length == 2)
                            {
                                value = (Convert.ToInt32(buffer.GetValue(0)) * 256) + Convert.ToInt32(buffer.GetValue(1));
                            }
                            else if (buffer.Length == 4)
                            {
                                value = (Convert.ToInt32(buffer.GetValue(0)) * 256 * 256 * 256) + (Convert.ToInt32(buffer.GetValue(1)) * 256 * 256) + (Convert.ToInt32(buffer.GetValue(2)) * 256) + Convert.ToInt32(buffer.GetValue(3));
                            }

                            //double realvalue = (double)value;
                            if (symbolName == "ActualIn.T_Engine" ||
                                symbolName == "ActualIn.T_AirInlet" ||
                                symbolName == "Out.fi_Ignition" ||
                                symbolName == "Out.M_EngTrqAct" ||
                                symbolName == "ECMStat.P_Engine" ||
                                symbolName == "IgnMastProt.fi_Offset" ||
                                symbolName == "Lambda.LambdaInt" ||
                                symbolName == "MAF.m_AirInlet")
                            {
                                if (value > 32000) value = -(65536 - value); // negatief maken
                            }

                            else if (symbolName == "KnkDet.KnockCyl") // 4 length
                            {
                                int knkcountcyl1 = 0;
                                int knkcountcyl2 = 0;
                                int knkcountcyl3 = 0;
                                int knkcountcyl4 = 0;
                                if (buffer.Length == 4)
                                {
                                    knkcountcyl1 = Convert.ToInt32(buffer.GetValue(0));
                                    knkcountcyl2 = Convert.ToInt32(buffer.GetValue(1));
                                    knkcountcyl3 = Convert.ToInt32(buffer.GetValue(2));
                                    knkcountcyl4 = Convert.ToInt32(buffer.GetValue(3));
                                    UpdateRealtimeInformationInTable(dt, "KnockCyl1", (float)knkcountcyl1);
                                    UpdateRealtimeInformationInTable(dt, "KnockCyl2", (float)knkcountcyl2);
                                    UpdateRealtimeInformationInTable(dt, "KnockCyl3", (float)knkcountcyl3);
                                    UpdateRealtimeInformationInTable(dt, "KnockCyl4", (float)knkcountcyl4);
                                }

                            }
                            else if (symbolName == "KnkDetAdap.KnkCntCyl") // 8 length
                            {
                                int knkcountcyl1 = 0;
                                int knkcountcyl2 = 0;
                                int knkcountcyl3 = 0;
                                int knkcountcyl4 = 0;
                                if (buffer.Length == 8)
                                {
                                    knkcountcyl1 = (Convert.ToInt32(buffer.GetValue(0)) * 256) + Convert.ToInt32(buffer.GetValue(1));
                                    knkcountcyl2 = (Convert.ToInt32(buffer.GetValue(2)) * 256) + Convert.ToInt32(buffer.GetValue(3));
                                    knkcountcyl3 = (Convert.ToInt32(buffer.GetValue(4)) * 256) + Convert.ToInt32(buffer.GetValue(5));
                                    knkcountcyl4 = (Convert.ToInt32(buffer.GetValue(6)) * 256) + Convert.ToInt32(buffer.GetValue(7));
                                    UpdateRealtimeInformationInTable(dt, "KnkCntCyl1", (float)knkcountcyl1);
                                    UpdateRealtimeInformationInTable(dt, "KnkCntCyl2", (float)knkcountcyl2);
                                    UpdateRealtimeInformationInTable(dt, "KnkCntCyl3", (float)knkcountcyl3);
                                    UpdateRealtimeInformationInTable(dt, "KnkCntCyl4", (float)knkcountcyl4);
                                }

                            }
                            else if (symbolName == "MisfAdap.N_MisfCountCyl") // 8 length
                            {
                                int miscountcyl1 = 0;
                                int miscountcyl2 = 0;
                                int miscountcyl3 = 0;
                                int miscountcyl4 = 0;
                                if (buffer.Length == 8)
                                {
                                    miscountcyl1 = (Convert.ToInt32(buffer.GetValue(0)) * 256) + Convert.ToInt32(buffer.GetValue(1));
                                    miscountcyl2 = (Convert.ToInt32(buffer.GetValue(2)) * 256) + Convert.ToInt32(buffer.GetValue(3));
                                    miscountcyl3 = (Convert.ToInt32(buffer.GetValue(4)) * 256) + Convert.ToInt32(buffer.GetValue(5));
                                    miscountcyl4 = (Convert.ToInt32(buffer.GetValue(6)) * 256) + Convert.ToInt32(buffer.GetValue(7));
                                    UpdateRealtimeInformationInTable(dt, "MisfCyl1", (float)miscountcyl1);
                                    UpdateRealtimeInformationInTable(dt, "MisfCyl2", (float)miscountcyl2);
                                    UpdateRealtimeInformationInTable(dt, "MisfCyl3", (float)miscountcyl3);
                                    UpdateRealtimeInformationInTable(dt, "MisfCyl4", (float)miscountcyl4);
                                }

                            }
                            value *= Convert.ToDouble(dr["Correction"]);
                            value += Convert.ToDouble(dr["Offset"]);
                            dr["Value"] = value;

                            try
                            {
                                if (Convert.ToDouble(dr["Peak"]) < value) dr["Peak"] = value;
                            }
                            catch (Exception peakE)
                            {
                                LogHelper.Log("Failed to set peak: " + peakE.Message);
                            }
                            // update realtime info
                            UpdateRealtimeInformation(symbolName, (float)value);
                            try
                            {
                                CheckSoundsToPlay(symbolName, value);
                            }
                            catch (Exception E)
                            {
                                LogHelper.Log(E.Message);
                            }
                        }
                        else
                        {
                            LogHelper.Log("Failed to read SRAM, symbol: " + symbolName);
                            System.Windows.Forms.Application.DoEvents();
                        }
                    }
                    Thread.Sleep(0);//<GS-11022010>

                }
                // <GS-29072010> if the multiadapter is in use 
                // and the user configured to use ADCs or thermoinput, get the values
                if (m_appSettings.CANBusAdapterType == CANBusAdapter.MultiAdapter)
                {
                    if (m_appSettings.Useadc1)
                    {
                        float adc = t8can.GetADCValue(0);
                        double convertedADvalue = Math.Round(ConvertADCValue(0, adc), 2);
                        string channelName = m_appSettings.Adc1channelname;
                        AddToRealtimeTable(dt, channelName, "ADC channel 1", 0, convertedADvalue, 0, 1, 0, m_appSettings.Adc1lowvalue / 1000, m_appSettings.Adc1highvalue / 1000, 0, 0, 0, 1);
                    }
                    if (m_appSettings.Useadc2)
                    {
                        float adc = t8can.GetADCValue(1);
                        double convertedADvalue = Math.Round(ConvertADCValue(1, adc), 2);
                        string channelName = m_appSettings.Adc2channelname;
                        AddToRealtimeTable(dt, channelName, "ADC channel 2", 0, convertedADvalue, 0, 1, 0, m_appSettings.Adc2lowvalue / 1000, m_appSettings.Adc2highvalue / 1000, 0, 0, 0, 1);
                    }
                    if (m_appSettings.Useadc3)
                    {
                        float adc = t8can.GetADCValue(2);
                        double convertedADvalue = Math.Round(ConvertADCValue(2, adc), 2);
                        string channelName = m_appSettings.Adc3channelname;
                        AddToRealtimeTable(dt, channelName, "ADC channel 3", 0, convertedADvalue, 0, 1, 0, m_appSettings.Adc3lowvalue / 1000, m_appSettings.Adc3highvalue / 1000, 0, 0, 0, 1);
                    }
                    if (m_appSettings.Useadc4)
                    {
                        float adc = t8can.GetADCValue(3);
                        double convertedADvalue = Math.Round(ConvertADCValue(3, adc), 2);
                        string channelName = m_appSettings.Adc4channelname;
                        AddToRealtimeTable(dt, channelName, "ADC channel 4", 0, convertedADvalue, 0, 1, 0, m_appSettings.Adc4lowvalue / 1000, m_appSettings.Adc4highvalue / 1000, 0, 0, 0, 1);
                    }
                    if (m_appSettings.Useadc5)
                    {
                        float adc = t8can.GetADCValue(4);
                        double convertedADvalue = Math.Round(ConvertADCValue(4, adc), 2);
                        string channelName = m_appSettings.Adc5channelname;
                        AddToRealtimeTable(dt, channelName, "ADC channel 5", 0, convertedADvalue, 0, 1, 0, m_appSettings.Adc5lowvalue / 1000, m_appSettings.Adc5highvalue / 1000, 0, 0, 0, 1);
                    }
                    if (m_appSettings.Usethermo)
                    {
                        float temperature = t8can.GetThermoValue();
                        string channelName = m_appSettings.Thermochannelname;
                        AddToRealtimeTable(dt, channelName, "Thermo channel", 0, temperature, 0, 1, 0, 0, 1023, 0, 0, 0, 1);
                    }
                }

                //LogHelper.Log("Updated in " + _sw.ElapsedMilliseconds.ToString() + " ms");
                
                LogRealTimeInformation(dt);
                
                //UpdateOpenViewers();
                //<GS-06012011> maybe move the fps counter timer here!
                _sw.Stop();
                // update fps indicator
                float secs = _sw.ElapsedMilliseconds / 1000F;
                secs = 1 / secs;
                if (float.IsInfinity(secs)) secs = 1;
                UpdateRealtimeInformation("FPSCounter", secs);

                dt.EndLoadData();
            }
        }

        private void UpdateOpenViewers()
        {
            UpdateInjectionMap();
            UpdateIgnitionMap();
            UpdateAirmassMap();
        }

        /// <summary>
        /// TODO: Has to check for negative values (FFFFFFFD for exmpl)
        /// </summary>
        /// <param name="value"></param>
        /// <param name="symbolname"></param>
        /// <param name="multiplywith"></param>
        /// <returns></returns>
        private int LookUpIndexAxisRPMMap(double value, string symbolname, double multiplywith)
        {
            int return_index = -1;
            double min_difference = 10000000;

            byte[] axisvalues = readdatafromfile(m_currentfile, (int)GetSymbolAddress(m_symbols, symbolname), GetSymbolLength(m_symbols, symbolname));
            if (isSixteenBitTable(symbolname))
            {
                for (int t = 0; t < axisvalues.Length; t += 2)
                {
                    int b = (int)(byte)axisvalues.GetValue(t) * 256;
                    b += (int)(byte)axisvalues.GetValue(t + 1);
                    if (b > 32000) b = -(65536 - b); // negatief maken
                    double db = (double)b;
                    db *= multiplywith;
                    double diff = Math.Abs(db - value);
                    if (min_difference > diff)
                    {
                        min_difference = diff;
                        // this is our index
                        return_index = t / 2;
                        // LogHelper.Log("Difference was: " + diff.ToString() + " at index " + return_index.ToString());

                    }
                }
            }
            else
            {
                for (int t = 0; t < axisvalues.Length; t++)
                {
                    int b = (int)(byte)axisvalues.GetValue(t);
                    double db = (double)b;
                    db *= multiplywith;
                    double diff = Math.Abs(db - value);
                    if (min_difference > diff)
                    {
                        min_difference = diff;
                        // this is our index
                        return_index = t;
                    }
                }
            }
            return return_index;
        }

        //TODO: adjust for Trionic 8
        private void UpdateAirmassMap()
        {
            int airmassindex = 0;
            int torqueindex = 0;
            int rpmindex = 0;
            int tpsindex = 0;
            //PedalMapCal.m_RequestMap has 
            // X: PedalMapCal.n_EngineMap (rpm)
            rpmindex = LookUpIndexAxisRPMMap(_currentEngineStatus.CurrentRPM, "PedalMapCal.n_EngineMap", 1);
            // Y: PedalMapCal.X_PedalMap (tps)
            tpsindex = LookUpIndexAxisRPMMap(_currentEngineStatus.CurrentThrottlePosition, "PedalMapCal.X_PedalMap", 0.1);
            UpdateDocksWithName("PedalMapCal.Trq_RequestMap", rpmindex, tpsindex);

            //TorqueCal.m_AirTorqMap has
            // X: TorqueCal.M_EngXSP
            torqueindex = LookUpIndexAxisRPMMap(_currentEngineStatus.CurrentEngineTorque, "TrqMastCal.Trq_EngXSP", 1);
            // Y: TorqueCal.n_EngYSP
            rpmindex = LookUpIndexAxisRPMMap(_currentEngineStatus.CurrentRPM, "TrqMastCal.n_EngYSP", 1);
            UpdateDocksWithName("TrqMastCal.m_AirTorqMap", torqueindex, rpmindex);

            //TorqueCal.M_NominalMap has
            //X: TorqueCal.m_AirXSP
            //Y: TorqueCal.n_EngYSP // same, so leave that out
            airmassindex = LookUpIndexAxisRPMMap(_currentEngineStatus.CurrentAirmassPerCombustion, "TrqMastCal.m_AirXSP", 1);
            UpdateDocksWithName("TrqMastCal.Trq_NominalMap", airmassindex, rpmindex);

            //BoostCal.RegMap has:
            //X: BoostCal.SetLoadXSP (airmass)
            //Y: BoostCal.n_EngSP (rpm)
            rpmindex = LookUpIndexAxisRPMMap(_currentEngineStatus.CurrentRPM, "AirCrtlCal.n_EngYSP", 1);
            airmassindex = LookUpIndexAxisRPMMap(_currentEngineStatus.CurrentAirmassPerCombustion, "AirCrtlCal.SetLoadXSP", 1);
            UpdateDocksWithName("AirCrtlCal.RegMap", airmassindex, rpmindex);

            //BstKnkCal.MaxAirmass
            //BstKnkCal.MaxAirmassAu
            //X: BstKnkCal.OffsetXSP // special because all negative
            //Y: BstKnkCal.n_EngYSP
            string xaxisstr = "BstKnkCal.OffsetXSP";
            if (!SymbolExists(xaxisstr)) xaxisstr = "BstKnkCal.fi_offsetXSP";
            rpmindex = LookUpIndexAxisRPMMap(_currentEngineStatus.CurrentRPM, "BstKnkCal.n_EngYSP", 1);
            airmassindex = LookUpIndexAxisRPMMap(_currentEngineStatus.CurrentIgnitionOffset, xaxisstr, 0.1);
            UpdateDocksWithName("BstKnkCal.MaxAirmass", airmassindex, rpmindex);
            UpdateDocksWithName("BstKnkCal.MaxAirmassAu", airmassindex, rpmindex);
        }

        private void UpdateDocksWithName(string symbolname, int xindex, int yindex)
        {
            try
            {
                foreach (DockPanel pnl in dockManager1.Panels)
                {
                    foreach (Control c in pnl.Controls)
                    {
                        if (c is IMapViewer)
                        {
                            IMapViewer vwr = (IMapViewer)c;
                            if (vwr.Map_name.StartsWith(symbolname))
                            {
                                vwr.HighlightCell(xindex, yindex);
                            }
                        }
                        else if (c is DockPanel)
                        {
                            DockPanel tpnl = (DockPanel)c;
                            foreach (Control c2 in tpnl.Controls)
                            {
                                if (c2 is IMapViewer)
                                {
                                    IMapViewer vwr2 = (IMapViewer)c2;
                                    if (vwr2.Map_name.StartsWith(symbolname))
                                    {
                                        vwr2.HighlightCell(xindex, yindex);
                                    }

                                }
                            }
                        }
                        else if (c is ControlContainer)
                        {
                            ControlContainer cntr = (ControlContainer)c;
                            foreach (Control c3 in cntr.Controls)
                            {
                                if (c3 is IMapViewer)
                                {
                                    IMapViewer vwr3 = (IMapViewer)c3;
                                    if (vwr3.Map_name.StartsWith(symbolname))
                                    {
                                        vwr3.HighlightCell(xindex, yindex);
                                    }
                                }
                            }
                        }
                    }
                }
            }
            catch (Exception E)
            {
                LogHelper.Log(E.Message);
            }
        }

        //TODO: adjust for Trionic 8
        private void UpdateIgnitionMap()
        {

            int airmassindex = 0;
            int rpmindex = 0;
            // IgnNormCal.Map has
            //X: IgnNormCal.m_AirXSP // airmass
            //Y: IgnNormCal.n_EngYSP // engine speed
            rpmindex = LookUpIndexAxisRPMMap(_currentEngineStatus.CurrentRPM, "IgnAbsCal.n_EngNormYSP", 1);
            airmassindex = LookUpIndexAxisRPMMap(_currentEngineStatus.CurrentAirmassPerCombustion, "IgnAbsCal.m_AirNormXSP", 1);
            UpdateDocksWithName("IgnAbsCal.fi_NormalMAP", airmassindex, rpmindex);
            UpdateDocksWithName("IgnAbsCal.fi_lowOctanMAP", airmassindex, rpmindex);
            UpdateDocksWithName("IgnAbsCal.fi_highOctanMAP", airmassindex, rpmindex);
            //IgnE85Cal.fi_AbsMap has:
            // same, leave it
            //UpdateDocksWithName("IgnE85Cal.fi_AbsMap", airmassindex, rpmindex);
            //KnkFuelCal.fi_MapMaxOff has
            //X: KnkFuelCal.m_AirXSP //airmass
            //Y: BstKnkCal.n_EngYSP // engine speed
            rpmindex = LookUpIndexAxisRPMMap(_currentEngineStatus.CurrentRPM, "BstKnkCal.n_EngYSP", 1);
            airmassindex = LookUpIndexAxisRPMMap(_currentEngineStatus.CurrentAirmassPerCombustion, "KnkFuelCal.m_AirXSP", 1);
            UpdateDocksWithName("KnkFuelCal.fi_MaxOffsetMap", airmassindex, rpmindex);
            //IgnKnkCal.IndexMap has
            // X: IgnKnkCal.m_AirXSP (airmass)
            // Y: IgnKnkCal.n_EngYSP (engine speed)
            rpmindex = LookUpIndexAxisRPMMap(_currentEngineStatus.CurrentRPM, "IgnKnkCal.n_EngYSP", 1);
            airmassindex = LookUpIndexAxisRPMMap(_currentEngineStatus.CurrentAirmassPerCombustion, "IgnKnkCal.m_AirXSP", 1);
            UpdateDocksWithName("IgnKnkCal.IndexMap", airmassindex, rpmindex);
            //KnkDetCal.RefFactorMap
            // X: KnkDetCal.m_AirXSP (airmass)
            // Y: KnkDetCal.n_EngYSP (engine speed)
            //rpmindex = LookUpIndexAxisRPMMap(_currentEngineStatus.CurrentRPM, "KnkDetCal.n_EngYSP", 1);
            //airmassindex = LookUpIndexAxisRPMMap(_currentEngineStatus.CurrentAirmassPerCombustion, "KnkDetCal.m_AirXSP", 1);
            //UpdateDocksWithName("KnkDetCal.RefFactorMap", airmassindex, rpmindex);

        }

        //TODO: adjust for Trionic 8
        private void UpdateInjectionMap()
        {
            int airmassindex = 0;
            int rpmindex = 0;

            //BFuelCal.Map has
            //X: BFuelCal.AirXSP (airmass)
            //Y: BFuelCal.RpmYSP (engine speed)
            rpmindex = LookUpIndexAxisRPMMap(_currentEngineStatus.CurrentRPM, "BFuelCal.RpmYSP", 1);
            airmassindex = LookUpIndexAxisRPMMap(_currentEngineStatus.CurrentAirmassPerCombustion, "BFuelCal.AirXSP", 1);
            UpdateDocksWithName("BFuelCal.LambdaOneFacMap", airmassindex, rpmindex);
            //BFuelCal.StartMap has
            //X: BFuelCal.AirXSP (airmass)
            //Y: BFuelCal.RpmYSP (engine speed)
            // uses the same as BFuelCal.Map, so leave it
            //UpdateDocksWithName("BFuelCal.StartMap", airmassindex, rpmindex);
            //KnkFuelCal.EnrichmentMap has
            //X: IgnKnkCal.m_AirXSP // airmass
            //Y: IgnKnkCal.n_EngYSP // engine speed
            //rpmindex = LookUpIndexAxisRPMMap(_currentEngineStatus.CurrentRPM, "IgnKnkCal.n_EngYSP", 1);
            //airmassindex = LookUpIndexAxisRPMMap(_currentEngineStatus.CurrentAirmassPerCombustion, "IgnKnkCal.m_AirXSP", 1);
            //UpdateDocksWithName("KnkFuelCal.EnrichmentMap", airmassindex, rpmindex);
        }

        private void LogRealTimeInformation(System.Data.DataTable dt)
        {
            if (dt == null) return;
            if (m_currentfile == "") return;
            DateTime datet = DateTime.Now;
            string logline = datet.ToString("dd/MM/yyyy HH:mm:ss") + "." + datet.Millisecond.ToString("D3") + "|";
            //            string logline = DateTime.Now.ToString("dd/MM/yyyy HH:mm:ss") + "|";
            foreach (DataRow dr in dt.Rows)
            {
                try
                {
                    //if (Convert.ToInt32(dr["Symbolnumber"]) > 0)
                    //{
                    logline += dr["SymbolName"].ToString() + "=" + Convert.ToDouble(dr["Value"]).ToString() + "|";
                    //}
                }
                catch (Exception E)
                {
                    LogHelper.Log("Failed to log to file: " + E.Message);
                }
            }
            if (m_WriteLogMarker)
            {
                m_WriteLogMarker = false;
                logline += "IMPORTANTLINE=1|";
            }
            else
            {
                logline += "IMPORTANTLINE=0|";
            }
            if (!Directory.Exists(Path.GetDirectoryName(m_currentfile) + "\\Logs")) Directory.CreateDirectory(Path.GetDirectoryName(m_currentfile) + "\\Logs");

            using (StreamWriter sw = new StreamWriter(Path.GetDirectoryName(m_currentfile) + "\\Logs\\" + DateTime.Now.ToString("yyyyMMdd") + "-CanTraceExt.t8l", true))
            {
                sw.WriteLine(logline);
            }
        }

        private void UpdateRealtimeInformation(string symbolname, float value)
        {
            if (!this.IsDisposed)
            {
                try
                {
                    this.Invoke(m_DelegateUpdateRealTimeValue, symbolname, value);
                }
                catch (Exception E)
                {
                    LogHelper.Log(E.Message);
                }
            }

        }

        private void CheckSoundsToPlay(string symbolName, double value)
        {
            string _sound2Play = string.Empty;
            if (symbolName == m_appSettings.Notification1symbol && m_appSettings.Notification1Active)
            {
                // check bounds
                switch (m_appSettings.Notification1condition)
                {
                    case 0: // equal
                        if (value == m_appSettings.Notification1value) _sound2Play = m_appSettings.Notification1sound;
                        break;
                    case 1: // is greater than
                        if (value > m_appSettings.Notification1value) _sound2Play = m_appSettings.Notification1sound;
                        break;
                    case 2: // is smaller than
                        if (value < m_appSettings.Notification1value) _sound2Play = m_appSettings.Notification1sound;
                        break;
                }
            }
            if (symbolName == m_appSettings.Notification2symbol && m_appSettings.Notification2Active && _sound2Play == "")
            {
                // check bounds
                switch (m_appSettings.Notification2condition)
                {
                    case 0: // equal
                        if (value == m_appSettings.Notification2value) _sound2Play = m_appSettings.Notification2sound;
                        break;
                    case 1: // is greater than
                        if (value > m_appSettings.Notification2value) _sound2Play = m_appSettings.Notification2sound;
                        break;
                    case 2: // is smaller than
                        if (value < m_appSettings.Notification2value) _sound2Play = m_appSettings.Notification2sound;
                        break;
                }
            }
            if (symbolName == m_appSettings.Notification3symbol && m_appSettings.Notification3Active && _sound2Play == "")
            {
                // check bounds
                switch (m_appSettings.Notification3condition)
                {
                    case 0: // equal
                        if (value == m_appSettings.Notification3value) _sound2Play = m_appSettings.Notification3sound;
                        break;
                    case 1: // is greater than
                        if (value > m_appSettings.Notification3value) _sound2Play = m_appSettings.Notification3sound;
                        break;
                    case 2: // is smaller than
                        if (value < m_appSettings.Notification3value) _sound2Play = m_appSettings.Notification3sound;
                        break;
                }
            }
            if (_sound2Play != "")
            {
                // we need to play a sound, but not too many times in a row, we have to wait until a previous sound
                // has ended

                if (File.Exists(_sound2Play))
                {
                    try
                    {
                        if (sndplayer != null)
                        {
                            if (_soundAllowed)
                            {
                                _soundAllowed = false; // no more for 2 seconds (sndTimer)
                                sndplayer.SoundLocation = _sound2Play;
                                sndplayer.Play();
                                m_WriteLogMarker = true; // mark this in the logfile immediately
                                sndTimer.Enabled = true;
                            }
                        }
                    }
                    catch (Exception E)
                    {
                        LogHelper.Log(E.Message);
                    }
                }
            }

        }

        private double ConvertADCValue(int channel, float value)
        {
            double retval = value;
            double m_HighVoltage = 5;
            double m_LowVoltage = 0;
            double m_HighValue = 1;
            double m_LowValue = 0;
            switch (channel)
            {
                case 0:
                    m_HighVoltage = m_appSettings.Adc1highvoltage;
                    m_LowVoltage = m_appSettings.Adc1lowvoltage;
                    m_LowValue = m_appSettings.Adc1lowvalue;
                    m_HighValue = m_appSettings.Adc1highvalue;
                    break;
                case 1:
                    m_HighVoltage = m_appSettings.Adc2highvoltage;
                    m_LowVoltage = m_appSettings.Adc2lowvoltage;
                    m_LowValue = m_appSettings.Adc2lowvalue;
                    m_HighValue = m_appSettings.Adc2highvalue;
                    break;
                case 2:
                    m_HighVoltage = m_appSettings.Adc3highvoltage;
                    m_LowVoltage = m_appSettings.Adc3lowvoltage;
                    m_LowValue = m_appSettings.Adc3lowvalue;
                    m_HighValue = m_appSettings.Adc3highvalue;
                    break;
                case 3:
                    m_HighVoltage = m_appSettings.Adc4highvoltage;
                    m_LowVoltage = m_appSettings.Adc4lowvoltage;
                    m_LowValue = m_appSettings.Adc4lowvalue;
                    m_HighValue = m_appSettings.Adc4highvalue;
                    break;
                case 4:
                    m_HighVoltage = m_appSettings.Adc5highvoltage;
                    m_LowVoltage = m_appSettings.Adc5lowvoltage;
                    m_LowValue = m_appSettings.Adc5lowvalue;
                    m_HighValue = m_appSettings.Adc5highvalue;
                    break;
                default:
                    break;
            }
            // convert using the known math
            // convert to AFR value using wideband lambda sensor settings
            // ranges 0 - 255 will be default for 0-5 volt
            double voltage = value; // <GS-14042011> Combiadapter seems to generate voltage in stead of 0-255 values ((value) / 255) * (m_HighVoltage / 1000 - m_LowVoltage / 1000);
            //LogHelper.Log("Wideband voltage: " + voltage.ToString());
            // now convert to AFR using user settings
            if (voltage < m_LowVoltage / 1000) voltage = m_LowVoltage / 1000;
            if (voltage > m_HighVoltage / 1000) voltage = m_HighVoltage / 1000;
            //LogHelper.Log("Wideband voltage (after clipping): " + voltage.ToString());
            double steepness = ((m_HighValue / 1000) - (m_LowValue / 1000)) / ((m_HighVoltage / 1000) - (m_LowVoltage / 1000));
            //LogHelper.Log("Steepness: " + steepness.ToString());
            retval = (m_LowValue / 1000) + (steepness * (voltage - (m_LowVoltage / 1000)));
            //LogHelper.Log("retval: " + retval.ToString());
            return retval;

        }

        private void UpdateRealtimeInformationInTable(System.Data.DataTable dt, string symbolname, double value)
        {
            if (dt != null)
            {
                bool _symbolFound = false;
                foreach (DataRow dr in dt.Rows)
                {
                    if (dr["SymbolName"].ToString() == symbolname)
                    {
                        dr["Value"] = value;
                        _symbolFound = true;
                        break;
                    }
                }
                if (!_symbolFound)
                {
                    dt.Rows.Add(symbolname, 0, value, 0, 1, 0, 0, 65535, 0, 0, 0, 1, 1, 1);
                }
            }
        }

        private void btnWriteLogMarker_ItemClick(object sender, ItemClickEventArgs e)
        {
            m_WriteLogMarker = true;
        }

        private void sndTimer_Tick(object sender, EventArgs e)
        {
            sndTimer.Enabled = false;
            _soundAllowed = true; // re-allow the playback of sounds
        }

        private string ConvertFuelcutStatus(int value)
        {
            //Fuel cut status, indicates what caused the fuelcut: 
            //0 - No fuelcut 
            //1 - Ignition key turned off 
            //2 - Acc pedal pressed during start 
            //3 - Engine speed above limit 
            //4 - Throttle block adaption active for the first time 
            //5 - 6 - Airmass guard ( pressure guard ) 
            //7 - Immobilizer code not correct 
            //8 - Current to h-bridge to high during throttle limphome 
            //9 - Torque to high during throttle limphome 
            //10 - Not used 
            //11 - Tampering protection of throttle 
            //12 - Error on all ignition trigg outputs 
            //13 - ECU not correctly programmed 
            //14 - To high rpm in Throttle limp home, pedal poti fault 
            //15 - Torque Master fuel cut request 
            //16 - TCM requests fuelcut to smoothen gear shift 
            //20 - Application conditions for fuel cut: See \"HELP FUEL_CUT\" menu.
            string retval = value.ToString();
            switch (value)
            {
                case 0:
                    retval = "No fuelcut";
                    break;
                case 1:
                    retval = "Ignition key turned off";
                    break;
                case 2:
                    retval = "Accelerator pedal pressed during start";
                    break;
                case 3:
                    retval = "RPM limiter (engine speed guard)";
                    break;
                case 4:
                    retval = "Throttle block adaption active 1st time";
                    break;
                case 5:
                    retval = "Engine position lost";
                    break;
                case 6:
                    retval = "Airmass limit (pressure guard)";
                    break;
                case 7:
                    retval = "Immobilizer code incorrect";
                    break;
                case 8:
                case 9:
                    retval = "Starter control relay circuit short to ground";
                    break;
                case 11:
                    retval = "Tampering protection of throttle";
                    break;
                case 12:
                    retval = "Error on all ignition trigger outputs";
                    break;
                case 13:
                    retval = "ECU not correctly programmed";
                    break;
                case 14:
                    retval = "Forced fuelcut by user";
                    break;
                case 15:
                    retval = "Transmission requests fuelcut";
                    break;
                case 16:
                    retval = "Kill engine, after engine has started, rpm too low";
                    break;
                case 20:
                    retval = "Application conditions for fuel cut -SAAB";
                    break;
                case 21:
                    retval = "Application conditions for fuel cut -OPEL";
                    break;
                case 31:
                    retval = "Power management fuelcut on one cylinder";
                    break;
                case 32:
                    retval = "Power management fuelcut on two cylinders";
                    break;
                case 33:
                    retval = "Power management fuelcut on three cylinders";
                    break;
                case 34:
                    retval = "Power management fuelcut on four cylinders";
                    break;
                case 35:
                    retval = "Power management fuelcut on five cylinders";
                    break;
                case 36:
                    retval = "Power management fuelcut on six cylinders";
                    break;
            }
            return retval;
        }

        private string ConvertLambdaStatus(int value)
        {
            string retval = value.ToString();
            switch (value)
            {
                case 0:
                    retval = "Closed loop activated";
                    break;
                case 1:
                    retval = "Closed loop not activated";
                    break;
                case 2:
                    retval = "Load too low";
                    break;
                case 3:
                    retval = "Fuel enrichment in progress (no knock)";
                    break;
                case 4:
                    retval = "Fuel enrichment in progress (knock)";
                    break;
                case 5:
                    retval = "CW temp too low, closed throttle";
                    break;
                case 6:
                    retval = "CW temp too low, open throttle";
                    break;
                case 7:
                    retval = "Engine speed too low";
                    break;
                case 8:
                    retval = "Negative throttle transient in progress";
                    break;
                case 9:
                    retval = "Positive throttle transient in progress";
                    break;
                case 10:
                    retval = "Fuel cut";
                    break;
                case 11:
                    retval = "Throttle in limp home";
                    break;
                case 12:
                    retval = "Diagnostic failure that affects the lambda control";
                    break;
                case 13:
                    retval = "Engine not started";
                    break;
                case 14:
                    retval = "Waiting number of combustion before hardware check";
                    break;
                case 15:
                    retval = "Waiting until engine probe is warm";
                    break;
                case 16:
                    retval = "Waiting until number of combustions have past after probe is warm";
                    break;
                case 17:
                    retval = "Hot soak in progress";
                    break;
                case 18:
                    retval = "SAI: Number of combustion to start closed loop has not passed";
                    break;
                case 19:
                    retval = "Lambda integrator is frozen to 0 by SAI lean clamp";
                    break;
                case 20:
                    retval = "Catalyst diagnose for V6 controls the fuel";
                    break;
                case 21:
                    retval = "Lambda start not finished";
                    break;
                case 22:
                    retval = "Lambda probe diagnose request open loop";
                    break;
            }
            return retval;
        }

        private string ConvertActiveAirDemand(int value)
        {
            string retval = value.ToString();
            switch (value)
            {
                case 10:
                    retval = "PedalMap";
                    break;
                case 11:
                    retval = "Cruise control";
                    break;
                case 12:
                    retval = "Idle control";
                    break;
                case 20:
                    retval = "Max engine torque";
                    break;
                case 21:
                    retval = "Traction control";
                    break;
                case 22:
                    retval = "Manual gearbox limit";
                    break;
                case 23:
                    retval = "Automatic gearbox limit";
                    break;
                case 24:
                    retval = "Stall limit (Aut)";
                    break;
                case 25:
                    retval = "Special mode";
                    break;
                case 26:
                    retval = "Reverse limit";
                    break;
                case 27:
                    retval = "Max vehicle speed";
                    break;
                case 28:
                    retval = "Brake management";
                    break;
                case 29:
                    retval = "System action";
                    break;
                case 30:
                    retval = "Max engine speed";
                    break;
                case 31:
                    retval = "Max vehicle speed";
                    break;
                case 40:
                    retval = "Min load";
                    break;
                case 41:
                    retval = "Min load";
                    break;
                case 50:
                    retval = "Knock airmass limit";
                    break;
                case 51:
                    retval = "Max engine speed";
                    break;
                case 52:
                    retval = "Max turbo speed";
                    break;
                case 53:
                    retval = "Max turbo speed";
                    break;
                case 54:
                    retval = "Crankcase vent error";
                    break;
                case 55:
                    retval = "Faulty APC";
                    break;
                case 61:
                    retval = "Engine tipin limit";
                    break;
                case 62:
                    retval = "Engine tipout limit";
                    break;
            }
            return retval;
        }

        private void btnGetFlashContent_ItemClick(object sender, ItemClickEventArgs e)
        {
            SaveFileDialog sfd = new SaveFileDialog();
            sfd.Filter = "Binary files|*.bin";
            if (sfd.ShowDialog() == DialogResult.OK)
            {

                SetCanAdapter();
                SetProgress("Starting flash download");
                if (!t8can.isOpen())
                {
                    t8can.openDevice(false);
                }
                if (t8can.isOpen())
                {
                    m_prohibitReading = true;
                    //byte[] snapshot = t8can.getFlashContent();                    
                    DoWorkEventArgs args = new DoWorkEventArgs(sfd.FileName);

                    t8can.ReadFlash(this, args);
                    while (args.Result == null)
                    {
                        System.Windows.Forms.Application.DoEvents();
                        Thread.Sleep(10);
                    }
                    if ((bool)args.Result == true)
                    {
                        frmInfoBox info = new frmInfoBox("Download done");
                    }
                    m_prohibitReading = false;
                    SetProgressIdle();
                }
            }
        }

        private void btnFlashECU_ItemClick(object sender, ItemClickEventArgs e)
        {            
            OpenFileDialog ofd = new OpenFileDialog();
            ofd.Filter = "Binary files|*.bin";
            ofd.Multiselect = false;
            if (ofd.ShowDialog() == DialogResult.OK)
            {

                SetCanAdapter();

                SetProgress("Starting flash download");
                if (!t8can.isOpen())
                {
                    t8can.openDevice(false);
                }
                if (t8can.isOpen())
                {
                    m_prohibitReading = true;
                    Thread.Sleep(1000);
                    System.Windows.Forms.Application.DoEvents();
                    DoWorkEventArgs args = new DoWorkEventArgs(ofd.FileName);
                    t8can.WriteFlash(this, args);
                    while (args.Result == null)
                    {
                        System.Windows.Forms.Application.DoEvents();
                        Thread.Sleep(10);
                    }
                    if ((bool)args.Result == true)
                    {
                        frmInfoBox info = new frmInfoBox("Flash sequence done");
                    }
                    else
                    {
                        if (t8can.NeedRecovery)
                        {
                            if (MessageBox.Show("Flash was erased but programming failed, do you which to attempt to recover the ECU?", "Warning!", MessageBoxButtons.YesNo) == DialogResult.OK)
                            {
                                t8can.RecoverECU(this, args);
                                while (args.Result == null)
                                {
                                    System.Windows.Forms.Application.DoEvents();
                                    Thread.Sleep(10);
                                }
                            }
                        }
                        else
                        {
                            frmInfoBox info = new frmInfoBox("Failed to update flash");
                        }
                        //<GS-12052011> if erase was done, we need to give the user an option to recover the ECU

                    }
                }
                else
                {
                    frmInfoBox info = new frmInfoBox("Unable to connect to Trionic 8 ECU");
                }
                m_prohibitReading = false;
                SetProgressIdle();
            }
        }

        private void btnImportSRAMFile_ItemClick(object sender, ItemClickEventArgs e)
        {
            //openFileDialog3.FileName = Path.GetFileNameWithoutExtension(m_currentfile) + ".RAM";
            OpenFileDialog ofd = new OpenFileDialog();
            ofd.Multiselect = false;
            ofd.Filter = "Snapshots|*.RAM";
            if (ofd.ShowDialog() == DialogResult.OK)
            {
                if (File.Exists(ofd.FileName))
                {
                    OpenSRAMFile(ofd.FileName);
                }
            }
        }

        private void OpenSRAMFile(string filename)
        {
            // opens the sram dump file and displays the maps inside the dump file
            // after verifying that this ramdump matches the selected binary.
            // this can result in a compare between flash maps and the sram map values
            m_currentsramfile = filename;
            barStaticItem1.Caption = "SRAM: " + Path.GetFileNameWithoutExtension(m_currentsramfile);

        }

        private byte[] readdatafromSRAMfile(string filename, int address, int length)
        {
            byte[] retval = new byte[length];
            FileStream fsi1 = File.OpenRead(filename);
            while (address > fsi1.Length) address -= (int)fsi1.Length;
            BinaryReader br1 = new BinaryReader(fsi1);
            fsi1.Position = address;
            string temp = string.Empty;
            for (int i = 0; i < length; i++)
            {
                retval.SetValue(br1.ReadByte(), i);
            }
            fsi1.Flush();
            br1.Close();
            fsi1.Close();
            fsi1.Dispose();
            return retval;
        }

        private void StartSRAMTableViewer(string filename, string symbolname, int length, int flashaddress, int sramaddress)
        {
            if (!File.Exists(filename)) return;
            DockPanel dockPanel;
            bool pnlfound = false;
            foreach (DockPanel pnl in dockManager1.Panels)
            {
                if (pnl.Text == "SRAM Symbol: " + symbolname + " [" + Path.GetFileName(m_currentsramfile) + "]")
                {
                    dockPanel = pnl;
                    pnlfound = true;
                    dockPanel.Show();
                }
            }
            if (!pnlfound)
            {
                dockManager1.BeginUpdate();
                try
                {
                    dockPanel = dockManager1.AddPanel(DockingStyle.Right);
                    dockPanel.Tag = filename;
                    IMapViewer tabdet;//= new MapViewer();
                    tabdet = new MapViewerEx();
                    tabdet.AutoUpdateIfSRAM = false;// m_appSettings.AutoUpdateSRAMViewers;
                    //tabdet.AutoUpdateInterval = m_appSettings.AutoUpdateInterval;
                    tabdet.SetViewSize(m_appSettings.DefaultViewSize);
                    tabdet.Filename = filename;
                    tabdet.Viewtype = m_appSettings.DefaultViewType;
                    tabdet.GraphVisible = m_appSettings.ShowGraphs;
                    //tabdet.IsHexMode = barViewInHex.Checked;
                    if (m_appSettings.Viewinhex)
                    {
                        tabdet.Viewtype = ViewType.Hexadecimal;
                    }
                    tabdet.DisableColors = m_appSettings.DisableMapviewerColors;
                    tabdet.AutoSizeColumns = m_appSettings.AutoSizeColumnsInWindows;
                    tabdet.IsRedWhite = m_appSettings.ShowRedWhite;
                    tabdet.Map_name = symbolname;
                    tabdet.Map_descr = TranslateSymbolName(tabdet.Map_name);
                    tabdet.Map_cat = XDFCategories.Undocumented;
                    tabdet.X_axisvalues = GetXaxisValues(m_currentfile, m_symbols, tabdet.Map_name);
                    tabdet.Y_axisvalues = GetYaxisValues(m_currentfile, m_symbols, tabdet.Map_name);

                    /** new 12/11/2008 **/
                    if (!m_appSettings.NewPanelsFloating)
                    {
                        // dockPanel = dockManager1.AddPanel(DevExpress.XtraBars.Docking.DockingStyle.Right);
                        if (m_appSettings.DefaultViewSize == ViewSize.NormalView)
                        {
                            int dw = 650;
                            if (tabdet.X_axisvalues.Length > 0)
                            {
                                dw = 30 + ((tabdet.X_axisvalues.Length + 1) * 35);
                            }
                            if (dw < 400) dw = 400;
                            if (m_appSettings.ShowGraphs)
                            {
                                dockPanel.FloatSize = new Size(dw, 900);
                            }
                            else
                            {
                                dockPanel.FloatSize = new Size(dw, 500);
                            }
                        }
                        else if (m_appSettings.DefaultViewSize == ViewSize.SmallView)
                        {
                            int dw = 550;
                            if (tabdet.X_axisvalues.Length > 0)
                            {
                                dw = 30 + ((tabdet.X_axisvalues.Length + 1) * 35);
                            }
                            if (dw < 380) dw = 380;
                            if (m_appSettings.ShowGraphs)
                            {
                                dockPanel.FloatSize = new Size(dw, 850);
                            }
                            else
                            {
                                dockPanel.FloatSize = new Size(dw, 450);
                            }
                        }
                        else if (m_appSettings.DefaultViewSize == ViewSize.ExtraSmallView)
                        {
                            int dw = 450;
                            if (tabdet.X_axisvalues.Length > 0)
                            {
                                dw = 30 + ((tabdet.X_axisvalues.Length + 1) * 30);
                            }
                            if (dw < 380) dw = 380;
                            if (m_appSettings.ShowGraphs)
                            {
                                dockPanel.FloatSize = new Size(dw, 700);
                            }
                            else
                            {
                                dockPanel.FloatSize = new Size(dw, 450);
                            }
                        }
                    }

                    SymbolAxesTranslator axestrans = new SymbolAxesTranslator();
                    string x_axis = string.Empty;
                    string y_axis = string.Empty;
                    string x_axis_descr = string.Empty;
                    string y_axis_descr = string.Empty;
                    string z_axis_descr = string.Empty;
                    axestrans.GetAxisSymbols(tabdet.Map_name, out x_axis, out y_axis, out x_axis_descr, out y_axis_descr, out z_axis_descr);

                    if (x_axis == "BstKnkCal.OffsetXSP")
                    {
                        if (!SymbolExists(x_axis)) x_axis = "BstKnkCal.fi_offsetXSP";
                    }

                    tabdet.X_axis_name = x_axis_descr;
                    tabdet.Y_axis_name = y_axis_descr;
                    tabdet.Z_axis_name = z_axis_descr;


                    int columns = 8;
                    int rows = 8;
                    int tablewidth = GetTableMatrixWitdhByName(m_currentfile, m_symbols, tabdet.Map_name, out columns, out rows);
                    int address = flashaddress;
                    //int sramaddress = sramaddress;
                    if (sramaddress != 0)
                    {
                        // while (address > m_currentfile_size) address -= m_currentfile_size;
                        tabdet.Map_address = address;
                        tabdet.Map_sramaddress = sramaddress;
                        tabdet.Map_length = length;
                        byte[] mapdata = readdatafromSRAMfile(filename, sramaddress, length);
                        tabdet.Map_content = mapdata;
                        tabdet.Correction_factor = GetMapCorrectionFactor(tabdet.Map_name);
                        tabdet.Correction_offset = GetMapCorrectionOffset(tabdet.Map_name);
                        tabdet.IsUpsideDown = GetMapUpsideDown(tabdet.Map_name);
                        tabdet.ShowTable(columns, isSixteenBitTable(tabdet.Map_name));

                        tabdet.IsRAMViewer = true;
                        tabdet.OnlineMode = true;
                        tabdet.Dock = DockStyle.Fill;
                        //tabdet.onSymbolSave += new MapViewer.NotifySaveSymbol(tabdet_onSymbolSave);
                        tabdet.onClose += new IMapViewer.ViewerClose(tabdet_onClose);
                        //tabdet.onAxisLock += new MapViewer.NotifyAxisLock(tabdet_onAxisLock);
                        //tabdet.onSliderMove += new MapViewer.NotifySliderMove(tabdet_onSliderMove);
                        //tabdet.onSelectionChanged += new MapViewer.SelectionChanged(tabdet_onSelectionChanged);
                        //tabdet.onSplitterMoved += new MapViewer.SplitterMoved(tabdet_onSplitterMoved);
                        //tabdet.onSurfaceGraphViewChanged += new MapViewer.SurfaceGraphViewChanged(tabdet_onSurfaceGraphViewChanged);
                        //tabdet.onGraphSelectionChanged += new MapViewer.GraphSelectionChanged(tabdet_onGraphSelectionChanged);
                        //tabdet.onViewTypeChanged += new MapViewer.ViewTypeChanged(tabdet_onViewTypeChanged);
                        tabdet.onReadFromSRAM += new IMapViewer.ReadDataFromSRAM(tabdet_onReadFromSRAM);
                        tabdet.onWriteToSRAM += new IMapViewer.WriteDataToSRAM(tabdet_onWriteToSRAM);
                        tabdet.onSelectionChanged += new IMapViewer.SelectionChanged(tabdet_onSelectionChanged);
                        tabdet.onSurfaceGraphViewChangedEx += new IMapViewer.SurfaceGraphViewChangedEx(mv_onSurfaceGraphViewChangedEx);
                        tabdet.onSurfaceGraphViewChanged += new IMapViewer.SurfaceGraphViewChanged(mv_onSurfaceGraphViewChanged);


                        //dockPanel.DockAsTab(dockPanel1);
                        dockPanel.Text = "SRAM Symbol: " + tabdet.Map_name + " [" + Path.GetFileName(filename) + "]";
                        bool isDocked = false;
                        if (m_appSettings.AutoDockSameSymbol)
                        {
                            foreach (DockPanel pnl in dockManager1.Panels)
                            {
                                if (pnl.Text.StartsWith("SRAM Symbol: " + tabdet.Map_name) && pnl != dockPanel && (pnl.Visibility == DockVisibility.Visible))
                                {
                                    dockPanel.DockAsTab(pnl, 0);
                                    isDocked = true;
                                    break;
                                }
                            }
                        }
                        /*if (!isDocked)
                        {
                            if (m_appSettings.AutoDockSameFile)
                            {
                                foreach (DevExpress.XtraBars.Docking.DockPanel pnl in dockManager1.Panels)
                                {
                                    if ((string)pnl.Tag == filename && pnl != dockPanel && (pnl.Visibility == DevExpress.XtraBars.Docking.DockVisibility.Visible))
                                    {
                                        dockPanel.DockAsTab(pnl, 0);
                                        isDocked = true;
                                        break;
                                    }
                                }
                            }
                        }*/

                        if (!isDocked)
                        {
                            dockPanel.DockTo(dockManager1, DockingStyle.Right, 0);
                            if (m_appSettings.AutoSizeNewWindows)
                            {
                                if (tabdet.X_axisvalues.Length > 0)
                                {
                                    dockPanel.Width = 30 + ((tabdet.X_axisvalues.Length + 1) * 35);
                                }
                                else
                                {
                                    //dockPanel.Width = this.Width - dockSymbols.Width - 10;
                                }
                            }
                            if (dockPanel.Width < 400) dockPanel.Width = 400;

                        }
                        dockPanel.Controls.Add(tabdet);
                    }
                }
                catch (Exception newdockE)
                {
                    LogHelper.Log(newdockE.Message);
                }
                dockManager1.EndUpdate();
            }
        }

        void mv_onSurfaceGraphViewChanged(object sender, IMapViewer.SurfaceGraphViewChangedEventArgs e)
        {
            if (m_appSettings.SynchronizeMapviewers)
            {
                foreach (DockPanel pnl in dockManager1.Panels)
                {
                    foreach (Control c in pnl.Controls)
                    {
                        if (c is IMapViewer)
                        {
                            if (c != sender)
                            {
                                IMapViewer vwr = (IMapViewer)c;
                                if (vwr.Map_name == e.Mapname)
                                {
                                    vwr.SetSurfaceGraphView(e.Pov_x, e.Pov_y, e.Pov_z, e.Pan_x, e.Pan_y, e.Pov_d);
                                    vwr.Invalidate();
                                }
                            }
                        }
                        else if (c is DockPanel)
                        {
                            DockPanel tpnl = (DockPanel)c;
                            foreach (Control c2 in tpnl.Controls)
                            {
                                if (c2 is IMapViewer)
                                {
                                    if (c2 != sender)
                                    {
                                        IMapViewer vwr2 = (IMapViewer)c2;
                                        if (vwr2.Map_name == e.Mapname)
                                        {
                                            vwr2.SetSurfaceGraphView(e.Pov_x, e.Pov_y, e.Pov_z, e.Pan_x, e.Pan_y, e.Pov_d);
                                            vwr2.Invalidate();
                                        }
                                    }
                                }
                            }
                        }
                        else if (c is ControlContainer)
                        {
                            ControlContainer cntr = (ControlContainer)c;
                            foreach (Control c3 in cntr.Controls)
                            {
                                if (c3 is IMapViewer)
                                {
                                    if (c3 != sender)
                                    {
                                        IMapViewer vwr3 = (IMapViewer)c3;
                                        if (vwr3.Map_name == e.Mapname)
                                        {
                                            vwr3.SetSurfaceGraphView(e.Pov_x, e.Pov_y, e.Pov_z, e.Pan_x, e.Pan_y, e.Pov_d);
                                            vwr3.Invalidate();
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }

        private byte[] ReadMapFromSRAM(SymbolHelper sh)
        {
            m_prohibitReading = true;
            bool success = false;
            int blockSize = 0x40;

            // we need security access for this


            LogHelper.Log("reading from address: " + sh.Start_address.ToString("X8") + " len: " + sh.Length.ToString());
            byte[] mapvalues = new byte[sh.Length];
            if (sh.Length < blockSize)
            {
                mapvalues = t8can.readMemory((int)sh.Start_address, sh.Length, out success);
                LogHelper.Log("ReadMapFromSRAM: " + success.ToString());
            }
            else
            {
                // 0x80 bytes at a time
                int nrReads = sh.Length / blockSize;
                if (sh.Length % blockSize > 0) nrReads++;
                int idx = 0;
                for (int i = 0; i < nrReads; i++)
                {
                    int address2read = (int)sh.Start_address + (i * blockSize);
                    int length2read = blockSize;
                    byte[] blockBytes = t8can.readMemory(address2read, length2read, out success);
                    Thread.Sleep(1);
                    LogHelper.Log("ReadMapFromSRAM: " + success.ToString());
                    // copy bytes to complete buffer
                    for (int j = 0; j < length2read; j++)
                    {
                        if (idx < mapvalues.Length)
                        {
                            mapvalues[idx++] = blockBytes[j];
                        }
                    }
                }
            }
            m_prohibitReading = false;
            return mapvalues;
        }

        void tabdet_onReadFromSRAM(object sender, IMapViewer.ReadFromSRAMEventArgs e)
        {
            // read data from SRAM through CAN bus and refresh the viewer with it
            bool writepossible = false;
            try
            {
                m_prohibitReading = true;
                //if (flash != null)
                {
                    if (m_connectedToECU)
                    {
                        writepossible = true;
                        //T5 byte[] resulttemp = tcan.readRAM((ushort)GetSymbolAddressSRAM(m_symbols, e.Mapname), (uint)GetSymbolLength(m_symbols, e.Mapname) + 1);
                        int symbolindex = GetSymbolNumberFromRealtimeList(GetSymbolNumber(m_symbols, e.Mapname), e.Mapname);
                        if (symbolindex >= 0)
                        {
                            //LogHelper.Log("Reading " + symbolindex.ToString() + " " + e.Mapname);
                            System.Windows.Forms.Application.DoEvents();
                            foreach (SymbolHelper shs in m_symbols)
                            {
                                if (shs.Varname == e.Mapname)
                                {
                                    try
                                    {
                                        byte[] result = ReadMapFromSRAM(shs);
                                        int rows = 0;
                                        int cols = 0;
                                        foreach (DockPanel pnl in dockManager1.Panels)
                                        {
                                            if (pnl.Text.StartsWith("Symbol: ") || pnl.Text.StartsWith("SRAM"))
                                            {
                                                foreach (Control c in pnl.Controls)
                                                {
                                                    if (c is IMapViewer)
                                                    {
                                                        IMapViewer vwr = (IMapViewer)c;
                                                        if (vwr.Map_name == e.Mapname)
                                                        {
                                                            vwr.Map_content = result;
                                                            GetTableMatrixWitdhByName(m_currentfile, m_symbols, e.Mapname, out cols, out rows);
                                                            vwr.IsRAMViewer = false;
                                                            vwr.ShowTable(cols, isSixteenBitTable(e.Mapname));
                                                            if ((m_connectedToECU) /*|| m_appSettings.DebugMode*/)
                                                            {
                                                                vwr.OnlineMode = true;
                                                                vwr.IsRAMViewer = true;
                                                            }
                                                            else
                                                            {
                                                                vwr.IsRAMViewer = false;
                                                            }
                                                        }
                                                    }
                                                    else if (c is DockPanel)
                                                    {
                                                        DockPanel tpnl = (DockPanel)c;
                                                        foreach (Control c2 in tpnl.Controls)
                                                        {
                                                            if (c2 is IMapViewer)
                                                            {
                                                                IMapViewer vwr2 = (IMapViewer)c2;
                                                                if (vwr2.Map_name == e.Mapname)
                                                                {
                                                                    vwr2.Map_content = result;
                                                                    GetTableMatrixWitdhByName(m_currentfile, m_symbols, e.Mapname, out cols, out rows);
                                                                    vwr2.IsRAMViewer = false;
                                                                    vwr2.ShowTable(cols, isSixteenBitTable(e.Mapname));
                                                                    if ((m_connectedToECU) /*|| m_appSettings.DebugMode*/)
                                                                    {
                                                                        vwr2.OnlineMode = true;
                                                                        vwr2.IsRAMViewer = true;
                                                                    }
                                                                    else
                                                                    {
                                                                        vwr2.IsRAMViewer = false;
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                    else if (c is ControlContainer)
                                                    {
                                                        ControlContainer cntr = (ControlContainer)c;
                                                        foreach (Control c3 in cntr.Controls)
                                                        {
                                                            if (c3 is IMapViewer)
                                                            {
                                                                IMapViewer vwr3 = (IMapViewer)c3;
                                                                if (vwr3.Map_name == e.Mapname)
                                                                {
                                                                    vwr3.Map_content = result;
                                                                    GetTableMatrixWitdhByName(m_currentfile, m_symbols, e.Mapname, out cols, out rows);
                                                                    vwr3.IsRAMViewer = false;
                                                                    vwr3.ShowTable(cols, isSixteenBitTable(e.Mapname));
                                                                    if ((m_connectedToECU) /*|| m_appSettings.DebugMode*/)
                                                                    {
                                                                        vwr3.OnlineMode = true;
                                                                        vwr3.IsRAMViewer = true;
                                                                    }
                                                                    else
                                                                    {
                                                                        vwr3.IsRAMViewer = false;
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }

                                            }
                                        }
                                    }
                                    catch (Exception E)
                                    {
                                        LogHelper.Log("Refresh viewer with SRAM data error: " + E.Message);
                                    }
                                    break;
                                }
                            }

                        }
                    }
                }
                if (!writepossible)
                {
                    frmInfoBox info = new frmInfoBox("An active CAN bus connection is needed to get data from the ECU");
                }
            }
            catch (Exception E)
            {
                LogHelper.Log("Failed to read MAP from SRAM: " + E.Message);
            }
            m_prohibitReading = false;
        }

        private void WriteMapToSRAM(string mapname, byte[] data)
        {
            //TODO: Implement SRAM writing for Trionic 8
        }

        void tabdet_onWriteToSRAM(object sender, IMapViewer.WriteToSRAMEventArgs e)
        {
            // write data to SRAM, check for valid connection first
            bool writepossible = false;
            try
            {
                //if (flash != null)
                {
                    if (m_connectedToECU)
                    {
                        writepossible = true;
                        m_prohibitReading = true;
                        try
                        {


                            WriteMapToSRAM(e.Mapname, e.Data);
                        }
                        catch (Exception E)
                        {
                            LogHelper.Log("Failed to write to SRAM: " + E.Message);
                        }
                    }
                }
                if (!writepossible)
                {
                    frmInfoBox info = new frmInfoBox("An active CAN bus connection is needed to write data to the ECU");
                }
            }
            catch (Exception E)
            {
                LogHelper.Log("Failed to write map to SRAM: " + E.Message);
            }
            m_prohibitReading = false;
        }

        private void StartSRAMTableViewer()
        {
            if (gridViewSymbols.SelectedRowsCount > 0)
            {
                int[] selrows = gridViewSymbols.GetSelectedRows();
                if (selrows.Length > 0)
                {
                    SymbolHelper sh = (SymbolHelper)gridViewSymbols.GetRow((int)selrows.GetValue(0));
                    DockPanel dockPanel;
                    bool pnlfound = false;
                    foreach (DockPanel pnl in dockManager1.Panels)
                    {
                        if (pnl.Text == "SRAM Symbol: " + sh.Varname + " [" + Path.GetFileName(m_currentsramfile) + "]")
                        {
                            dockPanel = pnl;
                            pnlfound = true;
                            dockPanel.Show();
                        }
                    }
                    if (!pnlfound)
                    {
                        dockManager1.BeginUpdate();
                        try
                        {
                            dockPanel = dockManager1.AddPanel(new System.Drawing.Point(-500, -500));
                            if (m_appSettings.ShowGraphs)
                            {
                                dockPanel.FloatSize = new Size(650, 700);
                            }
                            else
                            {
                                dockPanel.FloatSize = new Size(650, 450);
                            }
                            dockPanel.Tag = m_currentsramfile;
                            IMapViewer tabdet;//= new MapViewer();
                            tabdet = new MapViewerEx();
                            tabdet.AutoUpdateIfSRAM = false;// m_appSettings.AutoUpdateSRAMViewers;
                            //tabdet.AutoUpdateInterval = m_appSettings.AutoUpdateInterval;
                            tabdet.SetViewSize(m_appSettings.DefaultViewSize);
                            tabdet.Filename = m_currentsramfile;
                            tabdet.GraphVisible = m_appSettings.ShowGraphs;
                            //tabdet.IsHexMode = barViewInHex.Checked;
                            tabdet.Viewtype = m_appSettings.DefaultViewType;//ViewType.Easy;
                            if (m_appSettings.Viewinhex)
                            {
                                tabdet.Viewtype = ViewType.Hexadecimal;
                            }
                            tabdet.DisableColors = m_appSettings.DisableMapviewerColors;
                            tabdet.AutoSizeColumns = m_appSettings.AutoSizeColumnsInWindows;
                            tabdet.IsRedWhite = m_appSettings.ShowRedWhite;
                            tabdet.Map_name = sh.Varname;
                            tabdet.Map_descr = TranslateSymbolName(tabdet.Map_name);
                            tabdet.Map_cat = XDFCategories.Undocumented;
                            tabdet.X_axisvalues = GetXaxisValues(m_currentfile, m_symbols, tabdet.Map_name);
                            tabdet.Y_axisvalues = GetYaxisValues(m_currentfile, m_symbols, tabdet.Map_name);

                            /** NEW 12/11/2008 **/
                            if (!m_appSettings.NewPanelsFloating)
                            {
                                dockPanel = dockManager1.AddPanel(DockingStyle.Right);
                                if (m_appSettings.DefaultViewSize == ViewSize.NormalView)
                                {
                                    int dw = 650;
                                    if (tabdet.X_axisvalues.Length > 0)
                                    {
                                        dw = 30 + ((tabdet.X_axisvalues.Length + 1) * 35);
                                    }
                                    if (dw < 400) dw = 400;
                                    if (m_appSettings.ShowGraphs)
                                    {
                                        dockPanel.FloatSize = new Size(dw, 900);
                                    }
                                    else
                                    {
                                        dockPanel.FloatSize = new Size(dw, 500);
                                    }
                                }
                                else if (m_appSettings.DefaultViewSize == ViewSize.SmallView)
                                {
                                    int dw = 550;
                                    if (tabdet.X_axisvalues.Length > 0)
                                    {
                                        dw = 30 + ((tabdet.X_axisvalues.Length + 1) * 35);
                                    }
                                    if (dw < 380) dw = 380;
                                    if (m_appSettings.ShowGraphs)
                                    {
                                        dockPanel.FloatSize = new Size(dw, 850);
                                    }
                                    else
                                    {
                                        dockPanel.FloatSize = new Size(dw, 450);
                                    }
                                }
                                else if (m_appSettings.DefaultViewSize == ViewSize.ExtraSmallView)
                                {
                                    int dw = 450;
                                    if (tabdet.X_axisvalues.Length > 0)
                                    {
                                        dw = 30 + ((tabdet.X_axisvalues.Length + 1) * 30);
                                    }
                                    if (dw < 380) dw = 380;
                                    if (m_appSettings.ShowGraphs)
                                    {
                                        dockPanel.FloatSize = new Size(dw, 700);
                                    }
                                    else
                                    {
                                        dockPanel.FloatSize = new Size(dw, 450);
                                    }
                                }
                            }
                            else
                            {
                                System.Drawing.Point floatpoint = this.PointToClient(new System.Drawing.Point(dockSymbols.Location.X + dockSymbols.Width + 30, dockSymbols.Location.Y + 30));

                                dockPanel = dockManager1.AddPanel(floatpoint);
                                if (m_appSettings.DefaultViewSize == ViewSize.NormalView)
                                {
                                    int dw = 650;
                                    if (tabdet.X_axisvalues.Length > 0)
                                    {
                                        dw = 30 + ((tabdet.X_axisvalues.Length + 1) * 35);
                                    }
                                    if (dw < 400) dw = 400;
                                    if (m_appSettings.ShowGraphs)
                                    {
                                        dockPanel.FloatSize = new Size(dw, 900);
                                        tabdet.SetSplitter(0, 0, 280, false, false);

                                    }
                                    else
                                    {

                                        dockPanel.FloatSize = new Size(dw, 500);
                                    }
                                }
                                else if (m_appSettings.DefaultViewSize == ViewSize.SmallView)
                                {
                                    int dw = 550;
                                    if (tabdet.X_axisvalues.Length > 0)
                                    {
                                        dw = 30 + ((tabdet.X_axisvalues.Length + 1) * 35);
                                    }
                                    if (dw < 380) dw = 380;
                                    if (m_appSettings.ShowGraphs)
                                    {
                                        dockPanel.FloatSize = new Size(dw, 850);
                                        tabdet.SetSplitter(0, 0, 250, false, false);
                                        //tabdet.SetSurfaceGraphZoom(0.4);
                                    }
                                    else
                                    {

                                        dockPanel.FloatSize = new Size(dw, 450);
                                        //dockPanel.FloatSize = new Size(550, 450);
                                    }
                                }
                                else if (m_appSettings.DefaultViewSize == ViewSize.ExtraSmallView)
                                {
                                    int dw = 450;
                                    if (tabdet.X_axisvalues.Length > 0)
                                    {
                                        dw = 30 + ((tabdet.X_axisvalues.Length + 1) * 30);
                                    }
                                    if (dw < 380) dw = 380;
                                    if (m_appSettings.ShowGraphs)
                                    {
                                        dockPanel.FloatSize = new Size(dw, 700);
                                        tabdet.SetSplitter(0, 0, 320, false, false);
                                        // tabdet.SetSurfaceGraphZoom(0.5);
                                    }
                                    else
                                    {
                                        // dockPanel.FloatSize = new Size(450, 450);

                                        dockPanel.FloatSize = new Size(dw, 450);
                                    }
                                }
                                floatpoint = new System.Drawing.Point(Screen.PrimaryScreen.WorkingArea.Size.Width / 2 - dockPanel.FloatSize.Width / 2, Screen.PrimaryScreen.WorkingArea.Size.Height / 2 - dockPanel.FloatSize.Height / 2);
                                while ((floatpoint.X < (dockSymbols.Width + 20)) && ((floatpoint.X + dockSymbols.Width) < Screen.PrimaryScreen.WorkingArea.Size.Width)) floatpoint.X++;
                                dockPanel.FloatLocation = floatpoint;

                            }
                            /** end NEW 12/11/2008 */


                            // z, y and z axis to do
                            /*string xdescr = string.Empty;
                            string ydescr = string.Empty;
                            string zdescr = string.Empty;
                            GetAxisDescriptions(m_currentfile, m_symbols, tabdet.Map_name, out xdescr, out ydescr, out zdescr);
                            tabdet.X_axis_name = xdescr;
                            tabdet.Y_axis_name = ydescr;
                            tabdet.Z_axis_name = zdescr;*/
                            SymbolAxesTranslator axestrans = new SymbolAxesTranslator();
                            string x_axis = string.Empty;
                            string y_axis = string.Empty;
                            string x_axis_descr = string.Empty;
                            string y_axis_descr = string.Empty;
                            string z_axis_descr = string.Empty;
                            axestrans.GetAxisSymbols(tabdet.Map_name, out x_axis, out y_axis, out x_axis_descr, out y_axis_descr, out z_axis_descr);
                            if (x_axis == "BstKnkCal.OffsetXSP")
                            {
                                if (!SymbolExists(x_axis)) x_axis = "BstKnkCal.fi_offsetXSP";
                            }

                            tabdet.X_axis_name = x_axis_descr;
                            tabdet.Y_axis_name = y_axis_descr;
                            tabdet.Z_axis_name = z_axis_descr;


                            int columns = 8;
                            int rows = 8;
                            int tablewidth = GetTableMatrixWitdhByName(m_currentfile, m_symbols, tabdet.Map_name, out columns, out rows);
                            int address = (int)sh.Flash_start_address;
                            int sramaddress = (int)sh.Start_address;
                            if (sramaddress != 0)
                            {
                                //while (address > m_currentfile_size) address -= m_currentfile_size;
                                tabdet.Map_address = address;
                                tabdet.Map_sramaddress = sramaddress;
                                int length = sh.Length;
                                tabdet.Map_length = length;
                                byte[] mapdata = readdatafromSRAMfile(m_currentsramfile, sramaddress, length);
                                tabdet.Map_content = mapdata;
                                tabdet.Correction_factor = GetMapCorrectionFactor(tabdet.Map_name);
                                tabdet.Correction_offset = GetMapCorrectionOffset(tabdet.Map_name);
                                tabdet.IsUpsideDown = GetMapUpsideDown(tabdet.Map_name);
                                tabdet.ShowTable(columns, isSixteenBitTable(tabdet.Map_name));
                                //TryToAddOpenLoopTables(tabdet);

                                tabdet.IsRAMViewer = true;
                                tabdet.Dock = DockStyle.Fill;
                                //tabdet.onSymbolSave += new MapViewer.NotifySaveSymbol(tabdet_onSymbolSave);
                                tabdet.onClose += new IMapViewer.ViewerClose(tabdet_onClose);
                                //tabdet.onAxisLock += new MapViewer.NotifyAxisLock(tabdet_onAxisLock);
                                //tabdet.onSliderMove += new MapViewer.NotifySliderMove(tabdet_onSliderMove);
                                //tabdet.onSelectionChanged += new MapViewer.SelectionChanged(tabdet_onSelectionChanged);
                                //tabdet.onSplitterMoved += new MapViewer.SplitterMoved(tabdet_onSplitterMoved);
                                //tabdet.onSurfaceGraphViewChanged += new MapViewer.SurfaceGraphViewChanged(tabdet_onSurfaceGraphViewChanged);
                                //tabdet.onGraphSelectionChanged += new MapViewer.GraphSelectionChanged(tabdet_onGraphSelectionChanged);
                                //tabdet.onViewTypeChanged += new MapViewer.ViewTypeChanged(tabdet_onViewTypeChanged);
                                tabdet.onReadFromSRAM += new IMapViewer.ReadDataFromSRAM(tabdet_onReadFromSRAM);
                                tabdet.onWriteToSRAM += new IMapViewer.WriteDataToSRAM(tabdet_onWriteToSRAM);

                                tabdet.onSelectionChanged += new IMapViewer.SelectionChanged(tabdet_onSelectionChanged);
                                tabdet.onSurfaceGraphViewChangedEx += new IMapViewer.SurfaceGraphViewChangedEx(mv_onSurfaceGraphViewChangedEx);
                                tabdet.onSurfaceGraphViewChanged += new IMapViewer.SurfaceGraphViewChanged(mv_onSurfaceGraphViewChanged);

                                //dockPanel.DockAsTab(dockPanel1);
                                dockPanel.Text = "SRAM Symbol: " + tabdet.Map_name + " [" + Path.GetFileName(m_currentsramfile) + "]";
                                bool isDocked = false;
                                if (m_appSettings.AutoDockSameSymbol)
                                {
                                    foreach (DockPanel pnl in dockManager1.Panels)
                                    {
                                        if (pnl.Text.StartsWith("SRAM Symbol: " + tabdet.Map_name) && pnl != dockPanel && (pnl.Visibility == DockVisibility.Visible))
                                        {
                                            dockPanel.DockAsTab(pnl, 0);
                                            isDocked = true;
                                            break;
                                        }
                                    }
                                }
                                if (!isDocked)
                                {
                                    if (m_appSettings.AutoDockSameFile)
                                    {
                                        foreach (DockPanel pnl in dockManager1.Panels)
                                        {
                                            if ((string)pnl.Tag == m_currentsramfile && pnl != dockPanel && (pnl.Visibility == DockVisibility.Visible))
                                            {
                                                dockPanel.DockAsTab(pnl, 0);
                                                isDocked = true;
                                                break;
                                            }
                                        }
                                    }
                                }

                                if (!isDocked)
                                {
                                    dockPanel.DockTo(dockManager1, DockingStyle.Right, 0);
                                    if (m_appSettings.AutoSizeNewWindows)
                                    {
                                        if (tabdet.X_axisvalues.Length > 0)
                                        {
                                            dockPanel.Width = 30 + ((tabdet.X_axisvalues.Length + 1) * 35);
                                        }
                                        else
                                        {
                                            //dockPanel.Width = this.Width - dockSymbols.Width - 10;
                                        }
                                    }
                                    if (dockPanel.Width < 400) dockPanel.Width = 400;

                                }
                                dockPanel.Controls.Add(tabdet);
                            }
                        }
                        catch (Exception newdockE)
                        {
                            LogHelper.Log(newdockE.Message);
                        }
                        dockManager1.EndUpdate();
                    }
                }
            }

        }

        private void readFromSRAMFileToolStripMenuItem_Click(object sender, EventArgs e)
        {
            if (gridViewSymbols.FocusedRowHandle >= 0)
            {
                SymbolHelper sh = (SymbolHelper)gridViewSymbols.GetRow(gridViewSymbols.FocusedRowHandle);
                // 0x100000 - 0x108000 = SRAM
                StartSRAMTableViewer(m_currentsramfile, sh.Varname, sh.Length, (int)sh.Flash_start_address, (int)(sh.Start_address & 0x00FFFF));
            }
        }

        private void btnGetECUInfo_ItemClick(object sender, ItemClickEventArgs e)
        {
            SetCanAdapter();
            SetProgress("Starting ECU info retrieval");
            if (!t8can.isOpen())
            {
                t8can.openDevice(true);
            }
            if (t8can.isOpen())
            {
                m_prohibitReading = true;
                // get info and fill a special ECU info screen with it
                frmECUInformation info = new frmECUInformation();
                info.Show();
                info.SetECUHardwareDescription(t8can.GetECUDescription());
                info.SetECUHardware(t8can.GetECUHardware());
                info.SetECUHardwareType(t8can.RequestECUInfo(0x97, ""));
                info.SetECUHardwareSupplierID(t8can.RequestECUInfo(0x92, ""));
                info.SetECUBuildDate(t8can.GetBuildDate());
                info.SetECUSerialNumber(t8can.GetSerialNumber());
                info.SetECUSAABPartnumber(t8can.GetSaabPartnumber());
                info.SetECUBasemodel(t8can.GetInt64FromID(0xCC));
                info.SetECUEndmodel(t8can.GetInt64FromID(0xCB));
                info.SetCalibrationSet(t8can.GetCalibrationSet());
                info.SetCodefileVersion(t8can.GetCodefileVersion());
                info.SetSoftwareVersion(t8can.GetSoftwareVersion());
                info.SetSoftwareVersionFile(t8can.RequestECUInfo(0x0F, ""));
                info.SetSoftwareID1(t8can.RequestECUInfo(0xC1, ""));
                info.SetSoftwareID2(t8can.RequestECUInfo(0xC2, ""));
                info.SetSoftwareID3(t8can.RequestECUInfo(0xC3, ""));
                info.SetSoftwareID4(t8can.RequestECUInfo(0xC4, ""));
                info.SetSoftwareID5(t8can.RequestECUInfo(0xC5, ""));
                info.SetSoftwareID6(t8can.RequestECUInfo(0xC6, ""));
                info.SetVIN(t8can.GetVehicleVIN());
                info.SetEngineType(t8can.RequestECUInfo(0x0C, ""));
                info.SetSpeedLimit(t8can.GetTopSpeed() + " km/h");
                m_prohibitReading = false;

            }
            SetProgressIdle();
        }

        private void LoadMyMaps()
        {
            try
            {
                DevExpress.XtraBars.Ribbon.RibbonPage page_maps = new DevExpress.XtraBars.Ribbon.RibbonPage("My Maps");
                DevExpress.XtraBars.Ribbon.RibbonPageGroup rpgset = new DevExpress.XtraBars.Ribbon.RibbonPageGroup("myMaps settings");
                rpgset.AllowTextClipping = false;
                DevExpress.XtraBars.BarButtonItem btnset = new BarButtonItem();
                btnset.Caption = "Define myMaps";
                btnset.Tag = "DefineMaps";
                btnset.ItemClick += new ItemClickEventHandler(MyMapDefine_ItemClick);
                rpgset.ItemLinks.Add(btnset);
                page_maps.Groups.Add(rpgset);

                if (File.Exists(System.Windows.Forms.Application.StartupPath + "\\mymaps.xml"))
                {
                    try
                    {
                        System.Xml.XmlDocument mymaps = new System.Xml.XmlDocument();
                        mymaps.Load(System.Windows.Forms.Application.StartupPath + "\\mymaps.xml");




                        foreach (System.Xml.XmlNode category in mymaps.SelectNodes("categories/category"))
                        {
                            DevExpress.XtraBars.Ribbon.RibbonPageGroup rpg = new DevExpress.XtraBars.Ribbon.RibbonPageGroup(category.Attributes["title"].Value);
                            rpg.AllowTextClipping = false;
                            foreach (System.Xml.XmlNode map in category.SelectNodes("map"))
                            {
                                DevExpress.XtraBars.BarButtonItem btn = new BarButtonItem();
                                btn.Caption = map.Attributes["title"].Value;
                                btn.Tag = map.Attributes["symbol"].Value;
                                btn.ItemClick += new ItemClickEventHandler(MyMapItems_ItemClick);
                                rpg.ItemLinks.Add(btn);
                            }

                            page_maps.Groups.Add(rpg);
                        }
                    }
                    catch { }
                    //ribbonControl1.Pages.Add(page_maps);

                }
                ribbonControl1.Pages.Insert(3, page_maps);
            }
            catch (Exception myMapsE)
            {
                LogHelper.Log("Failed to create myMaps menu: " + myMapsE.Message);
            }
        }

        void MyMapDefine_ItemClick(object sender, ItemClickEventArgs e)
        {
            // define myMaps!
            frmDefineMyMaps mymapsdef = new frmDefineMyMaps();
            if (File.Exists(System.Windows.Forms.Application.StartupPath + "\\mymaps.xml"))
            {
                mymapsdef.Filename = System.Windows.Forms.Application.StartupPath + "\\mymaps.xml";
            }
            else
            {
                mymapsdef.CreateNewFile(System.Windows.Forms.Application.StartupPath + "\\mymaps.xml");
            }
            if (mymapsdef.ShowDialog() == DialogResult.OK)
            {
                // reload my maps
                if (ribbonControl1.Pages[3].Text == "My Maps")
                {
                    ribbonControl1.Pages.RemoveAt(3);
                }
                LoadMyMaps();
            }

        }

        void MyMapItems_ItemClick(object sender, ItemClickEventArgs e)
        {
            try
            {
                string map_name = e.Item.Tag.ToString().ToLower().Trim();

                /*if (map_name == "targetafr")
                    barButtonItem94_ItemClick(sender, e); // start 'target afr' mapviewer
                else if (map_name == "feedbackafr")
                    btnAFRFeedbackMap_ItemClick(sender, e); // start 'feedback afr' mapviewer
                else if (map_name == "feedbackvstargetafr")
                    btnAFRErrormap_ItemClick(sender, e); // start 'feedback vs target afr' mapviewer
                else*/
                StartTableViewer(e.Item.Tag.ToString().Trim());
            }
            catch { }
        }

        private void btnCopyAddressTable_ItemClick(object sender, ItemClickEventArgs e)
        {
            OpenFileDialog ofd = new OpenFileDialog();
            ofd.Filter = "T8 binary files|*.bin";
            ofd.Multiselect = false;
            ofd.FileName = "";
            ofd.Title = "Select binary file to transfer the address table to...";
            if (ofd.ShowDialog() == DialogResult.OK)
            {


                int addrtaboffset = GetAddrTableOffsetBySymbolTable(m_currentfile) + 7;
                int addrtaboffset_newfile = GetAddrTableOffsetBySymbolTable(ofd.FileName) + 7;
                LogHelper.Log("Addresstable offset 1: " + addrtaboffset.ToString());
                LogHelper.Log("Addresstable offset 2: " + addrtaboffset_newfile.ToString());
                bool _allow = false;
                if (addrtaboffset == addrtaboffset_newfile) _allow = true;
                if (!_allow)
                {
                    if (MessageBox.Show("Address table start addresses are not equal, continue anyway?", "Attention!", MessageBoxButtons.YesNo) == DialogResult.Yes)
                    {
                        _allow = true;
                    }
                }

                if (_allow)
                {
                    if (addrtaboffset > 0)
                    {
                        FileStream fsread = new FileStream(m_currentfile, FileMode.Open, FileAccess.Read);
                        using (BinaryReader br = new BinaryReader(fsread))
                        {

                            FileStream fswrite = new FileStream(ofd.FileName, FileMode.Open);
                            using (BinaryWriter bw = new BinaryWriter(fswrite))
                            {
                                fsread.Seek(addrtaboffset - 17, SeekOrigin.Begin); //was - 17
                                fswrite.Seek(addrtaboffset_newfile - 17, SeekOrigin.Begin);
                                bool endoftable = false;
                                while (!endoftable)
                                {
                                    // steeds 10 karaketers
                                    try
                                    {
                                        byte[] bytes = br.ReadBytes(10);
                                        if (bytes.Length == 10)
                                        {
                                            //DumpBytesToConsole(bytes);
                                            if ((Convert.ToInt32(bytes.GetValue(9)) != 0x00))
                                            {
                                                endoftable = true;
                                            }
                                            else
                                            {
                                                // Write to target file
                                                bw.Write(bytes);
                                            }
                                        }
                                        else
                                        {
                                            endoftable = true;
                                        }
                                    }
                                    catch (Exception E)
                                    {
                                        LogHelper.Log(E.Message);
                                    }

                                }
                            }
                        }
                        UpdateChecksum(ofd.FileName, true);
                        frmInfoBox info = new frmInfoBox("Transfer done");
                    }
                }
                else
                {
                    frmInfoBox info = new frmInfoBox("Transfer cancelled");
                }
            }
        }

        private void SetupLogFilters()
        {
            // setup the export filters
            LogFilters filterhelper = new LogFilters();
            frmLogFilters frmfilters = new frmLogFilters();
            LogFilterCollection filters = filterhelper.GetFiltersFromRegistry();
            frmfilters.SetFilters(filters);
            SymbolCollection sc = new SymbolCollection();
            foreach (SymbolHelper sh in m_symbols)
            {
                //if (!sh.Varname.Contains("!")) sc.Add(sh);
                if (!IsSymbolCalibration(sh.Varname)) sc.Add(sh);
            }
            frmfilters.SetSymbols(sc);
            if (frmfilters.ShowDialog() == DialogResult.OK)
            {
                filterhelper.SaveFiltersToRegistry(frmfilters.GetFilters());
            }
        }

        private void btnSetupLogFilters_ItemClick(object sender, ItemClickEventArgs e)
        {
            SetupLogFilters();
        }

        private void OpenAndDisplayLogFile(string filename)
        {
            // create a new dock with a graph view in it
            //dockManager1.BeginUpdate();
            DockPanel dp = dockManager1.AddPanel(DockingStyle.Left);
            dp.Size = new Size(dockManager1.Form.ClientSize.Width - dockSymbols.Width, dockSymbols.Height);
            dp.Hide();
            //dp.Visibility = DevExpress.XtraBars.Docking.DockVisibility.Hidden;

            //dp.FloatLocation = new System.Drawing.Point(dockSymbols.Location.X + dockSymbols.Width + 5, dockSymbols.Location.Y + 5);
            //dp.FloatSize = new Size(this.Bounds.
            //dockManager1.AddPanel(DevExpress.XtraBars.Docking.DockingStyle.Right);
            dp.Text = "CANBus logfile: " + Path.GetFileName(filename);
            RealtimeGraphControl lfv = new RealtimeGraphControl();
            //LogFilters lfhelper = new LogFilters();
            //lfv.SetFilters(lfhelper.GetFiltersFromRegistry());
            dp.Controls.Add(lfv);
            lfv.ImportT5Logfile(filename);
            //dp.Height = 600;
            lfv.Dock = DockStyle.Fill;

            dp.Show();


            //dockManager1.EndUpdate();
        }

        private void btnLoadTrionic8Logfile_ItemClick(object sender, ItemClickEventArgs e)
        {
            // open a logfile from the canlog
            OpenFileDialog ofd = new OpenFileDialog();
            ofd.Filter = "Trionic 8 logfiles|*.t8l";
            ofd.Title = "Open CAN bus logfile";
            ofd.Multiselect = false;
            if (ofd.ShowDialog() == DialogResult.OK)
            {
                CheckDefaultSymbolColors();
                OpenAndDisplayLogFile(ofd.FileName);
            }
        }

        System.Data.DataTable avgTable;


        private void btnViewMatrixFromLog_ItemClick(object sender, ItemClickEventArgs e)
        {
            // let the user select x axis, y axis and z axis symbols from the logfile
            //
            OpenFileDialog ofd = new OpenFileDialog();
            ofd.Filter = "Trionic 8 logfiles|*.t8l";
            ofd.Multiselect = false;
            if (ofd.ShowDialog() == DialogResult.OK)
            {
                avgTable = null;
                string[] alllines = File.ReadAllLines(ofd.FileName);
                System.Windows.Forms.Application.DoEvents();
                DateTime startDate = DateTime.MaxValue;
                DateTime endDate = DateTime.MinValue;
                SymbolCollection sc = new SymbolCollection();
                try
                {
                    // using (StreamReader sr = new StreamReader(ofd.FileName))
                    {
                        //string line = string.Empty;

                        char[] sep = new char[1];
                        char[] sep2 = new char[1];
                        //int linecount = 0;
                        sep.SetValue('|', 0);
                        sep2.SetValue('=', 0);
                        //while ((line = sr.ReadLine()) != null)
                        foreach (string line in alllines)
                        {
                            string[] values = line.Split(sep);
                            if (values.Length > 0)
                            {
                                try
                                {
                                    //dd/MM/yyyy HH:mm:ss
                                    //string logline = DateTime.Now.ToString("dd/MM/yyyy HH:mm:ss") + "|";

                                    string dtstring = (string)values.GetValue(0);
                                    DateTime dt = new DateTime(Convert.ToInt32(dtstring.Substring(6, 4)), Convert.ToInt32(dtstring.Substring(3, 2)), Convert.ToInt32(dtstring.Substring(0, 2)), Convert.ToInt32(dtstring.Substring(11, 2)), Convert.ToInt32(dtstring.Substring(14, 2)), Convert.ToInt32(dtstring.Substring(17, 2)));
                                    if (dt > endDate) endDate = dt;
                                    if (dt < startDate) startDate = dt;
                                    for (int t = 1; t < values.Length; t++)
                                    {
                                        string subvalue = (string)values.GetValue(t);
                                        string[] subvals = subvalue.Split(sep2);
                                        if (subvals.Length == 2)
                                        {
                                            string varname = (string)subvals.GetValue(0);
                                            bool sfound = false;
                                            foreach (SymbolHelper sh in sc)
                                            {
                                                if (sh.Varname == varname)
                                                {
                                                    sfound = true;
                                                }
                                            }
                                            SymbolHelper nsh = new SymbolHelper();
                                            nsh.Varname = varname;
                                            if (!sfound) sc.Add(nsh);
                                        }
                                    }
                                }
                                catch (Exception pE)
                                {
                                    LogHelper.Log(pE.Message);
                                }
                            }
                        }
                    }
                }
                catch (Exception E)
                {
                    LogHelper.Log(E.Message);
                }
                frmMatrixSelection sel = new frmMatrixSelection();
                sel.SetSymbolList(sc);
                sel.SetXSelection(m_appSettings.LastXAxisFromMatrix);
                sel.SetYSelection(m_appSettings.LastYAxisFromMatrix);
                sel.SetZSelection(m_appSettings.LastZAxisFromMatrix);
                if (sel.ShowDialog() == DialogResult.OK)
                {
                    // get selected for x, y and z
                    int type = sel.GetViewType(); // <GS-31032011> 0 = mean values, 1 = minimum values, 2 = maximum values
                    string x = sel.GetXAxisSymbol();
                    string y = sel.GetYAxisSymbol();
                    string z = sel.GetZAxisSymbol();
                    m_appSettings.LastXAxisFromMatrix = x;
                    m_appSettings.LastYAxisFromMatrix = y;
                    m_appSettings.LastZAxisFromMatrix = z;
                    double xmin = Double.MaxValue;
                    double xmax = Double.MinValue;
                    double ymin = Double.MaxValue;
                    double ymax = Double.MinValue;
                    double zmin = Double.MaxValue;
                    double zmax = Double.MinValue;
                    //using (StreamReader sr = new StreamReader(ofd.FileName))
                    {
                        // string line = string.Empty;
                        char[] sep = new char[1];
                        char[] sep2 = new char[1];
                        //int linecount = 0;
                        sep.SetValue('|', 0);
                        sep2.SetValue('=', 0);
                        //while ((line = sr.ReadLine()) != null)

                        foreach (string line in alllines)
                        {
                            string[] values = line.Split(sep);
                            if (values.Length > 0)
                            {
                                try
                                {
                                    //dd/MM/yyyy HH:mm:ss
                                    //string logline = DateTime.Now.ToString("dd/MM/yyyy HH:mm:ss") + "|";

                                    string dtstring = (string)values.GetValue(0);
                                    DateTime dt = new DateTime(Convert.ToInt32(dtstring.Substring(6, 4)), Convert.ToInt32(dtstring.Substring(3, 2)), Convert.ToInt32(dtstring.Substring(0, 2)), Convert.ToInt32(dtstring.Substring(11, 2)), Convert.ToInt32(dtstring.Substring(14, 2)), Convert.ToInt32(dtstring.Substring(17, 2)));
                                    if (dt > endDate) endDate = dt;
                                    if (dt < startDate) startDate = dt;
                                    for (int t = 1; t < values.Length; t++)
                                    {
                                        string subvalue = (string)values.GetValue(t);
                                        string[] subvals = subvalue.Split(sep2);
                                        if (subvals.Length == 2)
                                        {
                                            string varname = (string)subvals.GetValue(0);
                                            double value = ConvertToDouble((string)subvals.GetValue(1));

                                            if (value > 65535) value = 0;
                                            if (value < -65535) value = 0;
                                            if (varname == x)
                                            {
                                                // get max and min

                                                if (value > xmax) xmax = value;
                                                if (value < xmin) xmin = value;
                                            }
                                            else if (varname == y)
                                            {
                                                // get max and min
                                                if (value > ymax) ymax = value;
                                                if (value < ymin) ymin = value;
                                            }
                                            else if (varname == z)
                                            {
                                                // get max and min
                                                if (value > zmax) zmax = value;
                                                if (value < zmin) zmin = value;
                                            }

                                        }
                                    }
                                }
                                catch (Exception pE)
                                {
                                    LogHelper.Log(pE.Message);
                                }
                            }
                        }
                    }
                    // now we have it all
                    if (xmin == xmax || ymin == ymax)
                    {
                        frmInfoBox info = new frmInfoBox("No data to display ... x or y axis contains no differentiated values");
                        return;
                    }
                    frmMatrixResult result = new frmMatrixResult();
                    result.SetViewType(type); // <GS-31032011> 0 = mean values, 1 = minimum values, 2 = maximum values

                    // parse the file again and add the points
                    System.Data.DataTable dtresult = new System.Data.DataTable();
                    // xmin = -0.8
                    // xmin = 2.01
                    double[] x_values = new double[16];
                    double[] y_values = new double[16];

                    // fill x and y axis
                    for (int i = 0; i < 16; i++)
                    {

                        double xvalue = xmin;
                        if (i > 0) xvalue = xmin + i * ((xmax - xmin) / (15));
                        //LogHelper.Log("Adding: " + xvalue.ToString());
                        try
                        {
                            dtresult.Columns.Add(xvalue.ToString(), Type.GetType("System.Double"));
                        }
                        catch (Exception E)
                        {
                            LogHelper.Log("Failed to add column: " + E.Message);
                        }
                        x_values.SetValue(xvalue, i); //    test: andersom?
                    }
                    for (int i = 0; i < 16; i++)
                    {
                        //double yvalue = ymin + ((ymax - ymin) / i);
                        double yvalue = ymin;
                        if (i > 0) yvalue = ymin + i * ((ymax - ymin) / (15));
                        y_values.SetValue(yvalue, i); //    test: andersom?
                    }
                    for (int i = 0; i < 16; i++)
                    {
                        try
                        {
                            dtresult.Rows.Add(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
                        }
                        catch (Exception E)
                        {
                            LogHelper.Log("Failed to add empty row: " + E.Message);
                        }
                    }
                    // table filled
                    double _lastX = 0;
                    double _lastY = 0;
                    double _lastZ = 0;
                    //using (StreamReader sr = new StreamReader(ofd.FileName))
                    {
                        //string line = string.Empty;
                        char[] sep = new char[1];
                        char[] sep2 = new char[1];
                        //int linecount = 0;
                        sep.SetValue('|', 0);
                        sep2.SetValue('=', 0);
                        //while ((line = sr.ReadLine()) != null)
                        foreach (string line in alllines)
                        {
                            string[] values = line.Split(sep);
                            if (values.Length > 0)
                            {
                                try
                                {
                                    //dd/MM/yyyy HH:mm:ss
                                    //string logline = DateTime.Now.ToString("dd/MM/yyyy HH:mm:ss") + "|";

                                    string dtstring = (string)values.GetValue(0);
                                    DateTime dt = new DateTime(Convert.ToInt32(dtstring.Substring(6, 4)), Convert.ToInt32(dtstring.Substring(3, 2)), Convert.ToInt32(dtstring.Substring(0, 2)), Convert.ToInt32(dtstring.Substring(11, 2)), Convert.ToInt32(dtstring.Substring(14, 2)), Convert.ToInt32(dtstring.Substring(17, 2)));
                                    if (dt > endDate) endDate = dt;
                                    if (dt < startDate) startDate = dt;
                                    for (int t = 1; t < values.Length; t++)
                                    {
                                        string subvalue = (string)values.GetValue(t);
                                        string[] subvals = subvalue.Split(sep2);
                                        if (subvals.Length == 2)
                                        {
                                            string varname = (string)subvals.GetValue(0);
                                            double value = ConvertToDouble((string)subvals.GetValue(1));
                                            if (varname == x)
                                            {
                                                _lastX = value;
                                            }
                                            else if (varname == y)
                                            {
                                                _lastY = value;
                                            }
                                            else if (varname == z)
                                            {
                                                _lastZ = value;
                                            }

                                        }
                                    }
                                }
                                catch (Exception pE)
                                {
                                    LogHelper.Log(pE.Message);
                                }
                                // add point to the datatable
                                AddPointToDataTable(dtresult, _lastX, _lastY, _lastZ, xmin, xmax, ymin, ymax, zmin, zmax, type);
                            }
                        }
                    }
                    result.MaxValue = zmax;
                    result.MinValue = zmin;
                    result.SetXAxis(x_values);
                    result.SetYAxis(y_values);
                    result.SetXAxisName(x);
                    result.SetYAxisName(y);
                    result.SetZAxisName(z);
                    result.UseNewMapViewer = true;
                    result.SetTable(dtresult);
                    string typedescr = " (Mean values)";
                    if (type == 1) typedescr = " (Minimum values)";
                    else if (type == 1) typedescr = " (Maximum values)";
                    result.Text = "Matrix [" + x + " : " + y + " : " + z + "]" + typedescr;
                    result.ShowDialog();
                }
            }
        }

        private void AddPointToDataTable(System.Data.DataTable dt, double x, double y, double z, double xmin, double xmax, double ymin, double ymax, double zmin, double zmax, int type)
        {
            // table is 16x16
            if (avgTable == null)
            {
                avgTable = new System.Data.DataTable();
                // needs to init
                for (int i = 0; i < 16; i++)
                {
                    //double xvalue = xmin + ((xmax - xmin) / i);
                    double xvalue = xmin;
                    if (i > 0) xvalue = xmin + i * ((xmax - xmin) / (15));

                    avgTable.Columns.Add(xvalue.ToString(), Type.GetType("System.Double"));
                }
                for (int i = 0; i < 16; i++)
                {
                    avgTable.Rows.Add(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
                }
            }
            // which cell should we update?
            int xindex = 0;
            double xcurrdiff = Double.MaxValue;
            for (int i = 0; i < 16; i++)
            {
                //double xvalue = xmin + ((xmax - xmin) / i);
                double xvalue = xmin;
                if (i > 0) xvalue = xmin + i * ((xmax - xmin) / (15));

                double diffx = Math.Abs(xvalue - x);
                if (diffx < xcurrdiff)
                {
                    xcurrdiff = diffx;
                    xindex = i;
                }
            }
            int yindex = 0;
            double ycurrdiff = Double.MaxValue;
            for (int i = 0; i < 16; i++)
            {
                //double yvalue = ymin + ((ymax - ymin) / i);
                double yvalue = ymin;
                if (i > 0) yvalue = ymin + i * ((ymax - ymin) / (15));

                double diffy = Math.Abs(yvalue - y);
                if (diffy < ycurrdiff)
                {
                    ycurrdiff = diffy;
                    yindex = i;
                }
            }
            yindex = 15 - yindex; // flip the table


            //LogHelper.Log("x = " + x.ToString() + " y = " + y.ToString() + " xindex = " + xindex.ToString() + " yindex = " + yindex.ToString());
            // get the counter from avgTable
            if (type == 0)
            {
                double count = Convert.ToDouble(avgTable.Rows[yindex][xindex]);
                // calculate new average
                double currAvg = Convert.ToDouble(dt.Rows[yindex][xindex]);
                currAvg *= count;
                currAvg += z;
                count++;
                currAvg /= count;
                avgTable.Rows[yindex][xindex] = count;
                dt.Rows[yindex][xindex] = currAvg;
            }
            else if (type == 1)
            {
                // minimum values
                double currAvg = Convert.ToDouble(dt.Rows[yindex][xindex]);
                if (z < currAvg || currAvg == 0) dt.Rows[yindex][xindex] = z;
            }
            else if (type == 2)
            {
                // maximum values
                double currAvg = Convert.ToDouble(dt.Rows[yindex][xindex]);
                if (z > currAvg || currAvg == 0) dt.Rows[yindex][xindex] = z;
            }
        }

        private void btnSetSymbolColors_ItemClick(object sender, ItemClickEventArgs e)
        {
            frmPlotSelection plotsel = new frmPlotSelection();
            // get values from realtime panel
            // LoadRealtimeTable();
            CheckDefaultSymbolColors();
            foreach (SymbolHelper sh in m_symbols)
            {
                if (sh.Start_address > 0)
                {
                    plotsel.AddItemToList(sh.Varname);
                }
            }
            plotsel.ShowDialog();
        }

        private void ShowRealtimeMapFromECU(string symbolname)
        {
            if (m_connectedToECU)
            {
                foreach (SymbolHelper sh in m_symbols)
                {
                    string varname = sh.Varname;
                    if (varname.StartsWith("Symbol") && sh.Userdescription != "")
                    {
                        varname = sh.Userdescription;
                    }
                    if (varname == symbolname)
                    {
                        // convert to realtime symbol
                        // start an SRAM mapviewer for this symbol
                        int symbolnumber = GetSymbolNumberFromRealtimeList(GetSymbolNumber(m_symbols, varname), varname);
                        sh.Symbol_number = symbolnumber;

                        LogHelper.Log("Got symbolnumber: " + symbolnumber.ToString() + " for map: " + varname);
                        if (symbolnumber >= 0)
                        {
                            //byte[] result = ReadSymbolFromSRAM((uint)symbolnumber);
                            byte[] result = ReadMapFromSRAM(sh);
                            LogHelper.Log("read " + result.Length.ToString() + " bytes from SRAM!");
                            StartTableViewer(varname);
                            try
                            {
                                int rows = 0;
                                int cols = 0;
                                foreach (DockPanel pnl in dockManager1.Panels)
                                {
                                    if (pnl.Text.StartsWith("Symbol: ") || pnl.Text.StartsWith("SRAM"))
                                    {
                                        foreach (Control c in pnl.Controls)
                                        {
                                            if (c is IMapViewer)
                                            {
                                                IMapViewer vwr = (IMapViewer)c;
                                                if (vwr.Map_name == varname)
                                                {
                                                    vwr.Map_content = result;
                                                    GetTableMatrixWitdhByName(m_currentfile, m_symbols, varname, out cols, out rows);
                                                    vwr.IsRAMViewer = true;
                                                    vwr.OnlineMode = true;
                                                    vwr.ShowTable(cols, isSixteenBitTable(varname));
                                                }
                                            }
                                            else if (c is DockPanel)
                                            {
                                                DockPanel tpnl = (DockPanel)c;
                                                foreach (Control c2 in tpnl.Controls)
                                                {
                                                    if (c2 is IMapViewer)
                                                    {
                                                        IMapViewer vwr2 = (IMapViewer)c2;
                                                        if (vwr2.Map_name == varname)
                                                        {
                                                            vwr2.Map_content = result;
                                                            GetTableMatrixWitdhByName(m_currentfile, m_symbols, varname, out cols, out rows);
                                                            vwr2.IsRAMViewer = true;
                                                            vwr2.OnlineMode = true;
                                                            vwr2.ShowTable(cols, isSixteenBitTable(varname));
                                                        }
                                                    }
                                                }
                                            }
                                            else if (c is ControlContainer)
                                            {
                                                ControlContainer cntr = (ControlContainer)c;
                                                foreach (Control c3 in cntr.Controls)
                                                {
                                                    if (c3 is IMapViewer)
                                                    {
                                                        IMapViewer vwr3 = (IMapViewer)c3;
                                                        if (vwr3.Map_name == varname)
                                                        {
                                                            vwr3.Map_content = result;
                                                            GetTableMatrixWitdhByName(m_currentfile, m_symbols, varname, out cols, out rows);
                                                            vwr3.IsRAMViewer = true;
                                                            vwr3.OnlineMode = true;
                                                            vwr3.ShowTable(cols, isSixteenBitTable(varname));
                                                        }
                                                    }
                                                }
                                            }
                                        }

                                    }
                                }
                            }
                            catch (Exception E)
                            {
                                LogHelper.Log("Refresh viewer with SRAM data error: " + E.Message);
                            }
                            break;
                        }
                    }
                }
            }
        }


        private void btnViewKnockCountMap_ItemClick(object sender, ItemClickEventArgs e)
        {
            ShowRealtimeMapFromECU("KnkDetAdap.KnkCntMAP");
        }

        private void btnViewMissfireMap_ItemClick(object sender, ItemClickEventArgs e)
        {
            //ShowRealtimeMapFromECU("MissfAdap.MissfCntMap");
        }

        private void btnCreateFromTISFile_ItemClick(object sender, ItemClickEventArgs e)
        {
            // we need to decode a file from TIS and generate a .BIN file for that
            OpenFileDialog ofd = new OpenFileDialog() { Multiselect = false, Filter = "Binary files|*.bin", Title = "Select a binary file to base the new file on" };
            try
            {
                ofd.InitialDirectory = Path.Combine(System.Windows.Forms.Application.StartupPath, "Binaries");
            }
            catch (Exception) { }

            if (ofd.ShowDialog() == DialogResult.OK)
            {
                FileInfo fi = new FileInfo(ofd.FileName);
                if (fi.Length == 0x100000)
                {
                    // Read the entire base file into a temporary RAM buffer
                    byte[] binFile = File.ReadAllBytes(ofd.FileName);
                    // Create another temporary buffer in RAM for the new T8 BIN file
                    byte[] newFile = new byte[0x100000];
                    // Initialise all addresses to 0xff
                    for (int i = 0; i < 0x100000; i++)
                    {
                        newFile[i] = 0xFF;
                    }
                    // Copy recovery bootloader and adaption data from base file
                    for (int i = 0; i < 0x020000; i++)
                    {
                        newFile[i] = binFile[i];
                    }
                    // open gbf file
                    OpenFileDialog ofd2 = new OpenFileDialog() { Filter = "TIS T8 files|*.gbf", Title = "Choose a TIS T8 file to build the new file with", Multiselect = false };
                    if (ofd2.ShowDialog() == DialogResult.OK)
                    {
                        string gbfFileName = ofd2.FileName;
                        try
                        {
                            byte[] dataBuffer = new byte[4096];
                            using (Stream s = new GZipInputStream(File.OpenRead(gbfFileName)))
                            {
                                using (FileStream fs = File.Create(Path.GetFileNameWithoutExtension(gbfFileName)))
                                {
                                    StreamUtils.Copy(s, fs, dataBuffer);
                                }
                                gbfFileName = Path.GetFileNameWithoutExtension(gbfFileName);
                            }
                        }
                        catch (GZipException ex)
                        {
                            File.Delete(Path.GetFileNameWithoutExtension(gbfFileName));
                            LogHelper.Log("Selected gbf file is probably not gziped:" + ex.Message);
                        }

                        // Start updating FLASH from address 0x020000 
                        int address = 0x020000;
                        byte[] gbfbytes = File.ReadAllBytes(gbfFileName);
                        for (int gbft = 0; gbft < gbfbytes.Length; gbft++)
                        {
                            newFile[address + gbft] = decodeGbfData((gbfbytes[gbft]), gbft);
                        }

                        address += gbfbytes.Length;
                        // Add a 'Programming Station' string to the footer
                        const string programmingStationString = "forum.ecuproject.com";
                        newFile[address++] = encodeFooterData((byte)programmingStationString.Length);
                        newFile[address++] = encodeFooterData(0x10);    // programmingStationStringIdentifier
                        for (int i = 0; i < programmingStationString.Length; i++)
                        {
                            newFile[address + i] = encodeFooterData((byte)programmingStationString[i]);
                        }
                        address += programmingStationString.Length;
                        // Add an adaption data flag to the footer
                        newFile[address++] = encodeFooterData(0x01);
                        newFile[address++] = encodeFooterData(0xF9);    // adaptionRegionFlagIdentifier
                        newFile[address++] = encodeFooterData(0x01);
                    }
                    using (SaveFileDialog sfd = new SaveFileDialog() { Title = "Choose a filename for the new binary file", Filter = "Binary files|*.bin" })
                    {
                        if (sfd.ShowDialog() == DialogResult.OK)
                        {
                            File.WriteAllBytes(sfd.FileName, newFile);
                            frmInfoBox info = new frmInfoBox("New file created");
                        }
                    }

                }
                else
                {
                    frmInfoBox info = new frmInfoBox("You did not choose a valid T8 file as basefile");
                }
            }

        }

        // TODO: refactor bytecoder
        private byte encodeFooterData(byte footerByte)
        {
            return (byte)(((footerByte ^ 0x21) - 0xD6) & 0xFF);
        }

        // TODO: refactor bytecoder
        private byte decodeGbfData(byte gbfDataByte, int decoderIndex)
        {
            byte[] key = { 0x39, 0x68, 0x77, 0x6D, 0x47, 0x39 };
            return (byte)(gbfDataByte ^ key[(decoderIndex % 6)]);
        }


        private void exportSymbollistAsCSVToolStripMenuItem_Click(object sender, EventArgs e)
        {
            // export as CSV
            using (SaveFileDialog sfd = new SaveFileDialog() { Filter = "CSV files|*.csv", Title = "Select a filename to save the symbollist" })
            {
                if (sfd.ShowDialog() == DialogResult.OK)
                {
                    using (StreamWriter sw = new StreamWriter(sfd.FileName, false))
                    {
                        foreach (SymbolHelper sh in m_symbols)
                        {
                            sw.WriteLine(string.Format("{0},{1},{2},{3},{4},{5}", sh.Varname.Replace(',', '.'), sh.Flash_start_address, sh.Start_address, sh.Length, sh.Symbol_number, sh.Symbol_type));
                        }
                    }
                    frmInfoBox info = new frmInfoBox("Export done");
                }
            }
        }

        private void btnRecoverECU_ItemClick(object sender, ItemClickEventArgs e)
        {
            OpenFileDialog ofd = new OpenFileDialog();
            ofd.Filter = "Binary files|*.bin";
            ofd.Multiselect = false;
            if (ofd.ShowDialog() == DialogResult.OK)
            {
                SetCanAdapter();
                SetProgress("Starting recovery procedure");
                if (!t8can.isOpen())
                {
                    t8can.openDevice(false);
                }
                if (t8can.isOpen())
                {
                    m_prohibitReading = true;
                    Thread.Sleep(1000);
                    System.Windows.Forms.Application.DoEvents();
                    DoWorkEventArgs args = new DoWorkEventArgs(ofd.FileName);
                    t8can.RecoverECU(this, args);
                    while (args.Result == null)
                    {
                        System.Windows.Forms.Application.DoEvents();
                        Thread.Sleep(10);
                    }
                    if ((bool)args.Result == true)
                    {
                        frmInfoBox info = new frmInfoBox("Recovery done");
                    }
                    else
                    {
                        frmInfoBox info = new frmInfoBox("Failed to recover ECU");
                    }
                }
                else
                {
                    frmInfoBox info = new frmInfoBox("Unable to connect to Trionic 8 ECU");
                }
                m_prohibitReading = false;
                SetProgressIdle();
            }
        }

        private void btnLookupPartnumber_ItemClick(object sender, ItemClickEventArgs e)
        {
            frmPartnumberLookup lookup = new frmPartnumberLookup();
            lookup.ShowDialog();
            if (lookup.Open_File)
            {
                string filename = lookup.GetFileToOpen();
                if (filename != string.Empty)
                {
                    CloseProject();
                    m_appSettings.Lastprojectname = "";

                    OpenFile(filename);
                    m_appSettings.LastOpenedType = 0;

                }
            }
            else if (lookup.Compare_File)
            {
                string filename = lookup.GetFileToOpen();
                if (filename != string.Empty)
                {
                    CompareToFile(filename);
                }
            }
            //<GS-21062010>
            else if (lookup.CreateNewFile)
            {
                string filename = lookup.GetFileToOpen();
                if (filename != string.Empty)
                {
                    CloseProject();
                    m_appSettings.Lastprojectname = "";
                    File.Copy(filename, lookup.FileNameToSave);
                    OpenFile(lookup.FileNameToSave);
                    m_appSettings.LastOpenedType = 0;

                }
            }
        }

        private void ImportXMLDescriptorFile()
        {
            // ask user to point to XML document
            OpenFileDialog ofd = new OpenFileDialog();
            ofd.Filter = "XML documents|*.xml";
            ofd.Multiselect = false;
            if (ofd.ShowDialog() == DialogResult.OK)
            {
                TryToLoadAdditionalSymbols(ofd.FileName, false, m_symbols);
                gridControlSymbols.DataSource = m_symbols;
                SetDefaultFilters();
                gridControlSymbols.RefreshDataSource();
                SaveAdditionalSymbols();
            }
        }

        private void barButtonItem38_ItemClick(object sender, ItemClickEventArgs e)
        {
            ImportXMLDescriptorFile();
        }

        private void ImportCSVDescriptor()
        {
            OpenFileDialog ofd = new OpenFileDialog();
            ofd.Filter = "CSV documents|*.csv";
            ofd.Multiselect = false;
            if (ofd.ShowDialog() == DialogResult.OK)
            {
                TryToLoadAdditionalCSVSymbols(ofd.FileName);
                gridControlSymbols.DataSource = m_symbols;
                SetDefaultFilters();
                gridControlSymbols.RefreshDataSource();
                // and save the data to the repository
                SaveAdditionalSymbols();

            }
        }

        private void ImportCSVDescriptor(string filename)
        {
            TryToLoadAdditionalCSVSymbols(filename);
            gridControlSymbols.DataSource = m_symbols;
            SetDefaultFilters();
            gridControlSymbols.RefreshDataSource();
            // and save the data to the repository
            SaveAdditionalSymbols();
        }

        private void TryToLoadAdditionalCSVSymbols(string filename)
        {
            // convert to CSV file format
            // 56;AreaCal.A_MaxAdap;;;
            try
            {
                SymbolTranslator st = new SymbolTranslator();
                char[] sep = new char[1];
                sep.SetValue(';', 0);
                string[] fileContent = File.ReadAllLines(filename);
                foreach (string line in fileContent)
                {
                    string[] values = line.Split(sep);
                    try
                    {
                        string varname = (string)values.GetValue(1);
                        int symbolnumber = Convert.ToInt32(values.GetValue(0));
                        foreach (SymbolHelper sh in m_symbols)
                        {
                            if (sh.Symbol_number == symbolnumber)
                            {
                                sh.Userdescription = varname;
                                string helptext = string.Empty;
                                XDFCategories cat = XDFCategories.Undocumented;
                                XDFSubCategory sub = XDFSubCategory.Undocumented;
                                sh.Description = st.TranslateSymbolToHelpText(sh.Userdescription, out helptext, out cat, out sub);
                                //if(sh.Category == 
                                if (sh.Category == "Undocumented" || sh.Category == "")
                                {
                                    if (sh.Userdescription.Contains("."))
                                    {
                                        try
                                        {
                                            sh.Category = sh.Userdescription.Substring(0, sh.Userdescription.IndexOf("."));
                                            //LogHelper.Log("Set cat to " + sh.Category + " for " + sh.Userdescription);
                                        }
                                        catch (Exception cE)
                                        {
                                            LogHelper.Log("Failed to assign category to symbol: " + sh.Userdescription + " err: " + cE.Message);
                                        }
                                    }

                                }
                            }
                        }
                    }
                    catch (Exception lineE)
                    {
                        LogHelper.Log("Failed to import a symbol from CSV file " + line + ": " + lineE.Message);
                    }
                }
            }
            catch (Exception E)
            {
                LogHelper.Log("Failed to import additional CSV symbols: " + E.Message);
            }
        }

        private void barButtonItem39_ItemClick(object sender, ItemClickEventArgs e)
        {
            ImportCSVDescriptor();
        }

        private void barButtonItem40_ItemClick(object sender, ItemClickEventArgs e)
        {
            ImportAS2Descriptor();
        }

        private void TryToLoadAdditionalAS2Symbols(string filename)
        {
            // convert to AS2 file format

            try
            {
                SymbolTranslator st = new SymbolTranslator();
                char[] sep = new char[1];
                sep.SetValue(';', 0);
                string[] fileContent = File.ReadAllLines(filename);
                int symbolnumber = 0;
                foreach (string line in fileContent)
                {
                    if (line.StartsWith("*"))
                    {
                        symbolnumber++;
                        //AddLog(line);
                        string[] values = line.Split(sep);
                        try
                        {

                            string varname = (string)values.GetValue(0);
                            varname = varname.Substring(1);
                            int idxSymTab = 0;
                            foreach (SymbolHelper sh in m_symbols)
                            {
                                if (sh.Length > 0) idxSymTab++;
                                if (idxSymTab == symbolnumber)
                                //if (sh.Symbol_number == symbolnumber)
                                {
                                    sh.Userdescription = varname;
                                    string helptext = string.Empty;
                                    XDFCategories cat = XDFCategories.Undocumented;
                                    XDFSubCategory sub = XDFSubCategory.Undocumented;
                                    sh.Description = st.TranslateSymbolToHelpText(sh.Userdescription, out helptext, out cat, out sub);
                                    //if(sh.Category == 
                                    if (sh.Category == "Undocumented" || sh.Category == "")
                                    {
                                        if (sh.Userdescription.Contains("."))
                                        {
                                            try
                                            {
                                                sh.Category = sh.Userdescription.Substring(0, sh.Userdescription.IndexOf("."));
                                                //LogHelper.Log("Set cat to " + sh.Category + " for " + sh.Userdescription);
                                            }
                                            catch (Exception cE)
                                            {
                                                LogHelper.Log("Failed to assign category to symbol: " + sh.Userdescription + " err: " + cE.Message);
                                            }
                                        }

                                    }

                                    break;

                                }
                            }
                        }
                        catch (Exception lineE)
                        {
                            LogHelper.Log("Failed to import a symbol from AS2 file " + line + ": " + lineE.Message);
                        }

                    }
                }
            }
            catch (Exception E)
            {
                LogHelper.Log("Failed to import additional AS2 symbols: " + E.Message);
            }
        }

        private void ImportAS2Descriptor()
        {
            OpenFileDialog ofd = new OpenFileDialog();
            ofd.Filter = "AS2 documents|*.as2";
            ofd.Multiselect = false;
            if (ofd.ShowDialog() == DialogResult.OK)
            {
                TryToLoadAdditionalAS2Symbols(ofd.FileName);
                gridControlSymbols.DataSource = m_symbols;
                SetDefaultFilters();
                gridControlSymbols.RefreshDataSource();
                // and save the data to the repository
                SaveAdditionalSymbols();

            }
        }

        private void barButtonItem37_ItemClick(object sender, ItemClickEventArgs e)
        {

            try
            {
                SymbolTranslator st = new SymbolTranslator();
                OpenFileDialog ofd = new OpenFileDialog();
                if (ofd.ShowDialog() == DialogResult.OK)
                {
                    char[] sep = new char[1];
                    sep.SetValue(';', 0);
                    char[] sepspace = new char[1];
                    sepspace.SetValue(' ', 0);
                    string[] fileContent = File.ReadAllLines(ofd.FileName);
                    string symbolName = string.Empty;
                    string description = string.Empty;
                    bool readingDescription = false;
                    bool readType = false;
                    int xaxislineCount = -1;
                    int yaxislineCount = -1;
                    int resinfolinecount = -1;
                    string xaxisSymbol = "";
                    string yaxisSymbol = "";
                    float divisor = 1;
                    string type = string.Empty;

                    foreach (string line in fileContent)
                    {
                        if (line.StartsWith("*"))
                        {
                            if (line.StartsWith("*FFFuelCal.KnkEnrichmentMAP"))
                            {
                                LogHelper.Log("hold on");
                            }
                            readType = true;
                            xaxislineCount = -1;
                            yaxislineCount = -1;
                            resinfolinecount = -1;
                            description = description.Replace("Description:[\"", "");
                            description = description.Replace("\"]", "");
                            description = description.Replace("\t", "");
                            description = description.Replace("\"", "");
                            description = description.Trim();
                            while (description.Contains("  ")) description = description.Replace("  ", " ");
                            if (symbolName != string.Empty && description != string.Empty)
                            {
                                string ht = string.Empty;
                                XDFCategories cat = XDFCategories.Undocumented;
                                XDFSubCategory subcat = XDFSubCategory.Undocumented;
                                //  if (st.TranslateSymbolToHelpText(symbolName, out ht, out cat, out subcat) == string.Empty)
                                {
                                    DumpSymbolToSourceFile(symbolName, xaxisSymbol, yaxisSymbol, description, divisor, type);
                                    //LogHelper.Log(symbolName + Environment.NewLine + xaxisSymbol + Environment.NewLine + yaxisSymbol + Environment.NewLine + description);
                                }
                            }
                            divisor = 1;
                            type = string.Empty;
                            readingDescription = false;
                            symbolName = line.Replace("*", "");
                            description = "";
                            xaxisSymbol = "";
                            yaxisSymbol = "";

                        }
                        else if (line.StartsWith("Description:["))
                        {
                            xaxislineCount = -1;
                            yaxislineCount = -1;
                            resinfolinecount = -1;
                            if (!line.Contains("\"]")) readingDescription = true;
                            description = line;
                        }
                        else if (readingDescription)
                        {
                            description += line;
                            if (line.Contains("\"]")) readingDescription = false;
                        }
                        else if (readType)
                        {
                            readType = false;
                            if (line.StartsWith("MAP"))
                            {
                                // we need x and y axis info
                                resinfolinecount = 1;
                                xaxislineCount = 2;
                                yaxislineCount = 4;
                            }
                            else if (line.StartsWith("TABLE"))
                            {
                                resinfolinecount = 1;

                                xaxislineCount = 2;
                            }
                        }
                        else
                        {
                            if (xaxislineCount >= 0) xaxislineCount--;
                            if (yaxislineCount >= 0) yaxislineCount--;
                            if (resinfolinecount >= 0) resinfolinecount--;
                            if (resinfolinecount == 0)
                            {
                                // parse grootheid en factor uit de regel
                                //1 1024 0.000 2048 0 1 3 0 Fac
                                divisor = 1;
                                type = string.Empty;
                                string[] resvalues = line.Split(sepspace);
                                try
                                {
                                    divisor = (float)(1.0F / Convert.ToDouble(resvalues.GetValue(1)));
                                }
                                catch (Exception)
                                {
                                }
                                try
                                {
                                    type = resvalues.GetValue(8).ToString();
                                }
                                catch (Exception)
                                {

                                }
                            }
                            if (xaxislineCount == 0)
                            {
                                xaxislineCount = -1;
                                xaxisSymbol = line;
                            }
                            if (yaxislineCount == 0)
                            {
                                yaxislineCount = -1;
                                yaxisSymbol = line;
                            }
                        }
                    }
                }
            }
            catch (Exception E)
            {
                LogHelper.Log("Failed to import additional AS2 symbols: " + E.Message);
            }

            /*StreamReader sr = new StreamReader(@"C:\t7test\T7_EE0C.as2");
            string alltext = sr.ReadToEnd();
            char[] sep = new char[1];
            sep.SetValue((char)0x0A, 0);
            //  sep.SetValue((char)0x0A, 1);
            string[] lines = alltext.Split(sep);



            foreach (SymbolHelper sh in m_symbols)
            {
                //if (sh.Varname != "MAF.Q_AirInletNormHFM") continue;
                if (sh.Description == "" || sh.Description == sh.Varname)
                {
                    // try to find the description in the T7 info file
                    //LogHelper.Log("Find info for " + sh.Varname);
                    for (int i = 0; i < lines.Length; i++)
                    {

                        if (lines[i].StartsWith("*"))
                        {
                            string mapname = lines[i];
                            mapname = mapname.Replace("*", "");
                            mapname = mapname.Replace("\x0d", "");
                            mapname = mapname.Replace("\x0a", "");
                            //if (lines[i].Replace("*", "").StartsWith(sh.Varname))
                            if (mapname == sh.Varname)
                            {
                                // get next info
                                int j = 1;
                                bool foundEnd = false;
                                string description = string.Empty;
                                while (!foundEnd)
                                {
                                    if (lines[i + j].StartsWith("Description:["))
                                    {
                                        description = GetFullDescription(lines, i + j); // lines[i + j];
                                        foundEnd = true;
                                    }
                                    else if (lines[i + j].Trim().Length == 0)
                                    {

                                        foundEnd = true;
                                    }
                                    else if ((i + j) == lines.Length) foundEnd = true;
                                    j++;
                                }
                                description = description.Replace("]", "");
                                description = description.Trim();

                                if (description.Length > 3)
                                {
                                    LogHelper.Log("Found info for " + sh.Varname + ": " + description);
                                    AddToSourceFile(sh.Varname, description, "", "");
                                }
                                else
                                {
                                    //LogHelper.Log("No info found for: " + sh.Varname);
                                }
                            }
                        }
                    }
                }
            }*/
        }

        private void DumpSymbolToSourceFile(string symbolName, string xaxisSymbol, string yaxisSymbol, string description, float divisor, string type)
        {
            if (divisor != 1)
            {
                using (StreamWriter sw = new StreamWriter("c:\\t8fac.cs", true))
                {
                    sw.WriteLine("else if (symbolname == \"" + symbolName + "\") returnvalue = " + divisor.ToString().Replace(",", ".") + ";");
                }
            }
            /*if (description != string.Empty)
            {
                
                using (StreamWriter sw = new StreamWriter("c:\\t8sym.cs", true))
                {
                    sw.WriteLine("case \"" + symbolName + "\":");
                    sw.WriteLine("description = helptext = \"" + description + "\";");
                    sw.WriteLine("category = XDFCategories.Undocumented;");
                    sw.WriteLine("subcategory = XDFSubCategory.Undocumented;");
                    sw.WriteLine("break;");
                }
            }
            if (xaxisSymbol != string.Empty || yaxisSymbol != string.Empty)
            {
                using (StreamWriter sw = new StreamWriter("c:\\t8axis.cs", true))
                {
                    sw.WriteLine("case \"" + symbolName + "\":");
                    sw.WriteLine("x_axis = \"" + xaxisSymbol + "\";");
                    sw.WriteLine("y_axis = \"" + yaxisSymbol + "\";");
                   // sw.WriteLine("x_axis_description = \"\"");
                   // sw.WriteLine("y_axis_description = \"\"");
                   // sw.WriteLine("z_axis_description = \"\"");
                    sw.WriteLine("break;");
                }
            }*/
        }

        private void btnFlexFuelLimiter_ItemClick(object sender, ItemClickEventArgs e)
        {
            StartTableViewer("FFTrqCal.M_maxMAP");
        }

        private void toolStripMenuItem4_Click(object sender, EventArgs e)
        {
            if (gridViewSymbols.FocusedRowHandle >= 0)
            {
                SymbolHelper sh = (SymbolHelper)gridViewSymbols.GetRow(gridViewSymbols.FocusedRowHandle);
                // add to realtime table
                string symName = sh.Varname;
                if (symName.StartsWith("Symbol") && sh.Userdescription != string.Empty)
                {
                    symName = sh.Userdescription;
                }

                switch (symName)
                {
                    case "ActualIn.v_Vehicle2":
                        AddSymbolToRealTimeList(symName, sh.Symbol_number, 0, 255, 0, 0.1, sh.Description, (uint)GetSymbolAddressSRAM(m_symbols, symName), true);
                        break;
                    case "In.v_Vehicle":
                        AddSymbolToRealTimeList(symName, sh.Symbol_number, 0, 255, 0, 0.1, sh.Description, (uint)GetSymbolAddressSRAM(m_symbols, symName), true);
                        break;
                    case "FFTrqProt.Trq_MaxEngineBefComp":
                        AddSymbolToRealTimeList(symName, sh.Symbol_number, 0, 65535, 0, 0.1, sh.Description, (uint)GetSymbolAddressSRAM(m_symbols, symName), true);
                        break;
                    case "FFTrqProt.Trq_MaxEngine":
                        AddSymbolToRealTimeList(symName, sh.Symbol_number, 0, 65535, 0, 0.1, sh.Description, (uint)GetSymbolAddressSRAM(m_symbols, symName), true);
                        break;
                    default:
                        if (sh.Length == 1)
                        {
                            AddSymbolToRealTimeList(symName, sh.Symbol_number, 0, 255, 0, 1, sh.Description, (uint)GetSymbolAddressSRAM(m_symbols, symName), true);
                        }
                        else
                        {
                            AddSymbolToRealTimeList(symName, sh.Symbol_number, 0, 65535, 0, 1, sh.Description, (uint)GetSymbolAddressSRAM(m_symbols, symName), true);
                        }
                        break;
                }
            }
        }
    }

    static class SymbolDictionatry
    {
        static Dictionary<string, double> _dict = new Dictionary<string, double>
        {
        /** vanaf hier */
            /** vanaf hier */

            {"service6Eval.t_Ph3Result",1.0},
            {"service6Eval.N_FlankShiftCnt",1.0},
            {"service6Eval.N_AdjCombustCnt",1.0},
            {"service6Eval.BigLeakageResult",1.0},
            {"service6Eval.SmallLeakageResult",1.0},
            {"service6Eval.VerySmallLeakageResult",1.0},
            {"service6Eval.pRatioMean",0.01},
            {"service6Eval.U_O2SensPreMax",1.0},
            {"service6Eval.U_O2SensPreMin",1.0},
            {"service6Eval.U_O2SensPostMax",1.0},
            {"service6Eval.U_O2SensPostMin",1.0},
            {"service6Eval.n_IntDeadComb",1.0},
            {"service6Eval.LambdaAdapMin",0.01},
            {"service6Eval.LambdaAdapMax",0.01},
            {"service6Eval.LambdaAdapLim",0.01},
            {"service6Eval.t_O2SPostRespTestResult1",1.0},
            {"service6Eval.t_O2SPostRespTestResult2",1.0},
            {"service6Eval.t_Ph3result_Valid",1.0},
            {"service6Eval.N_FlankShiftCnt_N_AdjCombustCnt_Valid",1.0},
            {"service6Eval.IntDeadComb_Valid",1.0},
            {"service6Eval.BigLeakageResult_Valid",1.0},
            {"service6Eval.SmallLeakageResult_Valid",1.0},
            {"service6Eval.VerySmallLeakageResult_Valid",1.0},
            {"service6Eval.pRatio_Valid",1.0},
            {"service6Eval.O2SensPre_Valid",1.0},
            {"service6Eval.O2SensPost_Valid",1.0},
            {"service6Eval.Misfire_Valid",1.0},
            {"service6Eval.LongTermFuelTrim_Valid",1.0},
            {"service6Eval.O2SPostRespTest1_Valid",1.0},
            {"service6Eval.O2SPostRespTest2_Valid",1.0},
            {"service6EvalPostResponse.t_Result1",1.0},
            {"service6EvalPostResponse.t_Result2",1.0},
            {"service6EvalPostResponse.ST_Valid",1.0},
            {"StaticDPID01.Byte_1",1.0},
            {"StaticDPID01.Byte_2",1.0},
            {"StaticDPID01.Byte_3",1.0},
            {"StaticDPID01.Byte_4",1.0},
            {"StaticDPID01.Byte_5",1.0},
            {"StaticDPID01.Byte_6",1.0},
            {"StaticDPID01.Byte_7",1.0},
            {"StaticDPID02.Byte_1",1.0},
            {"StaticDPID02.Byte_2",1.0},
            {"StaticDPID02.Byte_3",1.0},
            {"StaticDPID02.Byte_4",1.0},
            {"StaticDPID02.Byte_5",1.0},
            {"StaticDPID02.Byte_6",1.0},
            {"StaticDPID02.Byte_7",1.0},
            {"StaticDPID03.Byte_1",1.0},
            {"StaticDPID03.Byte_2",1.0},
            {"StaticDPID03.Byte_3",1.0},
            {"StaticDPID03.Byte_4",1.0},
            {"StaticDPID03.Byte_5",1.0},
            {"StaticDPID03.Byte_6",1.0},
            {"StaticDPID03.Byte_7",1.0},
            {"StaticDPID04.Byte_1",1.0},
            {"StaticDPID04.Byte_2",1.0},
            {"StaticDPID04.Byte_3",1.0},
            {"StaticDPID04.Byte_4",1.0},
            {"StaticDPID04.Byte_5",1.0},
            {"StaticDPID04.Byte_6",1.0},
            {"StaticDPID04.Byte_7",1.0},
            {"StaticDPID10.Byte_1",1.0},
            {"StaticDPID10.Byte_2",1.0},
            {"StaticDPID10.Byte_3",1.0},
            {"StaticDPID10.Byte_4",1.0},
            {"StaticDPID10.Byte_5",1.0},
            {"StaticDPID10.Byte_6",1.0},
            {"StaticDPID10.Byte_7",1.0},
            {"StaticDPID11.Byte_1",1.0},
            {"StaticDPID11.Byte_2",1.0},
            {"StaticDPID11.Byte_3",1.0},
            {"StaticDPID11.Byte_4",1.0},
            {"StaticDPID11.Byte_5",1.0},
            {"StaticDPID11.Byte_6",1.0},
            {"StaticDPID11.Byte_7",1.0},
            {"StaticDPID12.Byte_1",1.0},
            {"StaticDPID12.Byte_2",1.0},
            {"StaticDPID12.Byte_3",1.0},
            {"StaticDPID12.Byte_4",1.0},
            {"StaticDPID12.Byte_5",1.0},
            {"StaticDPID12.Byte_6",1.0},
            {"StaticDPID12.Byte_7",1.0},
            {"StaticDPID13.Byte_1",1.0},
            {"StaticDPID13.Byte_2",1.0},
            {"StaticDPID13.Byte_3",1.0},
            {"StaticDPID13.Byte_4",1.0},
            {"StaticDPID13.Byte_5",1.0},
            {"StaticDPID13.Byte_6",1.0},
            {"StaticDPID13.Byte_7",1.0},
            {"StaticDPID14.Byte_1",1.0},
            {"StaticDPID14.Byte_2",1.0},
            {"StaticDPID14.Byte_3",1.0},
            {"StaticDPID14.Byte_4",1.0},
            {"StaticDPID14.Byte_5",1.0},
            {"StaticDPID14.Byte_6",1.0},
            {"StaticDPID14.Byte_7",1.0},
            {"StaticDPID15.Byte_1",1.0},
            {"StaticDPID15.Byte_2",1.0},
            {"StaticDPID15.Byte_3",1.0},
            {"StaticDPID15.Byte_4",1.0},
            {"StaticDPID15.Byte_5",1.0},
            {"StaticDPID15.Byte_6",1.0},
            {"StaticDPID15.Byte_7",1.0},
            {"StaticDPID16.Byte_1",1.0},
            {"StaticDPID16.Byte_2",1.0},
            {"StaticDPID16.Byte_3",1.0},
            {"StaticDPID16.Byte_4",1.0},
            {"StaticDPID16.Byte_5",1.0},
            {"StaticDPID16.Byte_6",1.0},
            {"StaticDPID16.Byte_7",1.0},
            {"StaticDPID17.Byte_1",1.0},
            {"StaticDPID17.Byte_2",1.0},
            {"StaticDPID17.Byte_3",1.0},
            {"StaticDPID17.Byte_4",1.0},
            {"StaticDPID17.Byte_5",1.0},
            {"StaticDPID17.Byte_6",1.0},
            {"StaticDPID17.Byte_7",1.0},
            {"StaticDPID18.Byte_1",1.0},
            {"StaticDPID18.Byte_2",1.0},
            {"StaticDPID18.Byte_3",1.0},
            {"StaticDPID18.Byte_4",1.0},
            {"StaticDPID18.Byte_5",1.0},
            {"StaticDPID18.Byte_6",1.0},
            {"StaticDPID18.Byte_7",1.0},
            {"StaticDPID19.Byte_1",1.0},
            {"StaticDPID19.Byte_2",1.0},
            {"StaticDPID19.Byte_3",1.0},
            {"StaticDPID19.Byte_4",1.0},
            {"StaticDPID19.Byte_5",1.0},
            {"StaticDPID19.Byte_6",1.0},
            {"StaticDPID19.Byte_7",1.0},
            {"StaticDPID1A.Byte_1",1.0},
            {"StaticDPID1A.Byte_2",1.0},
            {"StaticDPID1A.Byte_3",1.0},
            {"StaticDPID1A.Byte_4",1.0},
            {"StaticDPID1A.Byte_5",1.0},
            {"StaticDPID1A.Byte_6",1.0},
            {"StaticDPID1A.Byte_7",1.0},
            {"StaticDPID1C.Byte_1",1.0},
            {"StaticDPID1C.Byte_2",1.0},
            {"StaticDPID1C.Byte_3",1.0},
            {"StaticDPID1C.Byte_4",1.0},
            {"StaticDPID1C.Byte_5",1.0},
            {"StaticDPID1C.Byte_6",1.0},
            {"StaticDPID1C.Byte_7",1.0},
            {"StaticDPID31.Byte_1",1.0},
            {"StaticDPID31.Byte_2",1.0},
            {"StaticDPID31.Byte_3",1.0},
            {"StaticDPID31.Byte_4",1.0},
            {"StaticDPID31.Byte_5",1.0},
            {"StaticDPID31.Byte_6",1.0},
            {"StaticDPID31.Byte_7",1.0},
            {"StaticDPID32.Byte_1",1.0},
            {"StaticDPID32.Byte_2",1.0},
            {"StaticDPID32.Byte_3",1.0},
            {"StaticDPID32.Byte_4",1.0},
            {"StaticDPID32.Byte_5",1.0},
            {"StaticDPID32.Byte_6",1.0},
            {"StaticDPID32.Byte_7",1.0},
            {"StaticDPID33.Byte_1",1.0},
            {"StaticDPID33.Byte_2",1.0},
            {"StaticDPID33.Byte_3",1.0},
            {"StaticDPID33.Byte_4",1.0},
            {"StaticDPID33.Byte_5",1.0},
            {"StaticDPID33.Byte_6",1.0},
            {"StaticDPID33.Byte_7",1.0},
            {"StaticDPID34.Byte_1",1.0},
            {"StaticDPID34.Byte_2",1.0},
            {"StaticDPID34.Byte_3",1.0},
            {"StaticDPID34.Byte_4",1.0},
            {"StaticDPID34.Byte_5",1.0},
            {"StaticDPID34.Byte_6",1.0},
            {"StaticDPID34.Byte_7",1.0},
            {"StaticDPID37.Byte_1",1.0},
            {"StaticDPID37.Byte_2",1.0},
            {"StaticDPID37.Byte_3",1.0},
            {"StaticDPID37.Byte_4",1.0},
            {"StaticDPID37.Byte_5",1.0},
            {"StaticDPID37.Byte_6",1.0},
            {"StaticDPID37.Byte_7",1.0},
            {"StaticDPID38.Byte_1",1.0},
            {"StaticDPID38.Byte_2",1.0},
            {"StaticDPID38.Byte_3",1.0},
            {"StaticDPID38.Byte_4",1.0},
            {"StaticDPID38.Byte_5",1.0},
            {"StaticDPID38.Byte_6",1.0},
            {"StaticDPID38.Byte_7",1.0},
            {"StaticDPID39.Byte_1",1.0},
            {"StaticDPID39.Byte_2",1.0},
            {"StaticDPID39.Byte_3",1.0},
            {"StaticDPID39.Byte_4",1.0},
            {"StaticDPID39.Byte_5",1.0},
            {"StaticDPID39.Byte_6",1.0},
            {"StaticDPID39.Byte_7",1.0},
            {"StaticDPID3B.Byte_1",1.0},
            {"StaticDPID3B.Byte_2",1.0},
            {"StaticDPID3B.Byte_3",1.0},
            {"StaticDPID3B.Byte_4",1.0},
            {"StaticDPID3B.Byte_5",1.0},
            {"StaticDPID3B.Byte_6",1.0},
            {"StaticDPID3B.Byte_7",1.0},
            {"StaticDPID40.Byte_1",1.0},
            {"StaticDPID40.Byte_2",1.0},
            {"StaticDPID40.Byte_3",1.0},
            {"StaticDPID40.Byte_4",1.0},
            {"StaticDPID40.Byte_5",1.0},
            {"StaticDPID40.Byte_6",1.0},
            {"StaticDPID40.Byte_7",1.0},
            {"BoostMeterCal.Trq_Max",0.1},
            {"BoostMeterCal.Trq_MaxLow",0.1},
            {"BoostMeterCal.Trq_MaxFF",0.1},
            {"BoostMeterCal.Trq_MaxFFLow",0.1},
            {"BoostMeterCal.X_FactorNotStarted",1.0},
            {"BoostMeterCal.X_FactorSP",1.0},
            {"BoostMeterCal.X_FactorTAB",1.0},
            {"ETC5V.t_OOR1ContFailTmr",1.0},
            {"ETC5V.t_OOR2ContFailTmr",1.0},
            {"ETC5V.c_OOR1_Fail",1.0},
            {"ETC5V.c_OOR1_Smpl",1.0},
            {"ETC5V.c_OOR2_Fail",1.0},
            {"ETC5V.c_OOR2_Smpl",1.0},
            {"ETC5V.ST_OOR1_Err",1.0},
            {"ETC5V.ST_OOR2_Err",1.0},
            {"ETC5V.ST_OOR1_Flt",1.0},
            {"ETC5V.ST_OOR2_Flt",1.0},
            {"ETC5V.ST_OOR1MainMCP",1.0},
            {"ETC5V.ST_OOR2MainMCP",1.0},
            {"KnkFuelProt.FuelAdjust",0.0009765625},
            {"KnkFuelProt.FuelTab",0.0009765625},
            {"KnkFuelProt.fi_MaxOffset",0.1},
            {"KnkFuelProt.fi_MaxOff",0.1},
            {"KnkFuelProt.WeightFac1",1.0},
            {"KnkFuelProt.WeightFac2",1.0},
            {"KnkFuel.CylFuelFac",0.0009765625},
            {"KnkFuel.FuelFac",0.0009765625},
            {"KnkFuel.ST_EnableLam",1.0},
            {"KnkDetCal.fi_knkWinOffsMAP",0.1},
            {"KnkDetCal.fi_knkWinSizeMAP",0.1},
            {"KnkDetCal.m_AirNoiseXSP",1.0},
            {"KnkDetCal.m_AirXSP",1.0},
            {"KnkDetCal.n_EngNoiseYSP",1.0},
            {"KnkDetCal.n_EngYSP",1.0},
            {"KnkDetCal.LoadLimit",1.0},
            {"KnkDetCal.X_hystOffsetMAP",0.0009765625},
            {"KnkDetCal.X_AHystOffsetMAP",0.0009765625},
            {"KnkDetCal.X_K0",0.0009765625},
            {"KnkDetCal.X_K1",0.0009765625},
            {"KnkDetCal.X_K2",0.0009765625},
            {"KnkDetCal.X_K3",0.0009765625},
            {"KnkDetCal.X_K4",0.0009765625},
            {"KnkDetCal.X_judgeKnock",0.0009765625},
            {"KnkDetCal.knkWinStart",0.1},
            {"KnkDetCal.knkWinStop",0.1},
            {"KnkDetCal.f_KnkFreq",1.0},
            {"KnkDetCal.t_holdK3",1.0},
            {"KnkDetCal.n_holdK3",1.0},
            {"KnkDetCal.UpperDiffLim",0.0009765625},
            {"KnkDetCal.LowerDiffLim",0.0009765625},
            {"KnkDetCal.p_AirDeltaLim",0.1},
            {"KnkDetCal.T_EnableXSP",1.0},
            {"KnkDetCal.T_EnableYSP",1.0},
            {"KnkDetCal.fi_DiffXSP",0.1},
            {"KnkDetCal.K1TAB",0.0078125},
            {"KnkDetCal.KnockCylInit",1.0},
            {"KnkDetCal.knkWinMode",1.0},
            {"MisfAveCal.t_HiMFAve1KaSP",1.0},
            {"MisfAveCal.KaTAB",0.0009765625},
            {"MisfAveCal.t_HiMFAveAKbSP",1.0},
            {"MisfAveCal.KbTAB",0.0009765625},
            {"MisfAveCal.t_HiMFAve1KbSP",1.0},
            {"MisfAveCal.Ka2TAB",0.0009765625},
            {"MisfAveCal.t_HiMFAveAKaSP",1.0},
            {"MisfAveCal.Kb2TAB",0.0009765625},
            {"MisfAveCal.T_EngHighMFAve",1.0},
            {"MisfAveCal.T_EngLowMFAve",1.0},
            {"MisfAveCal.T_AirHighMFAve",1.0},
            {"MisfAveCal.T_AirLowMFAve",1.0},
            {"MisfAveCal.m_AirHighMFAve",1.0},
            {"MisfAveCal.m_AirLowMFAve",1.0},
            {"MisfAveCal.n_EngHighMFAve",1.0},
            {"MisfAveCal.n_EngLowMFAve",1.0},
            {"MisfAveCal.m_AirHigh2MFAve",1.0},
            {"MisfAveCal.m_AirLow2MFAve",1.0},
            {"MisfAveCal.n_EngHigh2MFAve",1.0},
            {"MisfAveCal.n_EngLow2MFAve",1.0},
            {"MisfAveCal.fi_RetardLimit",0.1},
            {"MisfAveCal.K_MFAveA1",0.0009765625},
            {"MisfAveCal.K_MFAveA2",0.0009765625},
            {"MisfAveCal.n_MFAve",1.0},
            {"MisfAveCal.n_HiMFAve1",1.0},
            {"MisfAveCal.n_HiMFAve2",1.0},
            {"MisfAveCal.MFIndexMAP",0.0078125},
            {"MisfAveCal.n_EngMFIndexYSP",1.0},
            {"MisfAveCal.m_AirMFIndexXSP",1.0},
            {"MisfAveCal.HiMFAveA_SWITCH",1.0},
            {"FFRfuelCal.X_blendError",0.1},
            {"FFRfuelCal.V_unusableFuel",0.1},
            {"FFRfuelCal.V_DeadBand",0.1},
            {"FFRfuelCal.f_FiltCutOff",1.0},
            {"FFRfuelCal.t_saveFuelLevel",0.1},
            {"FFRfuelCal.t_RfuelPossible",0.1},
            {"FFRfuelCal.V_RfuelTriggThres",0.1},
            {"FFRfuelCal.V_TankSP6",0.1},
            {"FFRfuelCal.V_ErrorTankTAB",0.1},
            {"FFRfuelCal.dV_RfuelStopped",0.1},
            {"FFRfuelCal.V_FuelConsLimit",0.1},
            {"FFRfuelCal.V_DeadBandFullTank",0.1},
            {"FFRfuelCal.ST_enable",1.0},
            {"FuelDynCal.n_CombOnStartPar",1.0},
            {"FuelDynCal.m_fuelAftFCutDiff",0.01},
            {"FuelDynCal.m_reqSlowDiffLim",0.01},
            {"FuelDynCal.m_actSlowDiffLim",0.01},
            {"FuelDynCal.n_EngineSP",1.0},
            {"FuelDynCal.T_EngineSP",1.0},
            {"FuelDynCal.T_eng6SP",1.0},
            {"FuelDynCal.T_engStarted5SP",1.0},
            {"FuelDynCal.WCFbetaSP",0.0078125},
            {"FuelDynCal.T_EngStrt3SP",1.0},
            {"FuelDynCal.t_Soak3SP",0.1},
            {"FuelDynCal.T_EngStrtOffsMAP",1.0},
            {"FuelDynCal.X_FilterEngOffs",0.0009765625},
            {"FuelDynCal.t_injMin",1.0},
            {"FuelDynCal.T_EngAftFCutSP",1.0},
            {"FuelDynCal.X_NormCombDetSP",0.0009765625},
            {"FuelDynCal.m_fuelDeltaSP",0.01},
            {"FuelDynCal.m_fuelDelta2SP",0.01},
            {"FuelDynCal.X_diffLevelAdjust",1.0},
            {"FuelDynCal.X_biasMAP",0.0078125},
            {"FuelDynCal.n_combSP",1.0},
            {"FuelDynCal.X_biasWUMAP",0.0078125},
            {"FuelDynCal.X_biasWUScaleMAP",0.0078125},
            {"FuelDynCal.n_combBetaLim",1.0},
            {"FuelDynCal.X_AfterFCutMAP",0.0078125},
            {"FuelDynCal.betaAftFCutMAP",0.00392156862745},
            {"FuelDynCal.ST_Enable",1.0},
            {"FuelDynCal.alphaMinLim",0.00392156862745},
            {"FuelDynCal.betaMinLim",0.00392156862745},
            {"FuelDynCal.WCFbetaTAB",0.00392156862745},
            {"FuelDynCal.X_negFuelLimMAP",0.00392156862745},
            {"FuelDynCal.betaMAP",0.00392156862745},
            {"FuelDynCal.alphaMAP",0.00392156862745},
            {"FuelDynCal.X_negStartFuelLimTAB",0.00392156862745},
            {"FuelDynCal.ST_EnableFast",1.0},
            {"FuelDynCal.ST_EnableSlow",1.0},
            {"FuelDynCal.ST_EnableNegFuelDynOnStart",1.0},
            {"FuelDynCal.ST_EnabAftFuelCutEnr",1.0},
            {"FuelDynSlowCal.X_FilterFac",0.0009765625},
            {"FuelDynSlowCal.alphaSlowTAB",0.00392156862745},
            {"FuelDynSlowCal.betaSlowTAB",0.00392156862745},
            {"FuelDynSlowCal.T_airSlowSP",1.0},
            {"SystemCal.NVDMChangedTimerLimit",1.0},
            {"SystemCal.ShutOffTime",1.0},
            {"SystemCal.t_AdjustGearSelVal",1.0},
            {"SystemCal.N_FreeStarts",1.0},
            {"SystemCal.N_MEC",1.0},
            {"SystemCal.ST_MuleCar",1.0},
            {"SystemCal.N_combEngineNotStarted",1.0},
            {"SystemCal.N_combPosEngStart",1.0},
            {"InitDIDsInNVDMCal.DID_07_Default",1.0},
            {"InitDIDsInNVDMCal.DID_24_Default",1.0},
            {"InitDIDsInNVDMCal.DID_71_Default",1.0},
            {"InitDIDsInNVDMCal.DID_72_Default",1.0},
            {"InitDIDsInNVDMCal.DID_73_Default",1.0},
            {"InitDIDsInNVDMCal.DID_75_Default",1.0},
            {"InitDIDsInNVDMCal.DID_9F_Default",1.0},
            {"InjCorrCal.InjectorConst",1.0},
            {"InjCorrCal.BattCorrTab",1.0},
            {"InjCorrCal.BattCorrSP",0.1},
            {"obdPTRelay.ST_OkStatus",1.0},
            {"obdPTRelay.ST_FaultCode",1.0},
            {"obdPTRelay.ST_Error",1.0},
            {"obdAC_Relay.ST_OkStatus",1.0},
            {"obdAC_Relay.ST_FaultCode",1.0},
            {"obdFuelPumpRelay.ST_OkStatus",1.0},
            {"obdFuelPumpRelay.ST_FaultCode",1.0},
            {"obdInjector1.ST_OkStatus",1.0},
            {"obdInjector1.ST_FaultCode",1.0},
            {"obdInjector2.ST_OkStatus",1.0},
            {"obdInjector2.ST_FaultCode",1.0},
            {"obdInjector3.ST_OkStatus",1.0},
            {"obdInjector3.ST_FaultCode",1.0},
            {"obdInjector4.ST_OkStatus",1.0},
            {"obdInjector4.ST_FaultCode",1.0},
            {"obdStartRelay.ST_OkStatus",1.0},
            {"obdStartRelay.ST_FaultCode",1.0},
            {"FFCal.T_EngLim",1.0},
            {"FFCal.X_BlendLim",0.1},
            {"FFCatDiagCal.X_constRateIntMax",0.0009765625},
            {"FFCatDiagCal.X_blendFacTabSP",0.1},
            {"FFCatDiagCal.X_blendFacTab",0.0009765625},
            {"FFCatModCal.T_SteadyStateMAP",1.0},
            {"FFCatModCal.X_SSTempInterpolWeightTAB",0.0078125},
            {"FFEvapDiagCal.X_TotTabRamp2MAP",0.0078125},
            {"FFEvapDiagCal.X_blendFacSP",0.1},
            {"FFEvapDiagCal.V_FuelVolSP",0.1},
            {"DNCompCal.SlowDriveActTAB",1.0},
            {"DNCompCal.SlowDriveRelTAB",1.0},
            {"DNCompCal.FastDriveActTAB",1.0},
            {"DNCompCal.FastDriveRelTAB",1.0},
            {"DNCompCal.n_DeltaSP",1.0},
            {"DNCompCal.DNIndSampleTime",1.0},
            {"DNCompCal.n_GearboxDiff",1.0},
            {"DNCompCal.T_EngSP",1.0},
            {"DNCompCal.T_TrnXSP",1.0},
            {"DNCompCal.n_EngYSP",1.0},
            {"DNCompCal.Trq_ReqNeutralMAP",0.1},
            {"DNCompCal.Trq_ReqDriveMAP",0.1},
            {"DNCompCal.n_EngNomDriveTAB",1.0},
            {"DNCompCal.n_EngNomNeutralTAB",1.0},
            {"DNCompCal.n_EngNomManualTAB",1.0},
            {"DNCompCal.v_VehicleLowLim",0.1},
            {"DNCompCal.v_VehicleHighLim",0.1},
            {"DNCompCal.v_DNDetection",0.1},
            {"DNCompCal.n_EngNomRampStep",1.0},
            {"DNCompCal.t_IdleRpmTime",1.0},
            {"DNCompCal.n_NomStartRpmFlareTAB",1.0},
            {"DNCompCal.n_StartFlareDecayRateTAB",1.0},
            {"DNCompCal.n_DeltaTAB",0.0078125},
            {"DNCompCal.ST_NC",1.0},
            {"IgnKnkAdap.fi_OffsetAdap",0.1},
            {"EngineTempSensorOhms",1.0},
            {"ExhaustTempSensorOhms",1.0},
            {"TankData.AD_VFuelTankSP",1.0},
            {"TankData.V_FuelTankTAB",0.1},
            {"TankData.V_MaxFuelTank",0.1},
            {"TankData.N_MaxADCount",1.0},
            {"TankData.N_MinADCount",1.0},
            {"RpmCtrlProt.P_PartIgn",0.1},
            {"RpmCtrlProt.I_PartIgn",0.1},
            {"RpmCtrlProt.D_PartIgn",0.1},
            {"RpmCtrlProt.P_PartAir",0.1},
            {"RpmCtrlProt.I_PartAir",0.1},
            {"RpmCtrlProt.RpmRegAverageDiff",0.1},
            {"RpmCtrlProt.Trq_BookedReserve",0.1},
            {"RpmCtrlProt.n_EngineDiff",1.0},
            {"RpmCtrlProt.n_EngineDelta",1.0},
            {"RpmCtrlProt.m_AirMBT",1.0},
            {"RpmCtrlProt.I_PartAirMax",0.1},
            {"RpmCtrlProt.I_PartAirMin",0.1},
            {"RpmCtrlProt.Trq_ReqRawNeutAdap",0.1},
            {"RpmCtrlProt.Trq_ReqRawDrivAdap",0.1},
            {"RpmCtrlProt.Trq_ResRequestHotSoak",0.1},
            {"RpmCtrlProt.ST_controlMode",1.0},
            {"RpmCtrlAdapProt.t_inWindow",0.001},
            {"RpmCtrlAdapProt.ST_inAdapMAP",1.0},
            {"RpmCtrlAdapProt.ST_status",1.0},
            {"RpmCtrl.D_PartIgn",0.1},
            {"RpmCtrl.I_PartAir",0.1},
            {"RpmCtrl.P_PartAir",0.1},
            {"RpmCtrl.I_PartIgn",0.1},
            {"RpmCtrl.P_PartIgn",0.1},
            {"RpmCtrl.Trq_Request",0.1},
            {"RpmCtrl.Trq_ResRequest",0.1},
            {"RpmCtrl.Trq_BookedReserve",0.1},
            {"RpmCtrl.Trq_ReqNeutAdap",0.1},
            {"RpmCtrl.Trq_ReqDrivAdap",0.1},
            {"RpmCtrl.Trq_ResRequestRaw",0.1},
            {"RpmCtrl.Trq_PowerComp",0.1},
            {"RpmCtrl.Trq_PowerCompRes",0.1},
            {"RpmCtrl.Trq_PedalComp",0.1},
            {"RpmCtrl.Trq_PdlRlsdLim",0.1},
            {"RpmCtrl.n_EngDeltaDer",1.0},
            {"RpmCtrl.ST_RpmCtrl",1.0},
            {"RpmCtrl.ST_TorqueCtrl",1.0},
            {"RpmCtrl.I_PartLimited",1.0},
            {"RpmCtrl.ST_EnablePowerComp",1.0},
            {"OilLifeCal.Pct_ChangeOilNow",0.1},
            {"OilLifeCal.Pct_ChangeOilSoon",0.1},
            {"OilLifeCal.N_EffRevLimit",1.0},
            {"OilLifeCal.N_MaximumColdStarts",1.0},
            {"OilLifeCal.T_MaximumCoolantForColdStart",1.0},
            {"OilLifeCal.l_MinimumDist",1.0},
            {"OilLifeCal.t_OilLifeHotPeriod",0.1},
            {"OilLifeCal.T_OilLifeOvertemp",1.0},
            {"OilLifeCal.X_PenaltyFactorTAB",1.0},
            {"OilLifeCal.T_OilSP",1.0},
            {"OilLifeCal.N_RecommendedCompoundRevs",1.0},
            {"OilLifeCal.l_RecommendedDist",1.0},
            {"OilLifeCal.ST_OilLifeHotStatus",1.0},
            {"OilLifeCal.ST_OilLifeSoonStatus",1.0},
            {"BoostAdapAdap.AdapMAP",0.0078125},
            {"BoostAdapAdap.ValidMAP",1.0},
            {"obdIgnitionCoilTrig1.ST_OkStatus",1.0},
            {"obdIgnitionCoilTrig1.ST_FaultCode",1.0},
            {"obdIgnitionCoilTrig2.ST_OkStatus",1.0},
            {"obdIgnitionCoilTrig2.ST_FaultCode",1.0},
            {"obdIgnitionCoilTrig3.ST_OkStatus",1.0},
            {"obdIgnitionCoilTrig3.ST_FaultCode",1.0},
            {"obdIgnitionCoilTrig4.ST_OkStatus",1.0},
            {"obdIgnitionCoilTrig4.ST_FaultCode",1.0},
            {"obdKnockCircuit.N_Combustions",1.0},
            {"obdKnockCircuit.ST_OkStatus",1.0},
            {"obdKnockCircuit.ST_FaultCode",1.0},
            {"obdKnockCircuit.N_Pulses",1.0},
            {"obdKnockCircuit.N_LowestPulseCount",1.0},
            {"JerkProt.JerkFactor",1.0},
            {"JerkProt.T_AirInlet",1.0},
            {"JerkProt.X_AccPos",0.1},
            {"REPProt.p_AirAmbient",0.1},
            {"REPProt.P_Saved",0.1},
            {"REPProt.X_LastPedal",0.1},
            {"REPProt.ST_Active",1.0},
            {"REPProt.ST_GSIState",1.0},
            {"KnkFuelCal.EnrichmentMap",0.0009765625},
            {"KnkFuelCal.fi_OffsetEnrichEnable",0.1},
            {"KnkFuelCal.fi_MaxOffsetMap",0.1},
            {"KnkFuelCal.m_AirXSP",1.0},
            {"KnkFuelCal.X_blendXSP",0.1},
            {"KnkFuelCal.X_weightYSP",1.0},
            {"KnkFuelCal.X_weightMAP",1.0},
            {"KnkFuelCal.LambLim",0.0009765625},
            {"KnkFuelCal.ST_RampCalc",1.0},
            {"StartAirCal.PedalLimit",0.1},
            {"StartAirCal.A_EngineStill",0.1},
            {"StartAirCal.A_ThrottleEngShutDown",0.1},
            {"StartAirCal.n_EngLimFixThrAreaMAP",1.0},
            {"StartAirCal.n_CombLimFixThrArea",1.0},
            {"StartAirCal.X_blendCombLimXSP",0.1},
            {"StartAirCal.T_EngCombLimYSP",1.0},
            {"StartAirCal.A_FixThrottle",0.1},
            {"StartAirCal.A_FixThrRampStep",0.1},
            {"StartAirCal.X_FixThrBoffLimit",0.0009765625},
            {"StartAirCal.ST_EnableFixThrArea",1.0},
            {"AreaAdap.A_Throttle",0.1},
            {"AirCtrlAdap.m_IpartThrMAP",0.0078125},
            {"ThrotPosCal.ThrotFiltFac",1.0},
            {"ThrotPosCal.X_LoLimit",0.1},
            {"ThrotPosCal.X_HiLimit",0.1},
            {"ThrotPosCal.X_EngPwrLim",0.1},
            {"ThrotPosCal.X_CntrlMax",0.1},
            {"ThrotPosCal.X_CntrlMin",0.1},
            {"ThrotPosCal.X_WOTThrs",0.1},
            {"ACCompCal.n_EngACShtHigh",1.0},
            {"ACCompCal.n_EngACShtLow",1.0},
            {"ACCompCal.X_AccPACShtOff",0.1},
            {"ACCompCal.t_ACShutOffAtAccel",1.0},
            {"ACCompCal.p_ACXSP",0.01},
            {"ACCompCal.n_EngineYSP",1.0},
            {"ACCompCal.Trq_ReqStaticMAP",0.1},
            {"ACCompCal.Trq_RequestTempDyn",0.1},
            {"ACCompCal.n_EngineSP",1.0},
            {"ACCompCal.t_ACRampOffDyn",1.0},
            {"ACCompCal.t_ACOnRampTAB",1.0},
            {"ACCompCal.t_ACRelayOffDelayTAB",1.0},
            {"ACCompCal.T_ACExDyn",1.0},
            {"ACCompCal.Trq_ReqDynamicMAP",0.1},
            {"ACCompCal.n_CombCrank",1.0},
            {"ACCompCal.t_DynPartDelay",1.0},
            {"ACCompCal.ST_Loop",1.0},
            {"ElevIdleProt.t_PowerSteerTimeStamp",1.0},
            {"ElevIdleProt.t_EnableLimitCounter",1.0},
            {"ElevIdleProt.t_DisableLimitCounter",1.0},
            {"ElevIdleProt.t_100msUBattCounterStamp",0.1},
            {"ElevIdleProt.t_100msOtsAirCounterStamp",0.1},
            {"ElevIdleProt.t_100msClutchActStamp",0.1},
            {"ElevIdleProt.ST_ActiveElevIdleRequest",1.0},
            {"ElevIdleProt.n_EngElevIdle1",1.0},
            {"ElevIdleProt.n_EngElevIdlePS",1.0},
            {"ElevIdleProt.n_EngElevIdleHotSoak",1.0},
            {"ElevIdleProt.n_EngElevIdleVehSpd",1.0},
            {"ElevIdleProt.n_EngElevIdleClutch",1.0},
            {"ElevIdleProt.n_EngElevIdleCatDiag",1.0},
            {"ElevIdleProt.n_EngElevIdleEvapDiag",1.0},
            {"ElevIdleProt.n_EngElevIdleServiceBay",1.0},
            {"ElevIdleProt.n_EngElevIdleAC",1.0},
            {"ElevIdleProt.n_EngElevIdleHeater",1.0},
            {"ElevIdleProt.n_EngElevIdleLowBattery",1.0},
            {"ElevIdleProt.n_EngElevIdleOilTemp",1.0},
            {"ElevIdleProt.n_EngElevIdleTOA",1.0},
            {"ElevIdleProt.n_ElevIdleRevving",1.0},
            {"ElevIdleProt.n_ElevIdleRevvingFreeze",1.0},
            {"ElevIdleProt.n_ElevIdleRevvingStepDown",1.0},
            {"ElevIdleProt.n_EngElevIdleHotSoakLevel",1.0},
            {"ElevIdleProt.T_OtsAirTmpCrFilt",1.0},
            {"ElevIdleProt.U_BattFilt",0.1},
            {"ElevIdleProt.ST_ElevIdleMovingCar",1.0},
            {"ElevIdleProt.ST_ElevIdleClutchActive",1.0},
            {"ElevIdleProt.ST_ElevIdleCatDiag",1.0},
            {"ElevIdleProt.ST_ElevIdleEvapDiag",1.0},
            {"ElevIdleProt.ST_ElevIdleExtReq",1.0},
            {"ElevIdleProt.ST_ElevIdleLimpHome",1.0},
            {"ElevIdleProt.ST_ElevIdleAmbientPressure",1.0},
            {"ElevIdleProt.ST_ElevIdleAmbientTemperature",1.0},
            {"ElevIdleProt.ST_ElevIdleBattLow",1.0},
            {"ElevIdleProt.ST_ActivateBattElevIdle",1.0},
            {"ElevIdleProt.ST_EnableLoop",1.0},
            {"ElevIdleProt.ST_ElevIdleExtReqRpmCond",1.0},
            {"ElevIdleProt.ST_ElevIdleExtReqTimeCond",1.0},
            {"ElevIdleProt.ST_ConvertibleCar",1.0},
            {"ElevIdleProt.ST_ElevIdleServiceBayDiag",1.0},
            {"ElevIdleProt.ST_ElevIdleRevving",1.0},
            {"ElevIdleProt.ST_ElevIdleRevvingPos",1.0},
            {"ElevIdle.n_Engine",1.0},
            {"ElevIdle.ST_ElevIdlePowerSteer",1.0},
            {"ElevIdle.ST_ElevIdleRevving",1.0},
            {"ECC_ControlProt.ST_StrokeRequest",1.0},
            {"obdThrotMinLearn.ST_OkStatus",1.0},
            {"obdThrotMinLearn.ST_FaultCode",1.0},
            {"obdThrotDefault.ST_OkStatus",1.0},
            {"obdThrotDefault.ST_FaultCode",1.0},
            {"obdThrot.ST_OkStatus",1.0},
            {"obdThrot.ST_FaultCode",1.0},
            {"obdThrot.ST_VehicleSpeedOk",1.0},
            {"obdECM.ST_OkStatus",1.0},
            {"obdECM.ST_FaultCode",1.0},
            {"obdECM.ST_VehicleSpeedOk",1.0},
            {"obdPedal.ST_OkStatus",1.0},
            {"obdPedal.ST_FaultCode",1.0},
            {"obdPedal.ST_VehicleSpeedOk",1.0},
            {"InjAnglProt.fi_InjActual",0.1},
            {"InjAnglProt.X_InjAnglRamp",1.0},
            {"InjAnglProt.X_InjAnglRampTAB",1.0},
            {"InjAnglProt.ST_InjAnglRamp",1.0},
            {"InjAngl.fi_InjActual",0.1},
            {"LambdaPostAdap.n_IntDeadComb",1.0},
            {"LambdaPostAdap.ST_Adap",1.0},
            {"AltCtrlProt.Engine_Coolant_Temperature",1.0},
            {"AltCtrlProt.Engine_Speed",1.0},
            {"AltCtrlProt.Idle_Speed_Desired",1.0},
            {"AltCtrlProt.PTSS_Engine_Running_Time",0.1},
            {"AltCtrlProt.t_PPEIReqOverride",0.1},
            {"AltCtrlProt.t_MinTimeOn",0.025},
            {"AltCtrlProt.t_TurnOnDelay",0.025},
            {"AltCtrlProt.t_TrqResHoldTime",0.025},
            {"AltCtrlProt.Cold_Start_Genr_Dsbl_Required",1.0},
            {"AltCtrlProt.Generator_L_Terminal_Control",1.0},
            {"AltCtrlProt.Generator_L_TermNormlCntrl",1.0},
            {"AltCtrlProt.Generator_L_TermPPEICntrl",1.0},
            {"AltCtrlProt.In_Park_Or_Neutral",1.0},
            {"AltCtrlProt.In_Park_Or_NeutralPrev",1.0},
            {"AltCtrlProt.PTSS_Engine_Running",1.0},
            {"AltCtrlProt.Selected_Range",1.0},
            {"AltCtrlProt.Stall_Genr_Dsbl_Required",1.0},
            {"AltCtrlProt.Ctrl_Disabled_By_Diagnose",1.0},
            {"AltCtrlProt.ST_IgnorePPEIReq",1.0},
            {"AltCtrlProt.ST_Park2DriveDelay",1.0},
            {"AltCtrl.Trq_ResRequest",0.1},
            {"StartProt.factorTotal",0.01},
            {"StartProt.factorEnr",0.01},
            {"StartProt.factorCombFac",0.01},
            {"StartProt.factorHotSoak",0.0078125},
            {"StartProt.RestartFac",0.0009765625},
            {"StartProt.X_WCFFac",0.0009765625},
            {"StartProt.X_WCFTargetFac",0.0009765625},
            {"StartProt.n_engDiffWCF",1.0},
            {"StartProt.n_combWCF",1.0},
            {"StartProt.n_combWCFHold",1.0},
            {"StartProt.n_engStartWCF",1.0},
            {"StartProt.t_StartTime",1.0},
            {"StartProt.factorScaleFacRpm",0.0078125},
            {"StartProt.CombCnt",1.0},
            {"StartProt.t_BefStart",1.0},
            {"StartProt.m_FuelBasic",0.01},
            {"StartProt.N_combFacRamp",1.0},
            {"StartProt.X_combRampPart",1.0},
            {"StartProt.ST_combFacRamp",1.0},
            {"StartProt.ST_Started",1.0},
            {"StartProt.BeforeStartState",1.0},
            {"StartProt.factorHighAlt",0.0078125},
            {"StartProt.Cnt_CombAboveEngDiffWCF",1.0},
            {"StartProt.Cnt_CombAboveEngHiLimWCF",1.0},
            {"Start.m_FuelActual",0.01},
            {"Start.ST_WCFuel",1.0},
            {"GearAdap.ST_Automatic",1.0},
            {"GearAdap.ST_ACRequested",1.0},
            {"GearAdap.ST_ESP_TCS",1.0},
            {"GearAdap.ST_CIM",1.0},
            {"AC_Master.Trq_ResRequest",0.1},
            {"AC_Master.Trq_Request",0.1},
            {"AC_Master.ST_AC_Type",1.0},
            {"AC_Master.ST_EOL_AC_TYPE",1.0},
            {"WrittenTroubleLog",1.0},
            {"VIOS_ExceptionAddress",1.0},
            {"VIOS_ExceptionReason",1.0},
            {"VIOS_ResetType",1.0},
            {"DatFlowMonCal.Time",1.0},
            {"DatFlowMonCal.TabAns",1.0},
            {"DatFlowMonCal.TabSta",1.0},
            {"DatFlowMonCal.Tab2",1.0},
            {"DatFlowMonCal.MaxContErr",1.0},
            {"DatFlowMon.timer",1.0},
            {"DatFlowMon.contErrCount",1.0},
            {"DatFlowMon.main_inquiry",1.0},
            {"DatFlowMon.mcp_inquiry",1.0},
            {"DatFlowMon.ST_Error",1.0},
            {"DatFlowMon.Carry",1.0},
            {"DatFlowMon.State",1.0},
            {"DatFlowMon.Calc",1.0},
            {"DatFlowMon.Endresult",1.0},
            {"DatFlowMon.ST_ClearData",1.0},
            {"DatFlowMon.BackgroundCount",1.0},
            {"AC_ControlProt.U_RunCrank",0.1},
            {"AC_ControlProt.T_EngineCoolant",1.0},
            {"AC_ControlProt.T_AirInletAtPwrUp",1.0},
            {"AC_ControlProt.v_Vehicle",0.1},
            {"AC_ControlProt.ST_ProtectionLimitExceeded",1.0},
            {"AC_ControlProt.ST_ClutchEngage",1.0},
            {"AC_Control.n_EngineSpeed",1.0},
            {"AC_Control.p_AC_Pressure",1.0},
            {"AC_Control.Trq_Request",0.1},
            {"AC_Control.Trq_ResRequest",0.1},
            {"AC_Control.ST_AC_ClutchRequest",1.0},
            {"AC_Control.ST_AC_Clutch_State",1.0},
            {"AC_Control.ST_Action",1.0},
            {"AC_Control.ST_ActionReason",1.0},
            {"AC_Control.ST_Dev_Cntrl_AC",1.0},
            {"AC_Control.ST_Dev_Cntrl_AC_State",1.0},
            {"AC_Control.ST_Dev_Cntrl_AC_Lim_Excd",1.0},
            {"AC_Control.ST_AC_Req",1.0},
            {"StartCtrlCal.T_EngineSP",1.0},
            {"StartCtrlCal.K_Cnt_EngRevs",1.0},
            {"StartCtrlCal.K_EngThresh",1.0},
            {"StartCtrlCal.K_FuelPumpDelay",1.0},
            {"StartCtrlCal.K_MaxCrank",0.1},
            {"StartCtrlCal.K_MinCrank",1.0},
            {"StartCtrlCal.K_PwrModeDelay",1.0},
            {"StartCtrlCal.K_ShortLowEngRunTime",0.1},
            {"StartCtrlCal.K_Clutch_Apply_Delay",1.0},
            {"StartCtrlCal.ST_ClutchNeutralSwitch",1.0},
            {"AfterStCal.StartMAP",0.0009765625},
            {"AfterStCal.n_CombXSP",1.0},
            {"AfterStCal.T_EngineYSP",1.0},
            {"AfterStCal.AmbientMAP",0.0009765625},
            {"AfterStCal.p_AirAmbientYSP",0.1},
            {"AfterStCal.RestartAdjustMAP",0.78125},
            {"AfterStCal.HotSoakMAP",0.0078125},
            {"AfterStCal.HotSoakCylFacTAB",0.0009765625},
            {"AfterStCal.t_soakXSP",0.1},
            {"AfterStCal.T_EngineYSP2",1.0},
            {"AfterStCal.HotSoakAdjustMAP",0.78125},
            {"AfterStCal.n_CombXSP2",1.0},
            {"AfterStCal.n_HotSoakCombLim",1.0},
            {"AfterStCal.T_WCFSP",1.0},
            {"AfterStCal.n_WCFSP",1.0},
            {"AfterStCal.WCFMAP",0.0009765625},
            {"AfterStCal.n_delayWCFTAB",1.0},
            {"TCompCal.FuelFacMap1",0.0009765625},
            {"TCompCal.FuelFacMap2",0.0009765625},
            {"TCompCal.FuelFacMap3",0.0009765625},
            {"TCompCal.FuelFacMap4",0.0009765625},
            {"TCompCal.FuelFacMap5",0.0009765625},
            {"TCompCal.FuelFacMap6",0.0009765625},
            {"TCompCal.FuelFacMap7",0.0009765625},
            {"TCompCal.FuelFacMap8",0.0009765625},
            {"TCompCal.n_EngineSP",1.0},
            {"TCompCal.m_AirInletSP",1.0},
            {"TCompCal.T_EngineTab",1.0},
            {"TCompCal.ST_Enable",1.0},
            {"TAirCompCal.T_airUpStep",0.0078125},
            {"TAirCompCal.T_airDownStep",0.0078125},
            {"TAirCompCal.FuelFacTAB",0.0009765625},
            {"TAirCompCal.T_AirInletSP",1.0},
            {"IgnMastCal.t_minDwellTime",1.0},
            {"IgnMastCal.t_maxDwellTime",1.0},
            {"IgnMastCal.fi_minFCITAB",0.1},
            {"IgnMastCal.MinMap",0.1},
            {"IgnMastCal.n_EngYSP",1.0},
            {"IgnMastCal.m_AirXSP",1.0},
            {"IgnMastCal.fi_RampInc",0.001},
            {"IgnMastCal.fi_RampDec",0.001},
            {"IgnMastCal.fi_FuelCutRampInc",0.001},
            {"IgnMastCal.fi_FuelCutRampDec",0.001},
            {"IgnMastCal.fi_Max",0.1},
            {"IgnMastCal.dwellTimeMap",1.0},
            {"IgnMastCal.n_EngDwellTimeYSP",1.0},
            {"IgnMastCal.UBattDwellTimeXSP",0.1},
            {"IgnMastCal.n_EngStartLowLim",1.0},
            {"IgnMastCal.IdleActivationTimer",1.0},
            {"IgnMastCal.fi_MinCatDiag",0.1},
            {"IgnMastCal.fi_MinLightOff",0.1},
            {"IgnMastCal.ST_StartEnable",1.0},
            {"IgnMastCal.ST_IdleEnable",1.0},
            {"IgnMastCal.ST_NormalEnable",1.0},
            {"IgnMastCal.ST_allowTCMMinIgn",1.0},
            {"IgnMastCal.ST_allowCatDiagMinIgn",1.0},
            {"obdFuelLvlSensDiag.ST_OkStatus",1.0},
            {"obdFuelLvlSensDiag.ST_FaultCode",1.0},
            {"obdFuelLvlSensDiag.ST_sensor1OK",1.0},
            {"obdFuelLvlSensDiag.ST_StartConditionsActivityOK",1.0},
            {"obdFuelLvlSensDiag.ST_EnableActivity1",1.0},
            {"obdFuelDetermination.V_FuelTankFilt",0.1},
            {"obdFuelLvlSensDiagAWD.ST_PrelState",1.0},
            {"obdFuelLvlSensDiagAWD.ST_State",1.0},
            {"obdFuelLvlSensDiagAWD.ST_sensor2OK",1.0},
            {"obdFuelLvlSensDiagAWD.ST_StateInitialized",1.0},
            {"obdFuelLvlSensDiagAWD.ST_StateTransition",1.0},
            {"obdFuelLvlSensDiagAWD.ST_EnableActivity2",1.0},
            {"obdRefuelDetect.V_FuelTankAfterStop",0.1},
            {"obdRefuelDetect.ST_HasBeenInEngineRunning",1.0},
            {"obdRefuelDetect.ST_V_FuelTankAfterStopValid",1.0},
            {"obdFuelTransferPumpDiag.ST_OkStatus",1.0},
            {"obdFuelTransferPumpDiag.ST_FaultCode",1.0},
            {"obdFuelTransferPumpDiag.t_TransferErrorTimer",0.1},
            {"obdFuelTransferPumpDiag.t_TransferHealingTimer",0.1},
            {"obdFuelTransferPumpDiagState",1.0},
            {"FuelAdapCal.t_BOFFTime",0.1},
            {"FuelAdapCal.t_PurgeTime",0.1},
            {"FuelAdapCal.t_PurgeBoffTime",0.1},
            {"FuelAdapCal.t_PurgeBladTime",0.1},
            {"FuelAdapCal.t_AdaptTime",0.1},
            {"FuelAdapCal.t_purgeVentDelay",0.1},
            {"FuelAdapCal.t_AfterCloop",0.001},
            {"FuelAdapCal.UpdateSpeed",0.78125},
            {"FuelAdapCal.n_StableDeltaLim",1.0},
            {"FuelAdapCal.n_IdleAdapLimit",1.0},
            {"FuelAdapCal.n_HighSpeedAdapLimit",1.0},
            {"FuelAdapCal.m_StableDeltaLim",1.0},
            {"FuelAdapCal.t_FirstHighSpeedAdap",0.1},
            {"FuelAdapCal.t_InWindow",0.001},
            {"FuelAdapCal.LambdaIntErrorLim",0.01},
            {"FuelAdapCal.AdapMax",0.01},
            {"FuelAdapCal.AdapMin",0.01},
            {"FuelAdapCal.m_AirFuelXSP",1.0},
            {"FuelAdapCal.n_EngYSP",1.0},
            {"FuelAdapCal.T_AdaptLim",1.0},
            {"FuelAdapCal.X_lambdaBoffLim",0.01},
            {"FuelAdapCal.K_Balance",0.0078125},
            {"FuelAdapCal.maxGradient_X",0.0003125},
            {"FuelAdapCal.maxGradient_Y",0.0003125},
            {"obdpTank.ST_OkStatus",1.0},
            {"obdpTank.ST_FaultCode",1.0},
            {"obdpTank.p_FuelTankFilt",1.0},
            {"obdpTank.p_FuelTankDiff",1.0},
            {"obdpTank.p_MaxTank",1.0},
            {"obdpTank.p_MinTank",1.0},
            {"obdpTank.N_FlankShift",1.0},
            {"obdpTank.ST_preCondRatOK",1.0},
            {"obdpTankAdap.ST_OkStatus",1.0},
            {"obdpTankAdap.ST_FaultCode",1.0},
            {"obdpTankAdap.p_NewAdap",1.0},
            {"obdpTankAdap.ST_AdapDone",1.0},
            {"obdpTankAdap.ST_FirstTimeAfterPowerUp",1.0},
            {"FFRfuelProt.V_FuelConsPrevSamp",1.0},
            {"FFRfuelProt.V_FuelConsLastSamp",1.0},
            {"FFRfuelProt.V_Rfuel",0.1},
            {"FFRfuelProt.V_RfuelOld",0.1},
            {"FFRfuelProt.V_FuelConsumed",0.1},
            {"FFRfuelProt.dV_fuelvol_1s",0.1},
            {"FFRfuelProt.dV_fuelvol_2s",0.1},
            {"FFRfuelProt.dV_fuelvol_5s",0.1},
            {"FFRfuelProt.V_FuelTank",0.1},
            {"FFRfuelProt.V_FuelTankFilt",0.1},
            {"FFRfuelProt.V_ErrorTankBef",0.1},
            {"FFRfuelProt.V_ErrorTankAft",0.1},
            {"FFRfuel.ST_refuel",1.0},
            {"SAICal.t_runTime",0.1},
            {"SAICal.t_soakSP",0.1},
            {"SAICal.X_cycleCompletedSP",1.0},
            {"SAICal.X_soakAdjustMAP",1.0},
            {"SAICal.m_AirSP",1.0},
            {"SAICal.n_combSP",1.0},
            {"SAICal.n_EngineSP",1.0},
            {"SAICal.L_RequestManMAP",0.0001},
            {"SAICal.L_RequestAutMAP",0.0001},
            {"SAICal.T_EngineSP",1.0},
            {"SAICal.m_AirInletLimit",1.0},
            {"SAICal.N_ClosedLoopDelay",1.0},
            {"SAICal.T_MinAirInlet",1.0},
            {"SAICal.T_MaxAirInlet",1.0},
            {"SAICal.p_AltCompSP",0.1},
            {"SAICal.Q_AirActMAP",0.01},
            {"SAICal.m_AirInjReqMAP",1.0},
            {"SAICal.m_AirLimLeanClamp",1.0},
            {"SAICal.X_fuelRamp",0.0009765625},
            {"SAICal.C_fuelFilt",0.0009765625},
            {"SAICal.C_airFilt",0.0009765625},
            {"SAICal.ST_Testmode",1.0},
            {"ETCThrot.t_RtnStart",0.001},
            {"ETCThrot.c_MinStability",1.0},
            {"ETCThrot.c_MinLrnLowVolt",1.0},
            {"ETCThrot.c_MinLrnCrank",1.0},
            {"ETCThrot.c_MinLrnEnbld",1.0},
            {"ETCThrot.X_RawSensor1",0.1},
            {"ETCThrot.X_RawSensor2",0.1},
            {"ETCThrot.X_NormSensor1",0.1},
            {"ETCThrot.X_Disp1",0.1},
            {"ETCThrot.X_NormSensor2",0.1},
            {"ETCThrot.X_Disp2",0.1},
            {"ETCThrot.X_Min1Proposd",0.1},
            {"ETCThrot.X_Min1Pending",0.1},
            {"ETCThrot.X_Min2Proposd",0.1},
            {"ETCThrot.X_Min2Pending",0.1},
            {"ETCThrot.X_OOC_Thrsh",0.1},
            {"ETCThrot.X_Displacement",0.1},
            {"ETCThrot.c_OOR1_Fail",1.0},
            {"ETCThrot.c_OOR1_ContFail",1.0},
            {"ETCThrot.c_OOR1_Smpl",1.0},
            {"ETCThrot.c_OOR2_Fail",1.0},
            {"ETCThrot.c_OOR2_ContFail",1.0},
            {"ETCThrot.c_OOR2_Smpl",1.0},
            {"ETCThrot.c_OOC_Fail",1.0},
            {"ETCThrot.c_OOC_ContFail",1.0},
            {"ETCThrot.c_OOC_Smpl",1.0},
            {"ETCThrot.c_Rtn_Err",1.0},
            {"ETCThrot.c_Rtn_Ok",1.0},
            {"ETCThrot.ST_MinLrn1Enbld",1.0},
            {"ETCThrot.ST_MinLrn2Enbld",1.0},
            {"ETCThrot.ST_Min1PendState",1.0},
            {"ETCThrot.ST_Min2PendState",1.0},
            {"ETCThrot.ST_MinLrnCmpltMain",1.0},
            {"ETCThrot.ST_ValidRxMsgSinceInitPrev",1.0},
            {"ETCThrot.ST_LrnCmptIgnCycle",1.0},
            {"ETCThrot.ST_MinLrnCranking",1.0},
            {"ETCThrot.ST_MinLrn1Cmpt",1.0},
            {"ETCThrot.ST_MinLrn2Cmpt",1.0},
            {"ETCThrot.ST_MinLrnActive",1.0},
            {"ETCThrot.ST_AllowCorr",1.0},
            {"ETCThrot.ST_Min_Err1",1.0},
            {"ETCThrot.ST_Min_Err2",1.0},
            {"ETCThrot.ST_MinLrnFltTestCmpt",1.0},
            {"ETCThrot.ST_TimerAllowsMinLrn",1.0},
            {"ETCThrot.ST_IceBreakEnbldOnce",1.0},
            {"ETCThrot.ST_MinLrnValid_MCP",1.0},
            {"ETCThrot.ST_OOR1_Err",1.0},
            {"ETCThrot.ST_OOR1_Flt",1.0},
            {"ETCThrot.ST_OOR1_FltLo",1.0},
            {"ETCThrot.ST_OOR1_FltHi",1.0},
            {"ETCThrot.ST_OOR2_Err",1.0},
            {"ETCThrot.ST_OOR2_Flt",1.0},
            {"ETCThrot.ST_OOR2_FltLo",1.0},
            {"ETCThrot.ST_OOR2_FltHi",1.0},
            {"ETCThrot.ST_OOC_Err",1.0},
            {"ETCThrot.ST_OOC_Flt",1.0},
            {"ETCThrot.ST_OOC_Flt_MainOrMCP",1.0},
            {"ETCThrot.ST_OOR1_Or_V5B_Err",1.0},
            {"ETCThrot.ST_OOR2_Or_V5B_Err",1.0},
            {"ETCThrot.ST_OOR1_Flt_MainOrMCP",1.0},
            {"ETCThrot.ST_OOR2_Flt_MainOrMCP",1.0},
            {"ETCThrot.ST_OOR1_Flt_Composit",1.0},
            {"ETCThrot.ST_OOR2_Flt_Composit",1.0},
            {"ETCThrot.ST_Defaulted",1.0},
            {"ETCThrot.ST_Pstn_1_Failed",1.0},
            {"ETCThrot.ST_RtnFlt",1.0},
            {"ETCThrot.ST_RtnTestCmpt",1.0},
            {"obdEvap.t_Ramp1_Level1",0.1},
            {"obdEvap.t_Ramp1_Level2",0.1},
            {"obdEvap.t_Ramp1_Level3",0.1},
            {"obdEvap.t_ColdStart",0.1},
            {"obdEvap.t_ColdStartExt",0.1},
            {"obdEvap.LeakageFactor",1.0},
            {"obdEvap.BigLeakageFactor",1.0},
            {"obdEvap.v_VehicleSpeedPrecondition",0.1},
            {"obdEvap.HCContPrecondition",0.01},
            {"obdEvap.PurgePrecondition",0.01},
            {"obdEvap.LambdaPrecondition",0.01},
            {"obdEvap.Ramp0",0.1},
            {"obdEvap.TotTabRamp2",0.1},
            {"obdEvap.DiffR2Result",0.1},
            {"obdEvap.p_AirAmbientDelta",0.1},
            {"obdEvap.p_AirAmbStack",0.1},
            {"obdEvap.m_DeltaMax",1.0},
            {"obdEvap.LambdaMaxNegDiff",0.01},
            {"obdEvap.HCContDiff",0.01},
            {"obdEvap.v_DiffPosMax",0.1},
            {"obdEvap.v_DiffNegMax",0.1},
            {"obdEvap.p_FuelTankFilt",1.0},
            {"obdEvap.p_PreviousPressure",1.0},
            {"obdEvap.p_MaxPosRamp0",1.0},
            {"obdEvap.p_MaxNegRamp0",1.0},
            {"obdEvap.p_MaxPosRamp1",1.0},
            {"obdEvap.p_MaxNegRamp1",1.0},
            {"obdEvap.p_MaxPosRamp2",1.0},
            {"obdEvap.p_MaxNegRamp2",1.0},
            {"obdEvap.p_SwitchPoint",1.0},
            {"obdEvap.ST_OkStatus",1.0},
            {"obdEvap.ST_FaultCode",1.0},
            {"obdEvap.LeakageResult",1.0},
            {"obdEvap.ST_FilterIgnoredByColdStart",1.0},
            {"obdEvap.DiagState",1.0},
            {"obdEvap.ActiveTest",1.0},
            {"obdEvap.BreakPreCondition",1.0},
            {"obdEvap.EvapPreBreakTemp",1.0},
            {"obdEvap.BreakCondDurTest",1.0},
            {"obdEvap.n_BrakeChanges",1.0},
            {"obdEvap.N_VapourTest1",1.0},
            {"obdEvap.N_VapourTest2",1.0},
            {"obdEvap.n_BigLeakErrorCnt",1.0},
            {"obdEvap.ST_ColdStart",1.0},
            {"obdEvap.ST_ColdStartExt",1.0},
            {"obdEvap.ST_CCVMayBeStuck",1.0},
            {"obdEvap.ST_ValveLockedByDiagnose",1.0},
            {"obdEvap.ST_NeedForSpeed",1.0},
            {"obdEvap.ST_IsRunning",1.0},
            {"obdEvap.ST_RequestElevatedIdle",1.0},
            {"obdEvap.ST_ProductionTest",1.0},
            {"obdEvap.ST_WorkshopTest",1.0},
            {"obdEvap.ST_DiagPrevRestOfDrvCycle",1.0},
            {"obdCCV.ST_OkStatus",1.0},
            {"obdCCV.ST_FaultCode",1.0},
            {"obdCCV.t_Error",0.1},
            {"obdCCV.p_RefLim",1.0},
            {"obdCCV.ST_DiagDone",1.0},
            {"obdCCV.N_CleanCounter",1.0},
            {"obdCCV.ST_PurgeClosedByDiagnose",1.0},
            {"obdCCV.ST_ActiveRationality",1.0},
            {"obdPurge.ST_OkStatus",1.0},
            {"obdPurge.ST_FaultCode",1.0},
            {"obdPurge.Ramp0",0.1},
            {"obdPurge.BreakPreCondition",1.0},
            {"obdPurge.ST_ActiveDiag",1.0},
            {"obdPurge.ST_DiagDone",1.0},
            {"obdPurge.ST_NeedForSpeed",1.0},
            {"ElCompProt.P_RequestFan",0.1},
            {"ElCompProt.P_RequestBatt",0.1},
            {"ElCompProt.Trq_RequestBatt",0.1},
            {"ElCompProt.Trq_RequestFan",0.1},
            {"ElCompProt.Trq_RequestAlt",0.1},
            {"ElCompProt.PWM_FTermFilt",0.1},
            {"ElCompProt.U_BattDiff",0.1},
            {"ElComp.Trq_Request",0.1},
            {"AirMassMastCal.n_EngMBTYSP",1.0},
            {"AirMassMastCal.Trq_MBTXSP",0.1},
            {"AirMassMastCal.m_AirMBTMAP",1.0},
            {"AirMassMastCal.t_RemStartAirDecrDelay",1.0},
            {"AirMassMastCal.ST_testMBT",1.0},
            {"Misf.t_DetectLevel",1.0},
            {"Misf.n_TransFilter",1.0},
            {"Misf.n_LoadFilter",1.0},
            {"Misf.N_TotalMisfire",1.0},
            {"Misf.N_FTPCountedMisfire",1.0},
            {"Misf.N_CATCountedMisfire",1.0},
            {"Misf.N_FilteredMisfire",1.0},
            {"Misf.N_ConsecutiveMisfire",1.0},
            {"Misf.N_RpmDiffFiltMisfire",1.0},
            {"Misf.N_FTPBlockTotMisfire",1.0},
            {"Misf.N_CATBlockTotMisfire",1.0},
            {"Misf.N_MisfireDiag",1.0},
            {"Misf.N_RpmDiffDiag",1.0},
            {"Misf.N_MisfCountCyl1",1.0},
            {"Misf.N_MisfCountCyl2",1.0},
            {"Misf.N_MisfCountCyl3",1.0},
            {"Misf.N_MisfCountCyl4",1.0},
            {"Misf.n_FTPBlockComb",1.0},
            {"Misf.n_CATBlockComb",1.0},
            {"Misf.n_CombFilterActual",1.0},
            {"Misf.n_ZeroDetectComb",1.0},
            {"Misf.n_NonZeroDetectComb",1.0},
            {"Misf.pct_WindowSignalRem",0.1},
            {"Misf.N_MisfSysActFcut",1.0},
            {"Misf.N_TestSglCylCombs",1.0},
            {"Misf.X_NormCombDetLevel",0.0009765625},
            {"Misf.ST_FilterActive",1.0},
            {"Misf.ST_FilterAllowed",1.0},
            {"Misf.ST_FTPActive",1.0},
            {"Misf.ST_MisfireStarted",1.0},
            {"Misf.ST_SystemAction",1.0},
            {"Misf.ST_HotFuelStart",1.0},
            {"Misf.N_FCutSysActions",1.0},
            {"Misf.ST_SglCylFuelCut",1.0},
            {"Misf.activeCylSglCylFCut",1.0},
            {"Misf.ST_SysActionSglCyl",1.0},
            {"MisfFTP.N_Cyl1",1.0},
            {"MisfFTP.N_Cyl2",1.0},
            {"MisfFTP.N_Cyl3",1.0},
            {"MisfFTP.N_Cyl4",1.0},
            {"MisfFTP.ST_Ready",1.0},
            {"MisfCAT.N_Cyl1",1.0},
            {"MisfCAT.N_Cyl2",1.0},
            {"MisfCAT.N_Cyl3",1.0},
            {"MisfCAT.N_Cyl4",1.0},
            {"MisfCAT.ST_Ready",1.0},
            {"MisfFTP2.N_Cyl1",1.0},
            {"MisfFTP2.N_Cyl2",1.0},
            {"MisfFTP2.N_Cyl3",1.0},
            {"MisfFTP2.N_Cyl4",1.0},
            {"MisfFTP2.ST_Ready",1.0},
            {"MisfCAT2.N_Cyl1",1.0},
            {"MisfCAT2.N_Cyl2",1.0},
            {"MisfCAT2.N_Cyl3",1.0},
            {"MisfCAT2.N_Cyl4",1.0},
            {"MisfCAT2.ST_Ready",1.0},
            {"CombDet.n_CombDetFault",1.0},
            {"CombDet.ST_vTooHighAtStart",1.0},
            {"CombDet.ST_CombDetFault",1.0},
            {"CombDet.ST_DiagnosArea",1.0},
            {"MisfProt.t_DelayTimer",1.0},
            {"MisfProt.X_OverheatAdditive",1.0},
            {"MisfProt.N_CATBlockNonWeightTotMisfire",1.0},
            {"MisfProt.t_MaxCycleVariation",1.0},
            {"MisfProt.m_LoadLevel",1.0},
            {"MisfProt.n_CombFilter",1.0},
            {"MisfProt.n_CombFromStart",1.0},
            {"MisfProt.Trq_FilterValue",0.1},
            {"MisfProt.t_CombDetFilt1Lev",1.0},
            {"MisfProt.ST_WasTooCold",1.0},
            {"MisfProt.ST_DelayStatus",1.0},
            {"MisfProt.ST_t_TDC_TDC_Delta_Low",1.0},
            {"MisfProt.ST_MisfDetectLevelZero",1.0},
            {"MisfProt.ST_IdleFiltCondition",1.0},
            {"MisfProt.ST_FCutOnThisCyl",1.0},
            {"JerkCal.T_AirInletTab",1.0},
            {"JerkCal.T_AirInletSP",1.0},
            {"JerkCal.p_AirAmbientTab",0.0078125},
            {"JerkCal.p_AirAmbientSP",0.1},
            {"JerkCal.n_EngineTab",0.0078125},
            {"JerkCal.n_EngineSP",1.0},
            {"JerkCal.t_JerkAbove",1.0},
            {"JerkCal.t_JerkBelow",1.0},
            {"JerkCal.CruiseFactor",0.78125},
            {"JerkCal.JerkFilter",1.0},
            {"JerkCal.X_JerkTempRed",0.78125},
            {"JerkCal.X_OffSteadyThr",0.0078125},
            {"JerkCal.X_AccPosLim",0.1},
            {"JerkCal.X_AccPosDiff",0.1},
            {"JerkCal.X_AccPos5Diff",0.1},
            {"JerkCal.X_AccPos4Diff",0.1},
            {"JerkCal.X_AccPos3Diff",0.1},
            {"JerkCal.X_3GearFac",0.0078125},
            {"JerkCal.X_4GearFac",0.0078125},
            {"JerkCal.T_AirInletMin",1.0},
            {"REPCal.T_AirInletSP",1.0},
            {"REPCal.T_AirInletTab",0.1},
            {"REPCal.p_AirAmbientHyst",0.1},
            {"REPCal.P_EngineMinLimit",0.1},
            {"REPCal.P_EngineHyst",0.1},
            {"REPCal.t_InhibitMin",1.0},
            {"REPCal.ST_GearShiftInhibit",1.0},
            {"WUSPCal.MaxTemp",1.0},
            {"WUSPCal.MinTemp",1.0},
            {"WUSPCal.Time",0.001},
            {"MapChk.CheckSum",1.0},
            {"MapChk.ST_Error",1.0},
            {"ETCLimpCal.P_LowLim",0.1},
            {"ETCLimpCal.m_EmptyVehicle",1.0},
            {"ETCLimpCal.a_MaxLimit",0.01},
            {"obdCore.t_RunTime",0.1},
            {"obdCore.InfoFaultManager",1.0},
            {"obdCore.T_EngineStart",1.0},
            {"obdCore.T_AirInletStart",1.0},
            {"obdCore.T_AirAmbientStart",1.0},
            {"obdCore.T_DrvCondCurrTemp",1.0},
            {"obdCore.T_DrvCondFaultTemp",1.0},
            {"obdCore.v_DrvCondFaultVeh",0.1},
            {"obdCore.v_DrvCondCurrVeh",0.1},
            {"obdCore.ST_FaultIndication",1.0},
            {"obdCore.n_DrvCondCurrRpm",1.0},
            {"obdCore.n_DrvCondFaultRpm",1.0},
            {"obdCore.m_DrvCondCurrLoad",0.01},
            {"obdCore.m_DrvCondFaultLoad",0.01},
            {"obdCore.faultCodeFaultManager",1.0},
            {"obdCore.ST_ActiveState",1.0},
            {"obdCore.ST_ActiveDiagSystem",1.0},
            {"obdCore.ST_SameDriveCond",1.0},
            {"obdCore.ST_MilFunc",1.0},
            {"obdCore.ST_SVSFunc",1.0},
            {"obdCore.ST_DiagPriority",1.0},
            {"obdCore.ST_InfoForTest",1.0},
            {"obdCore.ST_IndicatorCntTest",1.0},
            {"obdCore.ST_WarmupCycleCntTest",1.0},
            {"obdCore.ST_EightyCntTest",1.0},
            {"obdCore.n_TotFaults",1.0},
            {"obdCore.n_WarmUpCycle",1.0},
            {"obdCore.n_CurrIndicator",1.0},
            {"obdCore.n_AllIndicator",1.0},
            {"obdCore.RunCycleFaultManager",1.0},
            {"obdCore.diagNumFaultManager",1.0},
            {"obdCore.ExternalFaultManager",1.0},
            {"obdCore.ST_WarmUpCycleDone",1.0},
            {"obdCore.ST_OutOfLimitsAltitude",1.0},
            {"obdCore.ST_OutOfLimitsTemp",1.0},
            {"obdCore.ST_OutOfLimitsBattery",1.0},
            {"obdCore.ST_FirstDCYAfterPowerUp",1.0},
            {"obdCore.ST_TooBigAirAmbTol",1.0},
            {"OilLevelCal.t_EvaluationStartTime",0.1},
            {"OilLevelCal.n_EngineSpeedHigh",1.0},
            {"OilLevelCal.n_EngineSpeedLow",1.0},
            {"OilLevelCal.v_VehicleFirstTime",0.1},
            {"OilLevelCal.v_VehicleCityTrafficHigh",0.1},
            {"OilLevelCal.v_VehicleCountryRoadHigh",0.1},
            {"OilLevelCal.v_VehicleAutobahnHigh",0.1},
            {"OilLevelCal.v_VehicleCityTrafficLow",0.1},
            {"OilLevelCal.v_VehicleCountryRoadLow",0.1},
            {"OilLevelCal.v_VehicleAutobahnLow",0.1},
            {"OilLevelCal.a_AccelerationMax",0.001},
            {"OilLevelCal.a_DecelerationMax",0.001},
            {"OilLevelCal.M_EngineTorqueMax",1.0},
            {"OilLevelCal.M_EngineTorqueMin",1.0},
            {"OilLevelCal.t_DebounceTimerThrshCityTraffic",0.1},
            {"OilLevelCal.t_DebounceTimerThrshCountryRoad",0.1},
            {"OilLevelCal.t_DebounceTimerThrshAutobahn",0.1},
            {"OilLevelCal.t_DurationTimerThrshCityTraffic",0.1},
            {"OilLevelCal.t_DurationTimerThrshCountryRoad",0.1},
            {"OilLevelCal.t_DurationTimerThrshAutobahn",0.1},
            {"OilLevelCal.t_StaticEvalTime",1.0},
            {"OilLevelCal.T_OilTempLowLim",1.0},
            {"OilLevelCal.ST_OilLevelEvaluationMode",1.0},
            {"OilLevelCal.X_EventCounterThrshCityTraffic",1.0},
            {"OilLevelCal.X_EventCounterThrshCountryRoad",1.0},
            {"OilLevelCal.X_EventCounterThrshAutobahn",1.0},
            {"CrsCntrlCal.n_EngMin",1.0},
            {"CrsCntrlCal.n_EngMax",1.0},
            {"CrsCntrlCal.v_Max",0.1},
            {"CrsCntrlCal.v_Min",0.1},
            {"CrsCntrlCal.v_TapStep",0.1},
            {"CrsCntrlCal.v_AccReqSP",0.1},
            {"CrsCntrlCal.v_ResumeSP",0.1},
            {"CrsCntrlCal.v_SetSP",0.1},
            {"CrsCntrlCal.v_DecSP",0.1},
            {"CrsCntrlCal.v_DiffFCutLim",0.1},
            {"CrsCntrlCal.v_NegOffsUSD",0.1},
            {"CrsCntrlCal.v_PosOffsUSD",0.1},
            {"CrsCntrlCal.t_TapLim",1.0},
            {"CrsCntrlCal.t_Reset",1.0},
            {"CrsCntrlCal.t_FCut",1.0},
            {"CrsCntrlCal.t_ESPTCSDebounce",1.0},
            {"CrsCntrlCal.t_KeepTip",1.0},
            {"CrsCntrlCal.t_CANDelay",0.1},
            {"CrsCntrlCal.m_CarWeight",1.0},
            {"CrsCntrlCal.F_TapResponse",1.0},
            {"CrsCntrlCal.F_FrictionSP",1.0},
            {"CrsCntrlCal.F_FrictionTAB",1.0},
            {"CrsCntrlCal.F_2CnstSpdPosRmp",1.0},
            {"CrsCntrlCal.Trq_LimReset",0.1},
            {"CrsCntrlCal.Trq_MinReset",0.1},
            {"CrsCntrlCal.Trq_GainRdcLim",0.1},
            {"CrsCntrlCal.Trq_FCutOffset",0.1},
            {"CrsCntrlCal.Trq_FCutRmp",0.1},
            {"CrsCntrlCal.a_DiffGainLim",0.01},
            {"CrsCntrlCal.a_DiffFCutLim",0.01},
            {"CrsCntrlCal.a_DecThreshold",0.01},
            {"CrsCntrlCal.a_AccReqTAB",0.01},
            {"CrsCntrlCal.a_ResumeTAB",0.01},
            {"CrsCntrlCal.a_SetTAB",0.01},
            {"CrsCntrlCal.a_DecTAB",0.01},
            {"CrsCntrlCal.X_EfficiencyMan",0.78125},
            {"CrsCntrlCal.X_EfficiencySP",0.78125},
            {"CrsCntrlCal.X_EfficiencyTAB",0.78125},
            {"CrsCntrlCal.X_Cruising",0.0001},
            {"CrsCntrlCal.X_SetResDec",0.0001},
            {"CrsCntrlCal.X_ExtraGain",0.0001},
            {"CrsCntrlCal.X_ExtraGainCruising",0.0001},
            {"CrsCntrlCal.f_InitConstSpd",1.0},
            {"CrsCntrlCal.f_vFilter",1.0},
            {"CrsCntrlCal.f_SR",1.0},
            {"CrsCntrlCal.f_Force",1.0},
            {"CrsCntrlCal.F_InitConstLim",1.0},
            {"CrsCntrlCal.X_Overshot",1.0},
            {"CrsCntrlCal.t_Roadload",1.0},
            {"CrsCntrlCal.t_BrakeTest",1.0},
            {"CrsCntrlCal.ST_EnableRCFault",1.0},
            {"CrsCntrlCal.X_GainLwTrqRed",0.0078125},
            {"CrsCntrlCal.ST_LwSpdDropOut",1.0},
            {"CrsCntrlCal.X_DeltaAcc1",1.0},
            {"CrsCntrlCal.X_DeltaAcc2",1.0},
            {"CrsCntrlCal.X_DeltaAcc3",1.0},
            {"CrsCntrlCal.ST_UseSwProtFault",1.0},
            {"CrsCntrlCal.NumberOfErrors",1.0},
            {"CrsCntrlCal.ST_AutTrqReset",1.0},
            {"EngTipLimProt.t_HoldGearSevenTimer",1.0},
            {"EngTipLimProt.Trq_Delay",0.1},
            {"EngTipLimProt.Trq_Sum",0.1},
            {"EngTipLimProt.n_Diff",1.0},
            {"EngTipLimProt.n_DiffDelta",1.0},
            {"EngTipLimProt.n_EngFilt",1.0},
            {"EngTipLimProt.n_TrnTrbAngVl",1.0},
            {"EngTipLimProt.ST_FreeWheel",1.0},
            {"EngTipLimProt.ST_Gear",1.0},
            {"EngTipLimProt.N_Pointer",1.0},
            {"EngTipLim.Trq_TipInLimit",0.1},
            {"EngTipLim.ST_Active",1.0},
            {"ETCMisc.t_RtnStart",0.001},
            {"ETCMisc.t_MainLrnCorrupStart",1.0},
            {"ETCMisc.t_BatterySaverTmrStart",1.0},
            {"ETCMisc.c_ThrotActAirflow_Fail",1.0},
            {"ETCMisc.c_ThrotActAirflow_Smpl",1.0},
            {"ETCMisc.c_ThrotAct_Fail",1.0},
            {"ETCMisc.c_ThrotAct_Smpl",1.0},
            {"ETCMisc.X_BowdenLim",0.1},
            {"ETCMisc.X_ThrotDispFilt",0.1},
            {"ETCMisc.U_IgnToMCP",0.1},
            {"ETCMisc.ST_MainLrnCorrupFlt",1.0},
            {"ETCMisc.ST_BatterySaver",1.0},
            {"ETCMisc.ST_ThrotActAirflowFlt",1.0},
            {"ETCMisc.ST_ThrotActFlt",1.0},
            {"ETCMisc.ST_MainROMChksumFlt",1.0},
            {"ETCMisc.ST_MainAirChksumFlt",1.0},
            {"ETCMisc.ST_MainStackFlt",1.0},
            {"ETCMisc.ST_MAP_OOR_Flt",1.0},
            {"ETCMisc.ST_MAF_OOR_Flt",1.0},
            {"MCPSOH.c_MCPSOHFail",1.0},
            {"MCPSOH.ST_MCP_SOH_Flt",1.0},
            {"ad_aVehicle",1.0},
            {"BFuelProt.m_AirLimitMap",1.0},
            {"BFuelProt.t_JerkDelayMap",0.1},
            {"BFuelProt.TempEnrichFac2",1.0},
            {"BFuelProt.LambdaOneFac",0.0078125},
            {"BFuelProt.DelayedTempEnrichFac",0.0078125},
            {"BFuelProt.TempEnrichFacMAT",1.0},
            {"BFuelProt.FCIMinLoadFuelFacMAT",0.0078125},
            {"BFuelProt.JerkEnrTab",1.0},
            {"BFuelProt.ExhEnrMode",1.0},
            {"BFuelProt.ST_RampToMaxFCIEnrich",1.0},
            {"BFuel.b_jerkActive",1.0},
            {"BFuel.FuelFac",0.0078125},
            {"BFuel.TempOrJerkFac",0.0078125},
            {"BFuel.TempEnrichFac",0.0078125},
            {"BFuel.ST_HoldOrRampTempFac",1.0},
            {"BFuel.JerkEnrichFac",0.0078125},
            {"NVDMHasBeenErased",1.0},
            {"NVDMCopy.ST_ECM_ROM_Flt",1.0},
            {"NVDMCopy.l_ECM_ROM_Flt_odo",1.0},
            {"NVDMCopy.ST_ECM_CPU_COM_Flt",1.0},
            {"NVDMCopy.l_ECM_CPU_COM_odo",1.0},
            {"NVDMCopy.ST_ECM_Internal_Flt",1.0},
            {"NVDMCopy.l_ECM_Internal_Flt_odo",1.0},
            {"NVDMCopy.faultcode",1.0},
            {"NVDMCopy.faultcode_odo",1.0},
            {"NVDMCopy.N_SecurityCodeReset",1.0},
            {"NVDMCopy.BusOffCounter",1.0},
            {"NVDMCopy.LocalOverrunCounter",1.0},
            {"ETCThrotAdp.c_OOR1_MinSmpl",1.0},
            {"ETCThrotAdp.c_OOR1_MaxFail",1.0},
            {"ETCThrotAdp.c_OOR2_MinSmpl",1.0},
            {"ETCThrotAdp.c_OOR2_MaxFail",1.0},
            {"ETCThrotAdp.X_CorrDiffMax",0.1},
            {"ETCThrotAdp.X_MinCorrDiffMax",0.1},
            {"ETCThrotAdp.c_OOC_MinSmpl",1.0},
            {"ETCThrotAdp.c_OOC_MaxFail",1.0},
            {"ETCThrotAdp.X_NormMin1Min",0.1},
            {"ETCThrotAdp.X_NormMin1Max",0.1},
            {"ETCThrotAdp.X_NormMin2Min",0.1},
            {"ETCThrotAdp.X_NormMin2Max",0.1},
            {"ETCThrotAdp.c_MinLrnCompletions",1.0},
            {"ETCThrotAdp.c_MinLrnAttempts",1.0},
            {"ETCThrotAdp.X_NormMin2",0.1},
            {"ETCThrotAdp.X_NormMin1",0.1},
            {"ETCThrotAdp.X_NormMin1Neg",1.0},
            {"ETCThrotAdp.X_NormMin2Neg",1.0},
            {"ETCThrotAdp.ST_Min1Updated",1.0},
            {"ETCThrotAdp.ST_Min2Updated",1.0},
            {"obdDigIDM.ST_OkStatus",1.0},
            {"obdDigIDM.ST_FaultCode",1.0},
            {"obdIDM.ST_OkStatus",1.0},
            {"obdIDM.ST_FaultCode",1.0},
            {"LightOffProt.CombSinceLast",1.0},
            {"LightOffProt.n_CombOld",1.0},
            {"LightOffProt.Trq_ResRequest",0.1},
            {"LightOffProt.RampStep",0.1},
            {"LightOffProt.n_CombAfterStartConstRpm",1.0},
            {"LightOffProt.n_EngDecrStep",1.0},
            {"LightOffProt.n_EngDecrSmallStep",0.1},
            {"LightOffProt.n_EngineNeutral",1.0},
            {"LightOffProt.n_EngineDrive",1.0},
            {"LightOffProt.n_Engine",1.0},
            {"LightOffProt.DriveDelay",1.0},
            {"LightOffProt.ST_DriveActive",1.0},
            {"LightOffProt.ST_FirstTime",1.0},
            {"LightOffProt.rampStepSet",1.0},
            {"LightOff.Trq_ResRequest",0.1},
            {"LightOff.Trq_TargetReserve",0.1},
            {"LightOff.n_CombWithLO",1.0},
            {"LightOff.n_EngineGoal",1.0},
            {"LightOff.n_Engine",1.0},
            {"LightOff.ST_RpmMode",1.0},
            {"LightOff.ST_Active",1.0},
            {"LightOff.ST_Enabled",1.0},
            {"ETCPdl.t_ReleaseTime",1.0},
            {"ETCPdl.X_RawSensor1",0.1},
            {"ETCPdl.X_RawSensor2",0.1},
            {"ETCPdl.X_NormSensor1",0.1},
            {"ETCPdl.X_NormSensor2",0.1},
            {"ETCPdl.c_OOR1_Fail",1.0},
            {"ETCPdl.c_OOR1_ContFail",1.0},
            {"ETCPdl.c_OOR1_Smpl",1.0},
            {"ETCPdl.c_OOR2_Fail",1.0},
            {"ETCPdl.c_OOR2_ContFail",1.0},
            {"ETCPdl.c_OOR2_Smpl",1.0},
            {"ETCPdl.X_OOC_Thrsh",0.1},
            {"ETCPdl.c_OOC_Fail",1.0},
            {"ETCPdl.c_OOC_ContFail",1.0},
            {"ETCPdl.c_OOC_Smpl",1.0},
            {"ETCPdl.X_Disp1",0.1},
            {"ETCPdl.X_NormMin1",0.1},
            {"ETCPdl.X_NormMin2",0.1},
            {"ETCPdl.X_Disp2",0.1},
            {"ETCPdl.c_MinStability",1.0},
            {"ETCPdl.X_PropNormMin1",0.1},
            {"ETCPdl.X_PropNormMin2",0.1},
            {"ETCPdl.X_NormMin1Neg",1.0},
            {"ETCPdl.X_NormMin2Neg",1.0},
            {"ETCPdl.X_Disp12",0.1},
            {"ETCPdl.X_Displacement",0.1},
            {"ETCPdl.X_IndAccPos",0.1},
            {"ETCPdl.X_Disp_wo_Min",0.1},
            {"ETCPdl.X_Disp_w_Hys",0.1},
            {"ETCPdl.X_DispHyst",0.1},
            {"ETCPdl.X_DispDevLim",0.1},
            {"ETCPdl.ST_OOR1_Err",1.0},
            {"ETCPdl.ST_OOR1_Flt",1.0},
            {"ETCPdl.ST_OOR1_FltLo",1.0},
            {"ETCPdl.ST_OOR1_FltHi",1.0},
            {"ETCPdl.ST_OOR2_Err",1.0},
            {"ETCPdl.ST_OOR2_Flt",1.0},
            {"ETCPdl.ST_OOR2_FltLo",1.0},
            {"ETCPdl.ST_OOR2_FltHi",1.0},
            {"ETCPdl.ST_OOC_Err",1.0},
            {"ETCPdl.ST_OOC_Flt",1.0},
            {"ETCPdl.ST_OOC_Flt_MainOrMCP",1.0},
            {"ETCPdl.ST_OOR1_Or_V5B_Err",1.0},
            {"ETCPdl.ST_OOR2_Or_V5B_Err",1.0},
            {"ETCPdl.ST_OOR1_Flt_MainOrMCP",1.0},
            {"ETCPdl.ST_OOR2_Flt_MainOrMCP",1.0},
            {"ETCPdl.ST_OOR1_Flt_Composit",1.0},
            {"ETCPdl.ST_OOR2_Flt_Composit",1.0},
            {"ETCPdl.ST_MainLearned",1.0},
            {"ETCPdl.ST_MinLrnEnbld",1.0},
            {"ETCPdl.ST_MinFirstLrnCmpt",1.0},
            {"ETCPdl.ST_MinBumpUpEnbld",1.0},
            {"ETCPdl.ST_BumpUpDone",1.0},
            {"ETCPdl.ST_Min_Err1",1.0},
            {"ETCPdl.ST_Min_Err2",1.0},
            {"ETCPdl.ST_PstnDfltd",1.0},
            {"ETCPdl.ST_KickDownReq",1.0},
            {"ETCPdl.ST_Released",1.0},
            {"ETCPdl.ST_FirstMinAdpByCopy",1.0},
            {"ThrotPosAdp.ST_CntrlMechPstnMax",1.0},
            {"ThrotPosAdp.ST_CntrlMechPstnMin",1.0},
            {"Length",1.0},
            {"VIOSAdap.p_AirInlet",0.1},
            {"VIOSAdap.p_AirBefThrottle",0.1},
            {"VIOSAdap.p_SAI",0.1},
            {"VIOSAdap.p_FuelTank",1.0},
            {"FFFDynProt.X_bias",0.0078125},
            {"FFFDynProt.X_biasBefComp",0.0078125},
            {"FFFDynProt.X_biasWU",0.0078125},
            {"FFFDynProt.X_biasWUBefComp",0.0078125},
            {"FFFDynProt.X_biasWUScale",0.0078125},
            {"FFFDynProt.X_biasWUScaleBefComp",0.0078125},
            {"FFFDynProt.X_negFuelLim",0.00392156862745},
            {"FFFDynProt.X_negFuelLimBefComp",0.00392156862745},
            {"FFFDynProt.betaTAB",0.00392156862745},
            {"FFFDynProt.betaBefComp",0.00392156862745},
            {"FFFDynProt.beta",0.00392156862745},
            {"FFFDynProt.alphaTAB",0.00392156862745},
            {"FFFDynProt.alphaBefComp",0.00392156862745},
            {"FFFDynProt.alpha",0.00392156862745},
            {"FFFDynProt.alphaSlowBefComp",0.00392156862745},
            {"FFFDynProt.alphaSlow",0.00392156862745},
            {"FFFDynProt.betaSlowBefComp",0.00392156862745},
            {"FFFDynProt.betaSlow",0.00392156862745},
            {"FFFDynProt.X_negStartBefComp",0.00392156862745},
            {"FFFDynProt.X_NegStartFuel",0.00392156862745},
            {"O2SHeat.m_exhaust",1.0},
            {"O2SHeat.ST_RearHeaterNormalState",1.0},
            {"O2SHeatFrontProt.t_InitRampEnd",1.0},
            {"O2SHeatFrontProt.t_InitHeatEnd",1.0},
            {"O2SHeatFrontProt.m_dewpointHeatEnd",1.0},
            {"O2SHeatFrontProt.t_AfterDewEnd",1.0},
            {"O2SHeatFrontProt.U_HeaterVoltage",0.1},
            {"O2SHeatFrontProt.U_OldFiltVoltageUpScale",0.00078125},
            {"O2SHeatFrontProt.U_OldVoltageUpScale",0.00078125},
            {"O2SHeatFrontProt.U_UnfiltVoltage",0.1},
            {"O2SHeatFrontProt.U_HeaterVoltageUpScale",0.00078125},
            {"O2SHeatFrontProt.ST_State",1.0},
            {"O2SHeatFrontProt.PWM_Heater",1.0},
            {"O2SHeatRearProt.t_InitRampEnd",1.0},
            {"O2SHeatRearProt.t_InitHeatEnd",1.0},
            {"O2SHeatRearProt.m_dewpointHeatEnd",1.0},
            {"O2SHeatRearProt.t_AfterDewEnd",1.0},
            {"O2SHeatRearProt.U_HeaterVoltage",0.1},
            {"O2SHeatRearProt.U_OldFiltVoltageUpScale",0.00078125},
            {"O2SHeatRearProt.U_OldVoltageUpScale",0.00078125},
            {"O2SHeatRearProt.U_UnfiltVoltage",0.1},
            {"O2SHeatRearProt.U_HeaterVoltageUpScale",0.00078125},
            {"O2SHeatRearProt.ST_State",1.0},
            {"O2SHeatRearProt.PWM_Heater",1.0},
            {"AC_ControlCal.K_AC_OffTempHi",1.0},
            {"AC_ControlCal.K_AC_OffTempLo",1.0},
            {"AC_ControlCal.K_CompressorHiSpdDsblTme",0.1},
            {"AC_ControlCal.K_CompressorLoSpdDsblTme",0.1},
            {"AC_ControlCal.K_ContinuousGearDsngeOff",1.0},
            {"AC_ControlCal.K_TransientPN_DsngeOff",1.0},
            {"AC_ControlCal.K_TransientGearDsngeOff",1.0},
            {"AC_ControlCal.K_ContinuousPN_Dsnge",1.0},
            {"AC_ControlCal.n_EngineSpeedSP",1.0},
            {"AC_ControlCal.K_HighPresDsnge",1.0},
            {"AC_ControlCal.K_HighPresEnge",1.0},
            {"AC_ControlCal.K_HighSpeedGearEngeOff",1.0},
            {"AC_ControlCal.K_HighSpeedPN_EngeOff",1.0},
            {"AC_ControlCal.K_HighVoltDsnge",0.1},
            {"AC_ControlCal.K_HighVoltEnge",0.1},
            {"AC_ControlCal.K_LaunchPedPosDsngeTAB",1.0},
            {"AC_ControlCal.n_LaunchPedPosEngineSpeedSP",1.0},
            {"AC_ControlCal.K_LetOffPedDsblTme",0.1},
            {"AC_ControlCal.K_LowAccelDsnge",0.001},
            {"AC_ControlCal.K_LowAccelEnge",0.001},
            {"AC_ControlCal.K_LowVehSpdDsnge",0.1},
            {"AC_ControlCal.K_LowVehSpdEnge",0.1},
            {"AC_ControlCal.K_LowVoltDsnge",0.1},
            {"AC_ControlCal.K_LowVoltEnge",0.1},
            {"AC_ControlCal.K_LowPresDsnge",1.0},
            {"AC_ControlCal.K_LowPresEnge",1.0},
            {"AC_ControlCal.K_LowSpeedDsnge",1.0},
            {"AC_ControlCal.K_LowSpeedEngeOff",1.0},
            {"AC_ControlCal.K_MaxAntiSlugTme",1.0},
            {"AC_ControlCal.K_MaxClutchDelay",0.1},
            {"AC_ControlCal.K_MinClutchDsblTmeTAB",0.1},
            {"AC_ControlCal.K_ServOvrdMaxTme",0.1},
            {"AC_ControlCal.K_SlugCoolTempThrsh",1.0},
            {"AC_ControlCal.K_SlugIgnVoltThrsh",0.1},
            {"AC_ControlCal.K_SlugKoffMnfdTempThrsh",1.0},
            {"AC_ControlCal.K_SlugMaxRefPulses",1.0},
            {"AC_ControlCal.K_SlugMnfdTempThrsh",1.0},
            {"AC_ControlCal.K_SlugUnderPresLmt",1.0},
            {"AC_ControlCal.K_AC_OffTempFault",1.0},
            {"AltCtrlCal.m_FuelHighLim",0.01},
            {"AltCtrlCal.T_ColdStartDsblStdSP",1.0},
            {"AltCtrlCal.t_ColdStartDsblStdTAB",0.1},
            {"AltCtrlCal.T_ColdStartDsblDelayedSP",1.0},
            {"AltCtrlCal.t_ColdStartDsblDelayedATTAB",0.1},
            {"AltCtrlCal.t_ColdStartDsblDelayedMTTAB",0.1},
            {"AltCtrlCal.K_CumulativeL_TermOff",0.1},
            {"AltCtrlCal.K_EngSpdCutoutSP",1.0},
            {"AltCtrlCal.K_EngSpdCutoutInParkTAB",1.0},
            {"AltCtrlCal.K_EngSpdCutoutNotParkTAB",1.0},
            {"AltCtrlCal.t_MinPPEIReqOverride",0.1},
            {"AltCtrlCal.t_MinTimeOn",0.025},
            {"AltCtrlCal.t_TurnOnDelay",0.025},
            {"AltCtrlCal.t_TrqResHoldTime",0.025},
            {"AltCtrlCal.t_ColdStartPrk2DrvDelay",0.1},
            {"AltCtrlCal.Trq_ResRequest",0.1},
            {"AltCtrlCal.p_AirAmbientLowLim",0.1},
            {"AltCtrlCal.X_BlendLimDelay",0.1},
            {"AltCtrlCal.v_Enable",0.1},
            {"AltCtrlCal.U_BatteryLowLim",0.1},
            {"AltCtrlCal.ST_EnableRVC",1.0},
            {"AltCtrlCal.ST_UseDelayOnAT",1.0},
            {"AltCtrlCal.ST_UseDelayOnMT",1.0},
            {"P1680LOGData.Cnt_12p5msOverrun",1.0},
            {"O2SHeatFrontAdap.m_restartdewAdd",1.0},
            {"O2SHeatFrontAdap.Cnt_NoDewPointHeatInterrupts",1.0},
            {"O2SHeatRearAdap.m_restartdewAdd",1.0},
            {"O2SHeatRearAdap.Cnt_NoDewPointHeatInterrupts",1.0},
            {"FFTrqCal.FFTrq_MaxEngineTab1",0.1},
            {"FFTrqCal.FFTrq_MaxEngineTab2",0.1},
            {"FFTrqCal.X_torqueTAB",0.0078125},
            {"FFTrqCal.X_torqueColdTAB",0.0078125},
            {"FFTrqCal.M_maxColdMAP",0.1},
            {"FuelDynProt.m_fuelRequestCyl",0.01},
            {"FuelDynProt.m_fuelFilt",0.01},
            {"FuelDynProt.m_fuelFiltCyl",0.01},
            {"FuelDynProt.m_fuelSlwCmp",0.01},
            {"FuelDynProt.m_fuelSlwCmpCyl",0.01},
            {"FuelDynProt.m_fuelSlow",0.01},
            {"FuelDynProt.m_fuelSlowCyl",0.01},
            {"FuelDynProt.m_fuelFast",0.01},
            {"FuelDynProt.m_fuelFastCyl",0.01},
            {"FuelDynProt.m_fuelDeliv",0.01},
            {"FuelDynProt.m_fuelDelivCyl",0.01},
            {"FuelDynProt.m_fuelMinTime",0.01},
            {"FuelDynProt.m_fuelFiltReminder",1.0},
            {"FuelDynProt.m_FuelReqAftFCut",0.01},
            {"FuelDynProt.n_comb",1.0},
            {"FuelDynProt.m_fuelReqDiff",0.01},
            {"FuelDynProt.m_fuelDelta",0.01},
            {"FuelDynProt.m_fuelDeltaMax",0.01},
            {"FuelDynProt.T_EngineSP",1.0},
            {"FuelDynProt.betaBefWCF",0.0078125},
            {"FuelDynProt.X_negFuelLimTot",0.00392156862745},
            {"FuelDynProt.X_biasHigh",0.0078125},
            {"FuelDynProt.X_biasWU",0.0078125},
            {"FuelDynProt.X_biasWUScale",0.0078125},
            {"FuelDynProt.X_biasWUTot",0.0078125},
            {"FuelDynProt.X_biasTot",0.0078125},
            {"FuelDynProt.X_bias",0.0078125},
            {"FuelDynProt.FuelFacSlow",0.0009765625},
            {"FuelDynProt.FuelFacFast",0.0009765625},
            {"FuelDynProt.n_combBeta",1.0},
            {"FuelDynProt.betaAfterFCut",0.00392156862745},
            {"FuelDynProt.X_negFuelLim",0.00392156862745},
            {"FuelDynProt.tempIndex",1.0},
            {"FuelDynProt.ST_Status",1.0},
            {"FuelDynProt.X_AfterFCut",0.0078125},
            {"FuelDynProt.ST_aftFCutBeta",1.0},
            {"FuelDynProt.beta",0.00392156862745},
            {"FuelDynProt.alpha",0.00392156862745},
            {"FuelDynProt.ST_FuelDecStart",1.0},
            {"FDynFastProt.WWcompcoefa1",0.00392156862745},
            {"FDynFastProt.WWcompcoefb1",0.00392156862745},
            {"FDynFastProt.WWcompcoefb0inv",1.0},
            {"FDynFastProt.m_diff",0.01},
            {"FDynFastProt.m_diffMax",0.01},
            {"FDynFastProt.m_breakLevel",0.01},
            {"FDynFastProt.alphaUnb",0.00392156862745},
            {"FDynFastProt.betaUnb",0.00392156862745},
            {"FDynFastProt.alpha",0.00392156862745},
            {"FDynFastProt.beta",0.00392156862745},
            {"FDynSlowProt.WWcompcoefa1",0.00392156862745},
            {"FDynSlowProt.WWcompcoefb1",0.00392156862745},
            {"FDynSlowProt.WWcompcoefb0inv",1.0},
            {"FDynSlowProt.m_diff",0.01},
            {"FDynSlowProt.m_diffMax",0.01},
            {"FDynSlowProt.m_breakLevel",0.01},
            {"FDynSlowProt.alphaUnb",0.00392156862745},
            {"FDynSlowProt.betaUnb",0.00392156862745},
            {"FDynSlowProt.alpha",0.00392156862745},
            {"FDynSlowProt.beta",0.00392156862745},
            {"FuelDyn.FuelFac",0.0009765625},
            {"ETCKickDownCal.X_KickDownDetentHi",0.1},
            {"ETCKickDownCal.X_KickDownDetentLo",0.1},
            {"SensSwitchAdap.t_SnsrShortTime_1_Max",1.0},
            {"SensSwitchAdap.t_SnsrShortTime_1_Min",1.0},
            {"SensSwitchAdap.t_SnsrShortTime_2_Max",1.0},
            {"SensSwitchAdap.t_SnsrShortTime_2_Min",1.0},
            {"TrqMastProt.Trq_MBT",0.1},
            {"TrqMastProt.Trq_ReqTLO",0.1},
            {"TrqMastProt.Trq_WarmFriction",0.1},
            {"TrqMastProt.Trq_ResBuffer",0.1},
            {"TrqMastProt.Trq_ResReqIgn",0.1},
            {"TrqMastProt.Trq_OffsetIgn",0.1},
            {"TrqMastProt.Trq_CompRequest",0.1},
            {"TrqMastProt.Trq_MinLim",0.1},
            {"TrqMastProt.Trq_TotReq",0.1},
            {"TrqMastProt.Trq_TipReq",0.1},
            {"TrqMastProt.Trq_Req",0.1},
            {"TrqMastProt.Trq_TMCReq",0.1},
            {"TrqMastProt.Trq_MaxDerInc",0.1},
            {"TrqMastProt.Trq_MaxDerDec",0.1},
            {"TrqMastProt.X_OutAccPed",0.1},
            {"TrqMastProt.EngEfficiencyReq",0.1},
            {"TrqMastProt.IgnAngleDiffTLO",0.1},
            {"TrqMastProt.fi_RedTrqOffset",0.1},
            {"TrqMastProt.n_MaxCylInFuelCut",1.0},
            {"TrqMastProt.n_CylinderInFuelCut",1.0},
            {"TrqMastProt.ST_ActiveTorqueFunction",1.0},
            {"TrqMastProt.ST_PowerManagement",1.0},
            {"TrqMast.Trq_MaxRequested",0.1},
            {"TrqMast.Trq_Req",0.1},
            {"TrqMast.Trq_LimReq",0.1},
            {"TrqMast.Trq_ResReqIgn",0.1},
            {"TrqMast.Trq_ResReqAir",0.1},
            {"TrqMast.Trq_ReqSimTool",0.1},
            {"TrqMast.Trq_ResReqSimTool",0.1},
            {"TrqMast.Trq_GearBox",0.1},
            {"TrqMast.Trq_Brake",0.1},
            {"TrqMast.Trq_MBT",0.1},
            {"TrqMast.Trq_MBTActual",0.1},
            {"TrqMast.Trq_ColdFriction",0.1},
            {"TrqMast.Trq_EngAct",0.1},
            {"TrqMast.Trq_Nominal",0.1},
            {"TrqMast.Trq_EngDrRqd",0.1},
            {"TrqMast.Trq_CatReq",0.1},
            {"TrqMast.Trq_CatReqRes",0.1},
            {"TrqMast.fi_RedTrqOffset",0.1},
            {"TrqMast.EngEfficiencyReq",0.1},
            {"TrqMast.X_OutAccPed",0.1},
            {"TrqMast.X_OutAccPedGrad",0.1},
            {"TrqMast.n_EngNormalised",1.0},
            {"TrqMast.Trq_PedalorCruise",0.1},
            {"TrqMast.ST_DelayResIgnCatDiag",1.0},
            {"TrqMast.ST_ActiveTorqueFunction",1.0},
            {"TrqMast.ST_PowerManagement",1.0},
            {"TrqMast.ST_NoTipFilter",1.0},
            {"TrqMast.n_CylinderInFuelCut",1.0},
            {"KnkDetAdap.KnkCntMAP",1.0},
            {"KnkDetAdap.KnkCntCyl",1.0},
            {"MisfAveAdap.Ka",0.0009765625},
            {"MisfAveAdap.Kb",0.0009765625},
            {"AirMinLimCal.m_MinLoadMAP",1.0},
            {"AirMinLimCal.m_MinLoadIdleRevTAB",1.0},
            {"AirMinLimCal.m_idleRevEnabLoadStep",1.0},
            {"AirMinLimCal.m_idleRevDisLoadStep",1.0},
            {"AirMinLimCal.T_EngineSP",1.0},
            {"AirMinLimCal.n_EngineSP",1.0},
            {"AirMinLimCal.ST_EnabMinLoadIdleRev",1.0},
            {"TrqMastCal.Trq_MBTMAP",0.1},
            {"TrqMastCal.Trq_NominalMap",0.1},
            {"TrqMastCal.m_AirTorqMap",1.0},
            {"TrqMastCal.X_AccPedalMAP",0.1},
            {"TrqMastCal.IgnAngleDiffSP",0.1},
            {"TrqMastCal.TLO_TAB",0.1},
            {"TrqMastCal.n_EngineYSP",1.0},
            {"TrqMastCal.n_EngineXSP",1.0},
            {"TrqMastCal.n_MaxDerXSP",1.0},
            {"TrqMastCal.Trq_EngXSP",0.1},
            {"TrqMastCal.Trq_PedYSP",0.1},
            {"TrqMastCal.Trq_MaxDerIncMAP",0.1},
            {"TrqMastCal.Trq_MaxDerDecMAP",0.1},
            {"TrqMastCal.Trq_MaxDerShift",0.1},
            {"TrqMastCal.m_AirXSP",1.0},
            {"TrqMastCal.Trq_PedalRampStep",0.1},
            {"TrqMastCal.Trq_FuelCutRamp",0.1},
            {"TrqMastCal.Trq_StartFCutRamp",0.1},
            {"TrqMastCal.EngEfficiencyLowLimit",0.1},
            {"TrqMastCal.EngEfficiencyHighLimit",0.1},
            {"TrqMastCal.DelayResTrq",1.0},
            {"TrqMastCal.v_PwrMngBwdLim",0.1},
            {"TrqMastCal.n_MaxCylInFuelCutTAB",1.0},
            {"TrqMastCal.T_YSP",1.0},
            {"TrqMastCal.T_MaxDerYSP",1.0},
            {"TrqLimProt.t_stamp",0.1},
            {"TrqLimProt.t_NoiseRedTrig",1.0},
            {"TrqLimProt.t_NoiseRedConst",1.0},
            {"TrqLimProt.t_NoiseRedRamp",1.0},
            {"TrqLimProt.Trq_PowerLim",0.1},
            {"TrqLimProt.Trq_ManGear",0.1},
            {"TrqLimProt.Trq_NoiseReduction",0.1},
            {"TrqLimProt.Trq_CompressorNoiseRed",0.1},
            {"TrqLimProt.Trq_MaxEngine",0.1},
            {"TrqLimProt.Trq_StallLimit",0.1},
            {"TrqLimProt.Trq_BrakeLimit",0.1},
            {"TrqLimProt.Trq_SyncLimit",0.1},
            {"TrqLimProt.Trq_TrnLimAir",0.1},
            {"TrqLimProt.Trq_TrnLimIgn",0.1},
            {"TrqLimProt.Trq_TrnMinLim",0.1},
            {"TrqLimProt.Trq_TcsLimAir",0.1},
            {"TrqLimProt.Trq_TcsLimIgn",0.1},
            {"TrqLimProt.Trq_TcsMinLim",0.1},
            {"TrqLimProt.t_OverBoostTimer",1.0},
            {"TrqLimProt.t_CoolingTimer",1.0},
            {"TrqLimProt.OldTCTrqRqProt",1.0},
            {"TrqLimProt.M_ColdLimit",0.1},
            {"TrqLimProt.M_CurrentColdLimit",0.1},
            {"TrqLimProt.ST_NoiseReduction",1.0},
            {"TrqLimProt.OverBoostMode",1.0},
            {"TrqLimProt.ST_TCSProtectionFault",1.0},
            {"TrqLimProt.ST_TCSProtFaultThisMessage",1.0},
            {"TrqLimProt.ST_TCSInternalFault",1.0},
            {"TrqLimProt.RqProtFault",1.0},
            {"TrqLimProt.CheckUpdateCnt",1.0},
            {"TrqLimProt.ST_firstCheckTCSFault",1.0},
            {"TrqLimProt.ST_EngStartPrev",1.0},
            {"PwrLimProt.ST_Status",1.0},
            {"MaxEngSpdProt.n_EngLim",1.0},
            {"MaxEngSpdProt.K",0.01},
            {"MaxEngSpdProt.t_Ti",1.0},
            {"MaxEngSpdProt.n_Derivata",1.0},
            {"MaxEngSpdProt.n_DerivataPrev",1.0},
            {"MaxEngSpdProt.n_EngSpeedPrev",1.0},
            {"MaxEngSpdProt.n_EngLimFuelCut",1.0},
            {"MaxEngSpdProt.Trq_Offset",0.1},
            {"MaxEngSpdProt.Trq_PPart",0.1},
            {"MaxEngSpdProt.Trq_IPart",0.1},
            {"MaxEngSpdProt.Trq_IPart_old",0.1},
            {"MaxEngSpdProt.Trq_MaxEngSpeed",0.1},
            {"MaxEngSpdProt.Trq_MaxEngStartVal",0.1},
            {"MaxEngSpdProt.ST_Steady",1.0},
            {"TrqLim.Trq_LowLimAir",0.1},
            {"TrqLim.Trq_LowLimIgn",0.1},
            {"TrqLim.Trq_MinLim",0.1},
            {"TrqLim.Trq_DrRqLim",0.1},
            {"TrqLim.TCRqProt",1.0},
            {"TrqLim.ST_MinLim",1.0},
            {"TrqLim.ST_ActiveAirLimit",1.0},
            {"TrqLim.ST_ActiveIgnLimit",1.0},
            {"MaxEngSpd.ST_EngLimFuelCut",1.0},
            {"MaxEngSpd.ST_LimitMaxEngSpeedEnable",1.0},
            {"obdSAI.ST_OkStatus",1.0},
            {"obdSAI.ST_FaultCode",1.0},
            {"obdSAI.Q_AirInletFilt",0.01},
            {"obdSAI.p_ModelInFilt",0.1},
            {"obdSAI.p_Model",0.1},
            {"obdSAI.p_SecondaryAirFilt",0.1},
            {"obdSAI.p_PumpOff",0.1},
            {"obdSAI.p_SecondaryAirAtStart",0.1},
            {"obdSAI.pRatio",0.01},
            {"obdSAI.pRatioMean",0.01},
            {"obdSAI.N_MeanValue",1.0},
            {"obdSAI.fi_IgnitionFilt",0.1},
            {"obdSAI.ST_BreakCondition",1.0},
            {"obdSAI.ST_Status",1.0},
            {"obdSAI.ST_DiagPrevRestOfDrvCycle",1.0},
            {"PCFSCal.v_vehicleLim",0.1},
            {"PCFSCal.t_DsblFuelPump",0.1},
            {"PCFSCal.t_DsblInjector",0.1},
            {"PCFSCal.t_High_v_Vehicle",0.1},
            {"PCFSCal.ST_Enable",1.0},
            {"BstKnk.MaxAir",1.0},
            {"LimEng.m_nHigh",1.0},
            {"LimEng.ST_MaxLimActive",1.0},
            {"BstKnkProt.MapPointer",0.1},
            {"BstKnkProt.DivFactor",0.03125},
            {"obdServiceBayTest.requestedFuelFac",0.0009765625},
            {"obdServiceBayTest.ST_OkStatus",1.0},
            {"obdServiceBayTest.ST_FaultCode",1.0},
            {"obdServiceBayTest.ST_TestPhase",1.0},
            {"obdServiceBayTest.ST_Phase2",1.0},
            {"obdServiceBayTest.ST_Phase5",1.0},
            {"obdServiceBayTest.ST_PreCondition",1.0},
            {"obdServiceBayTest.ST_BreakCondDurTest",1.0},
            {"obdServiceBayTest.ST_TestStarted",1.0},
            {"obdServiceBayTest.ST_RequestedElevIdle",1.0},
            {"obdServiceBayTest.ST_ClosedLoopStopped",1.0},
            {"obdServiceBayTest.ST_O2SPreHeatPWM",1.0},
            {"obdServiceBayTest.ST_O2SPostHeatPWM",1.0},
            {"obdServiceBayTest.ST_O2SRespOveride",1.0},
            {"obdServiceBayTest.ST_TestStatus",1.0},
            {"obdServiceBayTest.ST_Phase5LastTestResult",1.0},
            {"obdServiceBayTest.ST_Phase4",1.0},
            {"AirMinLim.m_nLow",1.0},
            {"AirMinLim.Trq_MinLoad",0.1},
            {"AirMinLimProt.m_LowIdleRevving",1.0},
            {"pAirSensProt.p_DevMAP_SAI",0.1},
            {"pAirSensProt.p_DevSAI_pBef",0.1},
            {"pAirSensProt.p_DevMAP_pBef",0.1},
            {"pAirSensProt.ST_PerformDiag",1.0},
            {"pAirSensProt.ST_StabileCond",1.0},
            {"pAirSensProt.ST_RPMAfterPwrUp",1.0},
            {"pAirSensors.p_MAPAdap",0.1},
            {"pAirSensors.p_BEFAdap",0.1},
            {"pAirSensors.p_AirInlet",0.1},
            {"pAirSensors.p_AirBefThrottle",0.1},
            {"obdMAP.ST_OkStatus",1.0},
            {"obdMAP.ST_FaultCode",1.0},
            {"obdMAP.N_DevPresErrReadings",1.0},
            {"obdMAP.N_DevPresOKReadings",1.0},
            {"obdMAP.N_RelPedalErrReadings",1.0},
            {"obdMAP.N_RelPedalOkReadings",1.0},
            {"obdMAP.ST_ComparePressure",1.0},
            {"obdMAP.ST_DeviceFaultDetect",1.0},
            {"obdPBef.ST_OkStatus",1.0},
            {"obdPBef.ST_FaultCode",1.0},
            {"obdPBef.N_DevPresErrReadings",1.0},
            {"obdPBef.N_DevPresOKReadings",1.0},
            {"obdPBef.ST_ComparePressure",1.0},
            {"obdPBef.ST_SetLimphomeOnMAP",1.0},
            {"obdMAF.N_LoWin",1.0},
            {"obdMAF.N_HiWin",1.0},
            {"obdMAF.accumElementHiWin",1.0},
            {"obdMAF.accumElementLoWin",1.0},
            {"obdMAF.ST_OkStatus",1.0},
            {"obdMAF.ST_FaultCode",1.0},
            {"obdMAF.Q_AirDiff",0.01},
            {"obdMAF.meanLoWin",0.01},
            {"obdMAF.meanHiWin",0.01},
            {"obdMAF.MeanElementHiWin",0.01},
            {"obdMAF.bufHiWin",0.01},
            {"obdMAF.MeanElementLoWin",0.01},
            {"obdMAF.bufLoWin",0.01},
            {"obdMAF.N_bufUpdatesHiWin",1.0},
            {"obdMAF.N_bufUpdatesLoWin",1.0},
            {"obdMAF.X_pRatio",0.01},
            {"obdMAF.ST_SteadyState",1.0},
            {"obdMAF.ST_BypassSteadyState",1.0},
            {"obdMAF.ST_BreakPreCond",1.0},
            {"obdMAF.ST_DeviceFaultDetect",1.0},
            {"obdSAISens.ST_OkStatus",1.0},
            {"obdSAISens.ST_FaultCode",1.0},
            {"obdSAISens.N_DevPresErrReadings",1.0},
            {"obdSAISens.N_DevPresOKReadings",1.0},
            {"obdSAISens.ST_ComparePressure",1.0},
            {"FFBladCal.M_lowLimSysActTab",0.1},
            {"FFBladCal.n_LimSysActSP7",1.0},
            {"FFBladCal.K_AFRFiltQ",0.0009765625},
            {"FFBladCal.K_AFRFilt",0.0009765625},
            {"FFBladCal.K_HLAFRFilt",0.0009765625},
            {"FFBladCal.t_HLStartDelay",0.1},
            {"FFBladCal.t_HLRepeatDelay",0.1},
            {"FFBladCal.t_blendQTime",0.25},
            {"FFBladCal.X_HLMinLeanSwitch",0.78125},
            {"FFBladCal.n_HLMaxDelta",1.0},
            {"FFBladCal.m_HLMaxDelta",1.0},
            {"FFBladCal.n_eng4SP",1.0},
            {"FFBladCal.X_HLBlendOffset4TAB",0.1},
            {"FFBladCal.N_HLRampStep",1.0},
            {"FFBladCal.ST_HLEnable",1.0},
            {"FFBladCal.ST_enable",1.0},
            {"FFBlad1Cal.t_windowTime",0.25},
            {"FFBlad1Cal.t_minAdapTime",0.25},
            {"FFBlad1Cal.T_engLowLim",1.0},
            {"FFBlad1Cal.m_airLowLim",1.0},
            {"FFBlad1Cal.Q_airLimBoff",0.01},
            {"FFBlad1Cal.n_engLowLim",1.0},
            {"FFBlad1Cal.m_airDeltaLim",1.0},
            {"FFBlad1Cal.n_engDeltaLim",1.0},
            {"FFBlad1Cal.N_meanSamples",1.0},
            {"FFBlad1Cal.X_maxBlendDiff",0.1},
            {"FFBlad1Cal.X_blendMaxAdap",0.1},
            {"FFBlad1Cal.X_blendUpd",0.1},
            {"FFBlad1Cal.N_minAdaps",1.0},
            {"FFBlad1Cal.ST_adapDuringIdle",1.0},
            {"FFBlad1Cal.rampStep",1.0},
            {"FFBlad2Cal.t_windowTime",0.25},
            {"FFBlad2Cal.t_minAdapTime",0.25},
            {"FFBlad2Cal.T_engLowLim",1.0},
            {"FFBlad2Cal.m_airLowLim",1.0},
            {"FFBlad2Cal.Q_airLimBoff",0.01},
            {"FFBlad2Cal.n_engLowLim",1.0},
            {"FFBlad2Cal.m_airDeltaLim",1.0},
            {"FFBlad2Cal.n_engDeltaLim",1.0},
            {"FFBlad2Cal.N_meanSamples",1.0},
            {"FFBlad2Cal.X_maxBlendDiff",0.1},
            {"FFBlad2Cal.X_blendMaxAdap",0.1},
            {"FFBlad2Cal.X_blendUpd",0.1},
            {"FFBlad2Cal.N_minAdaps",1.0},
            {"FFBlad2Cal.ST_adapDuringIdle",1.0},
            {"FFBlad2Cal.rampStep",1.0},
            {"StartAir.A_FixThrAreaDelta",0.1},
            {"StartAir.n_EngLimFixThrArea",1.0},
            {"StartAir.ST_FuelCut",1.0},
            {"StartAir.ST_FixThrArea",1.0},
            {"OilPressureCal.n_CombDelay",1.0},
            {"OilPressureCal.ST_TestLampAtStart",1.0},
            {"KnkDet.ST_Knock",1.0},
            {"KnkDet.ST_ClearIgnOff",1.0},
            {"KnkDet.fi_KnockWindowOffset",0.1},
            {"KnkDet.KnkCntCyl1",1.0},
            {"KnkDet.KnkCntCyl2",1.0},
            {"KnkDet.KnkCntCyl3",1.0},
            {"KnkDet.KnkCntCyl4",1.0},
            {"KnkDet.KnockCyl",1.0},
            {"KnkDet.ST_Started",1.0},
            {"KnkDetProt.fi_knkWinOffs",0.1},
            {"KnkDetProt.X_npfX",0.0009765625},
            {"KnkDetProt.X_average",0.0009765625},
            {"KnkDetProt.X_Knock",0.0009765625},
            {"KnkDetProt.X_KnockFiltered",1.0},
            {"KnkDetProt.X_hystOffset",0.0009765625},
            {"KnkDetProt.X_NHystOffset",0.0009765625},
            {"KnkDetProt.X_AHystOffset",0.0009765625},
            {"KnkDetProt.npfX",0.0009765625},
            {"KnkDetProt.average",0.0009765625},
            {"KnkDetProt.BGN",0.0009765625},
            {"KnkDetProt.X_BGN",0.0009765625},
            {"KnkDetProt.np",1.0},
            {"KnkDetProt.X_KnkCyl",1.0},
            {"KnkDetProt.X_max",0.0009765625},
            {"KnkDetProt.t_K3Stamp",1.0},
            {"KnkDetProt.n_K3Stamp",1.0},
            {"KnkDetProt.FLT",0.0009765625},
            {"KnkDetProt.npfXDiff",0.0009765625},
            {"KnkDetProt.T_EnableLimit",1.0},
            {"KnkDetProt.K_HystOffset",0.0078125},
            {"tempX_KnockHigh",1.0},
            {"t_ReadXKnkStamp",1.0},
            {"X_KnockHighest",1.0},
            {"tempX_KnockHighFilt",1.0},
            {"X_KnockHighestFilt",1.0},
            {"KnkDetsym1",1.0},
            {"MisfAveProt.fi_DetectLevel",0.1},
            {"MisfAveProt.t_CDetectLevel",1.0},
            {"MisfAveProt.n_MFAveCounter",1.0},
            {"MisfAveProt.n_HiMFAve1Counter",1.0},
            {"MisfAveProt.n_HiMFAve2Counter",1.0},
            {"MisfAveProt.MFIndex",0.0078125},
            {"MisfAveProt.t_MFAve",1.0},
            {"MisfAveProt.t_HiMFAve1",1.0},
            {"MisfAveProt.t_HiMFAve2",1.0},
            {"MisfAveProt.t_HiMFAveA",1.0},
            {"MisfAveProt.t_MFAveSUM",1.0},
            {"MisfAveProt.t_HiMFAve1SUM",1.0},
            {"MisfAveProt.t_HiMFAve2SUM",1.0},
            {"MisfAveProt.MFAveActiveFlag",1.0},
            {"MisfAveProt.HiMFAve1ActiveFlag",1.0},
            {"MisfAveProt.HiMFAve2ActiveFlag",1.0},
            {"DNCompProt.RampStart",1.0},
            {"DNCompProt.Trq_Request",0.1},
            {"DNCompProt.Trq_ResRequest",0.1},
            {"DNCompProt.Trq_ReqNC",0.1},
            {"DNCompProt.Trq_ResRequestNC",0.1},
            {"DNCompProt.Trq_ReqNeutral",0.1},
            {"DNCompProt.Trq_ReqDrive",0.1},
            {"DNCompProt.t_RampTimer",1.0},
            {"DNCompProt.t_RampTimerTAB",1.0},
            {"DNCompProt.n_EngQuote",1.0},
            {"DNCompProt.DNLoadNCWeightFac",1.0},
            {"DNCompProt.n_StartFlareDecayRate",1.0},
            {"DNCompProt.n_NomStartRpmFlare",1.0},
            {"DNCompProt.ST_StartRampFinished",1.0},
            {"DNCompProt.State",1.0},
            {"DNCompProt.RampFinished",1.0},
            {"DNCompProt.NCfinished",1.0},
            {"DNComp.Trq_Request",0.1},
            {"DNComp.Trq_ResRequest",0.1},
            {"DNComp.n_EngineNominal",1.0},
            {"DNComp.n_EngineNominalLow",1.0},
            {"DNComp.ST_DriveActive",1.0},
            {"DNComp.ST_NeutralControl",1.0},
            {"DNComp.ST_DelayResIgn",1.0},
            {"IgnAbsAdap.o_octan",0.01},
            {"FFOBD.ST_MisfireFilterActive",1.0},
            {"FFOBDCat.X_blendMulFac",0.0009765625},
            {"CatMod.T_CatSteadyStateGas",1.0},
            {"CatMod.T_CatSteadyStateE85",1.0},
            {"CatMod.X_E85TempWeight",0.0078125},
            {"FFObdEvap.TotTabRamp2BefComp",0.1},
            {"MCPComCal.c_SerComContFail",1.0},
            {"MCPComCal.c_SerComContFailInit",1.0},
            {"MCPComCal.c_SerComFail",1.0},
            {"MCPComCal.c_SerComSmpl",1.0},
            {"IgnKnk.RetardIndex",0.01},
            {"IgnKnk.NRetardIndex",0.01},
            {"IgnKnk.ARetardIndex",0.01},
            {"IgnKnk.fi_MeanKnock",0.1},
            {"IgnKnk.fi_Offset",0.1},
            {"IgnKnk.fi_OffNorm",0.1},
            {"IgnKnk.fi_MaxOffset",0.1},
            {"IgnKnk.Index",0.01},
            {"IgnKnk.AdpHighLim",1.0},
            {"IgnKnk.fi_Diff",0.1},
            {"IgnKnk.ST_Trans",1.0},
            {"IgnTrans.fi_Offset",0.1},
            {"IgnTransProt.m_Diff",1.0},
            {"IgnTransProt.fi_Diff",0.1},
            {"IgnTransProt.factor",0.0009765625},
            {"IgnTransProt.fi_OffNew",0.1},
            {"IgnTransProt.fi_Offset",0.1},
            {"IgnTransProt.fi_rampStep",0.1},
            {"IgnTransProt.n_counter",1.0},
            {"IgnTransProt.m_Buffer",1.0},
            {"IgnTransProt.m_Air1",1.0},
            {"IgnTransProt.m_Air2",1.0},
            {"IgnTransProt.fi_mAir1",0.1},
            {"IgnTransProt.fi_mAir2",0.1},
            {"IgnTransProt.buffCount",1.0},
            {"IgnJerkProt.n_Delta",1.0},
            {"IgnJerkProt.n_DeltaLim",1.0},
            {"IgnJerkProt.fi_Offset",0.1},
            {"IgnJerkProt.ST_NewAllowed",1.0},
            {"IgnJerkProt.ST_Activated",1.0},
            {"IgnJerkProt.ST_PedalCond",1.0},
            {"KnkSoundRedProt.fi_Offset",0.1},
            {"FailSafeProt.fi_Offset",0.1},
            {"FailSafeProt.NoFailSafeCyl",1.0},
            {"FailSafeProt.singleCyl",1.0},
            {"FailSafeProt.HighNonFailCyl",1.0},
            {"FailSafeProt.lowRetardCyl",1.0},
            {"FailSafeProt.cyl",1.0},
            {"IgnKnkProt.fi_Retard",0.1},
            {"IgnKnkProt.n_Engine",1.0},
            {"IgnKnkProt.AdpLowLim",1.0},
            {"IgnKnkProt.fi_PartAdap",0.1},
            {"IgnKnkProt.K_RetardIndex",0.0078125},
            {"IgnKnkProt.fi_FailMeanKnock",0.1},
            {"IgnKnkProt.ST_adaption",1.0},
            {"IgnKnkProt.FailCyl",1.0},
            {"IgnKnkProt.NoFailCyl",1.0},
            {"IgnTempProt.fi_Offset",1.0},
            {"ElevIdleCal.t_100msDelayClutch",0.1},
            {"ElevIdleCal.v_VehicleHighLimit",0.1},
            {"ElevIdleCal.v_VehicleLowLimit",0.1},
            {"ElevIdleCal.n_EngElevIdle1Level",1.0},
            {"ElevIdleCal.n_EngElevIdlePSLevel",1.0},
            {"ElevIdleCal.T_engHotSoakSP",1.0},
            {"ElevIdleCal.n_EngElevIdleHotSoakTAB",1.0},
            {"ElevIdleCal.n_EngElevIdleVehSpdLevel",1.0},
            {"ElevIdleCal.n_EngElevIdleClutchActTAB",1.0},
            {"ElevIdleCal.n_EngElevIdleCatDiagLevel",1.0},
            {"ElevIdleCal.n_EngElevIdleEvapDiagLevel",1.0},
            {"ElevIdleCal.n_EngElevIdleServiceBayLevel1",1.0},
            {"ElevIdleCal.n_EngElevIdleServiceBayLevel2",1.0},
            {"ElevIdleCal.n_EngElevIdleServiceBayLevel3",1.0},
            {"ElevIdleCal.n_EngElevIdleOilTemp",1.0},
            {"ElevIdleCal.n_EngElevIdleTOALevel",1.0},
            {"ElevIdleCal.T_ElevIdleHeaterSP",1.0},
            {"ElevIdleCal.n_ElevIdleHeaterTAB",1.0},
            {"ElevIdleCal.T_ElevIdleACSP",1.0},
            {"ElevIdleCal.n_ElevIdleACTAB",1.0},
            {"ElevIdleCal.n_EngElevIdle1StepUp",1.0},
            {"ElevIdleCal.n_EngElevIdle1StepDown",1.0},
            {"ElevIdleCal.n_EngElevIdlePSStepUp",1.0},
            {"ElevIdleCal.n_EngElevIdlePSStepDown",1.0},
            {"ElevIdleCal.n_EngElevIdleHotSoakStepUp",1.0},
            {"ElevIdleCal.n_EngElevIdleHotSoakStepDown",1.0},
            {"ElevIdleCal.n_EngElevIdleVehSpdStepUp",1.0},
            {"ElevIdleCal.n_EngElevIdleVehSpdStepDown",1.0},
            {"ElevIdleCal.n_EngElevIdleClutchStepUp",1.0},
            {"ElevIdleCal.n_EngElevIdleClutchStepDown",1.0},
            {"ElevIdleCal.n_EngElevIdleCatDiagStepUp",1.0},
            {"ElevIdleCal.n_EngElevIdleCatDiagStepDown",1.0},
            {"ElevIdleCal.n_EngElevIdleEvapDiagStepUp",1.0},
            {"ElevIdleCal.n_EngElevIdleEvapDiagStepDown",1.0},
            {"ElevIdleCal.n_EngElevIdleACStepUp",1.0},
            {"ElevIdleCal.n_EngElevIdleACStepDown",1.0},
            {"ElevIdleCal.n_EngElevIdleHeaterStepUp",1.0},
            {"ElevIdleCal.n_EngElevIdleHeaterStepDown",1.0},
            {"ElevIdleCal.n_EngElevIdleLowBatteryStepUp",1.0},
            {"ElevIdleCal.n_EngElevIdleLowBatteryStepDown",1.0},
            {"ElevIdleCal.n_EngElevIdleOilTempStepUp",1.0},
            {"ElevIdleCal.n_EngElevIdleOilTempStepDown",1.0},
            {"ElevIdleCal.n_EngElevIdleTOAStepDown",1.0},
            {"ElevIdleCal.n_EngElevIdleSBTDiagStepUp",1.0},
            {"ElevIdleCal.n_EngElevIdleSBTDiagStepDown",1.0},
            {"ElevIdleCal.t_PowerSteerDelay",1.0},
            {"ElevIdleCal.p_AirAmbientLowLimit",0.1},
            {"ElevIdleCal.p_AirAmbientHighLimit",0.1},
            {"ElevIdleCal.T_AirAmbientLowLimit",1.0},
            {"ElevIdleCal.T_AirAmbientHighLimit",1.0},
            {"ElevIdleCal.T_OilTempLowLimit",1.0},
            {"ElevIdleCal.T_OilTempHighLimit",1.0},
            {"ElevIdleCal.t_100msFilterUpdate",0.1},
            {"ElevIdleCal.OtsAirFiltConst",1.0},
            {"ElevIdleCal.n_EngElevIdleUBattTAB",1.0},
            {"ElevIdleCal.t_ColdStartTimer",1.0},
            {"ElevIdleCal.t_LimitTimer",1.0},
            {"ElevIdleCal.t_ExtReqDelay",0.001},
            {"ElevIdleCal.BattFiltConst",1.0},
            {"ElevIdleCal.n_EngElevIdleRevvingRampTAB",1.0},
            {"ElevIdleCal.n_ElevIdleRevvingDiff",1.0},
            {"ElevIdleCal.T_ElevIdleRevvingSP",1.0},
            {"ElevIdleCal.U_BattSP",0.1},
            {"ElevIdleCal.U_BattLimitEnable",0.1},
            {"ElevIdleCal.U_BattLimitDisable",0.1},
            {"ElevIdleCal.ST_EnableEngElevIdleBattLow",1.0},
            {"ElevIdleCal.ST_EnableEngElevIdleHeater",1.0},
            {"ElevIdleCal.ST_EnableEngElevIdleAC",1.0},
            {"ElevIdleCal.ST_EnableEngElevIdleOilTemp",1.0},
            {"ElevIdleCal.ST_EnabIdleRevving",1.0},
            {"RpmCtrlAdapAdap.Trq_ReqDriveNormTAB",0.1},
            {"RpmCtrlAdapAdap.Trq_ReqNeutralNormTAB",0.1},
            {"obdImmo.ST_OkStatus",1.0},
            {"obdImmo.ST_FaultCode",1.0},
            {"BoostCal.TimeOpenBPV",1.0},
            {"BoostCal.MaxPosDerBPV",1.0},
            {"BoostCal.MaxNegDerBPV",1.0},
            {"BoostCal.HighThrLimBPV",1.0},
            {"BoostCal.LowThrLimBPV",1.0},
            {"BoostCal.v_NoiseReduction",0.1},
            {"BoostCal.p_AntiHowlLim",0.1},
            {"BoostCal.p_AntiHowlPairSP",0.1},
            {"BoostCal.p_AntiHowlTab",0.1},
            {"BoostAdapCal.m_IFaclimit",1.0},
            {"BoostAdapCal.p_AirInletDeltaLim",0.1},
            {"BoostAdapCal.updateSpeed",0.78125},
            {"BoostAdapCal.t_inWindow",0.001},
            {"BoostAdapCal.m_adapMax",0.0078125},
            {"BoostAdapCal.m_adapMin",0.0078125},
            {"BoostAdapCal.T_EngLowLim",1.0},
            {"BoostAdapCal.m_AirXSP",1.0},
            {"BoostAdapCal.n_EngYSP",1.0},
            {"BoostAdapCal.validitySpeed",1.0},
            {"BoostAdapCal.t_Validity",0.001},
            {"BoostAdapCal.validityThres",1.0},
            {"BoostAdapCal.ST_enable",1.0},
            {"TMCCal.t_ReqErrLim",0.001},
            {"TMCCal.t_ActualErrLim",0.001},
            {"TMCCal.t_BefRunReqDiag",0.1},
            {"TMCCal.Trq_BlockHeatComp",0.1},
            {"TMCCal.v_NeutralLim",0.1},
            {"TMCCal.t_D2NDelayTAB",1.0},
            {"TMCCal.T_D2NSP",1.0},
            {"TMCCal.T_EngSP",1.0},
            {"TMCCal.Trq_FrictionMAP",0.1},
            {"TMCCal.T_TrnOilSP",1.0},
            {"TMCCal.Trq_NeutralMAP",0.1},
            {"TMCCal.Trq_DriveMAP",0.1},
            {"TMCCal.p_ACSP",1.0},
            {"TMCCal.Trq_ACLoadTAB",0.1},
            {"TMCCal.Trq_ACDynRecTAB",0.1},
            {"TMCCal.t_ACDynReqSP",1.0},
            {"TMCCal.T_EngMinSP",1.0},
            {"TMCCal.Trq_MinLoadTAB",0.1},
            {"TMCCal.Trq_LimMargin",0.1},
            {"TMCCal.Trq_CalcFactor",0.1},
            {"TMCCal.f_FilterReqLim",0.1},
            {"TMCCal.f_FilterActLim",0.1},
            {"TMCCal.ActualErrLimFac",0.1},
            {"TMCCal.Trq_ActualErrLimOffset",0.1},
            {"TMCCal.Trq_MaxEngineTab",0.1},
            {"TMCCal.Trq_MaxEngineLowTab",0.1},
            {"TMCCal.Trq_MaxEngineFFTab",0.1},
            {"TMCCal.Trq_MaxEngineLowFFTab",0.1},
            {"TMCCal.n_EngYSP",1.0},
            {"TMCCal.n_Engine1YSP",1.0},
            {"TMCCal.n_Engine2YSP",1.0},
            {"TMCCal.n_Engine3YSP",1.0},
            {"TMCCal.Trq_MaxAboveIdle",0.1},
            {"TMCCal.Trq_MaxBelowIdle",0.1},
            {"TMCCal.Trq_ElLoadTAB",0.1},
            {"TMCCal.PWM_ElSP",0.1},
            {"TMCCal.f_FTerm",0.1},
            {"TMCCal.Trq_ForcedIdleMaxReq",0.1},
            {"TMCCal.Trq_ForcedIdleStep",0.1},
            {"TMCCal.v_VehicleForcedIdleLim",0.1},
            {"TMCCal.n_LowLim",1.0},
            {"TMCCal.n_HighLim",1.0},
            {"TMCCal.ST_ActualFilter",1.0},
            {"TMCCal.ST_UseRawFriction",1.0},
            {"FrompAdapAdap.AdapMAP",0.0078125},
            {"FFBoffAdap.m_accFuel",0.01},
            {"FFBoffAdap.m_accFuelComp",0.01},
            {"FFBoffAdap.N_coldStarts",1.0},
            {"FFBoffAdap.X_constRateIntCopy",0.0009765625},
            {"FFBoffAdap.ST_state",1.0},
            {"OilTempProt.T_OilAtStartUp",1.0},
            {"OilTempProt.T_EngineAtStartUp",1.0},
            {"OilTempProt.T_Engine_5_Sec",1.0},
            {"OilTempProt.ST_OilTemp",1.0},
            {"OilTemp.T_Oil",1.0},
            {"TrqLimCal.t_CANDelay",0.1},
            {"TrqLimCal.Trq_ManGear",0.1},
            {"TrqLimCal.Trq_StallLimit",0.1},
            {"TrqLimCal.Trq_MaxEngineTab1",0.1},
            {"TrqLimCal.Trq_MaxEngineTab2",0.1},
            {"TrqLimCal.Trq_HysIgnRed",0.1},
            {"TrqLimCal.Trq_BrakeLimit",0.1},
            {"TrqLimCal.Trq_SyncLimit",0.1},
            {"TrqLimCal.n_EngYSP",1.0},
            {"TrqLimCal.Trq_OverBoostTab",0.1},
            {"TrqLimCal.Trq_OverBoostOffset",0.1},
            {"TrqLimCal.Trq_OverBoostRamp",0.1},
            {"TrqLimCal.m_OverBoostLevel",1.0},
            {"TrqLimCal.t_OverBoost",1.0},
            {"TrqLimCal.t_Cooling",1.0},
            {"TrqLimCal.Trq_NoiseRedLim",0.1},
            {"TrqLimCal.Trq_AutNoiseRedLim",0.1},
            {"TrqLimCal.CompressorNoiseYSP",1.0},
            {"TrqLimCal.CompressorNoiseXSP",0.1},
            {"TrqLimCal.Trq_CompressorNoiseRedLimMAP",0.1},
            {"TrqLimCal.X_NoiseRedAccP",0.1},
            {"TrqLimCal.t_NoiseRAt50km",1.0},
            {"TrqLimCal.t_NoiseRedConst",1.0},
            {"TrqLimCal.t_NoiseRedRamp",1.0},
            {"TrqLimCal.v_NoiseRedMax",0.1},
            {"TrqLimCal.v_NoiseRedMin",0.1},
            {"TrqLimCal.T_ExhaustLimTcs",1.0},
            {"TrqLimCal.T_ExhaustLimit",1.0},
            {"TrqLimCal.M_maxColdMAP",0.1},
            {"TrqLimCal.T_engSP",1.0},
            {"TrqLimCal.T_engStartSP",1.0},
            {"TrqLimCal.M_ColdLimHyst",0.1},
            {"TrqLimCal.EnableOverBoost",1.0},
            {"TrqLimCal.ST_EnableTCSTrqReqProt",1.0},
            {"MaxEngSpdCal.T_EngineSP",1.0},
            {"MaxEngSpdCal.n_EngLimTab",1.0},
            {"MaxEngSpdCal.n_EngMin",1.0},
            {"MaxEngSpdCal.n_FuelCutOffset",1.0},
            {"MaxEngSpdCal.n_FuelCutHyst",1.0},
            {"MaxEngSpdCal.K_SteadyLowSpeed",0.01},
            {"MaxEngSpdCal.K_TransLowSpeed",0.01},
            {"MaxEngSpdCal.t_TiSteadyLowSpeed",1.0},
            {"MaxEngSpdCal.t_TiTransLowSpeed",1.0},
            {"MaxEngSpdCal.Trq_Min",0.1},
            {"MaxEngSpdCal.K_SteadyHighSpeed",0.01},
            {"MaxEngSpdCal.K_TransHighSpeed",0.01},
            {"MaxEngSpdCal.t_TiTransHighSpeed",1.0},
            {"MaxEngSpdCal.t_TiSteadyHighSpeed",1.0},
            {"MaxEngSpdCal.n_DerSteadyLimit",1.0},
            {"MaxEngSpdCal.v_SpeedLim",0.1},
            {"MaxEngSpdCal.FilterFac",0.001},
            {"MaxEngSpdCal.K_RampStep",0.01},
            {"NVDMChanged",1.0},
            {"candebug1",1.0},
            {"candebug2",1.0},
            {"candebug3",1.0},
            {"candebug4",1.0},
            {"candebug5",1.0},
            {"obdT_Est.T_HeatTranBl2Air",0.001},
            {"obdT_Est.T_HeatTranBl2HEx",0.001},
            {"obdT_Est.T_HeatTranBl2Rad",0.001},
            {"obdT_Est.Q_HExchanger",0.001},
            {"obdT_Est.Q_Radiator",0.001},
            {"obdT_Est.a1",1.0},
            {"obdT_Est.a3",1.0},
            {"obdT_Est.b1",1.0},
            {"obdT_Est.b3",1.0},
            {"obdT_Est.b4",1.0},
            {"obdT_Est.m_Fuel",1.0},
            {"obdT_Est.m_Air",1.0},
            {"obdT_Est.m_FuelTot",1.0},
            {"obdT_Est.m_AirTot",1.0},
            {"obdT_Est.TEngTemp",0.01},
            {"obdT_Est.TCylTemp",0.1},
            {"obdT_Est.T_Engine",0.01},
            {"obdT_Est.A_Thermostat",1.0},
            {"obdT_Est.ST_ColdStart",1.0},
            {"obdT_Est.ST_ModelUpdated",1.0},
            {"obdTAir.ST_OkStatus",1.0},
            {"obdTAir.ST_FaultCode",1.0},
            {"obdTAir.T_CompareIncrease",1.0},
            {"obdTAir.T_CompareDecrease",1.0},
            {"obdTAir.T_AirInletStart",1.0},
            {"obdTAir.t_Test1LoadLimitTimer",0.1},
            {"obdTAir.t_ActivityTimer",0.1},
            {"obdTAir.t_SpeedLimitTimer",0.1},
            {"obdTAir.t_LoadLimitTimer",0.1},
            {"obdTAir.t_StandStillTimer",0.1},
            {"obdTAir.t_AccLimitTimer",0.1},
            {"obdTAir.t_AccLoadTimer",0.1},
            {"obdTAir.ST_TempChange",1.0},
            {"obdTAir.ST_TimeExpired",1.0},
            {"obdTAir.ST_DrivingCond",1.0},
            {"obdTEng.n_deadCombustion",1.0},
            {"obdTEng.ST_OkStatus",1.0},
            {"obdTEng.ST_FaultCode",1.0},
            {"obdTEng.T_QCDiff",1.0},
            {"obdTEng.T_QCStack",1.0},
            {"obdTEng.T_QCMeanValueStack",1.0},
            {"obdTEng.t_lowLoadDead",0.1},
            {"obdTEng.t_highLoadDead",0.1},
            {"obdTEng.ST_TempChange",1.0},
            {"obdTEng.ST_mLowOK",1.0},
            {"obdTEng.ST_mHighOK",1.0},
            {"obdTEng.ST_ColdStart",1.0},
            {"obdTEng.ST_IgnOnTestDead",1.0},
            {"TempSensorSampleBuffer",0.1},
            {"TempEstimateSampleBuffer",0.1},
            {"obdTCool.T_Diff",0.0078125},
            {"obdTCool.ST_OkStatus",1.0},
            {"obdTCool.ST_FaultCode",1.0},
            {"obdTCool.T_MeanResult",1.0},
            {"obdTCool.T_ErrMin",1.0},
            {"obdTCool.T_DiffLimpVSReal",1.0},
            {"obdTCool.T_EngineLowest",1.0},
            {"obdTCool.N_Samples",1.0},
            {"obdTCool.t_HighSpeed",0.1},
            {"obdTCool.t_IdlePercent",0.1},
            {"obdTCool.t_FuelCutPercent",0.1},
            {"obdTCool.t_AtLowestEngineTemp",0.1},
            {"obdTCool.t_DiagRun",0.1},
            {"obdTCool.X_IdlePercent",1.0},
            {"obdTCool.X_FuelCut",1.0},
            {"obdTCool.ST_BreakPreCond",1.0},
            {"obdTCool.ST_BlkHeatStart",1.0},
            {"obdTEngDev.ST_OkStatus",1.0},
            {"obdTEngDev.ST_FaultCode",1.0},
            {"obdTEngDev.N_Samples",1.0},
            {"obdTEngDev.LinearCoef",1.0},
            {"obdTEngDev.MeanLinearRes",1.0},
            {"obdTEngDev.OffsetCoef",1.0},
            {"obdTEngDev.MeanOffsetRes",1.0},
            {"obdTEngDev.ST_LinearOffsetDone",1.0},
            {"obdTEngDev.N_BufSamples",1.0},
            {"obdHSCR.ST_OkStatus",1.0},
            {"obdHSCR.ST_FaultCode",1.0},
            {"obdHSCR.T_EngineStart",1.0},
            {"obdHSCR.ST_BlkHeatStart",1.0},
            {"obdHSCR.ST_EngStartTempStd",1.0},
            {"obdHSCR.ST_DiagState",1.0},
            {"obdLSCR.ST_OkStatus",1.0},
            {"obdLSCR.ST_FaultCode",1.0},
            {"obdLSCR.t_HighSpeed",0.1},
            {"obdLSCR.t_IdlePercent",0.1},
            {"obdLSCR.t_FuelCutPercent",0.1},
            {"obdLSCR.t_OKCond",0.1},
            {"obdLSCR.X_IdlePercent",1.0},
            {"obdLSCR.X_FuelCut",1.0},
            {"obdLSCR.ST_BreakPreCond",1.0},
            {"AirCtrlCal.t_ActualPresBefThr",1.0},
            {"AirCtrlCal.t_IpartUpdate",1.0},
            {"AirCtrlCal.p_ThrRatioSP",0.001},
            {"AirCtrlCal.ThrFlowFacTAB",1.0},
            {"AirCtrlCal.T_AirInletSP",1.0},
            {"AirCtrlCal.ThrTempFacTAB",1.0},
            {"AirCtrlCal.p_ReqDelFzILim",0.1},
            {"AirCtrlCal.m_ReqDeltaFzILim",1.0},
            {"AirCtrlCal.t_HoldFzI",1.0},
            {"AirCtrlCal.N_pBefCalcBuffDiff",1.0},
            {"AirCtrlCal.t_thrlag",1.0},
            {"AirCtrlCal.p_diffThrotSP",0.1},
            {"AirCtrlCal.Ppart_BoostAirM1TAB",0.01},
            {"AirCtrlCal.p_AirAmbientXSP",0.1},
            {"AirCtrlCal.m_AirBasicPressureMAP",1.0},
            {"AirCtrlCal.Ppart_BoostMap",0.01},
            {"AirCtrlCal.Ipart_BoostMap",0.01},
            {"AirCtrlCal.Dpart_BoostMap",0.01},
            {"AirCtrlCal.PIDXSP",1.0},
            {"AirCtrlCal.PIDYSP",1.0},
            {"AirCtrlCal.Ipart_BoostCoAirM1",0.01},
            {"AirCtrlCal.m_IFacMax",1.0},
            {"AirCtrlCal.FilterFactor",1.0},
            {"AirCtrlCal.n_EngYSP",1.0},
            {"AirCtrlCal.Hysteres",1.0},
            {"AirCtrlCal.SetLoadXSP",1.0},
            {"AirCtrlCal.RegMap",0.1},
            {"AirCtrlCal.VehicleSpeedLim",0.1},
            {"AirCtrlCal.m_RequestLim",1.0},
            {"AirCtrlCal.p_diffReqMAP",0.1},
            {"AirCtrlCal.m_diffPReqXSP",1.0},
            {"AirCtrlCal.K_loss",1.0},
            {"AirCtrlCal.K_loss_exhaust",1.0},
            {"AirCtrlCal.q_AirInletSP",0.01},
            {"AirCtrlCal.PRatioMaxTab",0.01},
            {"AirCtrlCal.k_Coeff",1.0},
            {"AirCtrlCal.m_deltahyst",1.0},
            {"AirCtrlCal.X_IPartThrConst",0.78125},
            {"AirCtrlCal.p_DiffMinThr",0.1},
            {"AirCtrlCal.p_DiffMinBoost",0.1},
            {"AirCtrlCal.p_DiffHysteresis",0.1},
            {"AirCtrlCal.I_PartThrLimSp",1.0},
            {"AirCtrlCal.m_IPartThrLimNegTab",0.0078125},
            {"AirCtrlCal.m_IPartThrLimPosTab",0.0078125},
            {"AirCtrlCal.T_AirInletYSP",1.0},
            {"AirCtrlCal.m_AirInletXSP",1.0},
            {"AirCtrlCal.m_AirBoostTempOffsMAP",1.0},
            {"AirCtrlCal.p_AfterTurbineXSP",0.1},
            {"AirCtrlCal.p_AirAmbientYSP",0.1},
            {"AirCtrlCal.m_AirBoostHighAltOffsMAP",1.0},
            {"AirCtrlCal.m_AirCtrlDFacTAB",1.0},
            {"AirCtrlCal.m_AirCtrlDFacSP",1.0},
            {"AirCtrlCal.p_ThrRaTriggFilter",0.001},
            {"AirCtrlCal.f_filterThrPRatio",0.1},
            {"AirCtrlCal.T_AirInletSP2",1.0},
            {"AirCtrlCal.BasicPresTempCompTAB",0.0078125},
            {"AirCtrlCal.p_AirInletDeltaThrCtrl",0.1},
            {"AirCtrlCal.t_AirInletDeltaThrCtrl",1.0},
            {"AirCtrlCal.m_ReqDerivataLimit",1.0},
            {"AirCtrlCal.t_IpartAdap",0.001},
            {"AirCtrlCal.T_EngIpartAdapLim",1.0},
            {"AirCtrlCal.m_ReqAdapXSP",1.0},
            {"AirCtrlCal.n_EngAdapYSP",1.0},
            {"AirCtrlCal.X_AdapFactor",0.78125},
            {"AirCtrlCal.m_IpartThrMaxMAP",0.0078125},
            {"AirCtrlCal.ST_BoostEnable",1.0},
            {"AreaCal.Area",0.1},
            {"AreaCal.Table",1.0},
            {"AreaCal.TableVenturi",1.0},
            {"AreaCal.Cd_DischargeMAP",0.0009765625},
            {"AreaCal.n_EngineSP",1.0},
            {"AreaCal.m_AirInletSP",1.0},
            {"AreaAdapCal.T_EngLowLim",1.0},
            {"AreaAdapCal.t_inWindow",0.001},
            {"AreaAdapCal.m_IpartThrLimitNormal",1.0},
            {"AreaAdapCal.m_IpartThrLimitForced",1.0},
            {"AreaAdapCal.IpartAreaRatioNormal",1.0},
            {"AreaAdapCal.IpartAreaRatioForced",1.0},
            {"AreaAdapCal.A_adapMax",0.1},
            {"AreaAdapCal.ST_enable",1.0},
            {"VenturiCal.n_NominalTAB",1.0},
            {"VenturiCal.p_AirAmbientSP",0.1},
            {"VenturiCal.ST_VenturiExist",1.0},
            {"GlobDataCal.t_gearShAct",1.0},
            {"GlobDataCal.n_EngfiltLim",1.0},
            {"GlobDataCal.f_filtC_NoGearShift",0.1},
            {"GlobDataCal.f_filtC_GearShift",0.1},
            {"InjAnglCal.T_LimitFix",1.0},
            {"InjAnglCal.fi_InjNoSync",1.0},
            {"InjAnglCal.fi_InjFixed",1.0},
            {"InjAnglCal.AirXSP",1.0},
            {"InjAnglCal.RpmYSP",1.0},
            {"InjAnglCal.Map",0.1},
            {"InjAnglCal.T_LimRamped",1.0},
            {"InjAnglCal.fi_InjRampStart",1.0},
            {"InjAnglCal.fi_InjRampDecr",1.0},
            {"InjAnglCal.X_InjAnglRampTab",1.0},
            {"InjAnglCal.T_EngineSP",1.0},
            {"InjAnglCal.ST_FixedAngle",1.0},
            {"InjAnglCal.ST_InjAnglRamp",1.0},
            {"obdGenFCtrl.tempFilteredFDutyCycle",1.0},
            {"obdGenFCtrl.ST_OkStatus",1.0},
            {"obdGenFCtrl.ST_FaultCode",1.0},
            {"obdGenFCtrl.X_FilteredFTermDutyCycle",0.1},
            {"obdGenLCtrl.ST_OkStatus",1.0},
            {"obdGenLCtrl.ST_FaultCode",1.0},
            {"obdGenLCtrl.ST_firstTime",1.0},
            {"obdGenLCtrl.ST_StableCond",1.0},
            {"obdFan1Ctrl.ST_OkStatus",1.0},
            {"obdFan1Ctrl.ST_FaultCode",1.0},
            {"obdFan2Ctrl.ST_OkStatus",1.0},
            {"obdFan2Ctrl.ST_FaultCode",1.0},
            {"obdFan3Ctrl.ST_OkStatus",1.0},
            {"obdFan3Ctrl.ST_FaultCode",1.0},
            {"MAFProt.X_rgAct",0.0009765625},
            {"MAFProt.X_rgRef",0.0009765625},
            {"MAFProt.t_delta",1.0},
            {"MAFProt.OrgFrompAddFac",1.0},
            {"MAFProt.t_TDC_TDC_Filt",1.0},
            {"MAFProt.T_Diff",1.0},
            {"MAFProt.X_DecreaseStep",1.0},
            {"MAFProt.X_IncreaseStep",1.0},
            {"MAFProt.t_NegTransFreezMain",1.0},
            {"MAFProt.t_PosTransFreezMain",1.0},
            {"MAFProt.m_AirFromp_AirInletPred",1.0},
            {"MAFProt.m_AirFromp_AirInletFuel",1.0},
            {"MAFProt.A_Throttle",0.1},
            {"MAFProt.A_ThrottlePrev",0.1},
            {"MAFProt.A_ThrottleDeltaRaw",0.1},
            {"MAFProt.A_ThrottleDeltaRawPrev",0.1},
            {"MAFProt.A_ThrottleDeltaFilt",0.1},
            {"MAFProt.X_Cman",1.0},
            {"MAFProt.Q_AirFromArea",0.01},
            {"MAFProt.Q_AirDiff",0.01},
            {"MAFProt.p_AirInletPredFac2",0.1},
            {"MAFProt.p_AirInletPredFac3",0.1},
            {"MAFProt.p_AirInletPred",0.1},
            {"MAFProt.p_AirInletPredPrev",0.1},
            {"MAFProt.p_AirInletReq",0.1},
            {"MAFProt.p_AirInletReqPrev",0.1},
            {"MAFProt.p_AirInletBuffer",0.1},
            {"MAFProt.p_DeltaInletXComb",0.1},
            {"MAFProt.p_DeltaInletXCombFuel",0.1},
            {"MAFProt.p_AirInletPredBuffer",0.1},
            {"MAFProt.p_DeltaInletPredXComb",0.1},
            {"MAFProt.FrompAdapAddOffs",0.0078125},
            {"MAFProt.WeightFactorMain",1.0},
            {"MAFProt.ST_NegTrans",1.0},
            {"MAFProt.ST_PosTrans",1.0},
            {"MAFProt.ST_Transient",1.0},
            {"MAFProt.NormAdjustFac",0.0078125},
            {"MAFProt.X_pAirInletPredNew",1.0},
            {"MAFProt.X_pAirInletPredOld",1.0},
            {"MAFProt.T_EngineFactor",1.0},
            {"MAFProt.X_pAirInletNew",1.0},
            {"MAFProt.X_pAirInletOld",1.0},
            {"MAFProt.ST_UseFromp",1.0},
            {"MAFProt.ST_BrakeRpmCtrl",1.0},
            {"MAFProt.ST_pAirInletBufferInitialized",1.0},
            {"MAFProt.ST_pAirInletPredBufferInitialized",1.0},
            {"FrompAdapProt.t_Timer",1.0},
            {"FrompAdapProt.m_AirFrompError",0.0078125},
            {"FrompAdapProt.t_inWindow",0.001},
            {"FrompAdapProt.ST_inAdapMAP",1.0},
            {"FrompAdapProt.ST_Allow",1.0},
            {"MAF.X_rgRatio",0.0009765625},
            {"MAF.T_InletPort",1.0},
            {"MAF.Q_AirInlet",0.01},
            {"MAF.Q_AirInletNorm",0.01},
            {"MAF.Q_AirInletNormHFM",0.01},
            {"MAF.m_AirInlet",1.0},
            {"MAF.m_AirInletDelta_100ms",1.0},
            {"MAF.m_AirInletHFM",1.0},
            {"MAF.m_AirInletFuel",1.0},
            {"MAF.m_AirFromp_AirInlet",1.0},
            {"MAF.m_AirFromp_AirInletUC",1.0},
            {"MAF.AirInletFuelDelta",1.0},
            {"MAF.Q_AirFromp_AirInlet",0.01},
            {"MAF.Q_AirFromp_AirInlet_NoAdap",0.01},
            {"MAF.FrompMulFacFixedRpm",1.0},
            {"MAF.FrompMulFac",1.0},
            {"MAF.FrompAddFacFixedRpm",1.0},
            {"MAF.FrompAddFac",1.0},
            {"MAF.K_FrompTAirinlet",1.0},
            {"MAF.K_FrompTEngine",1.0},
            {"MAF.m_AirInletNormHFM",1.0},
            {"MAF.p_AirInlet",0.1},
            {"MAF.p_DeltaInlet",0.1},
            {"MAF.p_reqDelta",0.1},
            {"MAF.p_AirInletDelta_100ms",0.1},
            {"MAF.p_ThrottleRatio",0.01},
            {"MAF.WeightFactorFuel",1.0},
            {"MAF.n_StartCombOnFromp",1.0},
            {"ETC5VCal.t_OOR1_ContFail",1.0},
            {"ETC5VCal.t_OOR2_ContFail",1.0},
            {"ETC5VCal.c_OOR1_Smpl",1.0},
            {"ETC5VCal.c_OOR2_Smpl",1.0},
            {"ETC5VCal.c_OOR1_Fail",1.0},
            {"ETC5VCal.c_OOR2_Fail",1.0},
            {"VehicleSpeedProt.t_RollingCountResetOccured",1.0},
            {"VehicleSpeed.l_RearLeftWheelDistance",1.0},
            {"VehicleSpeed.l_RearRightWheelDistance",1.0},
            {"VehicleSpeed.n_WhAngVlcFMean",1.0},
            {"VehicleSpeed.ST_RollingCountResetOccured",1.0},
            {"VehicleSpeed.ST_BigFrWhlDiff",1.0},
            {"obdIOT.ST_OkStatus",1.0},
            {"obdIOT.ST_FaultCode",1.0},
            {"obdIOT.ST_RunCondition",1.0},
            {"obdIOT.ST_State",1.0},
            {"obdIOT.ST_EngineHasRun",1.0},
            {"obdIOT.t_IOTAtStart",1.0},
            {"obdIOT.t_IOTDiff",1.0},
            {"obdIOT.t_100msCounterAtStart",0.1},
            {"obdIOT.t_100msCounterDiff",0.1},
            {"FMastAdap.V_FuelConsumed",1.0},
            {"FMastAdap.ST_EnableLambdaCalc",1.0},
            {"FuelAdapProt.t_adapStamp",1.0},
            {"FuelAdapProt.t_AfterCloop",0.001},
            {"FuelAdapProt.t_purgeTimer",0.1},
            {"FuelAdapProt.t_fuelAdapTimer",0.1},
            {"FuelAdapProt.t_BOFFTimer",0.1},
            {"FuelAdapProt.t_purgeTime",0.1},
            {"FuelAdapProt.t_adapDiagCounter",0.1},
            {"FuelAdapProt.t_EngineStarted",1.0},
            {"FuelAdapProt.n_delta",1.0},
            {"FuelAdapProt.X_FuelMap",0.01},
            {"FuelAdapProt.ST_subState",1.0},
            {"FuelAdapProt.ST_InAdapMap",1.0},
            {"FuelAdapProt.ST_jumpBackState",1.0},
            {"FuelAdapProt.ST_Stable",1.0},
            {"FuelAdap.FuelFac",0.0009765625},
            {"FuelAdap.ST_PurgeAllow",1.0},
            {"FuelAdap.ST_FirstIdleAdapt",1.0},
            {"FuelAdap.ST_FirstHighSpeedAdapt",1.0},
            {"FuelAdap.ST_State",1.0},
            {"obdEOL.ST_OkStatus",1.0},
            {"obdEOL.ST_FaultCode",1.0},
            {"SyncProt.LastCyl",1.0},
            {"SyncProt.DetectOkComb",1.0},
            {"SyncProt.DetectOkCnt",1.0},
            {"Sync.n_SyncDelay",1.0},
            {"Sync.EngineCycleMode",1.0},
            {"Sync.ST_DiagCommand",1.0},
            {"Sync.FaultCylinder",1.0},
            {"Sync.TempFaultCylinder",1.0},
            {"Sync.ST_Detect",1.0},
            {"Sync.N_FaultCylCount",1.0},
            {"Sync.ST_Detect1Cnt",1.0},
            {"Sync.ST_Detect2Cnt",1.0},
            {"Sync.ST_Detect1Cnt1",1.0},
            {"Sync.ST_Detect1Cnt2",1.0},
            {"Sync.ST_Detect1Cnt3",1.0},
            {"Sync.ST_Detect1Cnt4",1.0},
            {"Sync.ST_Detect2Cnt1",1.0},
            {"Sync.ST_Detect2Cnt2",1.0},
            {"Sync.ST_Detect2Cnt3",1.0},
            {"Sync.ST_Detect2Cnt4",1.0},
            {"obdCat.N_startSwitchCount",1.0},
            {"obdCat.t_Ph3Timer",1.0},
            {"obdCat.t_Phase3",1.0},
            {"obdCat.sumOfLambdaInt",1.0},
            {"obdCat.phase3TimeResult",1.0},
            {"obdCat.t_Phase2",1.0},
            {"obdCat.t_closedThrot",0.1},
            {"obdCat.t_Ph2Max",1.0},
            {"obdCat.t_Ph3Max",1.0},
            {"obdCat.ST_OkStatus",1.0},
            {"obdCat.ST_FaultCode",1.0},
            {"obdCat.actualFuelFac",0.0009765625},
            {"obdCat.Q_Av",0.01},
            {"obdCat.deltaFlow",0.01},
            {"obdCat.T_Catalyst",1.0},
            {"obdCat.LambdaIntMeanValue",0.01},
            {"obdCat.N_FuelCut",1.0},
            {"obdCat.FuelFacRamp",0.0009765625},
            {"obdCat.LambdaMeanDiff",0.01},
            {"obdCat.LastLambdaMeanValue",0.01},
            {"obdCat.LastLambdaMeanValueNotZeroed",0.01},
            {"obdCat.CatTempMulFac",0.0009765625},
            {"obdCat.LoadMulFac",0.0009765625},
            {"obdCat.n_Samples",1.0},
            {"obdCat.Trq_ReqCatDiag",0.1},
            {"obdCat.Trq_ResCatDiag",0.1},
            {"obdCat.ST_CatDiag",1.0},
            {"obdCat.N_LambdaSwitches",1.0},
            {"obdCat.ST_Active",1.0},
            {"obdCat.N_DiagHasPerformed",1.0},
            {"obdCat.ST_BreakPreCondition",1.0},
            {"obdCat.ST_BreakCondDurTest1",1.0},
            {"obdCat.ST_BreakCondDurTest2",1.0},
            {"obdCat.ST_BreakCondDurTest3",1.0},
            {"obdCat.N_BrakeLightActivated",1.0},
            {"obdCat.N_FailedDiagHasPerformed",1.0},
            {"obdCat.ST_ModifyLambdaScaleFactor",1.0},
            {"obdCat.ST_CalculateLambdaMean",1.0},
            {"obdCat.closedLoopStopped",1.0},
            {"obdCat.CatalystST_NoAjustForRearO2Sensor",1.0},
            {"obdCat.stopPurge",1.0},
            {"obdCat.requestedElevIdle",1.0},
            {"obdCat.ST_LeaveFirstPhase",1.0},
            {"obdCat.ST_DiagPrevRestOfDrvCycle",1.0},
            {"obdCat.ST_LeanInThirdPhase",1.0},
            {"CatModProt.t_FCutDelay",1.0},
            {"CatModProt.T_Catalyst",1.0},
            {"CatModProt.T_CatalystUnfilt",1.0},
            {"CatModProt.T_LambdaOffset",1.0},
            {"CatModProt.T_LambdaOffsetFilt",1.0},
            {"CatModProt.T_FCutOffsetFilt",1.0},
            {"CatModProt.T_CatalystPreFilt",1.0},
            {"CatModProt.T_CatSteadyState",1.0},
            {"CatModProt.T_Start",1.0},
            {"CatModProt.m_AirInletFilt",1.0},
            {"CatModProt.Q_AirInletFilt",0.01},
            {"CatModProt.QAirAccRatio",0.01},
            {"CatModProt.LoadFilterCoef",0.0001},
            {"CatModProt.QAirAccumulated",1.0},
            {"CatModProt.QAirAccMin",1.0},
            {"CatModProt.FuelFac",0.0009765625},
            {"CatModProt.TSoakWeightFac",0.0078125},
            {"CatModProt.QAccWeightFac",0.0078125},
            {"CatModProt.TEngineWeightFac",0.0078125},
            {"CatModProt.QCorrFac",0.0078125},
            {"CatModProt.ST_UseFCutOffset",1.0},
            {"CatModProt.WarmingUpFactor",0.0078125},
            {"hsmaf_freq",1.0},
            {"MCPReadPid.CurrentPid",1.0},
            {"MCPReadPid.Value",1.0},
            {"MCPReadPid.PrioCount",1.0},
            {"MCPReadPid.ActivateRead",1.0},
            {"MCPReadPid.ValueHasBeenRead",1.0},
            {"MCPReadPid.Stored",1.0},
            {"MCPCom.c_ChksumError",1.0},
            {"MCPCom.c_NoNewDataError",1.0},
            {"MCPCom.c_BufferOverrunError",1.0},
            {"MCPCom.c_SerComContFail",1.0},
            {"MCPCom.c_SerComFail",1.0},
            {"MCPCom.c_SerComSmpl",1.0},
            {"MCPCom.c_MCPClearCode",1.0},
            {"MCPCom.MCP_Test_ID",1.0},
            {"MCPCom.ST_CodeClrOccrd",1.0},
            {"MCPCom.ST_SerComErr",1.0},
            {"MCPCom.ST_SerComContFlt",1.0},
            {"MCPCom.ST_SerComFlt",1.0},
            {"MCPCom.ST_RxMsgErrChksum",1.0},
            {"MCPCom.ST_RxMsgErrPrev",1.0},
            {"MCPCom.ST_RxMsgErrProtocol",1.0},
            {"MCPCom.ST_ValidRxMsgSinceInit",1.0},
            {"MCPCom.ST_ValidRxMsg",1.0},
            {"MCPCom.ST_ValidRxMsgSinceTx",1.0},
            {"MCPCom.MessageType",1.0},
            {"MCPCom.MessageID",1.0},
            {"MCPCom.MessageTypePrev",1.0},
            {"MCPCom.MessageIDPrev",1.0},
            {"MCPCom.ST_TransmitFailed",1.0},
            {"MCPCom.ST_ClearMainFaults",1.0},
            {"FFTrqProt.Trq_MaxEngineBefComp",0.1},
            {"FFTrqProt.Trq_MaxEngine",0.1},
            {"FFTrqProt.M_maxBefComp",0.1},
            {"FFTrqProt.M_max",0.1},
            {"FFTrqProt.fi_highNormDiff",0.1},
            {"FFTrqProt.fraction",0.0009765625},
            {"FFTrqProt.fi_act_NormDiff",0.1},
            {"FFTrqProt.fi_act",0.1},
            {"FFTrqProt.M_torque",0.1},
            {"FFTrqProt.M_torqueBefComp",0.1},
            {"FFTrqProt.X_torque",0.0078125},
            {"FFTrqProt.X_torqueCold",0.0078125},
            {"FFFuelAdap.X_blendCalc",0.1},
            {"FFFuelAdap.X_blend",0.1},
            {"obdColdStart.t_fiDiffOk",1.0},
            {"obdColdStart.t_fiDiffLow",1.0},
            {"obdColdStart.t_RpmOk",1.0},
            {"obdColdStart.t_RpmLow",1.0},
            {"obdColdStart.t_DeltaLoadOk",1.0},
            {"obdColdStart.fi_Diff",0.1},
            {"obdColdStart.fi_DiffIdle",0.1},
            {"obdColdStart.ST_OkStatus",1.0},
            {"obdColdStart.ST_FaultCode",1.0},
            {"obdColdStart.m_DeltaLoad",1.0},
            {"obdColdStart.ST_FaultFlags",1.0},
            {"obdColdStart.ST_OKFlags",1.0},
            {"obdColdStart.ST_RpmEvalDone",1.0},
            {"obdColdStart.ST_fiDiffEvalDone",1.0},
            {"obdColdStart.ST_DiagComplete",1.0},
            {"AirMassMastProt.Trq_RequestAir",0.1},
            {"AirMassMastProt.m_Driver",1.0},
            {"AirMassMastProt.m_AirBeforeLimitation",1.0},
            {"AirMassMastProt.Q_Air",0.01},
            {"AirMassMastProt.ST_ActiveAirFunction",1.0},
            {"AirMassMast.m_Low",1.0},
            {"AirMassMast.m_High",1.0},
            {"AirMassMast.m_AirMBT",1.0},
            {"AirMassMast.m_Request",1.0},
            {"AirMassMast.Q_AirStart",0.01},
            {"SystemActionCal.Trq_LimReqHigh",0.1},
            {"SystemActionCal.Trq_LimReqLow",0.1},
            {"SystemActionCal.BefThrOffsetMAP",0.1},
            {"SystemActionCal.A_ThrottleXSP",0.1},
            {"SystemActionCal.m_AirInletYSP",1.0},
            {"SystemActionCal.ThrottleFilterConst",1.0},
            {"SystemActionCal.t_FaultyP_AC",0.001},
            {"SystemActionCal.PwrLimFanMAP",0.1},
            {"SystemActionCal.v_VehicleXSP",0.1},
            {"SystemActionCal.T_AirInletYSP",1.0},
            {"SystemActionCal.n_FaultyFanDrive2",1.0},
            {"SystemActionCal.n_FaultyFanDrive3",1.0},
            {"SystemActionCal.n_EngDfltFlowSP",1.0},
            {"SystemActionCal.Q_ThrotDfltFlowTAB",0.01},
            {"ACCompProt.t_ACOff",1.0},
            {"ACCompProt.t_RampStart",1.0},
            {"ACCompProt.t_RampOffDynStart",1.0},
            {"ACCompProt.t_DynPartOnTimer",1.0},
            {"ACCompProt.Trq_ReqStatic",0.1},
            {"ACCompProt.Trq_ReqDynamic",0.1},
            {"ACCompProt.Trq_HoldDynamic",0.1},
            {"ACCompProt.Trq_RequestDynRamped",0.1},
            {"ACCompProt.t_RampTimer",1.0},
            {"ACCompProt.ST_InitialLoadCompRead",1.0},
            {"ACCompProt.ST_ACTurnOffInitiated",1.0},
            {"ACCompProt.ST_ACReq",1.0},
            {"ACCompProt.ST_ACExTrqDem",1.0},
            {"ACCompProt.ST_ACCrankDone",1.0},
            {"ACCompProt.ST_RampOffDynPart",1.0},
            {"ACCompProt.CMD_ACRelay",1.0},
            {"ACCompProt.ST_RampingUpTrqReserve",1.0},
            {"ACCompProt.ST_InitDynamicCompRampDown",1.0},
            {"ACCompProt.ST_HoldDynamicComp",1.0},
            {"ACComp.Trq_Request",0.1},
            {"ACComp.Trq_ResRequest",0.1},
            {"ACComp.ST_AC_ReqAck",1.0},
            {"ACComp.ST_DelayResIgn",1.0},
            {"RMProt.PendingDTC",1.0},
            {"RMProt.t_EnableCond1Timer",0.1},
            {"RMProt.t_EnableCond2Timer",0.1},
            {"RMProt.t_EnableCond3Timer",0.1},
            {"RMProt.t_EnableCond4Timer",0.1},
            {"RMProt.t_EnableCond6Timer",0.1},
            {"RMProt.ST_EnableCond1Den",1.0},
            {"RMProt.ST_EnableCond2Den",1.0},
            {"RMProt.ST_EnableCond3Den",1.0},
            {"RMProt.ST_EnableCond4Den",1.0},
            {"RMProt.ST_EnableCond5Den",1.0},
            {"RMProt.ST_EnableCond6Den",1.0},
            {"RMProt.ST_DisableCriteria1",1.0},
            {"FFBoffCal.ST_enable",1.0},
            {"FFBoffCal.m_accFuelLimit",0.01},
            {"FFBoffCal.T_engLimit",1.0},
            {"FFBoffCal.Q_fuelConstRateMAP",1.0},
            {"FFBoffCal.n_eng3SP",1.0},
            {"FFBoffCal.p_diff6SP",0.1},
            {"FFBoffCal.t_constRateTime",0.1},
            {"FFBoffCal.t_engWarmTime",1.0},
            {"FFBoffCal.X_constRateLowLim",0.0009765625},
            {"FFBoffCal.lambdaIntMin",0.01},
            {"FFBoffCal.lambdaIntMax",0.01},
            {"FFBoffCal.Q_airLimit",0.01},
            {"FFBoffCal.t_SoakMin5SP",0.1},
            {"FFBoffCal.T_eng4SP",1.0},
            {"FFBoffCal.X_blendAdjustBoff",0.0078125},
            {"FFBoffCal.X_cRateIntFacLean",0.0078125},
            {"FFBoffCal.X_cRateIntFacRich",0.0078125},
            {"FFBoffCal.X_cRateEngOffMAP",0.0078125},
            {"CkFlrCapProt.ST_CkFlrCapBefMaxDCY",1.0},
            {"CkFlrCapProt.ST_N_DCYWithCkFlrCapOnUpdated",1.0},
            {"CkFlrCapProt.ST_BigLeakDetectedThisDCY",1.0},
            {"CkFlrCapProt.ST_resetAtClearFaultPending",1.0},
            {"CkFlrCapProt.ST_fmSmallDetected",1.0},
            {"CkFlrCapProt.ST_fmOkDetected",1.0},
            {"CkFlrCapProt.ST_fmRefuelDetected",1.0},
            {"CkFlrCapIn.ST_SmallLeakDetected",1.0},
            {"CkFlrCapIn.ST_BigLeakDetected",1.0},
            {"CkFlrCapIn.ST_OkDetected",1.0},
            {"CkFlrCapIn.ST_RefuelDetected",1.0},
            {"CkFlrCapOut.ST_CkFlrCap",1.0},
            {"PCFSProt.t_shutoffWait",0.1},
            {"PCFSProt.t_High_v_vehicleTimer",0.1},
            {"PCFSProt.State",1.0},
            {"PCFSProt.ST_AirbgDpl_Latched",1.0},
            {"PCFS.ST_DisableFuelPump",1.0},
            {"PCFS.ST_DisableInjectors",1.0},
            {"CoolFanProt.s10CounterMark",0.1},
            {"CoolFanProt.t_ChgOfFanSpdStamp",0.1},
            {"CoolFanProt.t_delayChgOfFanSpdStamp",0.1},
            {"CoolFanProt.t_AfterRunCounter",0.1},
            {"CoolFanProt.t_AfterRun",0.1},
            {"CoolFanProt.Fan_Command",0.1},
            {"CoolFanProt.Fan_Required_T_Engine",0.1},
            {"CoolFanProt.Fan_Required_AC",0.1},
            {"CoolFanProt.Fan_Required_T_TrnOil",0.1},
            {"CoolFanProt.Fan_Required_T_EngOil",0.1},
            {"CoolFanProt.Fan_Required",0.1},
            {"CoolFanProt.T_EngAfterRunStart",1.0},
            {"CoolFanProt.T_Highest",1.0},
            {"CoolFanProt.target_FanSpeed",1.0},
            {"CoolFanProt.actual_FanSpeed",1.0},
            {"CoolFanProt.ST_AfterRunReq",1.0},
            {"CoolFanProt.ST_changeFanSpeedDirectly",1.0},
            {"CoolFanProt.ST_AfterRunActive",1.0},
            {"CoolFan.ST_Fan_Request",1.0},
            {"CoolFan.ST_Fan_Request_Adjust",1.0},
            {"CoolFan.AC_OffTempHi",1.0},
            {"CoolFan.ST_fanSpeedChangeWaiting",1.0},
            {"CoolFan.ST_ActualFan",1.0},
            {"MxVhSpdProt.v_Vehicle",0.1},
            {"MxVhSpd.Trq_Limitation",0.1},
            {"MxVhSpd.v_Max",0.1},
            {"StartEngCal.n_CombOnFromp",1.0},
            {"StartEngCal.t_flareRpmPeak",1.0},
            {"StartEngCal.T_EngineXSP",1.0},
            {"StartEngCal.p_AirAmbientYSP",0.1},
            {"StartEngCal.Q_AirStartOffsetAutMAP",0.01},
            {"StartEngCal.Q_AirStartOffsetManMAP",0.01},
            {"StartEngCal.Q_StartOffsRamp",0.01},
            {"StartEngCal.t_delayBefQ_StartOffRed",1.0},
            {"StartEngCal.n_EngDerMaxAirMode1to0",1.0},
            {"StartEngCal.Q_SAM1toSAM0StepSize",0.01},
            {"StartEngCal.ST_CarryStartOffsToSAM0",1.0},
            {"In.r_WhlRotLNDrRC",1.0},
            {"In.r_WhlRotRNDrRC",1.0},
            {"In.v_Vehicle2",0.1},
            {"In.M_TCTrqRqVal",1.0},
            {"In.Cnt_TCTrqRqProt",1.0},
            {"In.M_TrnTrqRqVal",1.0},
            {"In.T_TrnOilTmp",1.0},
            {"In.n_TrnTrbAngVl",1.0},
            {"In.TrnEmRelDTC_CdNm",1.0},
            {"In.n_WhAngVlcFL",1.0},
            {"In.n_WhAngVlcFR",1.0},
            {"In.n_WhAngVlcRL",1.0},
            {"In.n_WhAngVlcRR",1.0},
            {"In.T_OtsAirTmpCrVal",1.0},
            {"In.T_OtSdTmpHiRes",1.0},
            {"In.ST_ManTrnRvsGrAtv",1.0},
            {"In.ST_SysPwrMd",1.0},
            {"In.X_EngCoolFanSpdAdj",1.0},
            {"In.ST_VehDynCntAtv",1.0},
            {"In.ST_ABSAtv",1.0},
            {"In.ST_WhSpdSnsDgnCmp",1.0},
            {"In.ST_EngyMgtMinIdlBstLvlRq",1.0},
            {"In.ST_CrsCntCncRq",1.0},
            {"In.ST_CrsCntOnSwAtv",1.0},
            {"In.ST_CrsCntRsmSwAtv",1.0},
            {"In.ST_CrsCntSetSwAtv",1.0},
            {"In.ST_CrsCntSwFld",1.0},
            {"In.Cnt_CrsCntlAliveRC",1.0},
            {"In.ST_CrusCntSwProt",1.0},
            {"In.Cnt_TCAliveRC",1.0},
            {"In.ST_TCSysAtv",1.0},
            {"In.ST_TCSysEnbld",1.0},
            {"In.ST_TCTrqIntvTyp",1.0},
            {"In.ST_TCTrqRdnRlzSg",1.0},
            {"In.X_TrnActGr",1.0},
            {"In.X_TrnGrSlctrPos",1.0},
            {"In.ST_TrnGrShftDir",1.0},
            {"In.ST_TrnTrqIntvTyp",1.0},
            {"In.ST_TrnTrqRdnRlzSg",1.0},
            {"In.ST_TrnTrqCnvCltSt",1.0},
            {"In.ST_TrnEmsMlfAtv",1.0},
            {"In.ST_TrnNtrlCntMdAtv",1.0},
            {"In.ST_TrnWrmUpShftPtrn",1.0},
            {"In.ST_ThrtlPrgrsnReq",1.0},
            {"In.ST_TrnWntrShPtSt",1.0},
            {"In.ST_TrnFrzFrStrRq",1.0},
            {"In.ST_TrnEmRelDTC_Str",1.0},
            {"In.TrnEmRelDTC_SysDes",1.0},
            {"In.ST_ACCmCltRq",1.0},
            {"In.M_ACCmTrqAct",1.0},
            {"In.ST_FrntECVDA",1.0},
            {"In.ST_BdyVDA",1.0},
            {"In.ST_ClimCntlVDA",1.0},
            {"In.ST_DrInfDisVDA",1.0},
            {"In.ST_EngOilLfRstRq",1.0},
            {"In.ST_EngyMgtMinIdlBs",1.0},
            {"In.ST_TrnCstLmSlpRq",1.0},
            {"In.ST_WhlRtLNDrRCRsOc",1.0},
            {"In.ST_WhlRtRNDrRCRsOc",1.0},
            {"In.ST_TrnTpUp_TpDwnMd",1.0},
            {"In.ST_Trans1WayCltchAct",1.0},
            {"In.ST_SuspSysModStat",1.0},
            {"In.ST_SIRDpl",1.0},
            {"In.ST_AirbgVDA",1.0},
            {"In.ST_GenRgSPDtyCycRq",1.0},
            {"In.p_AirAmbient",0.1},
            {"In.p_SAI",0.1},
            {"In.X_Egr",1.0},
            {"In.AD_SpareAnalog",1.0},
            {"In.AD_SpareAnalog2",1.0},
            {"In.T_Exhaust",1.0},
            {"In.a_Vehicle",0.001},
            {"In.U_BrakeLight",0.1},
            {"In.ST_OilLevelSwitch",1.0},
            {"In.even8Dummy2",1.0},
            {"In.ST_AccessorySwitch",1.0},
            {"In.ST_IgnitionKey",1.0},
            {"In.ST_StartNotOKSwitch",1.0},
            {"In.ST_ClutchSwitch",1.0},
            {"In.ST_BrakeSwitch",1.0},
            {"In.ST_BrakeLight",1.0},
            {"In.ST_PowerSteerPressureSwitch",1.0},
            {"In.ST_OilPresSwitch",1.0},
            {"In.p_AC",1.0},
            {"In.T_Engine",1.0},
            {"In.V_FuelTank",0.1},
            {"In.V_FuelTankAWDSec",0.1},
            {"In.V_FuelTankPrim",0.1},
            {"In.p_FuelTank",1.0},
            {"In.p_AirInlet",0.1},
            {"In.p_AirBefThrottle",0.1},
            {"In.U_O2SensFront",1.0},
            {"In.U_O2SensRear",1.0},
            {"In.AD_ThrotPstn",1.0},
            {"In.AD_ThrotPstn2",1.0},
            {"In.AD_PdlPstn",1.0},
            {"In.AD_PdlPstn2",1.0},
            {"In.AD_ThrotPstnDiag",1.0},
            {"In.AD_ThrotPstn2Diag",1.0},
            {"In.AD_PdlPstnDiag",1.0},
            {"In.AD_PdlPstn2Diag",1.0},
            {"In.t_SensorDiagTimeStamp",1.0},
            {"In.T_AirInlet",1.0},
            {"In.AD_FuelTank",1.0},
            {"In.AD_FuelTankAWDSec",1.0},
            {"In.p_FuelRail",0.1},
            {"In.pct_FuelTank",0.1},
            {"In.PWM_AlternatorFTerm",0.1},
            {"In.PWM_FuelPumpDiag",0.1},
            {"In.f_FuelPumpDiag",0.1},
            {"In.X_FFSensor",0.1},
            {"In.f_FFSensor",0.1},
            {"In.Q_AirInlet",0.01},
            {"In.v_Vehicle",0.1},
            {"In.n_Wheel",1.0},
            {"In.t_MCP_SOH_PulsePeriod",1.0},
            {"In.n_Engine",1.0},
            {"In.t_CombToComb",1.0},
            {"In.fi_EnginePosition",1.0},
            {"In.X_Knock",1.0},
            {"In.t_IgnitionDetect1",1.0},
            {"In.t_IgnitionDetect2",1.0},
            {"In.t_CombustionDetect1",1.0},
            {"In.t_CombustionDetect2",1.0},
            {"In.I_HeatO2SensFront",1.0},
            {"In.I_HeatO2SensRear",1.0},
            {"In.t_IgnitionOffPeriod",1.0},
            {"In.ST_AlternatorLTerm",1.0},
            {"In.U_ETCMotor",0.1},
            {"In.U_Battery",0.1},
            {"In.ST_5VAStatus",1.0},
            {"In.ST_5VBStatus",1.0},
            {"ActualIn.r_WhlRotLNDrRC",1.0},
            {"ActualIn.r_WhlRotRNDrRC",1.0},
            {"ActualIn.v_Vehicle2",0.1},
            {"ActualIn.M_TCTrqRqVal",1.0},
            {"ActualIn.Cnt_TCTrqRqProt",1.0},
            {"ActualIn.M_TrnTrqRqVal",1.0},
            {"ActualIn.T_TrnOilTmp",1.0},
            {"ActualIn.n_TrnTrbAngVl",1.0},
            {"ActualIn.TrnEmRelDTC_CdNm",1.0},
            {"ActualIn.n_WhAngVlcFL",1.0},
            {"ActualIn.n_WhAngVlcFR",1.0},
            {"ActualIn.n_WhAngVlcRL",1.0},
            {"ActualIn.n_WhAngVlcRR",1.0},
            {"ActualIn.T_OtsAirTmpCrVal",1.0},
            {"ActualIn.T_OtSdTmpHiRes",1.0},
            {"ActualIn.ST_ManTrnRvsGrAtv",1.0},
            {"ActualIn.ST_SysPwrMd",1.0},
            {"ActualIn.X_EngCoolFanSpdAdj",1.0},
            {"ActualIn.ST_VehDynCntAtv",1.0},
            {"ActualIn.ST_ABSAtv",1.0},
            {"ActualIn.ST_WhSpdSnsDgnCmp",1.0},
            {"ActualIn.ST_EngyMgtMinIdlBstLvlRq",1.0},
            {"ActualIn.ST_CrsCntCncRq",1.0},
            {"ActualIn.ST_CrsCntOnSwAtv",1.0},
            {"ActualIn.ST_CrsCntRsmSwAtv",1.0},
            {"ActualIn.ST_CrsCntSetSwAtv",1.0},
            {"ActualIn.ST_CrsCntSwFld",1.0},
            {"ActualIn.Cnt_CrsCntlAliveRC",1.0},
            {"ActualIn.ST_CrusCntSwProt",1.0},
            {"ActualIn.Cnt_TCAliveRC",1.0},
            {"ActualIn.ST_TCSysAtv",1.0},
            {"ActualIn.ST_TCSysEnbld",1.0},
            {"ActualIn.ST_TCTrqIntvTyp",1.0},
            {"ActualIn.ST_TCTrqRdnRlzSg",1.0},
            {"ActualIn.X_TrnActGr",1.0},
            {"ActualIn.X_TrnGrSlctrPos",1.0},
            {"ActualIn.ST_TrnGrShftDir",1.0},
            {"ActualIn.ST_TrnTrqIntvTyp",1.0},
            {"ActualIn.ST_TrnTrqRdnRlzSg",1.0},
            {"ActualIn.ST_TrnTrqCnvCltSt",1.0},
            {"ActualIn.ST_TrnEmsMlfAtv",1.0},
            {"ActualIn.ST_TrnNtrlCntMdAtv",1.0},
            {"ActualIn.ST_TrnWrmUpShftPtrn",1.0},
            {"ActualIn.ST_ThrtlPrgrsnReq",1.0},
            {"ActualIn.ST_TrnWntrShPtSt",1.0},
            {"ActualIn.ST_TrnFrzFrStrRq",1.0},
            {"ActualIn.ST_TrnEmRelDTC_Str",1.0},
            {"ActualIn.TrnEmRelDTC_SysDes",1.0},
            {"ActualIn.ST_ACCmCltRq",1.0},
            {"ActualIn.M_ACCmTrqAct",1.0},
            {"ActualIn.ST_FrntECVDA",1.0},
            {"ActualIn.ST_BdyVDA",1.0},
            {"ActualIn.ST_ClimCntlVDA",1.0},
            {"ActualIn.ST_DrInfDisVDA",1.0},
            {"ActualIn.ST_EngOilLfRstRq",1.0},
            {"ActualIn.ST_EngyMgtMinIdlBs",1.0},
            {"ActualIn.ST_TrnCstLmSlpRq",1.0},
            {"ActualIn.ST_WhlRtLNDrRCRsOc",1.0},
            {"ActualIn.ST_WhlRtRNDrRCRsOc",1.0},
            {"ActualIn.ST_TrnTpUp_TpDwnMd",1.0},
            {"ActualIn.ST_Trans1WayCltchAct",1.0},
            {"ActualIn.ST_SuspSysModStat",1.0},
            {"ActualIn.ST_SIRDpl",1.0},
            {"ActualIn.ST_AirbgVDA",1.0},
            {"ActualIn.ST_GenRgSPDtyCycRq",1.0},
            {"ActualIn.p_AirAmbient",0.1},
            {"ActualIn.p_SAI",0.1},
            {"ActualIn.X_Egr",1.0},
            {"ActualIn.AD_SpareAnalog",1.0},
            {"ActualIn.AD_SpareAnalog2",1.0},
            {"ActualIn.T_Exhaust",1.0},
            {"ActualIn.a_Vehicle",0.001},
            {"ActualIn.U_BrakeLight",0.1},
            {"ActualIn.ST_OilLevelSwitch",1.0},
            {"ActualIn.even8Dummy2",1.0},
            {"ActualIn.ST_AccessorySwitch",1.0},
            {"ActualIn.ST_IgnitionKey",1.0},
            {"ActualIn.ST_StartNotOKSwitch",1.0},
            {"ActualIn.ST_ClutchSwitch",1.0},
            {"ActualIn.ST_BrakeSwitch",1.0},
            {"ActualIn.ST_BrakeLight",1.0},
            {"ActualIn.ST_PowerSteerPressureSwitch",1.0},
            {"ActualIn.ST_OilPresSwitch",1.0},
            {"ActualIn.p_AC",1.0},
            {"ActualIn.T_Engine",1.0},
            {"ActualIn.V_FuelTank",0.1},
            {"ActualIn.V_FuelTankAWDSec",0.1},
            {"ActualIn.V_FuelTankPrim",0.1},
            {"ActualIn.p_FuelTank",1.0},
            {"ActualIn.p_AirInlet",0.1},
            {"ActualIn.p_AirBefThrottle",0.1},
            {"ActualIn.U_O2SensFront",1.0},
            {"ActualIn.U_O2SensRear",1.0},
            {"ActualIn.AD_ThrotPstn",1.0},
            {"ActualIn.AD_ThrotPstn2",1.0},
            {"ActualIn.AD_PdlPstn",1.0},
            {"ActualIn.AD_PdlPstn2",1.0},
            {"ActualIn.AD_ThrotPstnDiag",1.0},
            {"ActualIn.AD_ThrotPstn2Diag",1.0},
            {"ActualIn.AD_PdlPstnDiag",1.0},
            {"ActualIn.AD_PdlPstn2Diag",1.0},
            {"ActualIn.t_SensorDiagTimeStamp",1.0},
            {"ActualIn.T_AirInlet",1.0},
            {"ActualIn.AD_FuelTank",1.0},
            {"ActualIn.AD_FuelTankAWDSec",1.0},
            {"ActualIn.p_FuelRail",0.1},
            {"ActualIn.pct_FuelTank",0.1},
            {"ActualIn.PWM_AlternatorFTerm",0.1},
            {"ActualIn.PWM_FuelPumpDiag",0.1},
            {"ActualIn.f_FuelPumpDiag",0.1},
            {"ActualIn.X_FFSensor",0.1},
            {"ActualIn.f_FFSensor",0.1},
            {"ActualIn.Q_AirInlet",0.01},
            {"ActualIn.v_Vehicle",0.1},
            {"ActualIn.n_Wheel",1.0},
            {"ActualIn.t_MCP_SOH_PulsePeriod",1.0},
            {"ActualIn.n_Engine",1.0},
            {"ActualIn.t_CombToComb",1.0},
            {"ActualIn.fi_EnginePosition",1.0},
            {"ActualIn.X_Knock",1.0},
            {"ActualIn.t_IgnitionDetect1",1.0},
            {"ActualIn.t_IgnitionDetect2",1.0},
            {"ActualIn.t_CombustionDetect1",1.0},
            {"ActualIn.t_CombustionDetect2",1.0},
            {"ActualIn.I_HeatO2SensFront",1.0},
            {"ActualIn.I_HeatO2SensRear",1.0},
            {"ActualIn.t_IgnitionOffPeriod",1.0},
            {"ActualIn.ST_AlternatorLTerm",1.0},
            {"ActualIn.U_ETCMotor",0.1},
            {"ActualIn.U_Battery",0.1},
            {"ActualIn.ST_5VAStatus",1.0},
            {"ActualIn.ST_5VBStatus",1.0},
            {"LimpIn.r_WhlRotLNDrRC",1.0},
            {"LimpIn.r_WhlRotRNDrRC",1.0},
            {"LimpIn.v_Vehicle2",0.1},
            {"LimpIn.M_TCTrqRqVal",1.0},
            {"LimpIn.Cnt_TCTrqRqProt",1.0},
            {"LimpIn.M_TrnTrqRqVal",1.0},
            {"LimpIn.T_TrnOilTmp",1.0},
            {"LimpIn.n_TrnTrbAngVl",1.0},
            {"LimpIn.TrnEmRelDTC_CdNm",1.0},
            {"LimpIn.n_WhAngVlcFL",1.0},
            {"LimpIn.n_WhAngVlcFR",1.0},
            {"LimpIn.n_WhAngVlcRL",1.0},
            {"LimpIn.n_WhAngVlcRR",1.0},
            {"LimpIn.T_OtsAirTmpCrVal",1.0},
            {"LimpIn.T_OtSdTmpHiRes",1.0},
            {"LimpIn.ST_ManTrnRvsGrAtv",1.0},
            {"LimpIn.ST_SysPwrMd",1.0},
            {"LimpIn.X_EngCoolFanSpdAdj",1.0},
            {"LimpIn.ST_VehDynCntAtv",1.0},
            {"LimpIn.ST_ABSAtv",1.0},
            {"LimpIn.ST_WhSpdSnsDgnCmp",1.0},
            {"LimpIn.ST_EngyMgtMinIdlBstLvlRq",1.0},
            {"LimpIn.ST_CrsCntCncRq",1.0},
            {"LimpIn.ST_CrsCntOnSwAtv",1.0},
            {"LimpIn.ST_CrsCntRsmSwAtv",1.0},
            {"LimpIn.ST_CrsCntSetSwAtv",1.0},
            {"LimpIn.ST_CrsCntSwFld",1.0},
            {"LimpIn.Cnt_CrsCntlAliveRC",1.0},
            {"LimpIn.ST_CrusCntSwProt",1.0},
            {"LimpIn.Cnt_TCAliveRC",1.0},
            {"LimpIn.ST_TCSysAtv",1.0},
            {"LimpIn.ST_TCSysEnbld",1.0},
            {"LimpIn.ST_TCTrqIntvTyp",1.0},
            {"LimpIn.ST_TCTrqRdnRlzSg",1.0},
            {"LimpIn.X_TrnActGr",1.0},
            {"LimpIn.X_TrnGrSlctrPos",1.0},
            {"LimpIn.ST_TrnGrShftDir",1.0},
            {"LimpIn.ST_TrnTrqIntvTyp",1.0},
            {"LimpIn.ST_TrnTrqRdnRlzSg",1.0},
            {"LimpIn.ST_TrnTrqCnvCltSt",1.0},
            {"LimpIn.ST_TrnEmsMlfAtv",1.0},
            {"LimpIn.ST_TrnNtrlCntMdAtv",1.0},
            {"LimpIn.ST_TrnWrmUpShftPtrn",1.0},
            {"LimpIn.ST_ThrtlPrgrsnReq",1.0},
            {"LimpIn.ST_TrnWntrShPtSt",1.0},
            {"LimpIn.ST_TrnFrzFrStrRq",1.0},
            {"LimpIn.ST_TrnEmRelDTC_Str",1.0},
            {"LimpIn.TrnEmRelDTC_SysDes",1.0},
            {"LimpIn.ST_ACCmCltRq",1.0},
            {"LimpIn.M_ACCmTrqAct",1.0},
            {"LimpIn.ST_FrntECVDA",1.0},
            {"LimpIn.ST_BdyVDA",1.0},
            {"LimpIn.ST_ClimCntlVDA",1.0},
            {"LimpIn.ST_DrInfDisVDA",1.0},
            {"LimpIn.ST_EngOilLfRstRq",1.0},
            {"LimpIn.ST_EngyMgtMinIdlBs",1.0},
            {"LimpIn.ST_TrnCstLmSlpRq",1.0},
            {"LimpIn.ST_WhlRtLNDrRCRsOc",1.0},
            {"LimpIn.ST_WhlRtRNDrRCRsOc",1.0},
            {"LimpIn.ST_TrnTpUp_TpDwnMd",1.0},
            {"LimpIn.ST_Trans1WayCltchAct",1.0},
            {"LimpIn.ST_SuspSysModStat",1.0},
            {"LimpIn.ST_SIRDpl",1.0},
            {"LimpIn.ST_AirbgVDA",1.0},
            {"LimpIn.ST_GenRgSPDtyCycRq",1.0},
            {"LimpIn.p_AirAmbient",0.1},
            {"LimpIn.p_SAI",0.1},
            {"LimpIn.X_Egr",1.0},
            {"LimpIn.AD_SpareAnalog",1.0},
            {"LimpIn.AD_SpareAnalog2",1.0},
            {"LimpIn.T_Exhaust",1.0},
            {"LimpIn.a_Vehicle",0.001},
            {"LimpIn.U_BrakeLight",0.1},
            {"LimpIn.ST_OilLevelSwitch",1.0},
            {"LimpIn.even8Dummy2",1.0},
            {"LimpIn.ST_AccessorySwitch",1.0},
            {"LimpIn.ST_IgnitionKey",1.0},
            {"LimpIn.ST_StartNotOKSwitch",1.0},
            {"LimpIn.ST_ClutchSwitch",1.0},
            {"LimpIn.ST_BrakeSwitch",1.0},
            {"LimpIn.ST_BrakeLight",1.0},
            {"LimpIn.ST_PowerSteerPressureSwitch",1.0},
            {"LimpIn.ST_OilPresSwitch",1.0},
            {"LimpIn.p_AC",1.0},
            {"LimpIn.T_Engine",1.0},
            {"LimpIn.V_FuelTank",0.1},
            {"LimpIn.V_FuelTankAWDSec",0.1},
            {"LimpIn.V_FuelTankPrim",0.1},
            {"LimpIn.p_FuelTank",1.0},
            {"LimpIn.p_AirInlet",0.1},
            {"LimpIn.p_AirBefThrottle",0.1},
            {"LimpIn.U_O2SensFront",1.0},
            {"LimpIn.U_O2SensRear",1.0},
            {"LimpIn.AD_ThrotPstn",1.0},
            {"LimpIn.AD_ThrotPstn2",1.0},
            {"LimpIn.AD_PdlPstn",1.0},
            {"LimpIn.AD_PdlPstn2",1.0},
            {"LimpIn.AD_ThrotPstnDiag",1.0},
            {"LimpIn.AD_ThrotPstn2Diag",1.0},
            {"LimpIn.AD_PdlPstnDiag",1.0},
            {"LimpIn.AD_PdlPstn2Diag",1.0},
            {"LimpIn.t_SensorDiagTimeStamp",1.0},
            {"LimpIn.T_AirInlet",1.0},
            {"LimpIn.AD_FuelTank",1.0},
            {"LimpIn.AD_FuelTankAWDSec",1.0},
            {"LimpIn.p_FuelRail",0.1},
            {"LimpIn.pct_FuelTank",0.1},
            {"LimpIn.PWM_AlternatorFTerm",0.1},
            {"LimpIn.PWM_FuelPumpDiag",0.1},
            {"LimpIn.f_FuelPumpDiag",0.1},
            {"LimpIn.X_FFSensor",0.1},
            {"LimpIn.f_FFSensor",0.1},
            {"LimpIn.Q_AirInlet",0.01},
            {"LimpIn.v_Vehicle",0.1},
            {"LimpIn.n_Wheel",1.0},
            {"LimpIn.t_MCP_SOH_PulsePeriod",1.0},
            {"LimpIn.n_Engine",1.0},
            {"LimpIn.t_CombToComb",1.0},
            {"LimpIn.fi_EnginePosition",1.0},
            {"LimpIn.X_Knock",1.0},
            {"LimpIn.t_IgnitionDetect1",1.0},
            {"LimpIn.t_IgnitionDetect2",1.0},
            {"LimpIn.t_CombustionDetect1",1.0},
            {"LimpIn.t_CombustionDetect2",1.0},
            {"LimpIn.I_HeatO2SensFront",1.0},
            {"LimpIn.I_HeatO2SensRear",1.0},
            {"LimpIn.t_IgnitionOffPeriod",1.0},
            {"LimpIn.ST_AlternatorLTerm",1.0},
            {"LimpIn.U_ETCMotor",0.1},
            {"LimpIn.U_Battery",0.1},
            {"LimpIn.ST_5VAStatus",1.0},
            {"LimpIn.ST_5VBStatus",1.0},
            {"Fault.r_WhlRotLNDrRC",1.0},
            {"Fault.r_WhlRotRNDrRC",1.0},
            {"Fault.v_Vehicle2",1.0},
            {"Fault.M_TCTrqRqVal",1.0},
            {"Fault.Cnt_TCTrqRqProt",1.0},
            {"Fault.M_TrnTrqRqVal",1.0},
            {"Fault.T_TrnOilTmp",1.0},
            {"Fault.n_TrnTrbAngVl",1.0},
            {"Fault.TrnEmRelDTC_CdNm",1.0},
            {"Fault.n_WhAngVlcFL",1.0},
            {"Fault.n_WhAngVlcFR",1.0},
            {"Fault.n_WhAngVlcRL",1.0},
            {"Fault.n_WhAngVlcRR",1.0},
            {"Fault.T_OtsAirTmpCrVal",1.0},
            {"Fault.T_OtSdTmpHiRes",1.0},
            {"Fault.ST_ManTrnRvsGrAtv",1.0},
            {"Fault.ST_SysPwrMd",1.0},
            {"Fault.X_EngCoolFanSpdAdj",1.0},
            {"Fault.ST_VehDynCntAtv",1.0},
            {"Fault.ST_ABSAtv",1.0},
            {"Fault.ST_WhSpdSnsDgnCmp",1.0},
            {"Fault.ST_EngyMgtMinIdlBstLvlRq",1.0},
            {"Fault.ST_CrsCntCncRq",1.0},
            {"Fault.ST_CrsCntOnSwAtv",1.0},
            {"Fault.ST_CrsCntRsmSwAtv",1.0},
            {"Fault.ST_CrsCntSetSwAtv",1.0},
            {"Fault.ST_CrsCntSwFld",1.0},
            {"Fault.Cnt_CrsCntlAliveRC",1.0},
            {"Fault.ST_CrusCntSwProt",1.0},
            {"Fault.Cnt_TCAliveRC",1.0},
            {"Fault.ST_TCSysAtv",1.0},
            {"Fault.ST_TCSysEnbld",1.0},
            {"Fault.ST_TCTrqIntvTyp",1.0},
            {"Fault.ST_TCTrqRdnRlzSg",1.0},
            {"Fault.X_TrnActGr",1.0},
            {"Fault.X_TrnGrSlctrPos",1.0},
            {"Fault.ST_TrnGrShftDir",1.0},
            {"Fault.ST_TrnTrqIntvTyp",1.0},
            {"Fault.ST_TrnTrqRdnRlzSg",1.0},
            {"Fault.ST_TrnTrqCnvCltSt",1.0},
            {"Fault.ST_TrnEmsMlfAtv",1.0},
            {"Fault.ST_TrnNtrlCntMdAtv",1.0},
            {"Fault.ST_TrnWrmUpShftPtrn",1.0},
            {"Fault.ST_ThrtlPrgrsnReq",1.0},
            {"Fault.ST_TrnWntrShPtSt",1.0},
            {"Fault.ST_TrnFrzFrStrRq",1.0},
            {"Fault.ST_TrnEmRelDTC_Str",1.0},
            {"Fault.TrnEmRelDTC_SysDes",1.0},
            {"Fault.ST_ACCmCltRq",1.0},
            {"Fault.M_ACCmTrqAct",1.0},
            {"Fault.ST_FrntECVDA",1.0},
            {"Fault.ST_BdyVDA",1.0},
            {"Fault.ST_ClimCntlVDA",1.0},
            {"Fault.ST_DrInfDisVDA",1.0},
            {"Fault.ST_EngOilLfRstRq",1.0},
            {"Fault.ST_EngyMgtMinIdlBs",1.0},
            {"Fault.ST_TrnCstLmSlpRq",1.0},
            {"Fault.ST_WhlRtLNDrRCRsOc",1.0},
            {"Fault.ST_WhlRtRNDrRCRsOc",1.0},
            {"Fault.ST_TrnTpUp_TpDwnMd",1.0},
            {"Fault.ST_Trans1WayCltchAct",1.0},
            {"Fault.ST_SuspSysModStat",1.0},
            {"Fault.ST_SIRDpl",1.0},
            {"Fault.ST_AirbgVDA",1.0},
            {"Fault.n_EngSpd",1.0},
            {"Fault.X_AccPos",1.0},
            {"Fault.w_AccGrd",1.0},
            {"Fault.X_ThrPos",1.0},
            {"Fault.M_EngTrqAct",1.0},
            {"Fault.M_EngTrqDrRqd",1.0},
            {"Fault.M_EngTrqMax",1.0},
            {"Fault.p_ACRfHiSdFldPrs",1.0},
            {"Fault.X_EngBstPrsInd",1.0},
            {"Fault.T_EngCltTmp",1.0},
            {"Fault.X_EngOilRmnLf",1.0},
            {"Fault.v_VehSpd",1.0},
            {"Fault.l_DRCLftNDrvWhl",1.0},
            {"Fault.l_DRCRtNDrvWhl",1.0},
            {"Fault.V_FlInjRlCt",1.0},
            {"Fault.X_AccActPos",1.0},
            {"Fault.M_EngMxDrgTrq",1.0},
            {"Fault.T_EngIntAirTmp",1.0},
            {"Fault.p_BarPrsAbs",1.0},
            {"Fault.ST_EngTrqRdnFld",1.0},
            {"Fault.ST_BrkLmpSwAtv",1.0},
            {"Fault.ST_CrsCntCltSwAtv",1.0},
            {"Fault.CMD_EngLmpHmMdAtv",1.0},
            {"Fault.CMD_WrmUpShftPtrnRq",1.0},
            {"Fault.CMD_GenFld",1.0},
            {"Fault.ST_EngRngSt",1.0},
            {"Fault.CMD_CrsCntEnbld",1.0},
            {"Fault.CMD_CrsCntAtv",1.0},
            {"Fault.CMD_EngRecShftInd",1.0},
            {"Fault.ST_RghRdDtd",1.0},
            {"Fault.ST_ACCmCltEngd",1.0},
            {"Fault.CMD_EngOilChgNwIO",1.0},
            {"Fault.CMD_EngOilChgSnIO",1.0},
            {"Fault.CMD_EngOilLvlLwIO",1.0},
            {"Fault.CMD_EngOilPrsLwIO",1.0},
            {"Fault.X_EngCoolFanSpd",1.0},
            {"Fault.ST_DRCLtNDrWhRsOc",1.0},
            {"Fault.ST_DRCRtNDrWhRsOc",1.0},
            {"Fault.ST_FlInjRlCtRstOcc",1.0},
            {"Fault.AD_FlLvSnsUnpVl",1.0},
            {"Fault.FlLvPercent",1.0},
            {"Fault.ST_EngFlrCdeRtrR",1.0},
            {"Fault.ST_CrsCntThrtCmdSt",1.0},
            {"Fault.ST_EngWrmUpAch",1.0},
            {"Fault.CMD_SvcEngSysNonEmsIR",1.0},
            {"Fault.ST_AccKdwnAtv",1.0},
            {"Fault.ST_EngTrnEmsDTCStr",1.0},
            {"Fault.ST_EngTrqTCRqFld",1.0},
            {"Fault.ST_EngTrqTnsRqFld",1.0},
            {"Fault.ST_EngEmsMlfAtv",1.0},
            {"Fault.ST_EngCstLmSlpSt",1.0},
            {"Fault.ST_EngCstFlCutAct",1.0},
            {"Fault.ST_EngTrqACCRqFld",1.0},
            {"Fault.CMD_ApplyBrkPdlIO",1.0},
            {"Fault.CMD_CkFlFilrCapIO",1.0},
            {"Fault.ST_EngRPOId",1.0},
            {"Fault.CMD_EngGrShftInhRq",1.0},
            {"Fault.CMD_EngJrkShPtrnRq",1.0},
            {"Fault.CMD_EngNtrlCntInhRq",1.0},
            {"Fault.CMD_RdcEngPrfShPtrnRq",1.0},
            {"Fault.CMD_AirCndCmpStkRq",1.0},
            {"Fault.ST_AirCndOffIO",1.0},
            {"Fault.ST_ThrtlPrgrsnStat",1.0},
            {"Fault.ST_GenRgSPDtyCycRq",1.0},
            {"Fault.p_SAISens",1.0},
            {"Fault.X_Egr",1.0},
            {"Fault.AD_SpareAnalog",1.0},
            {"Fault.AD_SpareAnalog2",1.0},
            {"Fault.T_Exhaust",1.0},
            {"Fault.a_Vehicle",1.0},
            {"Fault.U_BrakeLight",1.0},
            {"Fault.ST_OilLevelSwitch",1.0},
            {"Fault.CMD_DiagSwitch",1.0},
            {"Fault.CMD_MainCPUSOH",1.0},
            {"Fault.CMD_CrankCaseValve",1.0},
            {"Fault.PWM_EgrValve",1.0},
            {"Fault.IgnDetect",1.0},
            {"Fault.f_PurgeValve",1.0},
            {"Fault.f_EgrValve",1.0},
            {"Fault.f_SecAirValve",1.0},
            {"Fault.f_EngineFan1",1.0},
            {"Fault.f_HeatO2SensFront",1.0},
            {"Fault.f_HeatO2SensRear",1.0},
            {"Fault.f_BoostCntrl",1.0},
            {"Fault.A_Throttle",1.0},
            {"Fault.V_FuelTankPrim",1.0},
            {"Fault.V_FuelTankAWDSec",1.0},
            {"Fault.p_AC",1.0},
            {"Fault.p_FuelTank",1.0},
            {"Fault.p_FuelRail",1.0},
            {"Fault.p_AirInlet",1.0},
            {"Fault.p_AirBefThrottle",1.0},
            {"Fault.T_AirInlet",1.0},
            {"Fault.AD_FuelTank",1.0},
            {"Fault.AD_FuelTankAWDSec",1.0},
            {"Fault.T_Engine",1.0},
            {"Fault.Q_AirInlet",1.0},
            {"Fault.v_Vehicle",1.0},
            {"Fault.n_Wheel",1.0},
            {"Fault.CMD_AlternatorLTerm",1.0},
            {"Fault.CMD_ACRelay",1.0},
            {"Fault.CMD_SecAirPump",1.0},
            {"Fault.CMD_EngineFan2",1.0},
            {"Fault.CMD_EngineFan3",1.0},
            {"Fault.CMD_CanisterCloseValve",1.0},
            {"Fault.CMD_MainRelay",1.0},
            {"Fault.CMD_CheckEngine",1.0},
            {"Fault.CMD_StartMotor",1.0},
            {"Fault.CMD_TurboBypass",1.0},
            {"Fault.CMD_ThrotMotorDisable",1.0},
            {"Fault.PWM_AlternatorFTerm",1.0},
            {"Fault.PWM_BoostCntrl",1.0},
            {"Fault.PWM_FuelPumpDiag",1.0},
            {"Fault.PWM_SecAirValve",1.0},
            {"Fault.PWM_PurgeValve",1.0},
            {"Fault.PWM_EngineFan1",1.0},
            {"Fault.PWM_HeatO2SensFront",1.0},
            {"Fault.PWM_HeatO2SensRear",1.0},
            {"Fault.PWM_FuelPump",1.0},
            {"Fault.n_Engine",1.0},
            {"Fault.t_Injection",1.0},
            {"Fault.t_SparkDwell",1.0},
            {"Fault.fi_Ignition",1.0},
            {"Fault.U_O2SensFront",1.0},
            {"Fault.U_O2SensRear",1.0},
            {"Fault.U_ETCMotor",1.0},
            {"Fault.U_Battery",1.0},
            {"Fault.X_Knock",1.0},
            {"Fault.X_FFSensor",1.0},
            {"Fault.ST_Immo",1.0},
            {"Fault.ST_EngSync",1.0},
            {"Fault.ST_CombustionDetect",1.0},
            {"Fault.ST_EOLDiag",1.0},
            {"Fault.ST_TCMFreezeFrame1Diag",1.0},
            {"Fault.ST_TCMFreezeFrame2Diag",1.0},
            {"Fault.ST_TCMFreezeFrame3Diag",1.0},
            {"Fault.ST_BrakeLight",1.0},
            {"Fault.ST_BrakeSwitch",1.0},
            {"Fault.ST_KnockCircuit",1.0},
            {"Fault.ST_IonDetectModule",1.0},
            {"Fault.ST_DigitalIDM",1.0},
            {"Fault.ST_FFSensorConductivity",1.0},
            {"Fault.ST_FuelTransferPump",1.0},
            {"Fault.X_AccPedal",1.0},
            {"Fault.EvapDiag",1.0},
            {"Fault.CatDiag",1.0},
            {"Fault.LongTermDiag",1.0},
            {"Fault.ShortTermDiag",1.0},
            {"Fault.EngineCoolantDiag",1.0},
            {"Fault.IdleSpeedDiag",1.0},
            {"Fault.MisfireFTPDiag",1.0},
            {"Fault.TimeToCloosedLoopDiag",1.0},
            {"Fault.O2SPreRespDiag",1.0},
            {"Fault.O2SPreSwitchPointDiag",1.0},
            {"Fault.ThrottleMinLearnDiag",1.0},
            {"Fault.ThrottleDefaultDiag",1.0},
            {"Fault.ThrottleDiag",1.0},
            {"Fault.ECMInternalDiag",1.0},
            {"Fault.PedalDiag",1.0},
            {"Fault.TestDummy1Diag",1.0},
            {"Fault.TestDummy2Diag",1.0},
            {"Fault.TestDummy3Diag",1.0},
            {"Fault.TankAdapDiag",1.0},
            {"Fault.RunCrankSignalDiag",1.0},
            {"Fault.AccessoryDiag",1.0},
            {"Fault.GeneratorFControlDiag",1.0},
            {"Fault.GeneratorLControlDiag",1.0},
            {"Fault.ClutchSwitchDiag",1.0},
            {"Fault.MisfireCatDiag",1.0},
            {"Fault.PowerSteerPressureSwitchDiag",1.0},
            {"Fault.ABSCanDataDiag",1.0},
            {"Fault.TCMCanDataDiag",1.0},
            {"Fault.FuelConsumptionDiag",1.0},
            {"Fault.CIMCanDataDiag",1.0},
            {"Fault.HighSpeedBusDiag",1.0},
            {"Fault.BusDataAHLDiag",1.0},
            {"Fault.BusDataEHPSDiag",1.0},
            {"Fault.SystemVoltageFaultDiag",1.0},
            {"Fault.TEngDevDiag",1.0},
            {"Fault.SADSCanDataDiag",1.0},
            {"Fault.HighSidedCltDiag",1.0},
            {"Fault.LowSidedCltDiag",1.0},
            {"Fault.ColdStartDiag",1.0},
            {"Fault.ServiceBayTestDiag",1.0},
            {"Fault.IOTDiag",1.0},
            {"Fault.O2SPostRespDiag",1.0},
            {"Fault.AF40FreezeFrameDiag",1.0},
            {"Fault.t_Injection_1",1.0},
            {"Fault.t_Injection_2",1.0},
            {"Fault.t_Injection_3",1.0},
            {"Fault.t_Injection_4",1.0},
            {"LimpActive.r_WhlRotLNDrRC",1.0},
            {"LimpActive.r_WhlRotRNDrRC",1.0},
            {"LimpActive.v_Vehicle2",1.0},
            {"LimpActive.M_TCTrqRqVal",1.0},
            {"LimpActive.Cnt_TCTrqRqProt",1.0},
            {"LimpActive.M_TrnTrqRqVal",1.0},
            {"LimpActive.T_TrnOilTmp",1.0},
            {"LimpActive.n_TrnTrbAngVl",1.0},
            {"LimpActive.TrnEmRelDTC_CdNm",1.0},
            {"LimpActive.n_WhAngVlcFL",1.0},
            {"LimpActive.n_WhAngVlcFR",1.0},
            {"LimpActive.n_WhAngVlcRL",1.0},
            {"LimpActive.n_WhAngVlcRR",1.0},
            {"LimpActive.T_OtsAirTmpCrVal",1.0},
            {"LimpActive.T_OtSdTmpHiRes",1.0},
            {"LimpActive.ST_ManTrnRvsGrAtv",1.0},
            {"LimpActive.ST_SysPwrMd",1.0},
            {"LimpActive.X_EngCoolFanSpdAdj",1.0},
            {"LimpActive.ST_VehDynCntAtv",1.0},
            {"LimpActive.ST_ABSAtv",1.0},
            {"LimpActive.ST_WhSpdSnsDgnCmp",1.0},
            {"LimpActive.ST_EngyMgtMinIdlBstLvlRq",1.0},
            {"LimpActive.ST_CrsCntCncRq",1.0},
            {"LimpActive.ST_CrsCntOnSwAtv",1.0},
            {"LimpActive.ST_CrsCntRsmSwAtv",1.0},
            {"LimpActive.ST_CrsCntSetSwAtv",1.0},
            {"LimpActive.ST_CrsCntSwFld",1.0},
            {"LimpActive.Cnt_CrsCntlAliveRC",1.0},
            {"LimpActive.ST_CrusCntSwProt",1.0},
            {"LimpActive.Cnt_TCAliveRC",1.0},
            {"LimpActive.ST_TCSysAtv",1.0},
            {"LimpActive.ST_TCSysEnbld",1.0},
            {"LimpActive.ST_TCTrqIntvTyp",1.0},
            {"LimpActive.ST_TCTrqRdnRlzSg",1.0},
            {"LimpActive.X_TrnActGr",1.0},
            {"LimpActive.X_TrnGrSlctrPos",1.0},
            {"LimpActive.ST_TrnGrShftDir",1.0},
            {"LimpActive.ST_TrnTrqIntvTyp",1.0},
            {"LimpActive.ST_TrnTrqRdnRlzSg",1.0},
            {"LimpActive.ST_TrnTrqCnvCltSt",1.0},
            {"LimpActive.ST_TrnEmsMlfAtv",1.0},
            {"LimpActive.ST_TrnNtrlCntMdAtv",1.0},
            {"LimpActive.ST_TrnWrmUpShftPtrn",1.0},
            {"LimpActive.ST_ThrtlPrgrsnReq",1.0},
            {"LimpActive.ST_TrnWntrShPtSt",1.0},
            {"LimpActive.ST_TrnFrzFrStrRq",1.0},
            {"LimpActive.ST_TrnEmRelDTC_Str",1.0},
            {"LimpActive.TrnEmRelDTC_SysDes",1.0},
            {"LimpActive.ST_ACCmCltRq",1.0},
            {"LimpActive.M_ACCmTrqAct",1.0},
            {"LimpActive.ST_FrntECVDA",1.0},
            {"LimpActive.ST_BdyVDA",1.0},
            {"LimpActive.ST_ClimCntlVDA",1.0},
            {"LimpActive.ST_DrInfDisVDA",1.0},
            {"LimpActive.ST_EngOilLfRstRq",1.0},
            {"LimpActive.ST_EngyMgtMinIdlBs",1.0},
            {"LimpActive.ST_TrnCstLmSlpRq",1.0},
            {"LimpActive.ST_WhlRtLNDrRCRsOc",1.0},
            {"LimpActive.ST_WhlRtRNDrRCRsOc",1.0},
            {"LimpActive.ST_TrnTpUp_TpDwnMd",1.0},
            {"LimpActive.ST_Trans1WayCltchAct",1.0},
            {"LimpActive.ST_SuspSysModStat",1.0},
            {"LimpActive.ST_SIRDpl",1.0},
            {"LimpActive.ST_AirbgVDA",1.0},
            {"LimpActive.ST_GenRgSPDtyCycRq",1.0},
            {"LimpActive.T_Exhaust",1.0},
            {"LimpActive.p_AirInjectionRail",1.0},
            {"LimpActive.p_PowerSteer",1.0},
            {"LimpActive.p_Fuel",1.0},
            {"LimpActive.ST_OilLevelSwitch",1.0},
            {"LimpActive.p_SAI",1.0},
            {"LimpActive.X_Egr",1.0},
            {"LimpActive.X_ActualGear",1.0},
            {"LimpActive.a_Vehicle",1.0},
            {"LimpActive.U_BrakeLight",1.0},
            {"LimpActive.AD_FuelTank",1.0},
            {"LimpActive.AD_FuelTankAWDSec",1.0},
            {"LimpActive.PWM_AlternatorFTerm",1.0},
            {"LimpActive.X_FFSensor",1.0},
            {"LimpActive.ST_AccessorySwitch",1.0},
            {"LimpActive.ST_IgnitionKey",1.0},
            {"LimpActive.ST_StartNotOKSwitch",1.0},
            {"LimpActive.ST_ClutchSwitch",1.0},
            {"LimpActive.ST_BrakeSwitch",1.0},
            {"LimpActive.ST_BrakeLight",1.0},
            {"LimpActive.ST_PowerSteerPressureSwitch",1.0},
            {"LimpActive.ST_OilPresSwitch",1.0},
            {"LimpActive.p_AC",1.0},
            {"LimpActive.T_Engine",1.0},
            {"LimpActive.V_FuelTankPrim",1.0},
            {"LimpActive.V_FuelTankAWDSec",1.0},
            {"LimpActive.V_FuelTank",1.0},
            {"LimpActive.pct_FuelTank",1.0},
            {"LimpActive.p_FuelRail",1.0},
            {"LimpActive.p_FuelTank",1.0},
            {"LimpActive.p_AirInlet",1.0},
            {"LimpActive.p_AirBefThrottle",1.0},
            {"LimpActive.U_O2SensFront",1.0},
            {"LimpActive.U_O2SensRear",1.0},
            {"LimpActive.AD_ThrotPstn",1.0},
            {"LimpActive.AD_ThrotPstn2",1.0},
            {"LimpActive.AD_PdlPstn",1.0},
            {"LimpActive.AD_PdlPstn2",1.0},
            {"LimpActive.T_AirInlet",1.0},
            {"LimpActive.Q_AirInlet",1.0},
            {"LimpActive.v_Vehicle",1.0},
            {"LimpActive.n_Wheel",1.0},
            {"LimpActive.X_Knock",1.0},
            {"LimpActive.I_HeatO2SensFront",1.0},
            {"LimpActive.I_HeatO2SensRear",1.0},
            {"LimpActive.U_ETCMotor",1.0},
            {"LimpActive.U_Battery",1.0},
            {"LimpActive.ST_5VAStatus",1.0},
            {"LimpActive.ST_5VBStatus",1.0},
            {"LimpActive.ST_AlternatorLTerm",1.0},
            {"Out.n_EngSpd",1.0},
            {"Out.X_AccPos",0.1},
            {"Out.w_AccGrd",1.0},
            {"Out.X_ThrPos",1.0},
            {"Out.M_EngTrqAct",1.0},
            {"Out.M_EngTrqDrRqd",1.0},
            {"Out.M_EngTrqMax",1.0},
            {"Out.p_ACRfHiSdFldPrs",1.0},
            {"Out.X_FuelAlcoholComp",0.1},
            {"Out.ST_FuelAlcoholCompV",1.0},
            {"Out.ST_FuelAlchlCompAdptnPrg",1.0},
            {"Out.X_EngBstPrsInd",1.0},
            {"Out.T_EngCltTmp",1.0},
            {"Out.X_EngOilRmnLf",0.1},
            {"Out.v_VehSpd",0.1},
            {"Out.l_DRCLftNDrvWhl",1.0},
            {"Out.l_DRCRtNDrvWhl",1.0},
            {"Out.V_FlInjRlCt",1.0},
            {"Out.X_AccActPos",0.1},
            {"Out.M_EngMxDrgTrq",1.0},
            {"Out.T_EngIntAirTmp",1.0},
            {"Out.p_BarPrsAbs",0.1},
            {"Out.ST_EngTrqRdnFld",1.0},
            {"Out.ST_BrkLmpSwAtv",1.0},
            {"Out.ST_CrsCntCltSwAtv",1.0},
            {"Out.CMD_EngLmpHmMdAtv",1.0},
            {"Out.CMD_WrmUpShftPtrnRq",1.0},
            {"Out.CMD_GenFld",1.0},
            {"Out.ST_EngRngSt",1.0},
            {"Out.CMD_CrsCntEnbld",1.0},
            {"Out.CMD_CrsCntAtv",1.0},
            {"Out.CMD_EngRecShftInd",1.0},
            {"Out.ST_RghRdDtd",1.0},
            {"Out.ST_ACCmCltEngd",1.0},
            {"Out.CMD_EngOilChgNwIO",1.0},
            {"Out.CMD_EngOilChgSnIO",1.0},
            {"Out.CMD_EngOilLvlLwIO",1.0},
            {"Out.CMD_EngOilPrsLwIO",1.0},
            {"Out.X_EngCoolFanSpd",1.0},
            {"Out.ST_DRCLtNDrWhRsOc",1.0},
            {"Out.ST_DRCRtNDrWhRsOc",1.0},
            {"Out.ST_FlInjRlCtRstOcc",1.0},
            {"Out.AD_FlLvSnsUnpVl",1.0},
            {"Out.FlLvPercent",1.0},
            {"Out.ST_EngFlrCdeRtrR",1.0},
            {"Out.ST_CrsCntThrtCmdSt",1.0},
            {"Out.ST_EngWrmUpAch",1.0},
            {"Out.CMD_SvcEngSysNonEmsIR",1.0},
            {"Out.ST_AccKdwnAtv",1.0},
            {"Out.ST_EngTrnEmsDTCStr",1.0},
            {"Out.ST_EngTrqTCRqFld",1.0},
            {"Out.ST_EngTrqTnsRqFld",1.0},
            {"Out.ST_EngEmsMlfAtv",1.0},
            {"Out.ST_EngCstLmSlpSt",1.0},
            {"Out.ST_EngCstFlCutAct",1.0},
            {"Out.ST_EngTrqACCRqFld",1.0},
            {"Out.CMD_ApplyBrkPdlIO",1.0},
            {"Out.CMD_CkFlFilrCapIO",1.0},
            {"Out.ST_EngRPOId",1.0},
            {"Out.CMD_EngGrShftInhRq",1.0},
            {"Out.CMD_EngJrkShPtrnRq",1.0},
            {"Out.CMD_EngNtrlCntInhRq",1.0},
            {"Out.CMD_RdcEngPrfShPtrnRq",1.0},
            {"Out.CMD_AirCndCmpStkRq",1.0},
            {"Out.ST_AirCndOffIO",1.0},
            {"Out.ST_ThrtlPrgrsnStat",1.0},
            {"Out.ST_ScntlGMLANPrtclDisRq",1.0},
            {"Out.ST_GenStptDtCycPtOvrAct",1.0},
            {"Out.f_PurgeValve",1.0},
            {"Out.PWM_EgrValve",0.1},
            {"Out.f_EgrValve",1.0},
            {"Out.PWM_BoostCntrl",0.1},
            {"Out.f_BoostCntrl",1.0},
            {"Out.ST_Sensor2SwitchToGnd",1.0},
            {"Out.CMD_DiagSwitch",1.0},
            {"Out.CMD_MainCPUSOH",1.0},
            {"Out.CMD_CrankCaseValve",1.0},
            {"Out.CMD_TurboBypass",1.0},
            {"Out.even8Dummy2",1.0},
            {"Out.CMD_ACRelay",1.0},
            {"Out.CMD_SecAirPump",1.0},
            {"Out.CMD_EngineFan2",1.0},
            {"Out.CMD_EngineFan3",1.0},
            {"Out.CMD_CanisterCloseValve",1.0},
            {"Out.CMD_MainRelay",1.0},
            {"Out.CMD_CheckEngine",1.0},
            {"Out.CMD_StartMotor",1.0},
            {"Out.CMD_ThrotMotorDisable",1.0},
            {"Out.even8Dummy3",1.0},
            {"Out.PWM_SecAirValve",0.1},
            {"Out.f_SecAirValve",1.0},
            {"Out.PWM_PurgeValve",0.1},
            {"Out.PWM_EngineFan1",0.1},
            {"Out.f_EngineFan1",1.0},
            {"Out.PWM_FuelPump",0.1},
            {"Out.t_Injection",1.0},
            {"Out.fi_Injection",0.1},
            {"Out.t_SparkDwell",1.0},
            {"Out.fi_Ignition",0.1},
            {"Out.PWM_HeatO2SensFront",1.0},
            {"Out.f_HeatO2SensFront",0.1},
            {"Out.PWM_HeatO2SensRear",1.0},
            {"Out.f_HeatO2SensRear",0.1},
            {"Out.CMD_AlternatorLTerm",1.0},
            {"DiagOut.fi_Injection",1.0},
            {"DiagOut.PWM_EgrValve",1.0},
            {"DiagOut.CMD_DiagSwitch",1.0},
            {"DiagOut.CMD_MainCPUSOH",1.0},
            {"DiagOut.CMD_CrankCaseValve",1.0},
            {"DiagOut.A_Throttle",1.0},
            {"DiagOut.X_ThrotPstnDes",0.1},
            {"DiagOut.PWM_BoostCntrl",0.1},
            {"DiagOut.PWM_SecAirValve",0.1},
            {"DiagOut.f_SecAirValve",1.0},
            {"DiagOut.PWM_PurgeValve",0.1},
            {"DiagOut.PWM_EngineFan1",0.1},
            {"DiagOut.f_EngineFan1",1.0},
            {"DiagOut.PWM_FuelPump",0.1},
            {"DiagOut.PWM_HeatO2SensFront",1.0},
            {"DiagOut.f_HeatO2SensFront",0.1},
            {"DiagOut.PWM_HeatO2SensRear",1.0},
            {"DiagOut.f_HeatO2SensRear",0.1},
            {"DiagOut.t_Injection",1.0},
            {"DiagOut.fi_Ignition",1.0},
            {"DiagOut.CMD_AlternatorLTerm",1.0},
            {"DiagOut.CMD_ACRelay",1.0},
            {"DiagOut.CMD_SecAirPump",1.0},
            {"DiagOut.CMD_EngineFan2",1.0},
            {"DiagOut.CMD_EngineFan3",1.0},
            {"DiagOut.CMD_CanisterCloseValve",1.0},
            {"DiagOut.CMD_MainRelay",1.0},
            {"DiagOut.CMD_CheckEngine",1.0},
            {"DiagOut.CMD_StartMotor",1.0},
            {"DiagOut.CMD_TurboBypass",1.0},
            {"DiagOut.CMD_ThrotMotorDisable",1.0},
            {"DiagActive.CMD_DiagSwitch",1.0},
            {"DiagActive.CMD_MainCPUSOH",1.0},
            {"DiagActive.CMD_CrankCaseValve",1.0},
            {"DiagActive.fi_Injection",1.0},
            {"DiagActive.PWM_EgrValve",1.0},
            {"DiagActive.A_Throttle",1.0},
            {"DiagActive.X_ThrotPstnDes",1.0},
            {"DiagActive.CMD_AlternatorLTerm",1.0},
            {"DiagActive.CMD_ACRelay",1.0},
            {"DiagActive.CMD_SecAirPump",1.0},
            {"DiagActive.CMD_EngineFan2",1.0},
            {"DiagActive.CMD_EngineFan3",1.0},
            {"DiagActive.CMD_CanisterCloseValve",1.0},
            {"DiagActive.CMD_MainRelay",1.0},
            {"DiagActive.CMD_CheckEngine",1.0},
            {"DiagActive.CMD_StartMotor",1.0},
            {"DiagActive.PWM_SecAirValve",1.0},
            {"DiagActive.f_SecAirValve",1.0},
            {"DiagActive.PWM_PurgeValve",1.0},
            {"DiagActive.PWM_EngineFan1",1.0},
            {"DiagActive.f_EngineFan1",1.0},
            {"DiagActive.PWM_FuelPump",1.0},
            {"DiagActive.PWM_BoostCntrl",1.0},
            {"DiagActive.CMD_TurboBypass",1.0},
            {"DiagActive.t_Injection",1.0},
            {"DiagActive.fi_Ignition",1.0},
            {"DiagActive.PWM_HeatO2SensFront",1.0},
            {"DiagActive.f_HeatO2SensFront",1.0},
            {"DiagActive.PWM_HeatO2SensRear",1.0},
            {"DiagActive.f_HeatO2SensRear",1.0},
            {"DiagActive.CMD_ThrotMotorDisable",1.0},
            {"DiagActive.ST_EvapProductionTest",1.0},
            {"DiagActive.ST_EvapWorkshopTest",1.0},
            {"DiagActive.ST_SAIWorkshopTest",1.0},
            {"DiagActive.ST_SglCylMisfFCutDisld",1.0},
            {"DiagActive.ST_EthanolBlendRate",1.0},
            {"DiagActive.ST_EthanolBlendRateAdaptation",1.0},
            {"DiagActive.ST_EthanolBlendRateAdaptationDisable",1.0},
            {"DiagActive.ST_ServiceBayTest",1.0},
            {"ECMStat.n_CombWhenSync",1.0},
            {"ECMStat.msCounter",1.0},
            {"ECMStat.t_100msCounter",0.1},
            {"ECMStat.n_Combustion",1.0},
            {"ECMStat.n_CombustionSync",1.0},
            {"ECMStat.t_EngineStarted",0.1},
            {"ECMStat.n_EngineStarted",1.0},
            {"ECMStat.t_msBackgroundTask",1.0},
            {"ECMStat.t_IgnKeyOn",1.0},
            {"ECMStat.p_Diff",1.0},
            {"ECMStat.n_Engine12p5ms",1.0},
            {"ECMStat.p_DiffThrot",1.0},
            {"ECMStat.t_StartTime",1.0},
            {"ECMStat.P_Engine",0.1},
            {"ECMStat.n_EngineDelta",1.0},
            {"ECMStat.n_EngineDelta2",1.0},
            {"ECMStat.JerkFactor",1.0},
            {"ECMStat.n_EngFilt",1.0},
            {"ECMStat.ST_MemoryCleared",1.0},
            {"ECMStat.T_EngStart",1.0},
            {"ECMStat.T_engStartCalc",1.0},
            {"ECMStat.T_engCalc",1.0},
            {"ECMStat.ST_EngineRunning",1.0},
            {"ECMStat.ST_ACRequested",1.0},
            {"ECMStat.ST_EngineStarted",1.0},
            {"ECMStat.ST_Automatic",1.0},
            {"ECMStat.ST_ESP_TCS",1.0},
            {"ECMStat.ST_CIM",1.0},
            {"ECMStat.ST_AutNeutral",1.0},
            {"ECMStat.ST_EngPosSynced",1.0},
            {"ECMStat.ST_Sync",1.0},
            {"ECMStat.ST_hotFuelStart",1.0},
            {"ECMStat.ST_PedalReleased",1.0},
            {"ECMStat.ST_EngineMoving",1.0},
            {"ECMStat.ST_EngNotMoving",1.0},
            {"ECMStat.ManualGear",1.0},
            {"ECMStat.ST_ActiveAirDem",1.0},
            {"ECMStat.ST_TCSCANBased",1.0},
            {"ECMStat.ST_SysPwrMd",1.0},
            {"MCPIn.X_PdlPstn1Raw",0.1},
            {"MCPIn.X_PdlPstn2Raw",0.1},
            {"MCPIn.X_PdlPstnIndSOH",0.1},
            {"MCPIn.X_PdlPstn1Disp",0.1},
            {"MCPIn.X_PdlPstn2Disp",0.1},
            {"MCPIn.X_PdlPstn1NormMin",0.1},
            {"MCPIn.X_PdlPstn2NormMin",0.1},
            {"MCPIn.X_PdlPstn1NormMax",0.1},
            {"MCPIn.X_PdlPstn2NormMax",0.1},
            {"MCPIn.X_ThrotPstn1Raw",0.1},
            {"MCPIn.X_ThrotPstn2Raw",0.1},
            {"MCPIn.X_ThrotPstnIndSOH",0.1},
            {"MCPIn.X_ThrotPstn1Disp",0.1},
            {"MCPIn.X_ThrotPstn2Disp",0.1},
            {"MCPIn.X_ThrotPstn1NormMin",0.1},
            {"MCPIn.X_ThrotPstn2NormMin",0.1},
            {"MCPIn.U_ETCIgn",0.1},
            {"MCPIn.MCP_RAM_Addr",1.0},
            {"MCPIn.MCP_RAM_Value",1.0},
            {"MCPIn.PID_Number",1.0},
            {"MCPIn.PID_Value",1.0},
            {"MCPIn.PWM_ThrActuator",0.1},
            {"MCPIn.ST_CruiseOnOffSwitch",1.0},
            {"MCPIn.ST_CruiseResAccelSwitch",1.0},
            {"MCPIn.ST_CruiseSetCoastSwitch",1.0},
            {"MCPIn.ST_CruiseInferred",1.0},
            {"MCPIn.ST_BrakeLamp",1.0},
            {"MCPIn.ST_RedundantBrake",1.0},
            {"MCPIn.ST_PPSMinLearnCondMet",1.0},
            {"MCPIn.ST_PPSMinBumpUpActive",1.0},
            {"MCPIn.ST_TPSAtMinPosition",1.0},
            {"MCPIn.ST_TPSMinLearnComplete",1.0},
            {"MCPIn.ST_TPSMinLearnAborted",1.0},
            {"MCPIn.ST_PPS1OOR",1.0},
            {"MCPIn.ST_PPS2OOR",1.0},
            {"MCPIn.ST_TPS1OOR",1.0},
            {"MCPIn.ST_TPS2OOR",1.0},
            {"MCPIn.ST_PPS12OOC",1.0},
            {"MCPIn.ST_TPS12OOC",1.0},
            {"MCPIn.ST_IgnVoltageOOC",1.0},
            {"MCPIn.ST_ActuatorFault",1.0},
            {"MCPIn.ST_ActuatorDegrPerfFault",1.0},
            {"MCPIn.ST_SensorSwitchFault",1.0},
            {"MCPIn.ST_MainSOHDiscreteLineFault",1.0},
            {"MCPIn.ST_ThrReturnFault",1.0},
            {"MCPIn.ST_ThrLimActive",1.0},
            {"MCPIn.ST_ThrLimFault",1.0},
            {"MCPIn.ST_InvalidMessage",1.0},
            {"MCPIn.ST_SPIComFault",1.0},
            {"MCPIn.ST_MainCPUFault",1.0},
            {"MCPIn.ST_MCPFault",1.0},
            {"MCPIn.ST_MCPROMFault",1.0},
            {"MCPIn.ST_MCPRAMFault",1.0},
            {"MCPIn.ST_MessageType",1.0},
            {"MCPIn.ST_TPSMinLearnOK",1.0},
            {"MCPIn.ST_ThrDefaultActivated",1.0},
            {"MCPIn.ST_BatSaveModeActive",1.0},
            {"MCPIn.ST_EngineShutDownModeActive",1.0},
            {"MCPIn.ST_ForcedIdleModeActive",1.0},
            {"MCPIn.ST_ReducedPowerModeActive",1.0},
            {"MCPIn.ST_BowdenCableModeActive",1.0},
            {"MCPIn.ST_KAMResetPerformed",1.0},
            {"MCPIn.ST_IceBreakActive",1.0},
            {"MCPIn.ST_ThrOpen",1.0},
            {"MCPIn.ST_ThrClose",1.0},
            {"MCPIn.ST_PPS_MAINVsMCPCorrFlt",1.0},
            {"MCPIn.ST_Vref1OOR",1.0},
            {"MCPIn.ST_Vref2OOR",1.0},
            {"MCPIn.ServiceModeTestID",1.0},
            {"MCPIn.ST_RomChecksumComplete",1.0},
            {"MCPIn.MCP_inquiry",1.0},
            {"MCPIn.MCP_reply",1.0},
            {"MCPIn.ST_MAIN_DFM_Flt",1.0},
            {"MCPIn.ST_PPS_Min1stLrnCmptMCP",1.0},
            {"MCPInPrev.X_PdlPstn1Raw",0.1},
            {"MCPInPrev.X_PdlPstn2Raw",0.1},
            {"MCPInPrev.X_PdlPstnIndSOH",0.1},
            {"MCPInPrev.X_PdlPstn1Disp",0.1},
            {"MCPInPrev.X_PdlPstn2Disp",0.1},
            {"MCPInPrev.X_PdlPstn1NormMin",0.1},
            {"MCPInPrev.X_PdlPstn2NormMin",0.1},
            {"MCPInPrev.X_PdlPstn1NormMax",0.1},
            {"MCPInPrev.X_PdlPstn2NormMax",0.1},
            {"MCPInPrev.X_ThrotPstn1Raw",0.1},
            {"MCPInPrev.X_ThrotPstn2Raw",0.1},
            {"MCPInPrev.X_ThrotPstnIndSOH",0.1},
            {"MCPInPrev.X_ThrotPstn1Disp",0.1},
            {"MCPInPrev.X_ThrotPstn2Disp",0.1},
            {"MCPInPrev.X_ThrotPstn1NormMin",0.1},
            {"MCPInPrev.X_ThrotPstn2NormMin",0.1},
            {"MCPInPrev.U_ETCIgn",0.1},
            {"MCPInPrev.MCP_RAM_Addr",1.0},
            {"MCPInPrev.MCP_RAM_Value",1.0},
            {"MCPInPrev.PID_Number",1.0},
            {"MCPInPrev.PID_Value",1.0},
            {"MCPInPrev.PWM_ThrActuator",0.1},
            {"MCPInPrev.ST_CruiseOnOffSwitch",1.0},
            {"MCPInPrev.ST_CruiseResAccelSwitch",1.0},
            {"MCPInPrev.ST_CruiseSetCoastSwitch",1.0},
            {"MCPInPrev.ST_CruiseInferred",1.0},
            {"MCPInPrev.ST_BrakeLamp",1.0},
            {"MCPInPrev.ST_RedundantBrake",1.0},
            {"MCPInPrev.ST_PPSMinLearnCondMet",1.0},
            {"MCPInPrev.ST_PPSMinBumpUpActive",1.0},
            {"MCPInPrev.ST_TPSAtMinPosition",1.0},
            {"MCPInPrev.ST_TPSMinLearnComplete",1.0},
            {"MCPInPrev.ST_TPSMinLearnAborted",1.0},
            {"MCPInPrev.ST_PPS1OOR",1.0},
            {"MCPInPrev.ST_PPS2OOR",1.0},
            {"MCPInPrev.ST_TPS1OOR",1.0},
            {"MCPInPrev.ST_TPS2OOR",1.0},
            {"MCPInPrev.ST_PPS12OOC",1.0},
            {"MCPInPrev.ST_TPS12OOC",1.0},
            {"MCPInPrev.ST_IgnVoltageOOC",1.0},
            {"MCPInPrev.ST_ActuatorFault",1.0},
            {"MCPInPrev.ST_ActuatorDegrPerfFault",1.0},
            {"MCPInPrev.ST_SensorSwitchFault",1.0},
            {"MCPInPrev.ST_MainSOHDiscreteLineFault",1.0},
            {"MCPInPrev.ST_ThrReturnFault",1.0},
            {"MCPInPrev.ST_ThrLimActive",1.0},
            {"MCPInPrev.ST_ThrLimFault",1.0},
            {"MCPInPrev.ST_InvalidMessage",1.0},
            {"MCPInPrev.ST_SPIComFault",1.0},
            {"MCPInPrev.ST_MainCPUFault",1.0},
            {"MCPInPrev.ST_MCPFault",1.0},
            {"MCPInPrev.ST_MCPROMFault",1.0},
            {"MCPInPrev.ST_MCPRAMFault",1.0},
            {"MCPInPrev.ST_MessageType",1.0},
            {"MCPInPrev.ST_TPSMinLearnOK",1.0},
            {"MCPInPrev.ST_ThrDefaultActivated",1.0},
            {"MCPInPrev.ST_BatSaveModeActive",1.0},
            {"MCPInPrev.ST_EngineShutDownModeActive",1.0},
            {"MCPInPrev.ST_ForcedIdleModeActive",1.0},
            {"MCPInPrev.ST_ReducedPowerModeActive",1.0},
            {"MCPInPrev.ST_BowdenCableModeActive",1.0},
            {"MCPInPrev.ST_KAMResetPerformed",1.0},
            {"MCPInPrev.ST_IceBreakActive",1.0},
            {"MCPInPrev.ST_ThrOpen",1.0},
            {"MCPInPrev.ST_ThrClose",1.0},
            {"MCPInPrev.ST_PPS_MAINVsMCPCorrFlt",1.0},
            {"MCPInPrev.ST_Vref1OOR",1.0},
            {"MCPInPrev.ST_Vref2OOR",1.0},
            {"MCPInPrev.ServiceModeTestID",1.0},
            {"MCPInPrev.ST_RomChecksumComplete",1.0},
            {"MCPInPrev.MCP_inquiry",1.0},
            {"MCPInPrev.MCP_reply",1.0},
            {"MCPInPrev.ST_MAIN_DFM_Flt",1.0},
            {"MCPInPrev.ST_PPS_Min1stLrnCmptMCP",1.0},
            {"MCPOut.X_ThrotPstnDes",0.1},
            {"MCPOut.X_PdlPstnInd",0.1},
            {"MCPOut.X_PdlPstn1NormMin",0.1},
            {"MCPOut.X_PdlPstn2NormMin",0.1},
            {"MCPOut.X_ThrotPstnIndIdle",0.1},
            {"MCPOut.X_ThrotPstn1NormMin",0.1},
            {"MCPOut.X_ThrotPstn2NormMin",0.1},
            {"MCPOut.T_InletAir",1.0},
            {"MCPOut.T_Engine",1.0},
            {"MCPOut.v_Vehicle",0.1},
            {"MCPOut.U_Ignition",0.1},
            {"MCPOut.MCP_RAM_Addr",1.0},
            {"MCPOut.MCP_RAM_CalAddr",1.0},
            {"MCPOut.MCP_RAM_CalValue",1.0},
            {"MCPOut.PID_Number",1.0},
            {"MCPOut.ST_Vref1Fault",1.0},
            {"MCPOut.ST_Vref2Fault",1.0},
            {"MCPOut.ST_PPS1OOR",1.0},
            {"MCPOut.ST_PPS2OOR",1.0},
            {"MCPOut.ST_TPS1OOR",1.0},
            {"MCPOut.ST_TPS2OOR",1.0},
            {"MCPOut.ST_ActuatorFault",1.0},
            {"MCPOut.ST_PPS12OOC",1.0},
            {"MCPOut.ST_TPS12OOC",1.0},
            {"MCPOut.ST_TPSOOC",1.0},
            {"MCPOut.ST_PPS12ShortCutFault",1.0},
            {"MCPOut.ST_TPS12ShortCutFault",1.0},
            {"MCPOut.ST_PPS12ShortCutError",1.0},
            {"MCPOut.ST_TPS12ShortCutError",1.0},
            {"MCPOut.ST_PPSMinBumpUpActive",1.0},
            {"MCPOut.ST_SPIComFault",1.0},
            {"MCPOut.ST_MainCPUFault",1.0},
            {"MCPOut.ST_MCPFault",1.0},
            {"MCPOut.ST_TPSMinLearnActive",1.0},
            {"MCPOut.ST_TPSMinLearnComplete",1.0},
            {"MCPOut.ST_EngineCranking",1.0},
            {"MCPOut.ST_EngineRunning",1.0},
            {"MCPOut.ST_PPSMinLearnCondMet",1.0},
            {"MCPOut.ST_ActuatorDefaultCommanded",1.0},
            {"MCPOut.ST_EngineShutDownModeCommanded",1.0},
            {"MCPOut.ST_ForcedIdleModeCommanded",1.0},
            {"MCPOut.ST_ReducedPowerModeCommanded",1.0},
            {"MCPOut.ST_BowdenCableModeCommanded",1.0},
            {"MCPOut.ST_LimitedAccelModeCommanded",1.0},
            {"MCPOut.ST_CruiseActive",1.0},
            {"MCPOut.ST_CruiseOnOffSwitch",1.0},
            {"MCPOut.ST_CruiseResumeAccelSwitch",1.0},
            {"MCPOut.ST_CruiseSetCoastSwitch",1.0},
            {"MCPOut.ST_BatterySaverModeCommanded",1.0},
            {"MCPOut.ST_MainCPUPowerDown",1.0},
            {"MCPOut.ST_MainCPUStandBy",1.0},
            {"MCPOut.ServiceTestID",1.0},
            {"MCPOut.ST_ThrReturnFault",1.0},
            {"MCPOut.MAIN_inquiry",1.0},
            {"MCPOut.MAIN_reply",1.0},
            {"MCPOut.ST_MCP_DFM_Flt",1.0},
            {"MCPOut.SecurIndex",1.0},
            {"MCPOut.SecurData",1.0},
            {"MCPOut.ST_PPS_Min1stLrnCmptMAIN",1.0},
            {"GlobData.f_filtCoeff",0.1},
            {"IgnAbsProt.fi_Start",0.1},
            {"IgnAbsProt.fi_highOctan",0.1},
            {"IgnAbsProt.fi_lowOctan",0.1},
            {"IgnAbsProt.fi_octanMapDiff",0.1},
            {"IgnAbsProt.o_octanMapDiff",0.01},
            {"IgnAbsProt.o_octanDiff",0.01},
            {"IgnAbsProt.fi_FuelCut",0.1},
            {"IgnAbsProt.fi_diffHighNormal",0.1},
            {"IgnAbsProt.fi_diffLowNormal",0.1},
            {"IgnAbsProt.fi_diff",0.1},
            {"IgnAbsProt.fi_MeanKnockUsed",0.1},
            {"IgnAbsProt.tempTAB",0.1},
            {"IgnAbsProt.t_OAdapTimer",0.1},
            {"IgnAbsProt.t_OAdapTimerSlow",0.1},
            {"IgnAbsProt.o_step",0.01},
            {"IgnAbsProt.ST_BladOctaneRamping",1.0},
            {"IgnAbs.fi_Normal_mAir",0.1},
            {"IgnAbs.fi_Ignition",0.1},
            {"IgnAbs.fi_basicIgn",0.1},
            {"IgnAbs.fi_octanOffset",0.1},
            {"IgnAbs.fi_NormalIgn",0.1},
            {"IgnAbs.fraction",0.0009765625},
            {"ECUIDCal.ApplicationSoftware_PartNo",1.0},
            {"ECUIDCal.ECMBasicComplete_PartNo",1.0},
            {"ECUIDCal.ApplicationFileName",1.0},
            {"MCPComAdap.c_SerComFailMax",1.0},
            {"MCPComAdap.c_SerComContFailMax",1.0},
            {"MCPComAdap.c_SerComSmplMin",1.0},
            {"MCPComAdap.ST_SerComFltMAINOccrd",1.0},
            {"GearSILCal.n_MinEngSpd",1.0},
            {"GearSILCal.n_MaxEngSpd",1.0},
            {"GearSILCal.p_AmbXSP",0.1},
            {"GearSILCal.n_EngYSP",1.0},
            {"GearSILCal.p_IntakeOverAmbPresMAP",0.1},
            {"GearSILCal.t_MinTimeOn",0.25},
            {"GearSILCal.t_MinTimeOff",0.25},
            {"GearSILCal.t_MinTimeOffDownShift",0.25},
            {"GearSILCal.X_AirHystPct",0.09765625},
            {"GearSILCal.n_EngSpdHyst",1.0},
            {"GearSILCal.Trq_DiffActPed",0.1},
            {"GearSILCal.T_EngActivate",1.0},
            {"GearCal.Ratio",0.01},
            {"GearCal.Range",0.01},
            {"GearCal.t_HoldNeutral",1.0},
            {"GearCal.T_TrnXSP",1.0},
            {"GearCal.v_VehIdleLim",0.1},
            {"SyncCal.t_DetectLimit",1.0},
            {"SyncCal.t_DetectLimLow",1.0},
            {"SyncCal.BefSync",1.0},
            {"SyncCal.n_SyncDelayTAB",1.0},
            {"SyncCal.n_CombFaultCylCnt",1.0},
            {"SyncCal.T_EngSP",1.0},
            {"SyncCal.N_DetectST1",1.0},
            {"SyncCal.N_DetectST2",1.0},
            {"SyncCal.n_OkCylOrder",1.0},
            {"SyncCal.n_CombLimit",1.0},
            {"SyncCal.n_CombLimitDiag",1.0},
            {"obdnEng.ST_OkStatus",1.0},
            {"obdnEng.ST_FaultCode",1.0},
            {"obdnEng.U_BattIgnOn",0.1},
            {"obdnEng.p_MAPIgnOn",0.1},
            {"obdnEng.N_LostEnginePositions",1.0},
            {"obdnEng.ST_EngineLostPosition",1.0},
            {"obdnEng.ST_EnginePosFound",1.0},
            {"obdnEng.ST_runInThreeSec",1.0},
            {"obdnEng.ST_ClosedThrottle",1.0},
            {"obdIdleSpeed.ST_OkStatus",1.0},
            {"obdIdleSpeed.ST_FaultCode",1.0},
            {"AirAmbientProt.h_AscentMax",1.0},
            {"AirAmbientProt.h_DescentLim",1.0},
            {"AirAmbientProt.t_MinLatest",1.0},
            {"AirAmbientProt.t_MaxLatest",1.0},
            {"AirAmbientProt.h_IntMin",1.0},
            {"AirAmbientProt.h_IntMax",1.0},
            {"AirAmbientProt.F_Friction",1.0},
            {"AirAmbientProt.F_FrictionMax",1.0},
            {"AirAmbientProt.p_MinHigh",0.1},
            {"AirAmbientProt.p_MaxLow",0.1},
            {"AirAmbientProt.p_MinLatest",0.1},
            {"AirAmbientProt.p_MaxLatest",0.1},
            {"AirAmbientProt.p_MinEP",0.1},
            {"AirAmbientProt.p_MaxEP",0.1},
            {"AirAmbientProt.p_MinEPDelta",0.1},
            {"AirAmbientProt.p_MaxEPDelta",0.1},
            {"AirAmbientProt.ST_MinHigh",1.0},
            {"AirAmbientProt.ST_MaxLow",1.0},
            {"AirAmbientProt.ST_MinLatest",1.0},
            {"AirAmbientProt.ST_MaxLatest",1.0},
            {"AirAmbientProt.ST_CLIPartBoost",1.0},
            {"AirAmbient1.t_Latest",1.0},
            {"AirAmbient1.p_Min",0.1},
            {"AirAmbient1.p_Max",0.1},
            {"AirAmbient2.t_Latest",1.0},
            {"AirAmbient2.t_Stamp",1.0},
            {"AirAmbient2.p_Min",0.1},
            {"AirAmbient2.p_Max",0.1},
            {"AirAmbient2.X_PrRatioMin",0.0009765625},
            {"AirAmbient2.X_PrRatioMax",0.0009765625},
            {"AirAmbient2.p_MinNoFilt",0.1},
            {"AirAmbient2.p_MaxNoFilt",0.1},
            {"AirAmbient2.p_MinFilt",0.1},
            {"AirAmbient2.p_MaxFilt",0.1},
            {"AirAmbient2.ST_Status",1.0},
            {"AirAmbient3.n_Engine",1.0},
            {"AirAmbient3.p_Max",0.1},
            {"AirAmbient3.p_AirBefThrBuff",0.1},
            {"AirAmbient3.X_PrAdjustEst",0.0078125},
            {"AirAmbient3.n_Index",1.0},
            {"AirAmbient.p_AirAmbient",0.1},
            {"AirAmbient.p_AirAmbientMin",0.1},
            {"AirAmbient.p_AirAmbientMax",0.1},
            {"ETC5VAdp.c_OOR1_FailMax",1.0},
            {"ETC5VAdp.c_OOR2_FailMax",1.0},
            {"ETCNonRTTaskProt.c_ETCDiagReportAllowed",1.0},
            {"ETCNonRTTaskProt.ST_IgnKeyPrev",1.0},
            {"ETCNonRTTaskProt.ST_IgnOrAccKeyPrev",1.0},
            {"ETCNonRTTaskProt.ST_EngineRunningPrev",1.0},
            {"ETCNonRTTaskProt.ST_ClearByKeyON",1.0},
            {"ETCNonRTTaskProt.ST_ClearByIgnOff",1.0},
            {"ETCNonRTTaskProt.ST_CodeClearInProgress",1.0},
            {"ETCNonRTTaskProt.ST_CodeClearInProgressPrev",1.0},
            {"ETCMiscCal.t_RtnDflt",1.0},
            {"ETCMiscCal.t_MinLrnProcFltTime",1.0},
            {"ETCMiscCal.t_BatterySaverTime",1.0},
            {"ETCMiscCal.X_MaxBatSavPdlPstn",0.1},
            {"ETCMiscCal.Q_MaxAirThrDefault",0.01},
            {"ETCMiscCal.c_ThrotActAirflow_Fail",1.0},
            {"ETCMiscCal.c_ThrotActAirflow_Smpl",1.0},
            {"ETCMiscCal.c_ThrotAct_Fail",1.0},
            {"ETCMiscCal.c_ThrotAct_Smpl",1.0},
            {"ETCMiscCal.K_BowdenGain",0.001},
            {"ETCMiscCal.X_PedHysOfstBowden",0.1},
            {"ETCMiscCal.X_BowdenIdlePstn",0.1},
            {"ETCMiscCal.X_BowdenLim",0.1},
            {"ETCMiscCal.X_BowdenMaxError",0.1},
            {"ETCMiscCal.StackMax",0.1},
            {"ETCMiscCal.U_IgnToMCPThrsh",0.1},
            {"MCPSOHCal.t_MCP_SOH_PrdMax",1.0},
            {"MCPSOHCal.t_MCP_SOH_PrdMin",1.0},
            {"MCPSOHCal.c_MCPSOHFail",1.0},
            {"PurgeCal.p_Diff16EUXSp",0.1},
            {"PurgeCal.p_Diff16USXSp",0.1},
            {"PurgeCal.ValveMap16EU",0.1},
            {"PurgeCal.ValveMap16US",0.1},
            {"PurgeCal.q_Flow16EUYSp",1.0},
            {"PurgeCal.q_Flow16USYSp",1.0},
            {"PurgeCal.PdiffMaxRefFlowEUTab",1.0},
            {"PurgeCal.PdiffMaxRefFlowUSTab",1.0},
            {"PurgeCal.m_AirLowSp",1.0},
            {"PurgeCal.m_AirHighSp",1.0},
            {"PurgeCal.m_AirDerLowTab",1.0},
            {"PurgeCal.m_AirDerHighTab",1.0},
            {"PurgeCal.MaxOLTime1",0.1},
            {"PurgeCal.MaxOLTime2",0.1},
            {"PurgeCal.CycleOffTime",0.1},
            {"PurgeCal.PurgePercentInc",1.0},
            {"PurgeCal.PrgPerLimLow",1.0},
            {"PurgeCal.AdpFuelFacLimLow",0.01},
            {"PurgeCal.AdpFreezeTimeBrake",0.1},
            {"PurgeCal.AdpFreezeTimeOC",0.1},
            {"PurgeCal.AdpFreezeTimeBoff",0.1},
            {"PurgeCal.AdpFreezeTimePosTrans",0.1},
            {"PurgeCal.AdpFreezeTimeNegTrans",0.1},
            {"PurgeCal.m_AirInletLim",1.0},
            {"PurgeCal.MaxAdpFreezeIndex",0.1},
            {"PurgeCal.HC100FastFiltFac",1.0},
            {"PurgeCal.HC0FastFiltFac",1.0},
            {"PurgeCal.HC100NormFiltFac",1.0},
            {"PurgeCal.HC0NormFiltFac",1.0},
            {"PurgeCal.HCContLimLow",0.01},
            {"PurgeCal.HCContLimCycle",0.01},
            {"PurgeCal.RampTimeUp",0.1},
            {"PurgeCal.n_RedOffset",1.0},
            {"PurgeCal.n_IdleInt",1.0},
            {"PurgeCal.n_MinOffset",1.0},
            {"PurgeCal.Q_AirRed",0.01},
            {"PurgeCal.Q_AirIdleLim",0.01},
            {"PurgeCal.MaxFuelFac",0.01},
            {"PurgeCal.IdleMaxFuelFac",0.01},
            {"PurgeCal.MaxFlow",1.0},
            {"PurgeCal.IdleMaxFlow",1.0},
            {"PurgeCal.T_VlvOffset100",1.0},
            {"PurgeCal.T_VlvOffset0",1.0},
            {"PurgeCal.VlvOffsetFac",0.1},
            {"PurgeCal.t_FuelInjFiltMin",1.0},
            {"PurgeCal.T_EngineLim",1.0},
            {"PurgeCal.T_EnginePriorityLim",1.0},
            {"PurgeCal.HCPriorityLimOn1",0.01},
            {"PurgeCal.HCPriorityLimOn2",0.01},
            {"PurgeCal.t_HighPriorityDelay",0.1},
            {"PurgeCal.HCPriorityLimOff",0.01},
            {"PurgeCal.v_LimIdle",0.1},
            {"PurgeCal.T_AirInletLimIdle",1.0},
            {"PurgeCal.V_Manifold",0.1},
            {"PurgeCal.Trq_MaxReserve",0.1},
            {"PurgeCal.Trq_HCLim",0.01},
            {"PurgeCal.ST_PurgeEnable",1.0},
            {"PurgeCal.P_Const",1.0},
            {"PurgeCal.I_Const",1.0},
            {"PurgeCal.FlowFacAdpFiltFac",1.0},
            {"PurgeCal.ST_BoostPurgeHWPresentEU",1.0},
            {"PurgeCal.ST_BoostPurgeHWPresentUS",1.0},
            {"PurgeCal.DiffPresMaxTol",0.78125},
            {"InjCorr.t_InjBatt",1.0},
            {"obdTCMFreezeFrame1.ST_OkStatus",1.0},
            {"obdTCMFreezeFrame1.ST_FaultCode",1.0},
            {"obdTCMFreezeFrame2.ST_OkStatus",1.0},
            {"obdTCMFreezeFrame2.ST_FaultCode",1.0},
            {"obdTCMFreezeFrame3.ST_OkStatus",1.0},
            {"obdTCMFreezeFrame3.ST_FaultCode",1.0},
            {"O2SHeatFrontCal.m_restartDewAddLimit",1.0},
            {"O2SHeatFrontCal.m_exhaust_lightOffTAB",1.0},
            {"O2SHeatFrontCal.m_exhaust_normalTAB",1.0},
            {"O2SHeatFrontCal.T_engLightOffSP",1.0},
            {"O2SHeatFrontCal.T_engNormalSP",1.0},
            {"O2SHeatFrontCal.m_restartDewAdd",1.0},
            {"O2SHeatFrontCal.t_InitRamp",0.1},
            {"O2SHeatFrontCal.U_InitRamp",0.1},
            {"O2SHeatFrontCal.t_InitHeat",0.1},
            {"O2SHeatFrontCal.T_DewPointLimit",1.0},
            {"O2SHeatFrontCal.U_InitHeat",0.1},
            {"O2SHeatFrontCal.U_DewPresent",0.1},
            {"O2SHeatFrontCal.t_minSoakDewPresent",0.1},
            {"O2SHeatFrontCal.t_AftDewHeatUp",0.1},
            {"O2SHeatFrontCal.U_AftDewHeatUp",0.1},
            {"O2SHeatFrontCal.U_NormHeatOffset",0.1},
            {"O2SHeatFrontCal.K_NormHeatSlope",0.001},
            {"O2SHeatFrontCal.f_OutputFilt",0.001},
            {"O2SHeatFrontCal.m_CutOffTAB",1.0},
            {"O2SHeatFrontCal.n_EngineSP",1.0},
            {"O2SHeatRearCal.m_restartDewAddLimit",1.0},
            {"O2SHeatRearCal.m_exhaust_lightOffTAB",1.0},
            {"O2SHeatRearCal.m_exhaust_normalTAB",1.0},
            {"O2SHeatRearCal.T_engLightOffSP",1.0},
            {"O2SHeatRearCal.T_engNormalSP",1.0},
            {"O2SHeatRearCal.m_restartDewAdd",1.0},
            {"O2SHeatRearCal.t_InitRamp",0.1},
            {"O2SHeatRearCal.U_InitRamp",0.1},
            {"O2SHeatRearCal.t_InitHeat",0.1},
            {"O2SHeatRearCal.T_DewPointLimit",1.0},
            {"O2SHeatRearCal.U_InitHeat",0.1},
            {"O2SHeatRearCal.U_DewPresent",0.1},
            {"O2SHeatRearCal.t_minSoakDewPresent",0.1},
            {"O2SHeatRearCal.t_AftDewHeatUp",0.1},
            {"O2SHeatRearCal.U_AftDewHeatUp",0.1},
            {"O2SHeatRearCal.U_NormHeatOffset",0.1},
            {"O2SHeatRearCal.K_NormHeatSlope",0.001},
            {"O2SHeatRearCal.f_OutputFilt",0.001},
            {"O2SHeatRearCal.m_CutOffTAB",1.0},
            {"O2SHeatRearCal.n_EngineSP",1.0},
            {"BFuelCal.m_AirJerkMAP",1.0},
            {"BFuelCal.T_jerkXSP",1.0},
            {"BFuelCal.n_jerkYSP",1.0},
            {"BFuelCal.t_JerkDelayMAP",0.1},
            {"BFuelCal.n_ExhEnrDelay",1.0},
            {"BFuelCal.X_ExhEnrRampOut",0.0009765625},
            {"BFuelCal.FCIMinLoadFuelFacMAP",0.0078125},
            {"BFuelCal.AirXSP",1.0},
            {"BFuelCal.RpmYSP",1.0},
            {"BFuelCal.AirFCIXSP",1.0},
            {"BFuelCal.RpmFCIYSP",1.0},
            {"BFuelCal.t_RampOutDelay",0.1},
            {"BFuelCal.t_JerkRampDelay",1.0},
            {"BFuelCal.LambdaOneFacMap",0.0078125},
            {"BFuelCal.TempEnrichFacMap",0.0078125},
            {"BFuelCal.JerkEnrichFacTAB",0.0078125},
            {"BFuelCal.FCIMaxFuelFac",0.0078125},
            {"BFuelCal.ST_JerkEnableLockup",1.0},
            {"ManGrShftProt.n_NextGear",1.0},
            {"ManGrShftProt.Ratio",1.0},
            {"ManGrShftProt.RatioFilt",1.0},
            {"ManGrShftProt.RatioDelta",1.0},
            {"ManGrShftProt.RatioHigh",1.0},
            {"ManGrShftProt.RatioLow",1.0},
            {"ManGrShftProt.ShiftMode",1.0},
            {"ManGrShft.n_EngRequest",1.0},
            {"ManGrShft.ST_GearShifting",1.0},
            {"SAIProt.m_AirAcc100",1.0},
            {"SAIProt.n_combCount",1.0},
            {"SAIProt.m_AirInjReq",1.0},
            {"SAIProt.m_AirInjReqMap",1.0},
            {"SAIProt.m_fuel",0.01},
            {"SAIProt.L_Request",0.0001},
            {"SAIProt.LambdaCalc",0.0001},
            {"SAIProt.Q_AirAct",0.01},
            {"SAIProt.Q_AirActMap",0.01},
            {"SAIProt.m_airAct",1.0},
            {"SAIProt.m_fuelBefComp",1.0},
            {"SAIProt.n_combOld",1.0},
            {"SAIProt.X_soakFac",1.0},
            {"SAIProt.t_runTime",0.1},
            {"SAIProt.ST_SAIPresent",1.0},
            {"SAIProt.ST_WorkShopTest",1.0},
            {"SAIProt.ST_NVDM",1.0},
            {"SAI.m_AirAcc",1.0},
            {"SAI.m_fuel",0.01},
            {"SAI.ST_ReqLeanClamp",1.0},
            {"SAI.ST_SAIRequest",1.0},
            {"SAI.ST_SAIActive",1.0},
            {"SAI.ST_AllowLClamp",1.0},
            {"SAI.ST_SAIPumpState",1.0},
            {"OBDAdap.t_CatDiagDuration",0.1},
            {"OBDAdap.t_Ph3Result",1.0},
            {"OBDAdap.t_Ph3EvalValue",1.0},
            {"OBDAdap.O2SensRespFltCnt",1.0},
            {"OBDAdap.FAdapWhenQAirError",1.0},
            {"OBDAdap.LambdaIntMeanValue",0.01},
            {"OBDAdap.Q_Av",0.01},
            {"OBDAdap.MAFQueResHiNegMax",0.01},
            {"OBDAdap.MAFQueResHiPosMax",0.01},
            {"OBDAdap.MAFQueResLoNegMax",0.01},
            {"OBDAdap.MAFQueResLoPosMax",0.01},
            {"OBDAdap.v_PosChange",0.1},
            {"OBDAdap.v_NegChange",0.1},
            {"OBDAdap.t_NoVSignal",0.1},
            {"OBDAdap.T_Ambient",0.01},
            {"OBDAdap.T_AmbientOld",0.01},
            {"OBDAdap.T_Catalyst",1.0},
            {"OBDAdap.T_Engine",1.0},
            {"OBDAdap.T_Exhaust",1.0},
            {"OBDAdap.T_CatModStop",1.0},
            {"OBDAdap.TCMFaultCode",1.0},
            {"OBDAdap.ST_PurgeFault",1.0},
            {"OBDAdap.X_CIMKill",1.0},
            {"OBDAdap.ST_CCVAdaptionOK",1.0},
            {"OBDAdap.Cnt_SAIFuelAdap",1.0},
            {"OBDAdap.ST_IOTDiagReportOk",1.0},
            {"OBDAdap.ST_IOTDiagReportFail",1.0},
            {"OBDAdapDFReady.IntakeAirTemperatureSensor",1.0},
            {"OBDAdapDFReady.EngineCoolantTemperatureSensor",1.0},
            {"OBDAdapDFReady.ManifoldAbsolutePressureSensor",1.0},
            {"OBDAdapDFReady.TurboChargerBoostSensor",1.0},
            {"OBDAdapDFReady.PowerTrainRelay",1.0},
            {"OBDAdapDFReady.FuelLevelSensorsDiag",1.0},
            {"OBDAdapDFReady.BoostPressureControlValve",1.0},
            {"OBDAdapDFReady.FuelPumpRelay",1.0},
            {"OBDAdapDFReady.AC_ClutchRelay",1.0},
            {"OBDAdapDFReady.BrakeSwitchSignal",1.0},
            {"OBDAdapDFReady.BrakeLightSignal",1.0},
            {"OBDAdapDFReady.ShortTermFuelTrim",1.0},
            {"OBDAdapDFReady.HighSideCoolantRat",1.0},
            {"OBDAdapDFReady.LongTermFuelTrim",1.0},
            {"OBDAdapDFReady.MassAirFlowSensor",1.0},
            {"OBDAdapDFReady.O2SensorPreHeater",1.0},
            {"OBDAdapDFReady.O2SensorPostHeater",1.0},
            {"OBDAdapDFReady.O2SensorPreCat",1.0},
            {"OBDAdapDFReady.O2SensorPostCat",1.0},
            {"OBDAdapDFReady.O2SensorPreSwitchPoint",1.0},
            {"OBDAdapDFReady.O2SensorPreRespons",1.0},
            {"OBDAdapDFReady.TurboChargerBypassValve",1.0},
            {"OBDAdapDFReady.CrankShaftPositionSensor",1.0},
            {"OBDAdapDFReady.EngineCoolantSystem",1.0},
            {"OBDAdapDFReady.TimeToClosedLoop",1.0},
            {"OBDAdapDFReady.CatIdle",1.0},
            {"OBDAdapDFReady.Throttle",1.0},
            {"OBDAdapDFReady.ECMInternal",1.0},
            {"OBDAdapDFReady.Pedal",1.0},
            {"OBDAdapDFReady.HighSpeedBus",1.0},
            {"OBDAdapDFReady.IdleSpeed",1.0},
            {"OBDAdapDFReady.PurgeValve",1.0},
            {"OBDAdapDFReady.CanisterCloseValve",1.0},
            {"OBDAdapDFReady.O2SPostRespDiag",1.0},
            {"OBDAdapDFReady.FuelTankPressure",1.0},
            {"OBDAdapDFReady.FuelTankPressureAdap",1.0},
            {"OBDAdapDFReady.Evaporator",1.0},
            {"OBDAdapDFReady.SAIPressureSensor",1.0},
            {"OBDAdapDFReady.TestCoreDummy1",1.0},
            {"OBDAdapDFReady.TestCoreDummy2",1.0},
            {"OBDAdapDFReady.TestCoreDummy3",1.0},
            {"OBDAdapDFReady.SecondaryAirSystem",1.0},
            {"OBDAdapDFReady.RunCrankSignal",1.0},
            {"OBDAdapDFReady.AccessorySignal",1.0},
            {"OBDAdapDFReady.GeneratorFControl",1.0},
            {"OBDAdapDFReady.GeneratorLControl",1.0},
            {"OBDAdapDFReady.Fan1Control",1.0},
            {"OBDAdapDFReady.Fan2Control",1.0},
            {"OBDAdapDFReady.Fan3Control",1.0},
            {"OBDAdapDFReady.ACPressureSensor",1.0},
            {"OBDAdapDFReady.MisfireFTP",1.0},
            {"OBDAdapDFReady.MisfireCAT",1.0},
            {"OBDAdapDFReady.ClutchSwitchSignal",1.0},
            {"OBDAdapDFReady.PowerSteeringPressureSwitch",1.0},
            {"OBDAdapDFReady.LowSidedCltDiag",1.0},
            {"OBDAdapDFReady.StartRelay",1.0},
            {"OBDAdapDFReady.ABSCANDataError",1.0},
            {"OBDAdapDFReady.TCMCANDataError",1.0},
            {"OBDAdapDFReady.SystemVoltageFault",1.0},
            {"OBDAdapDFReady.Injector1Circuit",1.0},
            {"OBDAdapDFReady.Injector2Circuit",1.0},
            {"OBDAdapDFReady.Injector3Circuit",1.0},
            {"OBDAdapDFReady.Injector4Circuit",1.0},
            {"OBDAdapDFReady.CIMCANDataError",1.0},
            {"OBDAdapDFReady.EngineCoolantTemperatureSensorDev",1.0},
            {"OBDAdapDFReady.Immo",1.0},
            {"OBDAdapDFReady.EngineSync",1.0},
            {"OBDAdapDFReady.CombustionDetect",1.0},
            {"OBDAdapDFReady.EOL",1.0},
            {"OBDAdapDFReady.TCMFreezeFrame1",1.0},
            {"OBDAdapDFReady.TCMFreezeFrame2",1.0},
            {"OBDAdapDFReady.KnockCircuit",1.0},
            {"OBDAdapDFReady.IgnitionCoilTrig1",1.0},
            {"OBDAdapDFReady.IgnitionCoilTrig2",1.0},
            {"OBDAdapDFReady.IgnitionCoilTrig3",1.0},
            {"OBDAdapDFReady.IgnitionCoilTrig4",1.0},
            {"OBDAdapDFReady.IonDetectModule",1.0},
            {"OBDAdapDFReady.EvapProduction",1.0},
            {"OBDAdapDFReady.EvapWorkshop",1.0},
            {"OBDAdapDFReady.ThrottleMinLearn",1.0},
            {"OBDAdapDFReady.ThrottleDefault",1.0},
            {"OBDAdapDFReady.DigitalIDM",1.0},
            {"OBDAdapDFReady.SADSCANDataError",1.0},
            {"OBDAdapDFReady.TCMFreezeFrame3",1.0},
            {"OBDAdapDFReady.ColdStartDiag",1.0},
            {"OBDAdapDFReady.ServiceBayTest",1.0},
            {"OBDAdapDFReady.IOTDiag",1.0},
            {"OBDAdapDFReady.AF40FrezeFrame",1.0},
            {"OBDAdapDFReady.FFSensorFreq",1.0},
            {"OBDAdapDFReady.FuelTransferPump",1.0},
            {"OBDCoreAdap.t_TotalRunTime",0.1},
            {"OBDCoreAdap.n_Runs",1.0},
            {"OBDCoreAdap.MIL_Distance",1.0},
            {"OBDCoreAdap.l_DistSinceFaultsCleared",1.0},
            {"OBDCoreAdap.N_WarmUpCyclesSinceFaultsCleared",1.0},
            {"OBDCoreAdap.injector_tested",1.0},
            {"OBDCoreAdap.ST_EngFlrCdeRtrR",1.0},
            {"OBDAdapEvap.LeakageResult",1.0},
            {"OBDAdapEvap.EvapStack",1.0},
            {"OBDAdapEvap.StackResult",1.0},
            {"OBDAdapEvap.n_Evap2BigResDiff",1.0},
            {"OBDAdapEvap.N_OutOfLimTemp",1.0},
            {"OBDAdapEvap.N_DiagPerformed",1.0},
            {"OBDAdapEvap.ST_StackReady",1.0},
            {"OBDAdapFuelTank.V_FuelTankFilt1",0.1},
            {"OBDAdapFuelTank.V_FuelTankFilt2",0.1},
            {"OBDAdapFuelTank.V_RefuelAfterrunSnapshot",0.1},
            {"OBDAdapFuelTank.l_PrimaryDistance",1.0},
            {"OBDAdapFuelTank.l_SecondaryDistance",1.0},
            {"OBDAdapFuelTank.V_MinFoundActivity1",0.1},
            {"OBDAdapFuelTank.V_MaxFoundActivity1",0.1},
            {"OBDAdapFuelTank.V_MinFoundActivity2",0.1},
            {"OBDAdapFuelTank.V_MaxFoundActivity2",0.1},
            {"OBDAdapFuelTank.l_State2Distance",1.0},
            {"OBDAdapFuelTank.ST_InState2",1.0},
            {"OBDAdapFuelTank.ST_LastErrorReportFromState2",1.0},
            {"OBDAdapFuelTank.ST_V_RefuelAfterrunSnapshotValid",1.0},
            {"OBDAdapFuelTank.ST_V_FuelTankFiltValid",1.0},
            {"OBDAdapFuelTank.t_TransferPumpErrorTimer",0.1},
            {"OBDAdapFuelTank.t_TransferPumpHealTimer",0.1},
            {"T_EstAdap.T_EngineMin",1.0},
            {"T_EstAdap.T_AirInletMin",1.0},
            {"MisfAdap.N_GST_EWMA_MisfCountCyl",1.0},
            {"MisfAdap.N_MisfCountCyl",1.0},
            {"MisfAdap.N_GST_MisfCountCyl",1.0},
            {"MisfAdap.N_FCutActions",1.0},
            {"MisfAdap.t_CombDetFilt2Lev",1.0},
            {"RMAdap.N_EvapNumerator",1.0},
            {"RMAdap.N_EvapDenominator",1.0},
            {"RMAdap.EvapRatio",1.0},
            {"RMAdap.N_O2RespNumerator",1.0},
            {"RMAdap.N_O2RespDenominator",1.0},
            {"RMAdap.O2RespRatio",1.0},
            {"RMAdap.N_O2PostRespNumerator",1.0},
            {"RMAdap.N_O2PostRespDenominator",1.0},
            {"RMAdap.O2PostRespRatio",1.0},
            {"RMAdap.N_CatNumerator",1.0},
            {"RMAdap.N_CatDenominator",1.0},
            {"RMAdap.CatRatio",1.0},
            {"RMAdap.N_SaiNumerator",1.0},
            {"RMAdap.N_SaiDenominator",1.0},
            {"RMAdap.SaiRatio",1.0},
            {"RMAdap.N_AWDTankNumerator",1.0},
            {"RMAdap.N_AWDTankDenominator",1.0},
            {"RMAdap.AWDTankRatio",1.0},
            {"RMAdap.N_EngCoolSysNumerator",1.0},
            {"RMAdap.N_EngCoolSysDenominator",1.0},
            {"RMAdap.EngCoolSysRatio",1.0},
            {"RMAdap.N_GeneralDenominator",1.0},
            {"RMAdap.N_IgnitionCycles",1.0},
            {"AWDTankRatioMonitorAdap.l_DrivingDistanceDen",1.0},
            {"TAmbModAdap.T_AirAmbient",1.0},
            {"GSTServiceAAdap.ST_DCCriteriaSatisfied",1.0},
            {"GSTServiceAAdap.ST_OKCriteriaForDTCSatisifed",1.0},
            {"OBDO2SPostAdap.t_TestResult1",1.0},
            {"OBDO2SPostAdap.t_TestResult1Cat",1.0},
            {"OBDO2SPostAdap.t_TestResult2",1.0},
            {"OBDO2SPostAdap.t_TestResult2Cat",1.0},
            {"OBDO2SPostAdap.t_TstRes1FcutMin",1.0},
            {"OBDO2SPostAdap.t_TstRes1FcutMax",1.0},
            {"OBDO2SPostAdap.ST_TestResultValid",1.0},
            {"LambdaProt.RestartCnt",1.0},
            {"LambdaProt.MinCombCounter",1.0},
            {"LambdaProt.LastCombNr",1.0},
            {"LambdaProt.N_HwCheckStamp",1.0},
            {"LambdaProt.N_BefHWStamp",1.0},
            {"LambdaProt.MinTempCthr",1.0},
            {"LambdaProt.MinTempOthr",1.0},
            {"LambdaProt.U_O2SensSwitchTemp",1.0},
            {"LambdaProt.U_O2SensSwitchAmb",1.0},
            {"LambdaProt.U_O2SensSwitch",1.0},
            {"LambdaProt.U_SwitchLimit",1.0},
            {"LambdaProt.U_SwitchLimitHyst",1.0},
            {"LambdaProt.U_O2SensRearFilt",1.0},
            {"LambdaProt.N_TransDelay",1.0},
            {"LambdaProt.NrComb2",1.0},
            {"LambdaProt.NrConstI",1.0},
            {"LambdaProt.N_SAIDelay",1.0},
            {"LambdaProt.LambdaInt",0.01},
            {"LambdaProt.X_intDevStart",0.01},
            {"LambdaProt.X_intDeviation",0.01},
            {"LambdaProt.X_intDevTarget",0.01},
            {"LambdaProt.LambIntMeanOld",0.01},
            {"LambdaProt.LambIntFreeze",0.01},
            {"LambdaProt.IntStepGain",0.0078125},
            {"LambdaProt.DecStep",0.01},
            {"LambdaProt.DecStepMapVal",0.01},
            {"LambdaProt.DecRamp",0.01},
            {"LambdaProt.IncStep",0.01},
            {"LambdaProt.IncStepMapVal",0.01},
            {"LambdaProt.IncRamp",0.01},
            {"LambdaProt.NoComb",1.0},
            {"LambdaProt.NoCombMax",1.0},
            {"LambdaProt.N_BeforeHW",1.0},
            {"LambdaProt.N_ST15CombDelay",1.0},
            {"LambdaProt.n_WCFCombDelay",1.0},
            {"LambdaProt.ST_intDev",1.0},
            {"LambdaProt.ST_RampOutInt",1.0},
            {"LambdaProt.ST_InitFiltLambda",1.0},
            {"LambdaProt.ST_Restart",1.0},
            {"LambdaProt.ST_Rich",1.0},
            {"LambdaProt.ST_AdapDone",1.0},
            {"LambdaProt.ST_StepDone",1.0},
            {"LambdaProt.ST_SwitchAllowed",1.0},
            {"LambdaProt.ST_SwitchPoint",1.0},
            {"LambdaPostProt.U_O2SensSwitchOffset",1.0},
            {"LambdaPostProt.U_pPart",1.0},
            {"LambdaPostProt.U_O2SensRearError",1.0},
            {"LambdaPostProt.ST_NoAdjustForRearO2Sensor_CatIdleDiag",1.0},
            {"LambdaPostProt.ST_NoAdjustForRearO2Sensor_O2SRespDiag",1.0},
            {"LambdaPostAdapProt.n_delta",1.0},
            {"LambdaPostAdapProt.m_delta",1.0},
            {"LambdaPostAdapProt.U_iPart",1.0},
            {"LambdaPostAdapProt.ST_resetIPart",1.0},
            {"LambdaPostAdapProt.ST_active",1.0},
            {"Lambda.n_NumberOfSwitch",1.0},
            {"Lambda.LambdaInt",0.01},
            {"Lambda.U_O2SensFrontFilt",1.0},
            {"Lambda.TimeLean",1.0},
            {"Lambda.TimeRich",1.0},
            {"Lambda.IntegratorBuf",0.01},
            {"Lambda.LambIntMean",0.01},
            {"Lambda.FuelFac",0.0009765625},
            {"Lambda.ST_Trans",1.0},
            {"Lambda.ST_Enable",1.0},
            {"Lambda.ST_ProbeTime",1.0},
            {"Lambda.Status",1.0},
            {"Lambda.ST_HWDone",1.0},
            {"Lambda.ST_EnrichmentActive",1.0},
            {"FFBoffProt.p_diff",0.1},
            {"FFBoffProt.Q_fuelConstRate",1.0},
            {"FFBoffProt.Q_fuel",1.0},
            {"FFBoffProt.m_fuel",0.01},
            {"FFBoffProt.m_fuelBefComp",0.01},
            {"FFBoffProt.t_constRateTimer",0.1},
            {"FFBoffProt.m_accFuelReduce",0.01},
            {"FFBoffProt.X_blendDiff",0.1},
            {"FFBoffProt.X_blendOld",0.1},
            {"FFBoffProt.ST_subState",1.0},
            {"FFBoffProt.ST_crankSampling",1.0},
            {"FFBoffProt.ST_trigged",1.0},
            {"FFBoffProt.X_constRateEngOff",0.0078125},
            {"FFBoff.X_constRateInt",0.0009765625},
            {"FFBoff.ST_active",1.0},
            {"FFBoff.ST_fuelAdap",1.0},
            {"EnableDiagCal.IntakeAirTemperatureSensor",1.0},
            {"EnableDiagCal.EngineCoolantTemperatureSensor",1.0},
            {"EnableDiagCal.ManifoldAbsolutePressureSensor",1.0},
            {"EnableDiagCal.TurboChargerBoostSensor",1.0},
            {"EnableDiagCal.PowerTrainRelay",1.0},
            {"EnableDiagCal.FuelLevelSensorsDiag",1.0},
            {"EnableDiagCal.BoostPressureControlValve",1.0},
            {"EnableDiagCal.FuelPumpRelay",1.0},
            {"EnableDiagCal.AC_ClutchRelay",1.0},
            {"EnableDiagCal.BrakeSwitchSignal",1.0},
            {"EnableDiagCal.BrakeLightSignal",1.0},
            {"EnableDiagCal.ShortTermFuelTrim",1.0},
            {"EnableDiagCal.HighSideCoolantRat",1.0},
            {"EnableDiagCal.LongTermFuelTrim",1.0},
            {"EnableDiagCal.MassAirFlowSensor",1.0},
            {"EnableDiagCal.O2SensorPreHeater",1.0},
            {"EnableDiagCal.O2SensorPostHeater",1.0},
            {"EnableDiagCal.O2SensorPreCat",1.0},
            {"EnableDiagCal.O2SensorPostCat",1.0},
            {"EnableDiagCal.O2SensorPreSwitchPoint",1.0},
            {"EnableDiagCal.O2SensorPreRespons",1.0},
            {"EnableDiagCal.TurboChargerBypassValve",1.0},
            {"EnableDiagCal.CrankShaftPositionSensor",1.0},
            {"EnableDiagCal.EngineCoolantSystem",1.0},
            {"EnableDiagCal.TimeToClosedLoop",1.0},
            {"EnableDiagCal.CatIdle",1.0},
            {"EnableDiagCal.Throttle",1.0},
            {"EnableDiagCal.ECMInternal",1.0},
            {"EnableDiagCal.Pedal",1.0},
            {"EnableDiagCal.HighSpeedBus",1.0},
            {"EnableDiagCal.IdleSpeed",1.0},
            {"EnableDiagCal.PurgeValve",1.0},
            {"EnableDiagCal.CanisterCloseValve",1.0},
            {"EnableDiagCal.O2SPostRespDiag",1.0},
            {"EnableDiagCal.FuelTankPressure",1.0},
            {"EnableDiagCal.FuelTankPressureAdap",1.0},
            {"EnableDiagCal.Evaporator",1.0},
            {"EnableDiagCal.SAIPressureSensor",1.0},
            {"EnableDiagCal.TestCoreDummy1",1.0},
            {"EnableDiagCal.TestCoreDummy2",1.0},
            {"EnableDiagCal.TestCoreDummy3",1.0},
            {"EnableDiagCal.SecondaryAirSystem",1.0},
            {"EnableDiagCal.RunCrankSignal",1.0},
            {"EnableDiagCal.AccessorySignal",1.0},
            {"EnableDiagCal.GeneratorFControl",1.0},
            {"EnableDiagCal.GeneratorLControl",1.0},
            {"EnableDiagCal.Fan1Control",1.0},
            {"EnableDiagCal.Fan2Control",1.0},
            {"EnableDiagCal.Fan3Control",1.0},
            {"EnableDiagCal.ACPressureSensor",1.0},
            {"EnableDiagCal.MisfireFTP",1.0},
            {"EnableDiagCal.MisfireCAT",1.0},
            {"EnableDiagCal.ClutchSwitchSignal",1.0},
            {"EnableDiagCal.PowerSteeringPressureSwitch",1.0},
            {"EnableDiagCal.LowSidedCltDiag",1.0},
            {"EnableDiagCal.StartRelay",1.0},
            {"EnableDiagCal.ABSCANDataError",1.0},
            {"EnableDiagCal.TCMCANDataError",1.0},
            {"EnableDiagCal.SystemVoltageFault",1.0},
            {"EnableDiagCal.Injector1Circuit",1.0},
            {"EnableDiagCal.Injector2Circuit",1.0},
            {"EnableDiagCal.Injector3Circuit",1.0},
            {"EnableDiagCal.Injector4Circuit",1.0},
            {"EnableDiagCal.CIMCANDataError",1.0},
            {"EnableDiagCal.EngineCoolantTemperatureSensorDev",1.0},
            {"EnableDiagCal.Immo",1.0},
            {"EnableDiagCal.EngineSync",1.0},
            {"EnableDiagCal.CombustionDetect",1.0},
            {"EnableDiagCal.EOL",1.0},
            {"EnableDiagCal.TCMFreezeFrame1",1.0},
            {"EnableDiagCal.TCMFreezeFrame2",1.0},
            {"EnableDiagCal.KnockCircuit",1.0},
            {"EnableDiagCal.IgnitionCoilTrig1",1.0},
            {"EnableDiagCal.IgnitionCoilTrig2",1.0},
            {"EnableDiagCal.IgnitionCoilTrig3",1.0},
            {"EnableDiagCal.IgnitionCoilTrig4",1.0},
            {"EnableDiagCal.IonDetectModule",1.0},
            {"EnableDiagCal.EvapProduction",1.0},
            {"EnableDiagCal.EvapWorkshop",1.0},
            {"EnableDiagCal.ThrottleMinLearn",1.0},
            {"EnableDiagCal.ThrottleDefault",1.0},
            {"EnableDiagCal.DigitalIDM",1.0},
            {"EnableDiagCal.SADSCANDataError",1.0},
            {"EnableDiagCal.TCMFreezeFrame3",1.0},
            {"EnableDiagCal.ColdStartDiag",1.0},
            {"EnableDiagCal.ServiceBayTest",1.0},
            {"EnableDiagCal.IOTDiag",1.0},
            {"EnableDiagCal.AF40FrezeFrame",1.0},
            {"EnableDiagCal.FFSensorFreq",1.0},
            {"EnableDiagCal.FuelTransferPump",1.0},
            {"CoreDiagCal.T_AirLoOBDLim",1.0},
            {"CoreDiagCal.T_EngLoOBDLim",1.0},
            {"CoreDiagCal.T_AirHiOBDLim",1.0},
            {"CoreDiagCal.T_EngHiOBDLim",1.0},
            {"CoreDiagCal.p_AirLoOBDLim",0.1},
            {"CoreDiagCal.p_AirHiOBDLim",0.1},
            {"CoreDiagCal.U_LowLim",0.1},
            {"CoreDiagCal.U_HighLim",0.1},
            {"CoreDiagCal.ST_ManufactorCode",1.0},
            {"CoreDiagCal.t_delayBatOutOfLim",0.1},
            {"CoreDiagCal.p_PosAmbDiffLim",0.1},
            {"CoreDiagCal.p_NegAmbDiffLim",0.1},
            {"CoreDiagCal.p_AmbDiffLimSP",0.1},
            {"CoreDiagCal.ST_ActiveDiagSystem",1.0},
            {"CoreDiagCal.ST_ACType",1.0},
            {"CoreDiagCal.ST_EnableOBD2Limit",1.0},
            {"CoreDiagCal.ST_FaultCodeNoDelete",1.0},
            {"CoreDiagCal.ST_dependBlink",1.0},
            {"CoreDiagCal.ST_NoReportTimer",1.0},
            {"CoreDiagCal.ST_OnlyDeviceCheck",1.0},
            {"CoreDiagCal.ST_SVSLampTest",1.0},
            {"CoreDiagCal.ST_NoSVSUntilReport",1.0},
            {"CoreDiagCal.ST_FailMemViaMILBlinkCode",1.0},
            {"CoreDiagCal.ST_GSTServ9InfoType8",1.0},
            {"CoreDiagCal.ST_GSTPID46",1.0},
            {"MAPDiagCal.p_RelPedalPresLimit",0.1},
            {"MAPDiagCal.p_MAPDevLim",0.1},
            {"MAPDiagCal.p_SAI_PBefDevLim",0.1},
            {"MAPDiagCal.n_rpmLim",1.0},
            {"MAPDiagCal.m_loadLim",1.0},
            {"MAPDiagCal.N_PressReadings",1.0},
            {"MAPDiagCal.N_RelPedalPresReadings",1.0},
            {"MAPDiagCal.p_crankLowLim",0.1},
            {"MAPDiagCal.p_crankUpperLim",0.1},
            {"MAPDiagCal.t_crankLim",0.1},
            {"PBefDiagCal.p_PBefDevLim",0.1},
            {"PBefDiagCal.p_MAP_SAIDevLim",0.1},
            {"PBefDiagCal.N_PressReadings",1.0},
            {"SAISensDiagCal.p_SAIDevLim",0.1},
            {"SAISensDiagCal.p_MAP_PBefDevLim",0.1},
            {"SAISensDiagCal.N_PressReadings",1.0},
            {"MAFDiagCal.Q_hiWindowLim",0.01},
            {"MAFDiagCal.MinErrAndFuelAdap",0.01},
            {"MAFDiagCal.MaxErrAndFuelAdap",0.01},
            {"MAFDiagCal.MaxErr",0.01},
            {"MAFDiagCal.MinErr",0.01},
            {"MAFDiagCal.MinFuelAdapLim",0.01},
            {"MAFDiagCal.MaxFuelAdapLim",0.01},
            {"MAFDiagCal.p_AirInletSteadyState",0.1},
            {"MAFDiagCal.Q_PreCondMin",0.01},
            {"MAFDiagCal.t_bypassSteady",0.1},
            {"MAFDiagCal.n_PreCondMin",1.0},
            {"MAFDiagCal.n_PreCondMax",1.0},
            {"MAFDiagCal.T_PreCondMin",1.0},
            {"MAFDiagCal.T_PreCondMax",1.0},
            {"MAFDiagCal.p_MaxInlBefQuote",1.0},
            {"MAFDiagCal.p_MinInlBefQuote",1.0},
            {"MAFDiagCal.t_vPreCond",0.1},
            {"MAFDiagCal.v_PreCond",0.1},
            {"MAFDiagCal.n_samplesForEval",1.0},
            {"MAFDiagCal.t_SteadyState",0.1},
            {"MAFDiagCal.ST_PurgeMode",1.0},
            {"MAFDiagCal.N_SamplesInElement",1.0},
            {"BoostDiagCal.t_Error",0.1},
            {"BoostDiagCal.t_Ok",0.1},
            {"BoostDiagCal.t_OkSlope",0.1},
            {"BoostDiagCal.m_DiffBoostError",1.0},
            {"BoostDiagCal.p_MaxLimHighAlt",0.1},
            {"BoostDiagCal.p_MaxLimLowAlt",0.1},
            {"BoostDiagCal.p_AirAmbientLim",0.1},
            {"BoostDiagCal.p_MAP_MinLimOK",0.1},
            {"BoostDiagCal.pBef_MAPMeanLim",0.1},
            {"BoostDiagCal.pMaxAirSlope",0.1},
            {"BoostDiagCal.pMinAirSlope",0.1},
            {"BoostDiagCal.X_MaxPedal",0.1},
            {"BoostDiagCal.X_MinPedal",0.1},
            {"BoostDiagCal.X_PedalSteady",0.1},
            {"BoostDiagCal.n_LowLim",1.0},
            {"BoostDiagCal.n_HighLim150",1.0},
            {"BoostDiagCal.n_HighLim175",1.0},
            {"BoostDiagCal.T_RunLimit",1.0},
            {"BoostDiagCal.ST_AirMode",1.0},
            {"BoostDiagCal.ST_AdapCondUsed",1.0},
            {"BypassDiagCal.p_ErrorLim",0.1},
            {"BypassDiagCal.p_OkLim",0.1},
            {"BypassDiagCal.p_MinBefStart",0.1},
            {"BypassDiagCal.p_AirInletMax",0.1},
            {"BypassDiagCal.n_MaxLim",1.0},
            {"BypassDiagCal.A_ThrOkLim",0.1},
            {"BypassDiagCal.t_pBefDrop",0.1},
            {"BypassDiagCal.Q_ErrorLim",0.01},
            {"BypassDiagCal.Q_OkLim",0.01},
            {"CatDiagCal.t_O2PostDelay",1.0},
            {"CatDiagCal.t_Ph3Min",1.0},
            {"CatDiagCal.t_FromStartMin",0.1},
            {"CatDiagCal.t_TrqDelayRecover",0.1},
            {"CatDiagCal.t_DelayTrgReqRamp",1.0},
            {"CatDiagCal.t_DelayGetDiagPriority",0.1},
            {"CatDiagCal.Q_Max",0.01},
            {"CatDiagCal.Q_Min",0.01},
            {"CatDiagCal.flowDec",0.01},
            {"CatDiagCal.flowInc",0.01},
            {"CatDiagCal.m_FuelCutLoadLim",1.0},
            {"CatDiagCal.n_Max",1.0},
            {"CatDiagCal.n_Min",1.0},
            {"CatDiagCal.T_CatMin",1.0},
            {"CatDiagCal.T_CatMax",1.0},
            {"CatDiagCal.v_VehicleMax",0.1},
            {"CatDiagCal.O2PostMax",1.0},
            {"CatDiagCal.O2postStartPh1Min",1.0},
            {"CatDiagCal.O2postStartPh3Min",1.0},
            {"CatDiagCal.LambdaMax",0.01},
            {"CatDiagCal.LambdaMin",0.01},
            {"CatDiagCal.FuelCutPosStep",1.0},
            {"CatDiagCal.FuelCutNegStep",1.0},
            {"CatDiagCal.FuelFacRampStep",1.0},
            {"CatDiagCal.FuelFacRampUpStep",1.0},
            {"CatDiagCal.FuelFacRecoverStep",1.0},
            {"CatDiagCal.ph2FuelFac",0.0009765625},
            {"CatDiagCal.ph3FuelFac",0.0009765625},
            {"CatDiagCal.Ph3LowPassCoef",0.0009765625},
            {"CatDiagCal.X_TExhUpCoef",0.0009765625},
            {"CatDiagCal.X_TExhDownCoef",0.0009765625},
            {"CatDiagCal.Trq_ReqAndRes",0.1},
            {"CatDiagCal.Trq_ReqAndResStep",0.1},
            {"CatDiagCal.Trq_ResStep",0.1},
            {"CatDiagCal.Trq_RecoverStep",0.1},
            {"CatDiagCal.LambdaMeanDiff",0.01},
            {"CatDiagCal.T_CatSP",1.0},
            {"CatDiagCal.T_CatMulFacTAB",0.0009765625},
            {"CatDiagCal.Q_AirMeanSP",0.01},
            {"CatDiagCal.LoadMulFacTAB",0.0009765625},
            {"CatDiagCal.RecoverRampUpStep",1.0},
            {"CatDiagCal.TrqReqPhase2",0.1},
            {"CatDiagCal.TrqReqPhase3",0.1},
            {"CatDiagCal.LambdaRampFactor",0.0009765625},
            {"CatDiagCal.Q_AirSP",0.01},
            {"CatDiagCal.t_Ph2MaxMAT",1.0},
            {"CatDiagCal.t_Ph3MaxMAT",1.0},
            {"CatDiagCal.U_MaxStartPh3",1.0},
            {"CatDiagCal.n_MinBeforeElevIdle",1.0},
            {"CatDiagCal.N_MaxDiag2Run",1.0},
            {"CatDiagCal.N_LambdaSwitches",1.0},
            {"CatDiagCal.ST_ReqElevIdle",1.0},
            {"CatDiagCal.N_BrakeLightMax",1.0},
            {"CatDiagCal.ST_StopDiagDuringMisfire",1.0},
            {"EvapDiagCal.p_Ramp0AllowedRipple",1.0},
            {"EvapDiagCal.p_Ramp0MaxDiff",1.0},
            {"EvapDiagCal.p_Ramp1AllowedRipple",1.0},
            {"EvapDiagCal.p_Ramp1MaxDiff",1.0},
            {"EvapDiagCal.p_Ramp2AllowedRipple",1.0},
            {"EvapDiagCal.p_Ramp2MaxDiff",1.0},
            {"EvapDiagCal.p_MaxTank",1.0},
            {"EvapDiagCal.T_HiLim",1.0},
            {"EvapDiagCal.T_LoLim",1.0},
            {"EvapDiagCal.T_AmbHiLim",1.0},
            {"EvapDiagCal.T_StartExecCtrl",1.0},
            {"EvapDiagCal.V_FuelMax",0.1},
            {"EvapDiagCal.V_FuelMin",0.1},
            {"EvapDiagCal.V_Test1FuelYSP",0.1},
            {"EvapDiagCal.V_Test2FuelYSP",0.1},
            {"EvapDiagCal.maxPosR2Diff",0.1},
            {"EvapDiagCal.maxNegR2Diff",0.1},
            {"EvapDiagCal.m_Delta",1.0},
            {"EvapDiagCal.t_MaxColdStart",0.1},
            {"EvapDiagCal.t_ExtColdStart",0.1},
            {"EvapDiagCal.t_DelayGetDiagPriority",0.1},
            {"EvapDiagCal.RampTimeUpEvap",0.1},
            {"EvapDiagCal.LeakFacTest1MAT",0.1},
            {"EvapDiagCal.LeakFacTest2MAT",0.1},
            {"EvapDiagCal.ramp0LoLim",0.1},
            {"EvapDiagCal.X_BlendDecisionLim",0.1},
            {"EvapDiagCal.Ramp2ResultXSP",1.0},
            {"EvapDiagCal.N_VapourLimTest1",1.0},
            {"EvapDiagCal.N_VapourLimTest2",1.0},
            {"EvapDiagCal.n_StackSize",1.0},
            {"EvapDiagCal.MaxResultDiff",1.0},
            {"EvapDiagCal.HCContEvapFiltFac",1.0},
            {"EvapDiagCal.n_StackFilledForFC",1.0},
            {"EvapTestCal1.p_MinTank",1.0},
            {"EvapTestCal1.p_Level1Ramp1",1.0},
            {"EvapTestCal1.p_Level2Ramp1",1.0},
            {"EvapTestCal1.p_Level3Ramp1",1.0},
            {"EvapTestCal1.p_PurgeFlowL2",1.0},
            {"EvapTestCal1.p_PurgeFlowL3",1.0},
            {"EvapTestCal1.PurgeloLim",0.01},
            {"EvapTestCal1.HCContDiff",0.01},
            {"EvapTestCal1.LambdaIntLim",0.01},
            {"EvapTestCal1.v_loLim",0.1},
            {"EvapTestCal1.v_hiLim",0.1},
            {"EvapTestCal1.v_Diff",0.1},
            {"EvapTestCal1.t_PressureIncrease",0.1},
            {"EvapTestCal1.t_StabilePressBefRamp0",0.1},
            {"EvapTestCal1.t_ramp2Eval",0.1},
            {"EvapTestCal1.t_Level1",0.1},
            {"EvapTestCal1.t_Level2",0.1},
            {"EvapTestCal1.t_Level3",0.1},
            {"EvapTestCal1.t_breakWaitTime",0.1},
            {"EvapTestCal1.t_Precondition",0.1},
            {"EvapTestCal1.PurgeDiagFlow",1.0},
            {"EvapTestCal1.PurgeDiagFlowL2",1.0},
            {"EvapTestCal1.PurgeDiagFlowL3",1.0},
            {"EvapTestCal1.p_AirAmbientDelta",0.1},
            {"EvapTestCal1.ramp0HiLim",0.1},
            {"EvapTestCal1.n_maxRamp2Eval",1.0},
            {"EvapTestCal1.n_BrakeChangeLim",1.0},
            {"EvapTestCal2.p_MinTank",1.0},
            {"EvapTestCal2.p_Level1Ramp1",1.0},
            {"EvapTestCal2.p_Level2Ramp1",1.0},
            {"EvapTestCal2.p_Level3Ramp1",1.0},
            {"EvapTestCal2.p_PurgeFlowL2",1.0},
            {"EvapTestCal2.p_PurgeFlowL3",1.0},
            {"EvapTestCal2.PurgeloLim",0.01},
            {"EvapTestCal2.HCContDiff",0.01},
            {"EvapTestCal2.LambdaIntLim",0.01},
            {"EvapTestCal2.v_loLim",0.1},
            {"EvapTestCal2.v_hiLim",0.1},
            {"EvapTestCal2.v_Diff",0.1},
            {"EvapTestCal2.t_PressureIncrease",0.1},
            {"EvapTestCal2.t_StabilePressBefRamp0",0.1},
            {"EvapTestCal2.t_ramp2Eval",0.1},
            {"EvapTestCal2.t_Level1",0.1},
            {"EvapTestCal2.t_Level2",0.1},
            {"EvapTestCal2.t_Level3",0.1},
            {"EvapTestCal2.t_breakWaitTime",0.1},
            {"EvapTestCal2.t_Precondition",0.1},
            {"EvapTestCal2.PurgeDiagFlow",1.0},
            {"EvapTestCal2.PurgeDiagFlowL2",1.0},
            {"EvapTestCal2.PurgeDiagFlowL3",1.0},
            {"EvapTestCal2.p_AirAmbientDelta",0.1},
            {"EvapTestCal2.ramp0HiLim",0.1},
            {"EvapTestCal2.n_maxRamp2Eval",1.0},
            {"EvapTestCal2.n_BrakeChangeLim",1.0},
            {"EvapTestCal3.p_MinTank",1.0},
            {"EvapTestCal3.p_Level1Ramp1",1.0},
            {"EvapTestCal3.p_Level2Ramp1",1.0},
            {"EvapTestCal3.p_Level3Ramp1",1.0},
            {"EvapTestCal3.p_PurgeFlowL2",1.0},
            {"EvapTestCal3.p_PurgeFlowL3",1.0},
            {"EvapTestCal3.PurgeloLim",0.01},
            {"EvapTestCal3.HCContDiff",0.01},
            {"EvapTestCal3.LambdaIntLim",0.01},
            {"EvapTestCal3.v_loLim",0.1},
            {"EvapTestCal3.v_hiLim",0.1},
            {"EvapTestCal3.v_Diff",0.1},
            {"EvapTestCal3.t_PressureIncrease",0.1},
            {"EvapTestCal3.t_StabilePressBefRamp0",0.1},
            {"EvapTestCal3.t_ramp2Eval",0.1},
            {"EvapTestCal3.t_Level1",0.1},
            {"EvapTestCal3.t_Level2",0.1},
            {"EvapTestCal3.t_Level3",0.1},
            {"EvapTestCal3.t_breakWaitTime",0.1},
            {"EvapTestCal3.t_Precondition",0.1},
            {"EvapTestCal3.PurgeDiagFlow",1.0},
            {"EvapTestCal3.PurgeDiagFlowL2",1.0},
            {"EvapTestCal3.PurgeDiagFlowL3",1.0},
            {"EvapTestCal3.p_AirAmbientDelta",0.1},
            {"EvapTestCal3.ramp0HiLim",0.1},
            {"EvapTestCal3.n_maxRamp2Eval",1.0},
            {"EvapTestCal3.n_BrakeChangeLim",1.0},
            {"CCVDiagCal.p_MinLim",1.0},
            {"CCVDiagCal.p_OkLim",1.0},
            {"CCVDiagCal.t_Error",0.1},
            {"PurgeDiagCal.ramp0ErrorLim",0.1},
            {"PurgeDiagCal.p_AllowedRipple",1.0},
            {"PurgeDiagCal.p_MaxPDiff",1.0},
            {"LongTermDiagCal.MapFilterCoef",0.0009765625},
            {"LongTermDiagCal.MapAdapLim",0.01},
            {"LongTermDiagCal.AdapSamplesForOk",1.0},
            {"LongTermDiagCal.MapAdapCntLim",1.0},
            {"LongTermDiagCal.MapAdapCntLimMAF",1.0},
            {"LongTermDiagCal.n_MAFCheckLowLimit",1.0},
            {"LongTermDiagCal.n_MAFCheckHighLimit",1.0},
            {"LongTermDiagCal.m_MAFCheckLowLimit",1.0},
            {"LongTermDiagCal.m_MAFCheckHighLimit",1.0},
            {"O2SRespDiagCal.Comb1",1.0},
            {"O2SRespDiagCal.Comb2",1.0},
            {"O2SRespDiagCal.t_ToStartTest",0.1},
            {"O2SRespDiagCal.t_CondTrue",0.1},
            {"O2SRespDiagCal.lambdaLim",0.01},
            {"O2SRespDiagCal.RampFactor",0.0009765625},
            {"O2SRespDiagCal.n_EngineMin",1.0},
            {"O2SRespDiagCal.n_EngineMax",1.0},
            {"O2SRespDiagCal.n_EngYSP",1.0},
            {"O2SRespDiagCal.m_AirmassXSP",1.0},
            {"O2SRespDiagCal.m_AirLow",1.0},
            {"O2SRespDiagCal.m_AirHigh",1.0},
            {"O2SRespDiagCal.m_PosDeltaMax",1.0},
            {"O2SRespDiagCal.m_NegDeltaMax",1.0},
            {"O2SRespDiagCal.m_CntUpAut",1.0},
            {"O2SRespDiagCal.m_CntDwAut",1.0},
            {"O2SRespDiagCal.m_CntUpMan",1.0},
            {"O2SRespDiagCal.m_CntDwMan",1.0},
            {"O2SRespDiagCal.LoadCntDown",1.0},
            {"O2SRespDiagCal.LoadCntLim",1.0},
            {"O2SRespDiagCal.CombMulFacMAT",0.0009765625},
            {"O2SRespDiagCal.FiltCo",0.0009765625},
            {"O2SRespDiagCal.MinFuelFac",0.01},
            {"O2SRespDiagCal.PreMinFlanks",1.0},
            {"O2SRespDiagCal.ST_RestartDiag",1.0},
            {"O2SPostDiagCal.X_FiltConst",0.0009765625},
            {"O2SPostDiagCal.t_HighFaultMax",0.1},
            {"O2SPostDiagCal.U_HighFault",1.0},
            {"O2SPostDiagCal.U_HighLimit",1.0},
            {"O2SPostDiagCal.t_LowFaultMax",0.1},
            {"O2SPostDiagCal.U_LowFault",1.0},
            {"O2SPostDiagCal.t_LambdaMin",0.1},
            {"O2SPostDiagCal.U_DeadHigh",1.0},
            {"O2SPostDiagCal.U_DeadLow",1.0},
            {"O2SPostDiagCal.t_DeadMax",0.1},
            {"O2SPostDiagCal.LambdaMax",0.01},
            {"O2SPostDiagCal.LambdaMin",0.01},
            {"O2SPostDiagCal.m_MinLimLowFault",1.0},
            {"O2SPostDiagCal.N_HighLimit",1.0},
            {"O2SPostDiagCal.N_ActiveTests",1.0},
            {"O2SPostRespDiagCal.T_EngineMin",1.0},
            {"O2SPostRespDiagCal.m_MaxDeltaLoad",1.0},
            {"O2SPostRespDiagCal.t_MinDeltaLoadOK",0.1},
            {"O2SPostRespDiagCal.t_MinInClosedLoop",0.1},
            {"O2SPostRespDiagCal.t_MaxSinceClosedLoop",1.0},
            {"O2SPostRespDiagCal.X_t_MisfDetectLevelFiltFac",0.0009765625},
            {"O2SPostRespDiagCal.t_DelayAfterAbort",1.0},
            {"O2SPostRespDiagCal.t_MisfDetectLevelMax",1.0},
            {"O2SPostRespDiagCal.U_MinBeforeTest",1.0},
            {"O2SPostRespDiagCal.U_TestHigh",1.0},
            {"O2SPostRespDiagCal.U_TestHighCat",1.0},
            {"O2SPostRespDiagCal.U_TestLow1",1.0},
            {"O2SPostRespDiagCal.U_TestLow1Cat",1.0},
            {"O2SPostRespDiagCal.t_RespLimit1",1.0},
            {"O2SPostRespDiagCal.t_RespLimit1Cat",1.0},
            {"O2SPostRespDiagCal.U_TestLow2",1.0},
            {"O2SPostRespDiagCal.U_TestLow2Cat",1.0},
            {"O2SPostRespDiagCal.t_RespLimit2",1.0},
            {"O2SPostRespDiagCal.t_RespLimit2Cat",1.0},
            {"O2SPostRespDiagCal.t_RespMax",1.0},
            {"O2SPostRespDiagCal.t_RespMaxCat",1.0},
            {"O2SPostRespDiagCal.ST_RestartDiag",1.0},
            {"O2SPostRespDiagCal.ST_DiagDuringFCut",1.0},
            {"O2SPreDiagCal.m_MinLimLowFault",1.0},
            {"O2SPreDiagCal.T_O2SStartSP",1.0},
            {"O2SPreDiagCal.t_O2SStartTAB",0.1},
            {"O2SPreDiagCal.t_HighFaultMax",0.1},
            {"O2SPreDiagCal.U_HighFault",1.0},
            {"O2SPreDiagCal.U_HighLimit",1.0},
            {"O2SPreDiagCal.t_LowFaultMax",0.1},
            {"O2SPreDiagCal.U_LowFault",1.0},
            {"O2SPreDiagCal.U_O2SPostMax",1.0},
            {"O2SPreDiagCal.t_MinusBrokenFaultMax",0.1},
            {"O2SPreDiagCal.MinusBrokenLambdaMax",0.01},
            {"O2SPreDiagCal.MaxLeanConstAdap",1.0},
            {"O2SPreDiagCal.MaxRichConstAdap",1.0},
            {"O2SPreDiagCal.N_HighLimit",1.0},
            {"O2SPreDiagCal.N_ActiveTests",1.0},
            {"O2SPreHeatDiagCal.I_Min",1.0},
            {"O2SPreHeatDiagCal.I_Max",1.0},
            {"O2SPreHeatDiagCal.PWM_Min",1.0},
            {"O2SPreHeatDiagCal.PWM_Max",1.0},
            {"O2SPreHeatDiagCal.t_ITFaultLimit",0.1},
            {"O2SPostHeatDiagCal.I_Min",1.0},
            {"O2SPostHeatDiagCal.I_Max",1.0},
            {"O2SPostHeatDiagCal.PWM_Min",1.0},
            {"O2SPostHeatDiagCal.PWM_Max",1.0},
            {"O2SPostHeatDiagCal.t_ITFaultLimit",0.1},
            {"BrSwDiagCal.v_LowLim",0.1},
            {"BrSwDiagCal.v_HighLim",0.1},
            {"BrSwDiagCal.t_LowLim",0.1},
            {"BrSwDiagCal.t_HighLim",0.1},
            {"BrSwDiagCal.t_accLowLim",0.1},
            {"BrSwDiagCal.t_accHighLim",0.1},
            {"BrLghtDiagCal.v_LowLim",0.1},
            {"BrLghtDiagCal.v_HighLim",0.1},
            {"BrLghtDiagCal.t_LowLim",0.1},
            {"BrLghtDiagCal.t_HighLim",0.1},
            {"BrLghtDiagCal.t_accLowLim",0.1},
            {"BrLghtDiagCal.t_accHighLim",0.1},
            {"CluSwDiagCal.v_LowLim",0.1},
            {"CluSwDiagCal.v_HighLim",0.1},
            {"CluSwDiagCal.t_LowLim",0.1},
            {"CluSwDiagCal.t_HighLim",0.1},
            {"PSSwDiagCal.t_FaultLim",0.1},
            {"pTankDiagCal.t_FlankShift",0.1},
            {"pTankDiagCal.N_maxFlankShifts",1.0},
            {"pTankDiagCal.p_maxDiff",1.0},
            {"pTankDiagCal.compLim",1.0},
            {"pTankDiagCal.V_FuelMax",0.1},
            {"FuelActivityCal.Distance2EU",1.0},
            {"FuelActivityCal.Distance2US",1.0},
            {"FuelActivityCal.V_ActivityCheck",0.1},
            {"FuelActivityCal.V_MaxLimEU",0.1},
            {"FuelActivityCal.V_MaxLimUS",0.1},
            {"FuelActivityCal.V_MinLimEU",0.1},
            {"FuelActivityCal.V_MinLimUS",0.1},
            {"FuelLvlSensDiagCal.t_RefuelAfterrunSnapshot",0.1},
            {"FuelLvlSensDiagCal.V_MinRefuelDiff",0.1},
            {"FuelLvlSensDiagCal.t_RefuelAfterStopSnapshot",0.1},
            {"FuelLvlSensDiagCal.t_RefuelMinStopDuration",0.1},
            {"FuelLvlSensDiagCal.v_MinLimitForLPFilter",0.1},
            {"FuelLvlSensDiagCal.l_MinDistanceForValidOut",1.0},
            {"FuelLvlSensDiagCal.X_Vol1FiltConst",0.0009765625},
            {"FuelLvlSensDiagFWDCal.V_ActivityCheckDistLimit",0.1},
            {"FuelLvlSensDiagFWDCal.l_DistanceActivity1",1.0},
            {"FuelLvlSensDiagFWDCal.l_DistanceActivity2",1.0},
            {"FuelLvlSensDiagAWDCal.X_Vol2FiltConst",0.0009765625},
            {"FuelLvlSensDiagAWDCal.V_PrimaryMinLimit",0.1},
            {"FuelLvlSensDiagAWDCal.V_PrimaryMaxLimit",0.1},
            {"FuelLvlSensDiagAWDCal.V_SecondaryMinLimit",0.1},
            {"FuelLvlSensDiagAWDCal.V_SecondaryMaxLimit",0.1},
            {"FuelLvlSensDiagAWDCal.t_StateTransitionDelay",0.1},
            {"FuelLvlSensDiagAWDCal.t_TransferDelay",0.1},
            {"FuelLvlSensDiagAWDCal.t_TransferHealingDelay",0.1},
            {"FuelLvlSensDiagAWDCal.V_ActivityCheck1",0.1},
            {"FuelLvlSensDiagAWDCal.V_ActivityCheck2",0.1},
            {"FuelLvlSensDiagAWDCal.l_DistanceActivity1",1.0},
            {"FuelLvlSensDiagAWDCal.l_DistanceActivity2",1.0},
            {"FuelLvlSensDiagAWDCal.l_DistanceActivity5",1.0},
            {"FuelLvlSensDiagAWDCal.l_DistanceStuckInState2",1.0},
            {"FuelLvlSensDiagAWDCal.V_TransferPumpVolume",0.1},
            {"FuelLvlSensDiagAWDCal.V_TransferPumpFaultTankDiff",0.1},
            {"AWDTankRatioMonitorCal.l_DenumeratorLimit",1.0},
            {"TEngDiagCal.n_deadCombLim",1.0},
            {"TEngDiagCal.T_deadDiffLim",1.0},
            {"TEngDiagCal.T_DiffExhTAir",1.0},
            {"TEngDiagCal.T_DeadLim",1.0},
            {"TEngDiagCal.T_IgnErrLim",1.0},
            {"TEngDiagCal.T_QCMeanErrLim",1.0},
            {"TEngDiagCal.T_QCErrLim",1.0},
            {"TEngDiagCal.T_BigQC",1.0},
            {"TEngDiagCal.v_deadLim",0.1},
            {"TEngDiagCal.m_LowLim",1.0},
            {"TEngDiagCal.m_HighLim",1.0},
            {"TEngDiagCal.t_mLowLim",0.1},
            {"TEngDiagCal.t_mHighLim",0.1},
            {"TEngDevDiagCal.LinearLim",1.0},
            {"TEngDevDiagCal.OffsetLim",1.0},
            {"TCoolDiagCal.T_PreCondLim",1.0},
            {"TCoolDiagCal.T_EvalNeg",1.0},
            {"TCoolDiagCal.T_EvalPos",1.0},
            {"TCoolDiagCal.T_DiffTAirTExh",1.0},
            {"TCoolDiagCal.T_DiffTEngTAir",1.0},
            {"TCoolDiagCal.t_Accum",0.1},
            {"TCoolDiagCal.t_HighSpeedPreCond",0.1},
            {"TCoolDiagCal.t_PreCond",0.1},
            {"TCoolDiagCal.X_IdlePercent",1.0},
            {"TCoolDiagCal.n_EngineNominal",1.0},
            {"TCoolDiagCal.K_TAirInletMin",0.01},
            {"TCoolDiagCal.K_TEngineStart",0.01},
            {"TCoolDiagCal.K_IdlePercent",0.01},
            {"TCoolDiagCal.K_RunTime",0.01},
            {"TCoolDiagCal.K_TErrMin",0.01},
            {"TCoolDiagCal.t_LowPreCond",0.1},
            {"TCoolDiagCal.t_HighPreCond",0.1},
            {"TCoolDiagCal.t_EngFallingTemp",0.1},
            {"TCoolDiagCal.T_StartDiag",1.0},
            {"TCoolDiagCal.T_EngFallingLimit",1.0},
            {"TCoolDiagCal.X_FuelCut",1.0},
            {"TCoolDiagCal.T_EngReportOkLimit",1.0},
            {"TCoolDiagCal.t_SoakMinutesLimit",0.1},
            {"T_EstDiagCal.MassEngineBlock",1.0},
            {"T_EstDiagCal.MassOfExhInChamber",1.0},
            {"T_EstDiagCal.AirK_1",0.001},
            {"T_EstDiagCal.AirK_2",0.001},
            {"T_EstDiagCal.SpecHeatWater",0.01},
            {"T_EstDiagCal.SpecHeatEngineBlock",0.01},
            {"T_EstDiagCal.SpecHeatExhaust",0.1},
            {"T_EstDiagCal.LowHeatValueGasolin",1.0},
            {"T_EstDiagCal.RatioBrakeWork",0.001},
            {"T_EstDiagCal.HeatTransExh2CylWall",1.0},
            {"T_EstDiagCal.Q_RadFlow",0.001},
            {"T_EstDiagCal.Q_HExhFlow1",0.0001},
            {"T_EstDiagCal.Q_HExhFlow2",0.0001},
            {"T_EstDiagCal.X_Air_Fuel",0.001},
            {"T_EstDiagCal.T_DiffTEngTAir",1.0},
            {"T_EstDiagCal.T_DiffTEngTAirExh",1.0},
            {"T_EstDiagCal.T_MinOpen",0.01},
            {"T_EstDiagCal.T_MinMaxDiff",0.01},
            {"T_EstDiagCal.n_Idle",1.0},
            {"T_EstDiagCal.n_Running",1.0},
            {"T_EstDiagCal.T_XtraCooling",1.0},
            {"T_EstDiagCal.ST_XtraCooling",1.0},
            {"IdleDiagCal.n_maxLowOffset",1.0},
            {"IdleDiagCal.n_maxHighOffset",1.0},
            {"IdleDiagCal.t_Error",0.1},
            {"IdleDiagCal.m_MaxAtLow",1.0},
            {"IdleDiagCal.n_EngDiff",1.0},
            {"nEngDiagCal.p_AirInletLim",0.1},
            {"nEngDiagCal.p_MAP_BAP",0.1},
            {"nEngDiagCal.U_BatteryLim",0.1},
            {"nEngDiagCal.t_PreCond",0.1},
            {"nEngDiagCal.t_MAP_BAPCond",0.1},
            {"nEngDiagCal.t_AccumpAir",0.1},
            {"nEngDiagCal.N_LostEnginePositionsStart",1.0},
            {"nEngDiagCal.N_LostEnginePositionsRun",1.0},
            {"TestCoreDiagCal.ST_DummyFault1",1.0},
            {"TestCoreDiagCal.ST_DummyFault2",1.0},
            {"TestCoreDiagCal.ST_DummyFault3",1.0},
            {"MisfCal.N_CombustionCountLimit",1.0},
            {"MisfCal.t_IgnDetWSize",1.0},
            {"MisfCal.t_IgnDetWStartOffs",1.0},
            {"MisfCal.t_dwellTimeMargin",1.0},
            {"MisfCal.N_MisfireFTPLimOBD2Man",1.0},
            {"MisfCal.N_MisfireFTPLimOBD2Aut",1.0},
            {"MisfCal.N_MisfireFTPLimEOBDMan",1.0},
            {"MisfCal.N_MisfireFTPLimEOBDAut",1.0},
            {"MisfCal.FTPLimHotFuelFactor",1.0},
            {"MisfCal.N_MisfireCATLimit",1.0},
            {"MisfCal.N_SystemActionOnComb",1.0},
            {"MisfCal.N_SystemActionOffComb",1.0},
            {"MisfCal.V_MisfireLowFuel",0.1},
            {"MisfCal.m_LoadLevelMAT",1.0},
            {"MisfCal.m_AirXSP",1.0},
            {"MisfCal.m_Air2XSP",1.0},
            {"MisfCal.m_AirHiLimFTP",1.0},
            {"MisfCal.CatOverheatFactorMAT",1.0},
            {"MisfCal.p_AirInletDiffLim",0.1},
            {"MisfCal.n_EngNomDiff",1.0},
            {"MisfCal.n_EngYSP",1.0},
            {"MisfCal.n_Eng2YSP",1.0},
            {"MisfCal.n_EngHiLimFTP",1.0},
            {"MisfCal.T_EngXSP",1.0},
            {"MisfCal.T_EngineSP",1.0},
            {"MisfCal.T_ActiveLim1",1.0},
            {"MisfCal.T_ActiveLim2",1.0},
            {"MisfCal.T_TempLimit",1.0},
            {"MisfCal.T_EngSyncActLimLow",1.0},
            {"MisfCal.T_EngSyncActLimHigh",1.0},
            {"MisfCal.T_EngOffHotFuel",1.0},
            {"MisfCal.T_EngStartHotFuel",1.0},
            {"MisfCal.T_AirStartHotFuel",1.0},
            {"MisfCal.t_MaxCycleMAT",1.0},
            {"MisfCal.fi_IgnDetWSize",0.1},
            {"MisfCal.fi_IgnDetWStartOffs",0.1},
            {"MisfCal.n_CombFilterTAB",1.0},
            {"MisfCal.n_CombFromStartTAB",1.0},
            {"MisfCal.n_CombAvDetect",1.0},
            {"MisfCal.X_PedalLimit",0.1},
            {"MisfCal.t_StartDelayTimeLOBD",0.1},
            {"MisfCal.t_StartDelayTimeEOBD",0.1},
            {"MisfCal.t_StartDelayTimeOBD2",0.1},
            {"MisfCal.Trq_OffsetTAB",0.1},
            {"MisfCal.n_EblSglCylEval",1.0},
            {"MisfCal.m_EblSglCylEval",1.0},
            {"MisfCal.T_ActIdleLimLo",1.0},
            {"MisfCal.T_ActIdleLimHi",1.0},
            {"MisfCal.v_VehIdleFilt",0.1},
            {"MisfCal.n_CycleVarIdle",1.0},
            {"MisfCal.ST_CountMapMode",1.0},
            {"MisfCal.ST_TqFilter",1.0},
            {"MisfCal.ST_TransFilterOk",1.0},
            {"MisfCal.ST_HotFuelLimActive",1.0},
            {"MisfCal.N_CombsSglCylFCut",1.0},
            {"MisfCal.N_TrigLvlFCut",1.0},
            {"MisfCal.N_MaxSysActions",1.0},
            {"MisfCal.ST_SglCylMisfDiagActive",1.0},
            {"MisfCal.ST_DsblLambdaCtrl",1.0},
            {"SyncDiagCal.n_SyncErrorLim",1.0},
            {"IDMDiagCal.n_ZeroDetectLimit",1.0},
            {"IDMDiagCal.n_EngineLimit",1.0},
            {"IDMDiagCal.m_AirInletLimit",1.0},
            {"CombDetCal.t_DetectLevLim",1.0},
            {"CombDetCal.n_CombAboveLimit",1.0},
            {"CombDetCal.pct_WinRemLim",0.1},
            {"CombDetCal.n_EngDiagLow",1.0},
            {"CombDetCal.n_EngDiagHigh",1.0},
            {"CombDetCal.m_AirDiagLow",1.0},
            {"CombDetCal.m_AirDiagHigh",1.0},
            {"CombDetCal.v_AtFirstComb",0.1},
            {"GenCtrlDiagCal.X_FTermDutyCycleKeyOn",0.1},
            {"GenCtrlDiagCal.X_FTermDutyCycleRun",0.1},
            {"GenCtrlDiagCal.t_FTermKeyOnTest",0.1},
            {"GenCtrlDiagCal.n_FTermRunTest",1.0},
            {"GenCtrlDiagCal.t_FTermRunTest",0.1},
            {"GenCtrlDiagCal.X_FTermInFilt",0.01},
            {"GenCtrlDiagCal.t_LTermKeyOnOpenTest",0.1},
            {"GenCtrlDiagCal.t_LTermKeyOnTest",0.1},
            {"GenCtrlDiagCal.t_LTermRunTest",0.1},
            {"GenCtrlDiagCal.t_L_limitOpenDiagTimer",0.1},
            {"GenCtrlDiagCal.t_StableTimer",0.1},
            {"FanCtrlDiagCal.t_DeviceErrorFan1",0.1},
            {"FanCtrlDiagCal.t_DeviceErrorFan2",0.1},
            {"FanCtrlDiagCal.t_DeviceErrorFan3",0.1},
            {"FanCtrlDiagCal.N_nrOfErrorsFan1",1.0},
            {"pAirSensDiagCal.t_StabilePress",0.1},
            {"immoDiagCal.t_BatteryAboveLim",0.1},
            {"immoDiagCal.U_BatteryLowLim",0.1},
            {"CatModCal.t_FCutDelayLimit",1.0},
            {"CatModCal.IncFiltCoef",0.0009765625},
            {"CatModCal.DecFiltCoef",0.0009765625},
            {"CatModCal.LambdaOffsetCoef",0.0009765625},
            {"CatModCal.FCutOffsetCoef",0.0009765625},
            {"CatModCal.mAirInletCoef",0.0009765625},
            {"CatModCal.QAirInletCoef",0.0009765625},
            {"CatModCal.LambdaSP",0.0009765625},
            {"CatModCal.T_FCutOffset",1.0},
            {"CatModCal.T_SteadyStateMAP",1.0},
            {"CatModCal.T_LambdaOffsetTAB",1.0},
            {"CatModCal.T_AccMinSP",1.0},
            {"CatModCal.T_SoakMin",1.0},
            {"CatModCal.m_SteadyStateXSP",1.0},
            {"CatModCal.Q_LoadFiltCoefSP",0.01},
            {"CatModCal.Q_AirAccLim",0.01},
            {"CatModCal.Q_CorrFacSP",0.01},
            {"CatModCal.n_SteadyStateYSP",1.0},
            {"CatModCal.LoadFiltCoefTAB",0.0001},
            {"CatModCal.T_EngineMulFacSP",1.0},
            {"CatModCal.T_AirInletXSP",1.0},
            {"CatModCal.QAirAccMinTAB",1.0},
            {"CatModCal.t_SoakMinYSP",0.1},
            {"CatModCal.QAccWeightFacSP",0.01},
            {"CatModCal.TEngineMulFacTAB",0.0078125},
            {"CatModCal.TSoakFacMAP",0.0078125},
            {"CatModCal.QAccWeightFacTAB",0.0078125},
            {"CatModCal.QCorrFacTAB",0.0078125},
            {"TAirDiagCal.t_Test1RunLimit",0.1},
            {"TAirDiagCal.t_Test2RunLimit",0.1},
            {"TAirDiagCal.t_SpeedLimit",0.1},
            {"TAirDiagCal.t_LoadLimit",0.1},
            {"TAirDiagCal.t_Test1LoadLimit",0.1},
            {"TAirDiagCal.t_StillLimit",0.1},
            {"TAirDiagCal.t_AccLimitMin",0.1},
            {"TAirDiagCal.t_AccLimitMax",0.1},
            {"TAirDiagCal.t_AccLoadLimit",0.1},
            {"TAirDiagCal.T_Test1DeadDiffLim",1.0},
            {"TAirDiagCal.T_Test2DeadDiffLim",1.0},
            {"TAirDiagCal.T_PreCond",1.0},
            {"TAirDiagCal.t_SoakLimit",0.1},
            {"TAirDiagCal.v_VehicleLimit",0.1},
            {"TAirDiagCal.v_AccLimit",0.1},
            {"TAirDiagCal.m_AirInletLimit",1.0},
            {"TAirDiagCal.m_AirAccLimit",1.0},
            {"TAirDiagCal.m_AirTest1Limit",1.0},
            {"TAmbModCal.t_StartWaitTAB",0.1},
            {"TAmbModCal.v_VehicleSP",0.1},
            {"TAmbModCal.v_VehicleLowStable",0.1},
            {"TAmbModCal.v_VehicleHighStable",0.1},
            {"TAmbModCal.T_ColdStartMax",1.0},
            {"TAmbModCal.T_ColdStartDelta",1.0},
            {"TAmbModCal.T_EngineSP",1.0},
            {"TAmbModCal.T_OffsetMAP",1.0},
            {"TAmbModCal.T_PrelSP",1.0},
            {"TAmbModCal.T_CompensationTAB",1.0},
            {"TAmbModCal.m_AirStepDownSP",1.0},
            {"TAmbModCal.m_AirInletSP",1.0},
            {"TAmbModCal.m_AirLowStable",1.0},
            {"TAmbModCal.m_AirHighStable",1.0},
            {"TAmbModCal.N_StepDownTAB",1.0},
            {"TAmbModCal.N_StableCntMax",1.0},
            {"TAmbModCal.TempFilterCoefTAB",0.0009765625},
            {"RMCal.T_DenomMinus7Low",1.0},
            {"RMCal.p_AirAmbientLow",0.1},
            {"RMCal.T_DenomPlus5Low",1.0},
            {"RMCal.T_DenomPlus35High",1.0},
            {"RMCal.T_DenomDiff",1.0},
            {"HSCRDiagCal.t_SoakLimitSP",0.1},
            {"HSCRDiagCal.T_TEngTAirDiffLimitTAB",1.0},
            {"HSCRDiagCal.T_TAirTEngDiffLimitTAB",1.0},
            {"HSCRDiagCal.T_EngFallingTemp",1.0},
            {"HSCRDiagCal.t_EngFallingLimit",0.1},
            {"FuelCutInhibitCal.FCIFaultCodeList",1.0},
            {"T2CLDiagCal.t_TempLowMinus7",0.1},
            {"T2CLDiagCal.t_TempMinus7ToPlus10",0.1},
            {"T2CLDiagCal.t_TempHighPlus10",0.1},
            {"LSCRDiagCal.t_LowPreCond",0.1},
            {"LSCRDiagCal.t_HighPreCond",0.1},
            {"LSCRDiagCal.t_HighSpeedPreCond",0.1},
            {"LSCRDiagCal.t_OKCond",0.1},
            {"LSCRDiagCal.v_PreCond",0.1},
            {"LSCRDiagCal.X_IdlePercent",1.0},
            {"LSCRDiagCal.X_FuelCut",1.0},
            {"LSCRDiagCal.n_EngineNominal",1.0},
            {"LSCRDiagCal.T_PreCondLim",1.0},
            {"LSCRDiagCal.T_StartDiagLowlim",1.0},
            {"LSCRDiagCal.T_FaultLim",1.0},
            {"LSCRDiagCal.ST_DisableOOLTemp",1.0},
            {"SAIDiagCal.t_RunTimeMin",0.1},
            {"SAIDiagCal.t_PumpOffTimeMin",0.1},
            {"SAIDiagCal.QAirFiltCoef",0.0009765625},
            {"SAIDiagCal.fiIgnFiltCoef",0.0009765625},
            {"SAIDiagCal.pModelFiltCoef",0.0009765625},
            {"SAIDiagCal.pSecAirFiltCoef",0.0009765625},
            {"SAIDiagCal.U_BattMulFacSP",0.1},
            {"SAIDiagCal.UBattMulFacTAB",0.0009765625},
            {"SAIDiagCal.T_AirInletMulFacSP",1.0},
            {"SAIDiagCal.TAirInletMulFacTAB",0.0009765625},
            {"SAIDiagCal.fi_IgnMulFacSP",0.1},
            {"SAIDiagCal.fiIgnMulFacTAB",0.0009765625},
            {"SAIDiagCal.Q_AirMulFacSP",0.01},
            {"SAIDiagCal.QAirMulFacTAB",0.0009765625},
            {"SAIDiagCal.pAirAmbientMulFacSP",0.1},
            {"SAIDiagCal.pAirAmbientMulFacTAB",0.0009765625},
            {"SAIDiagCal.m_FuelMulFacSP",0.01},
            {"SAIDiagCal.mFuelMulFacTAB",0.0009765625},
            {"SAIDiagCal.p_NormModelIn",0.1},
            {"SAIDiagCal.p_OffModelIn",0.1},
            {"SAIDiagCal.Q_AirInletMax",0.01},
            {"SAIDiagCal.Q_AirInletMin",0.01},
            {"SAIDiagCal.pMaxRatio",0.01},
            {"SAIDiagCal.pMinRatio",0.01},
            {"SAIDiagCal.p_MaxPumpOff",0.1},
            {"SAIDiagCal.N_MeanValue",1.0},
            {"SAIDiagCal.t_CalcDelayMean",0.1},
            {"ServiceBayCal.incFuelFac",0.0009765625},
            {"ServiceBayCal.decFuelFac",0.0009765625},
            {"ServiceBayCal.FuelFacRampStep",1.0},
            {"ServiceBayCal.t_Phase2SensorTest",0.1},
            {"ServiceBayCal.t_Phase2EvalLimit",0.1},
            {"ServiceBayCal.t_Phase4WaitLimit",0.1},
            {"ServiceBayCal.t_Phase5EvalLimit",0.1},
            {"ServiceBayCal.U_Rich",1.0},
            {"ServiceBayCal.U_Lean",1.0},
            {"ServiceBayCal.T_CatOffset",1.0},
            {"ServiceBayCal.N_AdjComp",0.0078125},
            {"ColdStartDiagCal.t_Error",1.0},
            {"ColdStartDiagCal.t_DeltaLoadOKMin",1.0},
            {"ColdStartDiagCal.fi_DiffMin",0.1},
            {"ColdStartDiagCal.fi_DiffIdleMin",0.1},
            {"ColdStartDiagCal.fi_DiffMinAut",0.1},
            {"ColdStartDiagCal.fi_DiffIdleMinAut",0.1},
            {"ColdStartDiagCal.m_DeltaLoadMax",1.0},
            {"ColdStartDiagCal.m_LoadMax",1.0},
            {"ColdStartDiagCal.n_LighOffOffset",1.0},
            {"IOTDiagCal.t_WaitAfterIgnitionOff",0.1},
            {"IOTDiagCal.t_TestPeriod",0.1},
            {"IOTDiagCal.t_MaxDiffAllowed",0.1},
            {"IOTDiagCal.t_IOTStartTolerance",0.1},
            {"GSTServiceACal.t_EngRun",0.1},
            {"GSTServiceACal.v_VehOpAboveLim",0.1},
            {"GSTServiceACal.t_VehOpAboveSpdLim",0.1},
            {"GSTServiceACal.v_IdleSpdLim",0.1},
            {"GSTServiceACal.t_IdleLim",0.1},
            {"RpmCtrlCal.P_PartIgnYSP",1.0},
            {"RpmCtrlCal.P_PartIgnMAP",0.1},
            {"RpmCtrlCal.P_PartIgnTakeOffSP",1.0},
            {"RpmCtrlCal.P_PartIgnTakeOffTAB",0.1},
            {"RpmCtrlCal.I_PartIgnSP",1.0},
            {"RpmCtrlCal.I_PartIgnTAB",0.1},
            {"RpmCtrlCal.P_PartAirYSP",1.0},
            {"RpmCtrlCal.v_VehicleXSP",0.1},
            {"RpmCtrlCal.I_PartAirSP",0.1},
            {"RpmCtrlCal.P_PartAirMAP",0.1},
            {"RpmCtrlCal.I_PartAirTAB",0.1},
            {"RpmCtrlCal.n_EngAdapLim",1.0},
            {"RpmCtrlCal.I_PartIgnDelay",1.0},
            {"RpmCtrlCal.I_PartIgnDecrDelay",1.0},
            {"RpmCtrlCal.I_PartAirDelay",1.0},
            {"RpmCtrlCal.I_PartAirDecrDelay",1.0},
            {"RpmCtrlCal.n_ResRequestStart",1.0},
            {"RpmCtrlCal.Trq_ResRequestStart",0.1},
            {"RpmCtrlCal.Trq_LowResRequestIdle",0.1},
            {"RpmCtrlCal.Trq_HighResRequestIdle",0.1},
            {"RpmCtrlCal.T_AirLowLimLowResReq",1.0},
            {"RpmCtrlCal.T_EngLowLimLowResReq",1.0},
            {"RpmCtrlCal.Trq_ResRequestTakeOff",0.1},
            {"RpmCtrlCal.Trq_ResRequestPowerSteer",0.1},
            {"RpmCtrlCal.T_engHotSoakSP",1.0},
            {"RpmCtrlCal.Trq_ResReqHotSoakTAB",0.1},
            {"RpmCtrlCal.Trq_BookedResRampStep",0.1},
            {"RpmCtrlCal.D_FacIgnMAP",1.0},
            {"RpmCtrlCal.v_VehicleYSP",0.1},
            {"RpmCtrlCal.I_PartAirMaxTAB",0.1},
            {"RpmCtrlCal.I_PartAirMinTAB",0.1},
            {"RpmCtrlCal.Trq_TakeOffLimSP",1.0},
            {"RpmCtrlCal.Trq_TakeOffLimLowTAB",0.1},
            {"RpmCtrlCal.Trq_CtrlFlagLowHyst",0.1},
            {"RpmCtrlCal.Trq_OverBookedResLim",0.1},
            {"RpmCtrlCal.n_EngPedalCompOffset",1.0},
            {"RpmCtrlCal.X_AFactor",0.001},
            {"RpmCtrlCal.X_BFactor",0.001},
            {"RpmCtrlCal.Trq_ResRequestIdleRevving",0.1},
            {"RpmCtrlCal.ST_EnablePowerComp",1.0},
            {"RpmCtrlCal.ST_AdapNominalized",1.0},
            {"RpmCtrlAdapCal.updateSpeed",0.78125},
            {"RpmCtrlAdapCal.t_inWindow",0.001},
            {"RpmCtrlAdapCal.adapMax",0.1},
            {"RpmCtrlAdapCal.adapMin",0.1},
            {"RpmCtrlAdapCal.T_EngYSP",1.0},
            {"RpmCtrlAdapCal.Trq_AdapLimit",0.1},
            {"RpmCtrlAdapCal.n_EngAdapLim",1.0},
            {"RpmCtrlAdapCal.ST_enable",1.0},
            {"CkFlrCapAdap.N_DCYWithCkFlrCapOn",1.0},
            {"CkFlrCapAdap.ST_InhibitedTillRefuel",1.0},
            {"SystemActionProt.Fault",1.0},
            {"SystemActionProt.Fault2",1.0},
            {"SystemActionProt.BefThrLimpHOffset",0.1},
            {"SystemActionProt.A_Throttle",1.0},
            {"SystemActionProt.t_faultyP_ACtimer",0.001},
            {"SystemActionProt.t_faultyP_ACoffset",0.001},
            {"SystemActionProt.ST_Fault",1.0},
            {"SystemAction.Trq_LimReq",0.1},
            {"SystemAction.ST_VRef1",1.0},
            {"SystemAction.ST_VRef2",1.0},
            {"FMastCal.m_AirFuelConsSP",1.0},
            {"FMastCal.X_FuelConsFacTAB",0.0009765625},
            {"FMastCal.m_AirInletFuelXSP",1.0},
            {"FMastCal.n_EngYSP",1.0},
            {"FMastCal.FuelCompCylMAP1",0.0009765625},
            {"FMastCal.FuelCompCylMAP2",0.0009765625},
            {"FMastCal.FuelCompCylMAP3",0.0009765625},
            {"FMastCal.FuelCompCylMAP4",0.0009765625},
            {"FMastCal.m_FuelAddCorr",0.01},
            {"FMastCal.f_cutOffFreqLambdaCalc",0.1},
            {"FMastCal.ST_keepFuelPressure",1.0},
            {"FMastCal.ST_fdynMultipleUpd",1.0},
            {"obdAF40FreezeFrame.ST_OkStatus",1.0},
            {"obdAF40FreezeFrame.ST_FaultCode",1.0},
            {"obdAF40FreezeFrame.ST_fmTrnEmsMlfAtv",1.0},
            {"MemoryCheckProt.CopyOfpiRomChecksum",1.0},
            {"MemoryCheckProt.CopyOfPiEncryptedRomChecksum",1.0},
            {"MemoryCheckProt.ST_Mode",1.0},
            {"MemoryCheckROMCks.state",1.0},
            {"MemoryCheckROMCks.currentAddr",1.0},
            {"MemoryCheckROMCks.left",1.0},
            {"MemoryCheckROMCks.checksum",1.0},
            {"MemoryCheckROMEncryptedCks.state",1.0},
            {"MemoryCheckROMEncryptedCks.count",1.0},
            {"MemoryCheckROMEncryptedCks.buffer",1.0},
            {"MemoryCheckCALEncryptedCks.state",1.0},
            {"MemoryCheckCALEncryptedCks.count",1.0},
            {"MemoryCheckCALEncryptedCks.buffer",1.0},
            {"MemoryCheck.t_Encryption",0.1},
            {"MemoryCheck.EncryptedRomChecksum",1.0},
            {"MemoryCheck.Service9CVN",1.0},
            {"MemoryCheck.Service9CalID",1.0},
            {"MemoryCheck.ST_Error",1.0},
            {"MemoryCheck.ST_Ready",1.0},
            {"BeforeStartState",1.0},
            {"BoostProt.OldRequest",1.0},
            {"BoostProt.p_Bypassmapvalue",1.0},
            {"BoostProt.ST_SignalFault",1.0},
            {"BoostAdapProt.t_inWindow",0.001},
            {"BoostAdapProt.t_ValidMAPStamp",1.0},
            {"BoostAdapProt.ST_inAdapMAP",1.0},
            {"BoostAdapProt.ST_ValidMAP",1.0},
            {"Boost.NoiseReduction",0.1},
            {"Boost.ReqDerivata",1.0},
            {"BoostAdap.m_AirLatestAdaption",0.0078125},
            {"BoostAdap.DiagnoseMAP",1.0},
            {"CrsCntrlProt.P_EngineDemand",1.0},
            {"CrsCntrlProt.t_StartTimer",1.0},
            {"CrsCntrlProt.t_KeepTipTimer",1.0},
            {"CrsCntrlProt.F_Feed",1.0},
            {"CrsCntrlProt.F_Friction",1.0},
            {"CrsCntrlProt.F_Integrator",1.0},
            {"CrsCntrlProt.F_Request",1.0},
            {"CrsCntrlProt.F_WheelMin",1.0},
            {"CrsCntrlProt.F_Roadload",1.0},
            {"CrsCntrlProt.v_Buffer",0.1},
            {"CrsCntrlProt.v_Actual",0.1},
            {"CrsCntrlProt.v_Actual_25ms",0.1},
            {"CrsCntrlProt.v_Request",0.1},
            {"CrsCntrlProt.v_Diff",0.1},
            {"CrsCntrlProt.v_Old",0.1},
            {"CrsCntrlProt.v_ActualFilt_25ms",1.0},
            {"CrsCntrlProt.a_Actual",0.01},
            {"CrsCntrlProt.a_ActualFilt1",0.01},
            {"CrsCntrlProt.a_ActualFilt2",0.01},
            {"CrsCntrlProt.a_ActualFilt3",0.01},
            {"CrsCntrlProt.a_Request",0.01},
            {"CrsCntrlProt.a_Diff",0.01},
            {"CrsCntrlProt.X_Ratio",0.78125},
            {"CrsCntrlProt.X_Trq2Force",0.78125},
            {"CrsCntrlProt.X_Efficiency",0.78125},
            {"CrsCntrlProt.X_GainReg",0.0001},
            {"CrsCntrlProt.X_ExtraGain",0.0001},
            {"CrsCntrlProt.ST_Mode",1.0},
            {"CrsCntrlProt.ST_InternalCodeErr",1.0},
            {"CrsCntrlProt.ST_GearStatus",1.0},
            {"CrsCntrlProt.ST_SetSw",1.0},
            {"CrsCntrlProt.ST_CanSw",1.0},
            {"CrsCntrlProt.ST_DecSw",1.0},
            {"CrsCntrlProt.ST_OnSw",1.0},
            {"CrsCntrlProt.ST_SwitchFailed",1.0},
            {"CrsCntrlProt.ST_On",1.0},
            {"CrsCntrlProt.ST_FreeToCruise",1.0},
            {"CrsCntrlProt.ST_DecSwPosFlnk",1.0},
            {"CrsCntrlProt.ST_SetSwPosFlnk",1.0},
            {"CrsCntrlProt.ST_ModeFinished",1.0},
            {"CrsCntrlProt.ST_ModeInit",1.0},
            {"CrsCntrlProt.ST_BrakeTestPerformed",1.0},
            {"CrsCntrlProt.ST_SoftRelease",1.0},
            {"CrsCntrlProt.ST_AllBttnWrRlsd",1.0},
            {"CrsCntrlProt.Cnt_AliveRC",1.0},
            {"CrsCntrlProt.ST_AliveRCFault",1.0},
            {"CrsCntrlProt.ST_ESPTCSActive",1.0},
            {"CrsCntrlProt.ST_LwSpdDropOut",1.0},
            {"CrsCntrlProt.ST_FCutAllwd",1.0},
            {"CrsCntrlProt.ST_DecLimitActive",1.0},
            {"CrsCntrlProt.ST_NegSpdOffsUSD",1.0},
            {"CrsCntrlProt.ST_CCSwProtectionFault",1.0},
            {"CrsCntrlProt.ST_CrsHsBnOvrdd",1.0},
            {"CrsCntrlProt.ST_EnableHighGain",1.0},
            {"CrsCntrlProt.ST_PosSpdOffsUSD",1.0},
            {"CrsCntrl.Trq_Request",0.1},
            {"CrsCntrl.a_ActualFilt2",0.01},
            {"CrsCntrl.F_Actual",1.0},
            {"CrsCntrl.ST_Active",1.0},
            {"CrsCntrl.CMD_CruiseEnabled",1.0},
            {"CrsCntrl.ST_ClutchSwitchActive",1.0},
            {"CrsCntrl.CMD_CruiseActive",1.0},
            {"CrsCntrl.ST_Switch",1.0},
            {"CrsCntrl.n_SwitchProtectionValue",1.0},
            {"CrsCntrl.ST_KeepTip",1.0},
            {"CrsCntrl.ST_TMCRedDis",1.0},
            {"CrsCntrlAliveRC.CCSwProt",1.0},
            {"CrsCntrlAliveRC.IndicationOn",1.0},
            {"CrsCntrlAliveRC.Cnt_AliveRC",1.0},
            {"CrsCntrlAliveRC.RCIndex",1.0},
            {"CrsCntrlAliveRC.SWProtIndex",1.0},
            {"CrsCntrlAliveRC.RCArray",1.0},
            {"CrsCntrlAliveRC.SWProtArray",1.0},
            {"CrsCntrlAliveRC.sum",1.0},
            {"CrsCntrlAliveRC.SWProtSum",1.0},
            {"CrsCntrlAliveRC.Cnt_Reads",1.0},
            {"CrsCntrlAliveRC.RCSynced",1.0},
            {"CrsCntrlAliveRC.OldRC",1.0},
            {"CrsCntrlAliveRC.ST_CCSwProtFaultThisMessage",1.0},
            {"CrsCntrlAdap.MissingCond",1.0},
            {"CrsCntrlAdap.SwitchOffReason",1.0},
            {"PurgeProt.TotalPurged",1.0},
            {"PurgeProt.FuelPurged",1.0},
            {"PurgeProt.AdpFreezeIndex",0.1},
            {"PurgeProt.FuelFacMaxFlow",1.0},
            {"PurgeProt.LocalMaxFlow",1.0},
            {"PurgeProt.PdiffMaxFlow",1.0},
            {"PurgeProt.RefFlow",1.0},
            {"PurgeProt.ReqFlow",1.0},
            {"PurgeProt.SetPurgePercent",0.001},
            {"PurgeProt.AdpFreezeTime",0.1},
            {"PurgeProt.m_AirDer",1.0},
            {"PurgeProt.LambdaFiltAdp",0.01},
            {"PurgeProt.LambdaFiltCtrl",0.01},
            {"PurgeProt.X_pDiffMax",0.0078125},
            {"PurgeProt.X_pDiffMin",0.0078125},
            {"PurgeProt.P_Fac",1.0},
            {"PurgeProt.I_Fac",1.0},
            {"PurgeProt.LocalMaxFuelFac",0.01},
            {"PurgeProt.PurgePercent",0.001},
            {"PurgeProt.FlowFac",0.0009765625},
            {"PurgeProt.HCContFiltFac",1.0},
            {"PurgeProt.ValveOffset",0.1},
            {"PurgeProt.HCPriorityLimOn",0.01},
            {"PurgeProt.t_Delay",1.0},
            {"PurgeProt.Age_Delay",1.0},
            {"PurgeProt.N_FuelFacOffsetActEvapTest",0.0009765625},
            {"PurgeProt.N_FuelFacLimitActEvapTest",0.0009765625},
            {"PurgeProt.m_FuelBuffer",0.01},
            {"PurgeProt.n_Min",1.0},
            {"PurgeProt.n_Red",1.0},
            {"PurgeProt.p_DiffAct",0.1},
            {"PurgeProt.InjMaxFuelFac",0.01},
            {"PurgeProt.LambdaIntCopy",0.01},
            {"PurgeProt.LambdaStatusCopy",1.0},
            {"PurgeProt.AdpFreeze",1.0},
            {"PurgeProt.RampRestart",1.0},
            {"PurgeProt.ST_CtrlLocked",1.0},
            {"PurgeProt.ST_USTank",1.0},
            {"PurgeProt.ST_BoostPurgeHWPresent",1.0},
            {"Purge.FuelFac",0.01},
            {"Purge.LambdaFiltEvap",0.01},
            {"Purge.AdaptionEvap",0.01},
            {"Purge.Flow",1.0},
            {"Purge.DiagFlow",1.0},
            {"Purge.HCCont",0.01},
            {"Purge.Q_AirPrg",0.01},
            {"Purge.m_AirPrg",1.0},
            {"Purge.m_FuelPrg",0.01},
            {"Purge.m_FuelPrgValve",0.01},
            {"Purge.p_DiffNormal",0.1},
            {"Purge.p_DiffNormalMax",0.1},
            {"Purge.p_DiffNormalMin",0.1},
            {"Purge.p_DiffBoost",0.1},
            {"Purge.Trq_Reserve",0.1},
            {"Purge.Valve",0.1},
            {"Purge.FlowOffsetFac",0.0009765625},
            {"Purge.ST_TankDiag",1.0},
            {"Purge.SAI_IntrStatus",1.0},
            {"Purge.ST_StartRamp",1.0},
            {"Purge.ST_FastAdp",1.0},
            {"Purge.Status",1.0},
            {"Purge.ST_HighPriority",1.0},
            {"Purge.ST_O2SensDiagFreeze",1.0},
            {"Purge.ST_DiagFlowLimited",1.0},
            {"Purge.ST_cycleOff",1.0},
            {"ExhaustProt.T_CalcDly",1.0},
            {"ExhaustProt.T_AirMapVal",1.0},
            {"ExhaustProt.T_IgnMapVal",1.0},
            {"ExhaustProt.T_TotMapVal",1.0},
            {"ExhaustProt.fi_Offset",0.1},
            {"ExhaustProt.T_Limit",1.0},
            {"ExhaustProt.T_Tau1",0.0078125},
            {"ExhaustProt.T_Tau2",0.0078125},
            {"ExhaustProt.T_Tau3",0.0078125},
            {"ExhaustProt.T_Tau4",0.0078125},
            {"Exhaust.RampValue",1.0},
            {"Exhaust.T_Calc",1.0},
            {"Exhaust.ST_Status",1.0},
            {"StartCal.T_EngineXSP",1.0},
            {"StartCal.n_EngineYSP",1.0},
            {"StartCal.m_FuelBasic",0.01},
            {"StartCal.T_EngineSP",1.0},
            {"StartCal.EnrFacTAB",0.01},
            {"StartCal.EnrFacThrFaultTAB",0.01},
            {"StartCal.t_RestartXSP",0.1},
            {"StartCal.T_engRestartSP",1.0},
            {"StartCal.RestartFacMAP",0.0009765625},
            {"StartCal.RpmStartLim",1.0},
            {"StartCal.CombStartLim",1.0},
            {"StartCal.T_engWCFStop",1.0},
            {"StartCal.n_engDiffWCF",1.0},
            {"StartCal.T_engWCFSP",1.0},
            {"StartCal.t_soakWCFSP",0.1},
            {"StartCal.X_WCFFacMAP",0.0009765625},
            {"StartCal.n_CombYSP",1.0},
            {"StartCal.CombFacMAP",0.01},
            {"StartCal.m_FuelBefStart",0.01},
            {"StartCal.N_combFacRamp",1.0},
            {"StartCal.t_BefStRunCold",1.0},
            {"StartCal.t_BefStRunWarm",1.0},
            {"StartCal.T_BefStEngine",1.0},
            {"StartCal.m_ReStBefFuel",0.01},
            {"StartCal.p_HighAltSP",0.1},
            {"StartCal.n_EngNoCombFac",1.0},
            {"StartCal.ScaleFacRpmMap",0.0078125},
            {"StartCal.HighAltFacMap",0.0078125},
            {"StartCal.X_WCFRamp",1.0},
            {"StartCal.n_engHiLimWCF",1.0},
            {"StartCal.n_combWCFHold",1.0},
            {"StartCal.n_CombEvalStopTAB",1.0},
            {"StartCal.n_CombEvalStart",1.0},
            {"StartCal.ST_UseMAF",1.0},
            {"StartCal.Cnt_CombAboveEngDiffLimWCF",1.0},
            {"StartCal.Cnt_CombAboveEngHiLimWCF",1.0},
            {"Gear.Ratio",0.01},
            {"Gear.ST_NoGearSelected",1.0},
            {"GearProt.t_TimeStamp",1.0},
            {"GearProt.t_HoldNeutral",1.0},
            {"GearProt.X_LastPosition",1.0},
            {"GearProt.X_TrnGrSlctrPos",1.0},
            {"GearSILProt.t_MinTimeOn",0.25},
            {"GearSILProt.t_MinTimeOff",0.25},
            {"GearSILProt.t_MinTimeOffDownShift",0.25},
            {"GearSILProt.Trq_EngNextGear",0.1},
            {"GearSILProt.Trq_MaxEngNextGear",0.1},
            {"GearSILProt.m_AirNextGear",1.0},
            {"GearSILProt.m_MaxAirNextGear",1.0},
            {"GearSILProt.Q_AirNextGear",0.01},
            {"GearSILProt.n_EngNextGear",1.0},
            {"GearSILProt.X_RecGear",1.0},
            {"GearSILProt.X_ActualGear",1.0},
            {"GearSILProt.X_LastGear",1.0},
            {"GearSILProt.X_LastGearEngaged",1.0},
            {"OilLifeProt.l_DistanceForColdstart",1.0},
            {"OilLifeProt.l_DistancePastSecond",1.0},
            {"OilLifeProt.N_EngineRevsLastSecond",1.0},
            {"OilLifeProt.Pct_OilLifeResetValue",0.1},
            {"OilLifeProt.t_OverHeat",0.1},
            {"OilLifeProt.l_RearLeftWheelDistance_Last",1.0},
            {"OilLifeProt.Pct_RemainingEngineOilLife",0.1},
            {"OilLifeProt.ST_ChangeOilNow",1.0},
            {"OilLifeProt.ST_ChangeOilSoon",1.0},
            {"OilLifeProt.ST_EngineOverheated",1.0},
            {"OilLife.OFVC_EngineOilLifeResetValue",1.0},
            {"OilLife.OFVC_EngineOilLifeReset",1.0},
            {"OilLife.ST_CpidEngineOilLifeReset",1.0},
            {"OilLife.ST_ColdStart",1.0},
            {"CkFlrCapCal.N_MaxDCYWithCkFlrCapOn",1.0},
            {"CkFlrCapCal.ST_EnabledByDefault",1.0},
            {"ETCPdlAdp.c_OOR1_MinSmpl",1.0},
            {"ETCPdlAdp.c_OOR1_MaxFail",1.0},
            {"ETCPdlAdp.c_OOR2_MinSmpl",1.0},
            {"ETCPdlAdp.c_OOR2_MaxFail",1.0},
            {"ETCPdlAdp.X_CorrDiffMax",0.1},
            {"ETCPdlAdp.X_MinCorrDiffMax",0.1},
            {"ETCPdlAdp.c_OOC_MinSmpl",1.0},
            {"ETCPdlAdp.c_OOC_MaxFail",1.0},
            {"ETCPdlAdp.X_NormSensor1Min",0.1},
            {"ETCPdlAdp.X_NormSensor2Min",0.1},
            {"ETCPdlAdp.X_NormMin1Min",0.1},
            {"ETCPdlAdp.X_NormMin2Min",0.1},
            {"ETCPdlAdp.X_Max1",0.1},
            {"ETCPdlAdp.X_Max2",0.1},
            {"ETCPdlAdp.X_DispMin",0.1},
            {"FFIgnCal.o_octaneTAB",0.01},
            {"FFIgnCal.n_SyncDelayTAB",1.0},
            {"FFIgnCal.o_step",0.01},
            {"FFIgnCal.fi_adapLimHigh",0.1},
            {"FFIgnCal.X_hystOffsetMAP",0.0009765625},
            {"FFIgnCal.X_ignTAB",0.0078125},
            {"OilTempAdap.T_Oil",1.0},
            {"OilTempAdap.T_Engine",1.0},
            {"BstKnkCal.DivFacHighLoad",0.03125},
            {"BstKnkCal.DivFacLowLoad",0.03125},
            {"BstKnkCal.DivFacDelTimer",1.0},
            {"BstKnkCal.fi_offsetXSP",0.1},
            {"BstKnkCal.n_EngYSP",1.0},
            {"BstKnkCal.MaxAirmass",1.0},
            {"BstKnkCal.NegStep",1.0},
            {"OilLevelProt.t_FirstEntry",1.0},
            {"OilLevelProt.t_FirstTimeAboveSpeedLimit",1.0},
            {"OilLevelProt.N_NumberOfReadings",1.0},
            {"OilLevelProt.t_DebounceTimerCityTraffic",0.1},
            {"OilLevelProt.t_DebounceTimerCountryRoad",0.1},
            {"OilLevelProt.t_DebounceTimerAutobahn",0.1},
            {"OilLevelProt.ST_CityTrafficCondition",1.0},
            {"OilLevelProt.ST_CountryRoadCondition",1.0},
            {"OilLevelProt.ST_AutobahnCondition",1.0},
            {"OilLevelProt.ST_LowLevel",1.0},
            {"OilLevelProt.ST_CityTrafficLowLevel",1.0},
            {"OilLevelProt.ST_CountryRoadLowLevel",1.0},
            {"OilLevelProt.ST_AutobahnLowLevel",1.0},
            {"obdReadyness.obdReadyness",1.0},
            {"AfterStProt.T_EngineStart",1.0},
            {"AfterStProt.StartFac",0.0009765625},
            {"AfterStProt.AmbientFac",0.0009765625},
            {"AfterStProt.HotSoakFac",0.0078125},
            {"AfterStProt.HotSoakAdjust",0.78125},
            {"AfterStProt.RestartAdjust",0.78125},
            {"AfterStProt.t_HotSoakMinutes",0.1},
            {"AfterStProt.n_CombDelayWCF",1.0},
            {"AfterStProt.startFuelFac",0.0009765625},
            {"AfterSt.FuelFac",0.0009765625},
            {"AfterSt.HotSoakFac",0.0078125},
            {"AfterSt.n_Combustion",1.0},
            {"AfterSt.ST_AfterStart",1.0},
            {"AfterSt.ST_HotSoak",1.0},
            {"TComp.FuelFac",0.0009765625},
            {"TComp.FuelFacTab",0.0009765625},
            {"TComp.T_EngineSP",1.0},
            {"TAirComp.FuelFac",0.0009765625},
            {"TAirComp.T_airFilt",1.0},
            {"ElCompCal.P_FanCompTAB",0.1},
            {"ElCompCal.U_BattDiffSP",0.1},
            {"ElCompCal.P_BattDiffTAB",0.1},
            {"ElCompCal.Trq_BattReqInc",0.1},
            {"ElCompCal.Trq_FTermMap",0.1},
            {"ElCompCal.PWM_FTermYSP",0.1},
            {"ElCompCal.n_FTermXSP",1.0},
            {"ElCompCal.f_FTerm",0.1},
            {"ElCompCal.ST_Enable",1.0},
            {"ElCompCal.ST_EnableFtermComp",1.0},
            {"obdO2SPostResp.ST_OkStatus",1.0},
            {"obdO2SPostResp.ST_FaultCode",1.0},
            {"obdO2SPostResp.ST_BreakPreCond",1.0},
            {"obdO2SPostResp.t_TestResult1",1.0},
            {"obdO2SPostResp.t_TestResult1Fcut",1.0},
            {"obdO2SPostResp.t_TestResult2",1.0},
            {"obdO2SPostResp.t_MisfDetectLevelFilt",1.0},
            {"obdO2SPostResp.ST_DeltaLoadOK",1.0},
            {"obdO2SPostResp.ST_ClosedLoopOK",1.0},
            {"obdO2SPostResp.ST_FuelCutAllCylinders",1.0},
            {"obdO2SPostResp.ST_O2SensRearFalling",1.0},
            {"obdO2SPostResp.ST_t_MisfDetectLevelFiltOk",1.0},
            {"obdO2SPostResp.ST_UMinBefTestOK",1.0},
            {"obdO2SPostResp.ST_FlagsFrozen",1.0},
            {"obdO2SPostResp.ST_TestRunning",1.0},
            {"obdO2SPostResp.ST_RespTestDone",1.0},
            {"obdO2SPostResp.ST_TestDuringCatDiag",1.0},
            {"ETCPdlCal.t_AboveIgnLo",0.001},
            {"ETCPdlCal.t_ReleaseDebounceTime",1.0},
            {"ETCPdlCal.X_PPS2_Ofst",0.1},
            {"ETCPdlCal.X_NormLim1Hi",0.1},
            {"ETCPdlCal.X_NormLim1Lo",0.1},
            {"ETCPdlCal.c_OOR1_Fail",1.0},
            {"ETCPdlCal.c_OOR1_ContFail",1.0},
            {"ETCPdlCal.c_OOR1_Smpl",1.0},
            {"ETCPdlCal.X_NormLim2Hi",0.1},
            {"ETCPdlCal.X_NormLim2Lo",0.1},
            {"ETCPdlCal.c_OOC_Fail",1.0},
            {"ETCPdlCal.c_OOR2_Fail",1.0},
            {"ETCPdlCal.c_OOR2_ContFail",1.0},
            {"ETCPdlCal.c_OOR2_Smpl",1.0},
            {"ETCPdlCal.CorrThrsh",1.0},
            {"ETCPdlCal.X_CorrOffset",0.1},
            {"ETCPdlCal.c_OOC_ContFail",1.0},
            {"ETCPdlCal.X_Min_OOC_Thrsh",0.1},
            {"ETCPdlCal.c_OOC_Smpl",1.0},
            {"ETCPdlCal.X_MaxInit",0.1},
            {"ETCPdlCal.X_MinAdjust",0.1},
            {"ETCPdlCal.X_MinInit",0.1},
            {"ETCPdlCal.c_MinLearnStable",1.0},
            {"ETCPdlCal.U_MinIgnLoThrsh",0.1},
            {"ETCPdlCal.X_Min1LowThrsh",0.1},
            {"ETCPdlCal.X_Min2LowThrsh",0.1},
            {"ETCPdlCal.X_Min1StableThrsh",0.1},
            {"ETCPdlCal.X_Min2StableThrsh",0.1},
            {"ETCPdlCal.X_Max1",0.1},
            {"ETCPdlCal.X_Max2",0.1},
            {"ETCPdlCal.X_MinLrnDownClamp",0.1},
            {"ETCPdlCal.X_MinFrstLrnDownClamp",0.1},
            {"ETCPdlCal.X_ReleaseLimit",0.1},
            {"ETCPdlCal.X_AdpCopyLim",0.1},
            {"ETCPdlCal.v_FloorMatProt",0.1},
            {"ETCPdlCal.ST_PPS1RawSlope",1.0},
            {"ETCPdlCal.ST_MaxPedCal",1.0},
            {"ETCPdlCal.PPS2RawSlope",1.0},
            {"ETCLimpMode.LimitedAcceleration",1.0},
            {"ETCLimpMode.BrakeManagement",1.0},
            {"ETCLimpMode.BowdenCable",1.0},
            {"ETCLimpMode.DefaultThrottlePosition",1.0},
            {"ETCLimpMode.ForcedIdle",1.0},
            {"ETCLimpMode.EngineShutdown",1.0},
            {"ETCLimpMAIN.LimitedAcceleration",1.0},
            {"ETCLimpMAIN.BrakeManagement",1.0},
            {"ETCLimpMAIN.BowdenCable",1.0},
            {"ETCLimpMAIN.DefaultThrottlePosition",1.0},
            {"ETCLimpMAIN.ForcedIdle",1.0},
            {"ETCLimpMAIN.EngineShutdown",1.0},
            {"ETCLimpProt.P_LimAccel",0.1},
            {"AirAmbientCal.h_DeltaGeneral",1.0},
            {"AirAmbientCal.h_pMaxIntMax",1.0},
            {"AirAmbientCal.h_pMaxIntMin",1.0},
            {"AirAmbientCal.K_AscentMax",0.78125},
            {"AirAmbientCal.K_DescentLim",0.78125},
            {"AirAmbientCal.F_FrictionSP",1.0},
            {"AirAmbientCal.F_FrictionTAB",1.0},
            {"AirAmbientCal.F_FrictionMaxTAB",1.0},
            {"AirAmbientCal.X_PrRatioMinMAP",0.0009765625},
            {"AirAmbientCal.X_PrRatioMaxMAP",0.0009765625},
            {"AirAmbientCal.p_ThrRatioSP",0.001},
            {"AirAmbientCal.n_EngineSP",1.0},
            {"AirAmbientCal.t_CLIPartStart",1.0},
            {"AirAmbientCal.t_CLIPartDelay",1.0},
            {"AirAmbientCal.FiltFac",1.0},
            {"AirAmbientCal.n_EngineMax",1.0},
            {"AirAmbientCal.n_EngineStep",1.0},
            {"AirAmbientCal.p_ThrPrRatioMax",0.001},
            {"AirAmbientCal.p_ThrPrRatioDelta",0.001},
            {"AirAmbientCal.p_AirBefThrMaxDelta",0.1},
            {"AirAmbientCal.p_AirAmbMaxDelta",0.1},
            {"AirAmbientCal.p_AirAmbSensorErr",0.1},
            {"AirAmbientCal.p_HighAltDependOffs",0.1},
            {"AirAmbientCal.p_CLIpartAdjustOffs",0.1},
            {"AirAmbientCal.t_Delay",1.0},
            {"AirAmbientCal.m_Min",1.0},
            {"AirAmbientCal.m_Max",1.0},
            {"AirAmbientCal.p_RampStep",0.1},
            {"AirAmbientCal.X_PrAdjustEst",0.0078125},
            {"AirAmbientCal.ST_CLIpart",1.0},
            {"AirAmbientCal.ST_DisableEP",1.0},
            {"FCutCal.t_EngSpdFCut",1.0},
            {"FCutCal.t_AfterEngStart",1.0},
            {"FCutCal.n_EngOffLimNeutralAut",1.0},
            {"FCutCal.n_EngOffLimLockAut",1.0},
            {"FCutCal.n_EngOffOpenSP",1.0},
            {"FCutCal.n_EngOffOpenTAB",1.0},
            {"FCutCal.n_EngOffLimTab",1.0},
            {"FCutCal.n_EngFuelCutLimHyst",1.0},
            {"FCutCal.n_EngineCSLU",1.0},
            {"FCutCal.n_EngineKillAut",1.0},
            {"FCutCal.n_EngineKillTAB",1.0},
            {"FCutCal.v_EngineKillSP",0.1},
            {"FCutCal.m_AirInletLimit",1.0},
            {"FCutCal.m_AirInletTime",1.0},
            {"FCutCal.t_ApplFuelCutTimer",1.0},
            {"FCutCal.n_EngOpenThrottle",1.0},
            {"FCutCal.U_O2SensRearLimit",1.0},
            {"FCutCal.n_CombInFuelCutSP",1.0},
            {"FCutCal.T_EngineSP",1.0},
            {"FCutCal.FuelFactorMAP",0.0009765625},
            {"FCutCal.n_DelayRelPedFCut",1.0},
            {"FCutCal.A_ThrottleTAB",0.1},
            {"FCutCal.n_EngineSP",1.0},
            {"FCutCal.t_OpenMaxTAB",1.0},
            {"FCutCal.T_Exhaust",1.0},
            {"FCutCal.n_CombSinceFuelCutSP",1.0},
            {"FCutCal.X_combAdjustTAB",1.0},
            {"FCutCal.t_ApplFuelCutTimer1",1.0},
            {"FCutCal.t_ApplFuelCutTimer2",1.0},
            {"FCutCal.T_ExhaustLimit",1.0},
            {"FCutCal.T_ExhaustLowLimit",1.0},
            {"FCutCal.v_VehicleLim",0.1},
            {"FCutCal.X_AccPedalLim",0.1},
            {"FCutCal.FCutMinTemp",1.0},
            {"FCutCal.T_EngHighLimGearShift",1.0},
            {"FCutCal.t_CutDuringGearShiftMAP",1.0},
            {"FCutCal.t_InhibitDuringGearShiftMAP",1.0},
            {"FCutCal.T_idleRevvingFCut",1.0},
            {"FCutCal.ST_DisableFCI",1.0},
            {"FCutCal.ST_Activate",1.0},
            {"FCutCal.ST_Enable",1.0},
            {"FCutCal.ST_EnabIdleRevvingFCut",1.0},
            {"OilLifeAdap.l_KilometerTrigger",1.0},
            {"SystemProt.shut_off_time",1.0},
            {"SystemProt.pumprelay_off_time",1.0},
            {"SystemProt.mainrelay_off_time",1.0},
            {"SystemProt.systemMasterMode",1.0},
            {"System.NVDMChangedTimer",1.0},
            {"System.t_stampPowering",0.001},
            {"System.X_CpuUtilization",0.1},
            {"System.X_HwioUtilization",0.1},
            {"System.StackMax",0.1},
            {"System.Run",1.0},
            {"System.MainPwrDwn",1.0},
            {"System.MCPPwrDwnMsgSent",1.0},
            {"System.SOHTogglingDisabled",1.0},
            {"System.NVDMChangedShutOff",1.0},
            {"System.okToDiagnosFFSensor",1.0},
            {"System.ST_EngineVariant",1.0},
            {"eTemp0",1.0},
            {"eTemp1",1.0},
            {"eTemp2",1.0},
            {"eTemp3",1.0},
            {"eTemp4",1.0},
            {"eTemp5",1.0},
            {"eTemp6",1.0},
            {"eTemp7",1.0},
            {"eTemp8",1.0},
            {"eTemp9",1.0},
            {"eTemp10",1.0},
            {"eTemp11",1.0},
            {"fi_ApplicationTask",1.0},
            {"Crank.t_TDC_TDC_Delta",1.0},
            {"Crank.n_Engine_LastReading",1.0},
            {"Crank.n_EngineDerivative",1.0},
            {"Crank.ActiveDeltaCyl",1.0},
            {"Crank.Cylinder",1.0},
            {"Crank.KnockCylinder",1.0},
            {"Crank.FuelCylinder",1.0},
            {"Crank.fi_KnockWStart",0.1},
            {"Crank.fi_KnockWStop",0.1},
            {"Crank.t_KnockWSize",1.0},
            {"Crank.fi_KnockWSize",0.1},
            {"Crank.fi_IgnDetWStart",0.1},
            {"Crank.fi_CombDetWStart",0.1},
            {"Crank.fi_IgnDetWStop",0.1},
            {"Crank.fi_CombDetWStop",0.1},
            {"Crank.t_IgnDetWSize",1.0},
            {"Crank.fi_IgnDetWSize",0.1},
            {"Crank.fi_CombDetWSize",0.1},
            {"Crank.t_CombDetWSize",1.0},
            {"Crank.t_IgnDetWStartOffs",1.0},
            {"Crank.fi_IgnDetWStartOffs",0.1},
            {"Crank.ST_EnginePosFound",1.0},
            {"ignAngle",0.1},
            {"viosCyl",1.0},
            {"ResetInfo",1.0},
            {"BoostMeterProt.Trq_MaxEngine",0.1},
            {"BoostMeterProt.X_Factor",1.0},
            {"LambdaCal.t_transTime",1.0},
            {"LambdaCal.RestartTime",1.0},
            {"LambdaCal.rampTempScaleTAB",0.0078125},
            {"LambdaCal.T_rampTempSP",1.0},
            {"LambdaCal.IntStepGainTAB",0.0078125},
            {"LambdaCal.IntStepGainMisfireTAB",0.0078125},
            {"LambdaCal.U_O2SensRearErrorSP",1.0},
            {"LambdaCal.DecStepMAP",0.01},
            {"LambdaCal.DecRampMAP",0.01},
            {"LambdaCal.IncStepMAP",0.01},
            {"LambdaCal.IncRampMAP",0.01},
            {"LambdaCal.RampOutFac",0.01},
            {"LambdaCal.RampOutJerkFac",0.01},
            {"LambdaCal.LambHighLim",0.0009765625},
            {"LambdaCal.LambLowLim",0.0009765625},
            {"LambdaCal.m_AirInletSP",1.0},
            {"LambdaCal.MinRpm",1.0},
            {"LambdaCal.n_EngineSP",1.0},
            {"LambdaCal.TempTrans",1.0},
            {"LambdaCal.TempSp",1.0},
            {"LambdaCal.TempCthrTab",1.0},
            {"LambdaCal.TempOthrTab",1.0},
            {"LambdaCal.MinCombustion",1.0},
            {"LambdaCal.N_BeforeHW",1.0},
            {"LambdaCal.N_TransDelay",1.0},
            {"LambdaCal.CombNrTab2",1.0},
            {"LambdaCal.N_ST15DelayTAB",1.0},
            {"LambdaCal.U_O2SensSwitch",1.0},
            {"LambdaCal.U_O2SensSwitchTAB",1.0},
            {"LambdaCal.T_SwitchPointSP",1.0},
            {"LambdaCal.U_O2SensSwitchAmbTAB",1.0},
            {"LambdaCal.p_SwitchPointAmbSP",0.1},
            {"LambdaCal.U_O2SensSwitchHyst",1.0},
            {"LambdaCal.U_AdjStepMisfireSP",1.0},
            {"LambdaCal.U_O2SensRearRefSigMAP",1.0},
            {"LambdaCal.U_O2SensRearRefSigOffsMisfire",1.0},
            {"LambdaCal.U_MinSwitchLimit",1.0},
            {"LambdaCal.U_MaxSwitchLimit",1.0},
            {"LambdaCal.f_CutOffFreqTime",0.1},
            {"LambdaCal.f_cutOffFreqLambMean",0.1},
            {"LambdaCal.p_deltaLimit",0.1},
            {"LambdaCal.X_intDevLimit",0.01},
            {"LambdaCal.X_intDevAdjust",1.0},
            {"LambdaCal.T_EngIntDevOffLim",1.0},
            {"LambdaCal.t_intDevOffDelay",0.1},
            {"LambdaCal.t_intDevHoldAbort",0.1},
            {"LambdaCal.n_EngIntDevOffLim",1.0},
            {"LambdaCal.m_AirIntDevOffLim",1.0},
            {"LambdaCal.T_delayWCFSP",1.0},
            {"LambdaCal.n_CombDelayWCFTAB",1.0},
            {"LambdaCal.ST_Enable",1.0},
            {"LambdaPostAdapCal.t_FCutDelay",0.1},
            {"LambdaPostAdapCal.t_WindowDelay",0.1},
            {"LambdaPostAdapCal.t_AdapDelay",0.1},
            {"LambdaPostAdapCal.n_StableDeltaLim",1.0},
            {"LambdaPostAdapCal.n_HighLim",1.0},
            {"LambdaPostAdapCal.n_LowLim",1.0},
            {"LambdaPostAdapCal.m_StableDeltaLim",1.0},
            {"LambdaPostAdapCal.m_HighLim",1.0},
            {"LambdaPostAdapCal.m_LowLim",1.0},
            {"LambdaPostAdapCal.U_iPartLow",1.0},
            {"LambdaPostAdapCal.U_iPartHigh",1.0},
            {"LambdaPostAdapCal.T_engLimit",1.0},
            {"LambdaPostAdapCal.n_IntDeadCombMax",1.0},
            {"LambdaPostAdapCal.n_IntDeadCombAdap",1.0},
            {"LambdaPostCal.T_O2SensRearAdjLim",1.0},
            {"LambdaPostCal.U_pPartTAB",1.0},
            {"LambdaPostCal.U_pPartSP",1.0},
            {"LambdaPostCal.U_O2SensSwitchOffsetMax",1.0},
            {"LambdaPostCal.switchOffsetFac",0.0078125},
            {"LambdaPostCal.C_iPart",0.0078125},
            {"FFBladProt.m_airDelta_100ms",1.0},
            {"FFBladProt.n_engDelta_100ms",1.0},
            {"FFBladProt.AFRFilt",0.01},
            {"FFBladProt.X_blend",0.1},
            {"FFBladProt.X_blendAct",0.1},
            {"FFBladProt.X_blendNew",0.1},
            {"FFBladProt.X_blendQ",0.1},
            {"FFBladProt.ST_aboveQLim",1.0},
            {"FFBladProt.ST_ramp",1.0},
            {"FFBladProt.X_accBlend",0.1},
            {"FFBladProt.X_blendUpd",0.1},
            {"FFBladProt.N_meanCount",1.0},
            {"FFBladProt.t_delayTimer",0.25},
            {"FFBladProt.t_windowTimer",0.25},
            {"FFBladProt.ST_subState",1.0},
            {"FFBladProt.ST_restartState",1.0},
            {"FFBladProt.ST_HL",1.0},
            {"FFBladProt.t_HLTimer",0.1},
            {"FFBladProt.X_HLFacHigh",0.0009765625},
            {"FFBladProt.X_HLBlend",0.1},
            {"FFBladProt.HLAFRFilt",0.01},
            {"FFBladProt.M_lowLim",0.1},
            {"FFBladProt.M_lowLimSysAct",0.1},
            {"FFBlad.X_HLFac",0.0009765625},
            {"FFBladAdap.t_blendTimer",0.25},
            {"FFBladAdap.ST_state",1.0},
            {"FFBladAdap.N_adap",1.0},
            {"FFBladAdap.N_adap1",1.0},
            {"FFBladAdap.N_adap2",1.0},
            {"FrictionLoadProt.Trq_RequestT_Eng",0.1},
            {"FrictionLoadProt.Trq_RequestT_Air",0.1},
            {"FrictionLoadProt.Trq_Request_p_Air",0.1},
            {"FrictionLoad.Trq_Request",0.1},
            {"FrictionLoad.Trq_PumpReq",0.1},
            {"ECUID.MCPSoftware_PartNo",1.0},
            {"ECUID.BootHWIO_PartNo",1.0},
            {"ECUID.ECMHardwareComplete_PartNo",1.0},
            {"ECUID.EOLParameter_PartNo",1.0},
            {"ECUID.ECMComplete_PartNo",1.0},
            {"ECUID.SupplierHardwareNo",1.0},
            {"ECUID.ProgrammingEquipmentID",1.0},
            {"ECUID.ApplicationDownloadDate",1.0},
            {"ECUID.EngineType",1.0},
            {"ECUID.VehicleIdNo",1.0},
            {"FFFDynCal.T_eng6SP",1.0},
            {"FFFDynCal.T_engStarted5SP",1.0},
            {"FFFDynCal.X_biasMAP",0.0078125},
            {"FFFDynCal.X_biasWUMAP",0.0078125},
            {"FFFDynCal.X_biasWUScaleMAP",0.0078125},
            {"FFFDynCal.X_negFuelLimMAP",0.00392156862745},
            {"FFFDynCal.betaMAP",0.00392156862745},
            {"FFFDynCal.alphaMAP",0.00392156862745},
            {"FFFDynCal.alphaSlowTAB",0.00392156862745},
            {"FFFDynCal.betaSlowTAB",0.00392156862745},
            {"FFFDynCal.X_negStartFuelLimTAB",0.00392156862745},
            {"PedalMapCal.t_PedMapRamp",1.0},
            {"PedalMapCal.v_VehAutSP",1.0},
            {"PedalMapCal.X_AutFacTab",1.0},
            {"PedalMapCal.v_VehManSP",1.0},
            {"PedalMapCal.X_ManFacTab",1.0},
            {"PedalMapCal.n_EngineMap",1.0},
            {"PedalMapCal.X_PedalMap",1.0},
            {"PedalMapCal.Trq_RequestMap",0.1},
            {"PedalMapCal.Trq_RequestSportMap",0.1},
            {"PedalMapCal.X_PedHighLim",1.0},
            {"PedalMapCal.X_PedLowLim",1.0},
            {"PedalMapCal.X_PedDeltLim",1.0},
            {"PedalMapCal.SportFactor",1.0},
            {"PedalMapCal.v_VehicleForcedIdleLim",0.1},
            {"PedalMapCal.Trq_ForcedIdleMaxReq",0.1},
            {"PedalMapCal.Trq_ForcedIdleStep",0.1},
            {"PedalMapCal.Trq_ThrDefPosStep",0.1},
            {"PedalMapCal.Trq_ThrDefPosStartTAB",0.1},
            {"PedalMapCal.T_ThrDefPosStartSP",1.0},
            {"PedalMapCal.T_SportModeEnable",1.0},
            {"PedalMapCal.Trq_ForcedIdleResReq",0.1},
            {"PedalMapCal.GainFactorYSP",1.0},
            {"PedalMapCal.GainFactorMap",0.0078125},
            {"PedalMapCal.GainFactorRampStep",0.0078125},
            {"PedalMapCal.v_GainLimit",0.1},
            {"PedalMapCal.ST_EnableGainFactor",1.0},
            {"TOACal.v_highLimit",0.1},
            {"TOACal.v_lowLimit",0.1},
            {"TOACal.n_EngNominal",1.0},
            {"TOACal.n_EngDiffYSP",1.0},
            {"TOACal.v_vehicleXSP",0.1},
            {"TOACal.Trq_P_partMAP",0.1},
            {"TOACal.X_D_partFacTAB",0.0009765625},
            {"TOACal.v_vehicleYSP",0.1},
            {"TOACal.Trq_maxTAB",0.1},
            {"TOACal.X_a1Fac",0.001},
            {"TOACal.X_bFac",0.001},
            {"TOACal.X_pedalLowLimit",0.1},
            {"TOACal.X_pedalHighLimit",0.1},
            {"TOACal.X_gainStep",0.0009765625},
            {"TOACal.ST_enable",1.0},
            {"BlockHeatProt.T_engCalc128",0.0078125},
            {"BlockHeatProt.T_DiffBlkHeatStart",1.0},
            {"BlockHeatProt.AftStFuelFacRampStep",1.0},
            {"BlockHeat.StartFuelFac",0.0009765625},
            {"BlockHeat.AftStFuelFac",0.0009765625},
            {"BlockHeat.Trq_FricOffset",0.1},
            {"BlockHeat.Q_StartOffset",0.01},
            {"BlockHeat.ST_DisableLightOff",1.0},
            {"BlockHeat.ST_BlkHeatStart",1.0},
            {"BlockHeat.ST_lambdaIntStop",1.0},
            {"LightOffCal.TempLim",1.0},
            {"LightOffCal.T_EngineSP",1.0},
            {"LightOffCal.T_EngCombTAB",1.0},
            {"LightOffCal.Trq_RequestXSP",0.1},
            {"LightOffCal.n_EngYSP",1.0},
            {"LightOffCal.Trq_ReserveMAP",0.1},
            {"LightOffCal.n_CombAftSt",1.0},
            {"LightOffCal.PosDeltaLim",0.1},
            {"LightOffCal.NegDeltaLim",0.1},
            {"LightOffCal.T_AirInletSP",1.0},
            {"LightOffCal.T_AirCombTAB",1.0},
            {"LightOffCal.n_EngRampSP",1.0},
            {"LightOffCal.RampStepTAB",0.1},
            {"LightOffCal.n_CombAfterStartRpmTAB",1.0},
            {"LightOffCal.T_EngSP",1.0},
            {"LightOffCal.n_EngDriveTAB",1.0},
            {"LightOffCal.n_EngNeutralTAB",1.0},
            {"LightOffCal.n_EngRampDownStep",0.1},
            {"LightOffCal.n_EngNomRampStep",1.0},
            {"LightOffCal.v_VehicleThreshold",0.1},
            {"LightOffCal.p_AirAmbHigh",0.1},
            {"LightOffCal.p_AirAmbLow",0.1},
            {"LightOffCal.DriveDelay",1.0},
            {"LightOffCal.ST_EnableReserve",1.0},
            {"LightOffCal.ST_EnableRpm",1.0},
            {"LightOffCal.ST_AllowRestart",1.0},
            {"CoolFanCal.K_AC_OffTempFault",1.0},
            {"CoolFanCal.K_AC_On_FanRequired",0.1},
            {"CoolFanCal.K_FanSpeedMinTime",0.1},
            {"CoolFanCal.K_FanChangeDelay",0.1},
            {"CoolFanCal.K_VehicleSpdIsZeroHi",0.1},
            {"CoolFanCal.K_VehicleSpdIsZeroLo",0.1},
            {"CoolFanCal.K_Speed_ON_FanSP",0.1},
            {"CoolFanCal.K_Speed_OFF_FanSP",0.1},
            {"CoolFanCal.Fan_SpeedONTAB",1.0},
            {"CoolFanCal.Fan_SpeedOFFTAB",1.0},
            {"CoolFanCal.K_ECT_FanReqTAB",0.1},
            {"CoolFanCal.T_EngineSP",1.0},
            {"CoolFanCal.K_AC_FanReqTAB",0.1},
            {"CoolFanCal.ACSP",1.0},
            {"CoolFanCal.K_TempEngOil_FanReqTAB",0.1},
            {"CoolFanCal.T_EngOilSP",1.0},
            {"CoolFanCal.K_FanAdjustLimitHi",0.1},
            {"CoolFanCal.K_FanAdjustLimitLo",0.1},
            {"CoolFanCal.K_VehicleSpdFanAdjustHi",0.1},
            {"CoolFanCal.K_VehicleSpdFanAdjustLo",0.1},
            {"CoolFanCal.K_CoolantTempOverride",1.0},
            {"CoolFanCal.K_TempTransOilHi",1.0},
            {"CoolFanCal.K_TempTransOilLo",1.0},
            {"CoolFanCal.K_TempEngOilHi",1.0},
            {"CoolFanCal.K_AC_PressureHigh",1.0},
            {"CoolFanCal.K_MaxVehicleSpeed",0.1},
            {"CoolFanCal.K_AfterRunFan",0.1},
            {"CoolFanCal.T_EngAfterRunSP",1.0},
            {"CoolFanCal.K_AfterRunTimeTAB",0.1},
            {"CoolFanCal.K_AfterRunStartTempHi",1.0},
            {"CoolFanCal.K_AfterRunStartTempLo",1.0},
            {"CoolFanCal.K_AfterRunTimeMax",0.1},
            {"CoolFanCal.K_FanPwrUpDelay",0.1},
            {"CoolFanCal.K_D1_SpeedTAB",1.0},
            {"CoolFanCal.K_D2_SpeedTAB",1.0},
            {"CoolFanCal.K_D3_SpeedTAB",1.0},
            {"CoolFanCal.K_DALL_SpeedSP",1.0},
            {"CoolFanCal.K_FanSpdChgIdle",1.0},
            {"CoolFanCal.ST_DisableDelayedAfterrun",1.0},
            {"EngTipLimCal.X_Koeff",0.0001},
            {"EngTipLimCal.Trq_BacklashMap",0.1},
            {"EngTipLimCal.Trq_BacklashAutTab",0.1},
            {"EngTipLimCal.Trq_BacklashFCutAutTab",0.1},
            {"EngTipLimCal.Trq_RequestSP",0.1},
            {"EngTipLimCal.Trq_MaxInit",0.1},
            {"EngTipLimCal.Trq_MaxRamp",0.1},
            {"EngTipLimCal.Trq_SumOffset",0.1},
            {"EngTipLimCal.n_DiffDeltaXSP",1.0},
            {"EngTipLimCal.n_DiffYSP",1.0},
            {"EngTipLimCal.n_EngShftLim",1.0},
            {"EngTipLimCal.n_EngNomOff",1.0},
            {"EngTipLimCal.f_filtCoeff",0.1},
            {"EngTipLimCal.X_PedalRequestSP",0.1},
            {"EngTipLimCal.X_BacklashFacTab",0.78125},
            {"EngTipLimCal.X_AccFreeWheel",0.78125},
            {"EngTipLimCal.X_RatioLowDetect",0.01},
            {"EngTipLimCal.X_RatioHighDetect",0.01},
            {"EngTipLimCal.X_RatioLowEnabled",0.01},
            {"EngTipLimCal.X_RatioHighEnabled",0.01},
            {"EngTipLimCal.X_Ratio2Gear",0.01},
            {"EngTipLimCal.X_PedalDetectLevel",0.1},
            {"EngTipLimCal.t_HoldGearSeven",1.0},
            {"EngTipLimCal.ST_Enable",1.0},
            {"EngTipLimCal.ST_ATBrakeLogic",1.0},
            {"EngTipLimCal.ST_EnableFreeWheelFcn",1.0},
            {"EngTipLimCal.ST_TCMUpdated",1.0},
            {"EngTipLimNormCal.t_TipOut",1.0},
            {"EngTipLimNormCal.Trq_BacklashTipOutMap",0.1},
            {"EngTipLimNormCal.Trq_TipOutRampTab",0.1},
            {"EngTipLimNormCal.Trq_SumTipIn",0.1},
            {"EngTipLimNormCal.Trq_BacklashTab",0.1},
            {"EngTipLimNormCal.Trq_BacklashFCutTab",0.1},
            {"EngTipLimNormCal.n_TipSP",1.0},
            {"EngTipLimNormCal.n_EngTipOutRampSP",1.0},
            {"EngTipLimNormCal.ST_GearYSP",1.0},
            {"EngTipLimNormCal.N_TipInMap",1.0},
            {"EngTipLimNormCal.N_TipOutMap",1.0},
            {"EngTipLimSportCal.t_TipOut",1.0},
            {"EngTipLimSportCal.Trq_BacklashTipOutMap",0.1},
            {"EngTipLimSportCal.Trq_TipOutRampTab",0.1},
            {"EngTipLimSportCal.Trq_SumTipIn",0.1},
            {"EngTipLimSportCal.Trq_BacklashTab",0.1},
            {"EngTipLimSportCal.Trq_BacklashFCutTab",0.1},
            {"EngTipLimSportCal.n_TipSP",1.0},
            {"EngTipLimSportCal.n_EngTipOutRampSP",1.0},
            {"EngTipLimSportCal.ST_GearYSP",1.0},
            {"EngTipLimSportCal.N_TipInMap",1.0},
            {"EngTipLimSportCal.N_TipOutMap",1.0},
            {"SensSwitchCal.c_ModFcn",1.0},
            {"SensSwitchCal.c_TPSSwitchFail",1.0},
            {"SensSwitchCal.c_TPSSwitchSmpl",1.0},
            {"SensSwitchCal.X_TPS_SwitchOnROCMax",0.1},
            {"SensSwitchCal.X_TPS_SwitchLoMax",0.1},
            {"SensSwitchCal.X_TPS_SwitchOffROCMax",0.1},
            {"SensSwitchCal.c_TPSShortContFail",1.0},
            {"AccelProt.RawAccel",0.001},
            {"AccelProt.MaxAccel",0.001},
            {"AccelProt.v_Vehicle",0.1},
            {"AccelProt.FiltAccel",0.001},
            {"AccelProt.FiltFact",1.0},
            {"AccelProt.Clear",1.0},
            {"MCPReadProt.Addr",1.0},
            {"MCPReadProt.ReadAddr",1.0},
            {"MCPReadProt.Value",1.0},
            {"MCPReadProt.ptr",1.0},
            {"MCPReadProt.EvenByte",1.0},
            {"MCPReadProt.OddByte",1.0},
            {"MCPReadProt.ActivateRead",1.0},
            {"BlockHeatCal.AftStFuelFacRampStep",1.0},
            {"BlockHeatCal.Trq_FricOffsetRampStep",1.0},
            {"BlockHeatCal.Q_StartOffsetRampStep",1.0},
            {"BlockHeatCal.n_lambdaIntStop",1.0},
            {"BlockHeatCal.StartFuelFacMAP",0.0009765625},
            {"BlockHeatCal.t_SoakMinutesSP",0.1},
            {"BlockHeatCal.T_DiffBlkHeatStartTAB",1.0},
            {"BlockHeatCal.T_BlkHeatSP",1.0},
            {"BlockHeatCal.T_engBlkHeatSP",1.0},
            {"BlockHeatCal.AftStFuelFacMAP",0.0009765625},
            {"BlockHeatCal.engCoolRampStep",0.01},
            {"BlockHeatCal.Trq_FricOffsetTAB",0.1},
            {"BlockHeatCal.Q_StartOffsetTAB",0.01},
            {"BlockHeatCal.T_AirInletLim",1.0},
            {"BlockHeatCal.T_EngineLimHigh",1.0},
            {"BlockHeatCal.T_EngineLimLow",1.0},
            {"BlockHeatCal.t_soakSP",0.1},
            {"BlockHeatCal.X_reStartFacTAB",0.78125},
            {"BlockHeatCal.X_AftReStartFacTAB",0.78125},
            {"StartCtrlProt.t_StartMotorAct",1.0},
            {"StartCtrlProt.n_Stop",1.0},
            {"StartCtrlProt.N_CombStop",1.0},
            {"StartCtrlProt.N_CombStamp",1.0},
            {"StartCtrlProt.t_ModeCrankActive",1.0},
            {"StartCtrlProt.t_fuelpumpact",1.0},
            {"StartCtrlProt.t_Clutch_Apply_Delay_Timer",1.0},
            {"StartCtrlProt.StopCond",1.0},
            {"StartCtrlProt.StartCond",1.0},
            {"StartCtrlProt.ST_CrankOffSinceEnable",1.0},
            {"StartCtrlProt.DiagCond",1.0},
            {"StartCtrlProt.N_AllDiagCondTrue",1.0},
            {"StartCtrlProt.StartCond5Hold",1.0},
            {"StartCtrlProt.CMD_StartMotor",1.0},
            {"StartCtrlProt.ST_Clutch_Apply_Delay",1.0},
            {"StartCtrlProt.clutchNeutralSwitchPresent",1.0},
            {"StartCtrlProt.clutchSwitchNotOk",1.0},
            {"StartCtrl.ST_FuelCutReq",1.0},
            {"TimeLastDCY",0.1},
            {"obdLTFT.ST_OkStatus",1.0},
            {"obdLTFT.ST_FaultCode",1.0},
            {"obdLTFT.LambdaAdapPreFilt",0.01},
            {"obdLTFT.LambdaAdapFilt",0.01},
            {"obdLTFT.LambdaAdapPreFiltMAF",0.01},
            {"obdLTFT.LambdaAdapFiltMAF",0.01},
            {"obdLTFT.LambdaAdapMin",0.01},
            {"obdLTFT.LambdaAdapMax",0.01},
            {"obdLTFT.AdapSamples",1.0},
            {"obdLTFT.AdapMap",1.0},
            {"obdLTFT.ST_State",1.0},
            {"obdLTFT.ST_FoundOk",1.0},
            {"obdLTFT.ST_GSTCondOk",1.0},
            {"obdSTFT.ST_OkStatus",1.0},
            {"obdSTFT.ST_FaultCode",1.0},
            {"obdSTFT.ST_FoundOk",1.0},
            {"obdSTFT.ST_State",1.0},
            {"obdO2SResp.ST_OkStatus",1.0},
            {"obdO2SResp.ST_FaultCode",1.0},
            {"obdO2SResp.N_CombustCnt",1.0},
            {"obdO2SResp.N_FlankShiftCnt",1.0},
            {"obdO2SResp.N_AdjCombustCnt",1.0},
            {"obdO2SResp.N_LoadCnt",1.0},
            {"obdO2SResp.m_SondDeltaLoad",1.0},
            {"obdO2SResp.ST_TestActive",1.0},
            {"obdO2SResp.ST_TestDone",1.0},
            {"obdO2SResp.ST_CombFlankShftDone",1.0},
            {"O2SRespST_NoAjustForRearO2Sensor",1.0},
            {"StartCountCombDuringLambdaFlankShifts",1.0},
            {"enableScaleFactor",1.0},
            {"obdO2SPre.WindowArray",1.0},
            {"obdO2SPre.ST_OkStatus",1.0},
            {"obdO2SPre.ST_FaultCode",1.0},
            {"obdO2SPre.t_Low",0.1},
            {"obdO2SPre.t_Dead",0.1},
            {"obdO2SPre.t_TestDeadDiag",0.1},
            {"obdO2SPre.t_O2SPreHeat",0.1},
            {"obdO2SPre.t_MinusBroken",0.1},
            {"obdO2SPre.T_O2SPreHeatBefTest",1.0},
            {"obdO2SPre.U_O2SPreMin",1.0},
            {"obdO2SPre.U_O2SPreMax",1.0},
            {"obdO2SPre.N_HighCounter",1.0},
            {"obdO2SPre.N_ActiveTests",1.0},
            {"obdO2SPre.ST_ActiveHighTest",1.0},
            {"obdO2SPre.ST_Fault",1.0},
            {"obdO2SPre.ST_O2SPreCondOk",1.0},
            {"obdO2SPost.WindowArray",1.0},
            {"obdO2SPost.ST_OkStatus",1.0},
            {"obdO2SPost.ST_FaultCode",1.0},
            {"obdO2SPost.U_O2SensorRearFilt",1.0},
            {"obdO2SPost.t_Low",0.1},
            {"obdO2SPost.t_LowOK",0.1},
            {"obdO2SPost.U_O2SPostMin",1.0},
            {"obdO2SPost.U_O2SPostMax",1.0},
            {"obdO2SPost.N_HighCounter",1.0},
            {"obdO2SPost.N_ActiveTests",1.0},
            {"obdO2SPost.ST_ActiveHighTest",1.0},
            {"obdO2SPost.ST_O2SPostCondOk",1.0},
            {"obdO2SPost.t_Dead",0.1},
            {"obdO2SPost.t_Ok",0.1},
            {"obdO2SPost.ST_OKReportedNoCircuitActivity",1.0},
            {"obdO2SPreHeat.t_FaultRunTime",1.0},
            {"obdO2SPreHeat.ST_OkStatus",1.0},
            {"obdO2SPreHeat.ST_FaultCode",1.0},
            {"obdO2SPreHeat.ST_IntrTest",1.0},
            {"obdO2SPostHeat.t_FaultRunTime",1.0},
            {"obdO2SPostHeat.ST_OkStatus",1.0},
            {"obdO2SPostHeat.ST_FaultCode",1.0},
            {"obdO2SPostHeat.ST_IntrTest",1.0},
            {"obdO2SPreSwPnt.ST_OkStatus",1.0},
            {"obdO2SPreSwPnt.ST_FaultCode",1.0},
            {"obdT2CL.ST_OkStatus",1.0},
            {"obdT2CL.ST_FaultCode",1.0},
            {"obdT2CL.t_Start",0.1},
            {"obdT2CL.ST_TempState",1.0},
            {"VehicleSpeedCal.l_WheelCircumference",1.0},
            {"VehicleSpeedCal.n_BigFrWhlDiffLim",1.0},
            {"VehicleSpeedCal.t_BigDiffDebounce",1.0},
            {"FFIgnProt.n_SyncDelayBefComp",1.0},
            {"FFIgnProt.n_SyncDelay",1.0},
            {"FFIgnProt.o_octaneBefComp",0.01},
            {"FFIgnProt.X_hystOffset",0.0009765625},
            {"FFIgnProt.X_hystOffsetBefComp",0.0009765625},
            {"FFIgnProt.o_octane",0.01},
            {"FFIgnProt.X_ign",0.0078125},
            {"FFIgnProt.ST_rampOctane",1.0},
            {"FFIgnProt.ST_safeOctaneLevel",1.0},
            {"obdBrakeSwitch.ST_OkStatus",1.0},
            {"obdBrakeSwitch.ST_FaultCode",1.0},
            {"obdBrakeSwitch.t_Decrease",0.1},
            {"obdBrakeSwitch.t_Increase",0.1},
            {"obdBrakeSwitch.ST_DecreaseConditionOk",1.0},
            {"obdBrakeSwitch.ST_IncreaseConditionOk",1.0},
            {"obdBrakeSwitch.N_HiFaultyBrake",1.0},
            {"obdBrakeSwitch.N_LoFaultyBrake",1.0},
            {"obdBrakeSwitch.ST_SignalHistory",1.0},
            {"obdBrakeLight.ST_OkStatus",1.0},
            {"obdBrakeLight.ST_FaultCode",1.0},
            {"obdBrakeLight.t_Decrease",0.1},
            {"obdBrakeLight.t_Increase",0.1},
            {"obdBrakeLight.ST_DecreaseConditionOk",1.0},
            {"obdBrakeLight.ST_IncreaseConditionOk",1.0},
            {"obdBrakeLight.N_HiFaultyBrake",1.0},
            {"obdBrakeLight.N_LoFaultyBrake",1.0},
            {"obdBrakeLight.ST_SignalHistory",1.0},
            {"obdRunCrank.ST_OkStatus",1.0},
            {"obdRunCrank.ST_FaultCode",1.0},
            {"obdAccessory.ST_OkStatus",1.0},
            {"obdAccessory.ST_FaultCode",1.0},
            {"obdAccessory.ST_AccessoryFound",1.0},
            {"obdp_AC.ST_OkStatus",1.0},
            {"obdp_AC.ST_FaultCode",1.0},
            {"obdClutchSw.ST_OkStatus",1.0},
            {"obdClutchSw.ST_FaultCode",1.0},
            {"obdClutchSw.t_Decrease",0.1},
            {"obdClutchSw.ST_DecreaseConditionOk",1.0},
            {"obdClutchSw.ST_IncreaseConditionOk",1.0},
            {"obdClutchSw.N_FaultyClutch",1.0},
            {"obdClutchSw.ST_SignalHistory",1.0},
            {"obdPSSw.ST_OkStatus",1.0},
            {"obdPSSw.ST_FaultCode",1.0},
            {"obdPSSw.t_FaultTimer",0.1},
            {"obdPSSw.ST_SignalHistory",1.0},
            {"obdABS.ST_OkStatus",1.0},
            {"obdABS.ST_FaultCode",1.0},
            {"obdTCMCan.ST_OkStatus",1.0},
            {"obdTCMCan.ST_FaultCode",1.0},
            {"obdSystVoltFault.N_Bank1Faults",1.0},
            {"obdSystVoltFault.N_Bank2Faults",1.0},
            {"obdCIM.ST_OkStatus",1.0},
            {"obdCIM.ST_FaultCode",1.0},
            {"obdHighSpeedBus.ST_OkStatus",1.0},
            {"obdHighSpeedBus.ST_FaultCode",1.0},
            {"obdSADS.ST_OkStatus",1.0},
            {"obdSADS.ST_FaultCode",1.0},
            {"StartEngProt.Q_StartOffsHighRes",1.0},
            {"StartEngProt.Q_AirStartOffset",0.01},
            {"StartEngProt.Q_StartOffsAdd",0.01},
            {"StartEngProt.ST_SAM0",1.0},
            {"StartEng.msCountWhenEnterAirMode0",0.001},
            {"StartEng.m_RemStartOffs",1.0},
            {"StartEng.m_AirStartOffset",1.0},
            {"StartEng.Q_StartOffs",0.01},
            {"StartEng.n_EngReqAtEntryOfAirMode0",1.0},
            {"StartEng.Q_and_p_RampSAM1ToSAM0Started",1.0},
            {"StartEng.Q_and_p_RampSAM1ToSAM0Finished",1.0},
            {"StartEng.Q_SAM1to0RampType",1.0},
            {"StartEng.StartAirMode",1.0},
            {"IgnMastProt.fi_Min",0.1},
            {"IgnMastProt.fi_Offset",0.1},
            {"IgnMastProt.fi_Ramp",1.0},
            {"IgnMastProt.fi_Ignition",0.1},
            {"IgnMastProt.fi_Basic",0.1},
            {"IgnMastProt.fi_Abs",0.1},
            {"IgnMastProt.fi_TrqCtrl",0.1},
            {"IgnMastProt.fi_Target",0.1},
            {"IgnMastProt.fi_OffsetTemp",0.1},
            {"IgnMastProt.fi_OffsetKnockSound",0.1},
            {"IgnMastProt.OctaneIndex",0.01},
            {"IgnMastProt.fi_RedTrq",0.1},
            {"IgnMastProt.fi_minFCI",0.1},
            {"IgnMastProt.fi_MinMAT",0.1},
            {"IgnMastProt.RampDir",1.0},
            {"IgnMastProt.LastActiveMap",1.0},
            {"IgnMastProt.CombCounter",1.0},
            {"IgnMastProt.CombCounter12ms5",1.0},
            {"IgnMastProt.CombCounter25",1.0},
            {"IgnMastProt.CombCounter50",1.0},
            {"IgnMastProt.ST_TrqIgnActive",1.0},
            {"IgnMastProt.ST_minIgn",1.0},
            {"IgnMast.t_dwellTime",1.0},
            {"IgnMast.fi_OffsetFuel",0.1},
            {"IgnMast.fi_Actual",0.1},
            {"IgnMast.fi_EngOff",0.1},
            {"IgnMast.fi_AirOff",0.1},
            {"IgnMast.fi_IgnMBT",0.1},
            {"IgnMast.ST_FuelCutIgnitionActive",1.0},
            {"IgnMast.ActiveMap",1.0},
            {"IgnMast.IgnMode",1.0},
            {"TAmbMod.T_AirAmbient",1.0},
            {"TAmbMod.T_AirAmbAtStart",1.0},
            {"TAmbMod.T_AirAmbPrel",1.0},
            {"TAmbMod.T_AirAmbPreFilt",1.0},
            {"TAmbMod.N_StableCounter",1.0},
            {"TAmbMod.ST_StableCond",1.0},
            {"MxVhSpdCal.v_Max",0.1},
            {"MxVhSpdCal.v_Hysteresis",0.1},
            {"MxVhSpdCal.X_Proportional",0.0078125},
            {"MxVhSpdCal.X_Integrator",0.0078125},
            {"MxVhSpdCal.f_vFilter",1.0},
            {"ETCMiscAdap.ST_MainLrnCorruptOccrd",1.0},
            {"MCPSOHAdap.ST_MCPSOHFltOccrd",1.0},
            {"OilTempCal.T_StartUpOilBias",1.0},
            {"OilTempCal.T_EngineSP",1.0},
            {"OilTempCal.N_EngineRevsDelayTAB",1.0},
            {"OilTempCal.T_OilTransitionThrsh",1.0},
            {"OilTempCal.X_OilTransition",0.0009765625},
            {"OilTempCal.T_DegreePerRevTAB",1.52590218967e-05},
            {"OilTempCal.T_OilEquilibriumThrsh",1.0},
            {"OilTempCal.n_EngineSP",1.0},
            {"OilTempCal.T_EngineSpeedIncreaseTAB",0.0078125},
            {"OilTempCal.p_AirInletSP",0.1},
            {"OilTempCal.T_AirInletIncreaseTAB",0.0078125},
            {"OilTempCal.T_AirInletXSP",1.0},
            {"OilTempCal.v_VehicleYSP",0.1},
            {"OilTempCal.T_SpeedAndLoadDecreaseMap",0.0078125},
            {"OilTempCal.X_EstimatedOilTempCoeffTAB",1.52590218967e-05},
            {"OilTempCal.X_CoolantCoeff",0.0078125},
            {"FFFuelProt.lPFiltRemFFSensor",1.0},
            {"FFFuelProt.t_stampIgnKey",0.001},
            {"FFFuelProt.enrFacBefComp",0.01},
            {"FFFuelProt.combFacBefComp",0.01},
            {"FFFuelProt.m_ExhaustO2SHeatRearLightOff",1.0},
            {"FFFuelProt.m_ExhaustO2SHeatRearLightOffBefComp",1.0},
            {"FFFuelProt.m_ExhaustO2SHeatRearNormal",1.0},
            {"FFFuelProt.m_ExhaustO2SHeatRearNormalBefComp",1.0},
            {"FFFuelProt.BlkHeatAftStRampStepBefComp",1.0},
            {"FFFuelProt.FCutMinTempBefComp",1.0},
            {"FFFuelProt.fi_maxOffset",0.1},
            {"FFFuelProt.fi_maxOffsetBefComp",0.1},
            {"FFFuelProt.fi_maxOff",0.1},
            {"FFFuelProt.fi_maxOffBefComp",0.1},
            {"FFFuelProt.KnkFuel",0.0078125},
            {"FFFuelProt.KnkFuelBefComp",0.0009765625},
            {"FFFuelProt.enrFac",0.0078125},
            {"FFFuelProt.combFac",0.0078125},
            {"FFFuelProt.aftStartBefComp",0.0009765625},
            {"FFFuelProt.aftStartFac",0.0078125},
            {"FFFuelProt.aftStAmbientFac",0.0078125},
            {"FFFuelProt.aftStAmbientFacBefComp",0.0009765625},
            {"FFFuelProt.TCompBefComp",0.0009765625},
            {"FFFuelProt.TCompFac",0.0078125},
            {"FFFuelProt.InjAngBefComp",0.1},
            {"FFFuelProt.InjAng",0.1},
            {"FFFuelProt.lambdaIntBefComp",0.01},
            {"FFFuelProt.lambdaIntLim",0.01},
            {"FFFuelProt.RestartFacBefComp",0.0009765625},
            {"FFFuelProt.RestartFac",0.0009765625},
            {"FFFuelProt.AfterStRestartFacBefComp",0.78125},
            {"FFFuelProt.AfterStRestartFac",0.78125},
            {"FFFuelProt.X_hotSoakAdjustBefComp",0.78125},
            {"FFFuelProt.X_hotSoakAdjust",0.78125},
            {"FFFuelProt.t_JerkDelayBefComp",0.1},
            {"FFFuelProt.t_JerkDelay",0.1},
            {"FFFuelProt.m_BFuelAirMassLimitBefComp",1.0},
            {"FFFuelProt.m_BFuelAirMassLimit",1.0},
            {"FFFuelProt.U_LambdaO2SensSwitchBefComp",1.0},
            {"FFFuelProt.U_LambdaO2SensSwitchFac",1.0},
            {"FFFuelProt.X_LambdaDecRampBefComp",0.01},
            {"FFFuelProt.X_LambdaDecRamp",0.01},
            {"FFFuelProt.X_LambdaIncRampBefComp",0.01},
            {"FFFuelProt.X_LambdaIncRamp",0.01},
            {"FFFuelProt.LambdaRampTempScaleBefComp",0.0078125},
            {"FFFuelProt.LambdaRampTempScale",0.0078125},
            {"FFFuelProt.m_FuelBasicBefComp",0.01},
            {"FFFuelProt.BlkHeatStartFuelFacBefComp",0.0009765625},
            {"FFFuelProt.BlkHeatStartFuelFac",0.0009765625},
            {"FFFuelProt.BlkHeatAfterStFuelFacBefComp",0.0009765625},
            {"FFFuelProt.BlkHeatAfterStFuelFac",0.0009765625},
            {"FFFuelProt.AfterStFastDriveFuelFacBefComp",0.0009765625},
            {"FFFuelProt.AfterStFastDriveFuelFac",0.0009765625},
            {"FFFuelProt.BlkHeatReStartFuelFacBefComp",0.78125},
            {"FFFuelProt.BlkHeatReStartFuelFac",0.78125},
            {"FFFuelProt.BlkHeatAftReStartFuelFacBefComp",0.78125},
            {"FFFuelProt.BlkHeatAftReStartFuelFac",0.78125},
            {"FFFuelProt.LambdaRamp",0.01},
            {"FFFuelProt.t_FFSensorDelay",1.0},
            {"FFFuelProt.TempEnrFac",0.0078125},
            {"FFFuelProt.TempEnrFacBefComp",0.0078125},
            {"FFFuelProt.BFuelJerkEnrichFacBefComp",0.0078125},
            {"FFFuelProt.BFuelJerkEnrichFac",0.0078125},
            {"FFFuelProt.factorHighAltBefComp",0.0078125},
            {"FFFuelProt.factorHighAlt",0.0078125},
            {"FFFuel.AFR",0.01},
            {"FFFuel.U_LambdaHighSwitch",1.0},
            {"FFFuel.U_LambdaLowSwitch",1.0},
            {"FFFuel.LambdaIntSysAct",0.01},
            {"FFFuel.X_fuel",0.0078125},
            {"FFFuel.X_fuelStart",0.0078125},
            {"FFFuel.X_fuelReStart",0.0078125},
            {"FFFuel.X_fuelCP",0.0078125},
            {"FFFuel.X_hotSoak",0.0078125},
            {"FFFuel.X_fuelBlkHeat",0.0078125},
            {"FFFuel.ST_RearLambdaClosedLoop",1.0},
            {"FFFuel.ST_Ethanol",1.0},
            {"FFFuel.ST_enable",1.0},
            {"obdCombDet.ST_OkStatus",1.0},
            {"obdCombDet.ST_FaultCode",1.0},
            {"obdSync.ST_OkStatus",1.0},
            {"obdSync.ST_FaultCode",1.0},
            {"obdMisfFTP.ST_OkStatus",1.0},
            {"obdMisfFTP.ST_FaultCode",1.0},
            {"obdMisfFTP.N_BlockTotalMisfire",1.0},
            {"obdMisfFTP.N_Exceedances",1.0},
            {"obdMisfFTP.firstBlock",1.0},
            {"obdMisfFTP.firstBlockExceedance",1.0},
            {"obdMisfFTP.ExceedanceSameDrvCond",1.0},
            {"obdMisfFTP.SameDrivingConditions",1.0},
            {"obdMisfFTP.isInSameDrivingConditions",1.0},
            {"obdMisfCAT.ST_OkStatus",1.0},
            {"obdMisfCAT.ST_FaultCode",1.0},
            {"obdMisfCAT.N_BlockTotalMisfire",1.0},
            {"obdMisfCAT.N_Exceedances",1.0},
            {"obdMisfCAT.firstBlock",1.0},
            {"obdMisfCAT.MILHasBlinked",1.0},
            {"obdMisfCAT.SameDrivingConditions",1.0},
            {"obdMisfCAT.isInSameDrivingConditions",1.0},
            {"obdMisfFuelcut.ST_OkStatus",1.0},
            {"obdMisfFuelcut.ST_FaultCode",1.0},
            {"obdMisfFuelcut.N_BlockTotalMisfire",1.0},
            {"obdMisfFuelcut.N_Exceedances",1.0},
            {"obdMisfFuelcut.firstBlock",1.0},
            {"obdMisfFuelcut.MILHasBlinked",1.0},
            {"obdMisfFuelcut.SameDrivingConditions",1.0},
            {"obdMisfFuelcut.isInSameDrivingConditions",1.0},
            {"FFFuelCal.BlkHeatAftStRampStep",1.0},
            {"FFFuelCal.T_FCutMinTemp",1.0},
            {"FFFuelCal.m_airXSP",1.0},
            {"FFFuelCal.KnkEnrichmentMAP",0.0078125},
            {"FFFuelCal.fi_offsetEnrichEnableMAP",0.1},
            {"FFFuelCal.fi_MaxOffsetMAP",0.1},
            {"FFFuelCal.AFRTAB",0.01},
            {"FFFuelCal.enrFacTAB",0.0078125},
            {"FFFuelCal.EnrFacThrFaultTAB",0.0078125},
            {"FFFuelCal.combFacMAP",0.0078125},
            {"FFFuelCal.afterStartMAP",0.0078125},
            {"FFFuelCal.AftStAmbientMAP",0.0078125},
            {"FFFuelCal.n_combSP4",1.0},
            {"FFFuelCal.n_combSP5",1.0},
            {"FFFuelCal.n_combLimit",1.0},
            {"FFFuelCal.T_engSP12",1.0},
            {"FFFuelCal.T_engSP6",1.0},
            {"FFFuelCal.T_engSP4",1.0},
            {"FFFuelCal.T_engSP5",1.0},
            {"FFFuelCal.T_engFFSensorDelaySP5",1.0},
            {"FFFuelCal.T_engSP2",1.0},
            {"FFFuelCal.T_engSoakSP",1.0},
            {"FFFuelCal.T_engAftStFastDriveSP5",1.0},
            {"FFFuelCal.n_combSP",1.0},
            {"FFFuelCal.T_engSP7",1.0},
            {"FFFuelCal.T_engSP14",1.0},
            {"FFFuelCal.T_blendYSP",1.0},
            {"FFFuelCal.n_afterStartSP",1.0},
            {"FFFuelCal.TCompMAP1",0.0078125},
            {"FFFuelCal.TCompMAP2",0.0078125},
            {"FFFuelCal.TCompMAP3",0.0078125},
            {"FFFuelCal.TCompMAP4",0.0078125},
            {"FFFuelCal.TCompMAP5",0.0078125},
            {"FFFuelCal.TCompMAP6",0.0078125},
            {"FFFuelCal.TCompMAP7",0.0078125},
            {"FFFuelCal.TCompMAP8",0.0078125},
            {"FFFuelCal.n_engTCompSP",1.0},
            {"FFFuelCal.m_airInletTCompSP",1.0},
            {"FFFuelCal.lambdaIntLimTAB",0.01},
            {"FFFuelCal.InjAngTAB",0.1},
            {"FFFuelCal.RestartFacMAP",0.0009765625},
            {"FFFuelCal.AfterStRestartFacMAP",0.78125},
            {"FFFuelCal.X_hotSoakAdjustMAP",0.78125},
            {"FFFuelCal.m_ExhaustO2SHeatRearLightOffTAB",1.0},
            {"FFFuelCal.m_ExhaustO2SHeatRearNormalTAB",1.0},
            {"FFFuelCal.t_JerkDelayMAP",0.1},
            {"FFFuelCal.m_BFuelAirMassJerkMAP",1.0},
            {"FFFuelCal.U_LambdaO2SensSwitchFacMAP",1.0},
            {"FFFuelCal.X_LambdaDecRampTAB",0.01},
            {"FFFuelCal.X_LambdaIncRampTAB",0.01},
            {"FFFuelCal.LambdaRampTempScaleTAB",0.0078125},
            {"FFFuelCal.X_blendSP9",0.1},
            {"FFFuelCal.X_blendSP5",0.1},
            {"FFFuelCal.X_blend2SP9",0.1},
            {"FFFuelCal.X_blendSP",0.1},
            {"FFFuelCal.X_BlendLimForRearSond",0.1},
            {"FFFuelCal.X_blendLimReduNeutRpm",0.1},
            {"FFFuelCal.m_FuelBasic",0.01},
            {"FFFuelCal.BlkHeatStartFuelFacMAP",0.0009765625},
            {"FFFuelCal.BlkHeatAfterStFuelFacMAP",0.0009765625},
            {"FFFuelCal.AfterStFastDriveFuelFacMAP",0.0009765625},
            {"FFFuelCal.AfterStFastDriveGasolineFuelFac",0.0009765625},
            {"FFFuelCal.t_soakSP",0.1},
            {"FFFuelCal.BlkHeatReStFuelFacTAB",0.78125},
            {"FFFuelCal.BlkHeatAftReStFuelFacTAB",0.78125},
            {"FFFuelCal.U_02SensRearTAB",1.0},
            {"FFFuelCal.U_LambdaOffsetSwitch",1.0},
            {"FFFuelCal.Q_LambdaRampSP6",0.01},
            {"FFFuelCal.LambdaRampTAB",0.01},
            {"FFFuelCal.t_FFSensorDelayTAB",1.0},
            {"FFFuelCal.X_GasolineBlendLim",0.1},
            {"FFFuelCal.N_StartcombFacRampTAB",1.0},
            {"FFFuelCal.n_DelayRelPedFCut",1.0},
            {"FFFuelCal.X_FilterFFSensor",0.0009765625},
            {"FFFuelCal.TempEnrichFacMAP",0.0078125},
            {"FFFuelCal.X_fuelMAP",0.0078125},
            {"FFFuelCal.X_fuelStartMAP",0.0078125},
            {"FFFuelCal.X_fuelReStartMAP",0.0078125},
            {"FFFuelCal.X_fuelCPMAP",0.0078125},
            {"FFFuelCal.X_hotSoakTAB",0.0078125},
            {"FFFuelCal.BFuelJerkEnrichFacTAB",0.0078125},
            {"FFFuelCal.HighAltFacMap",0.0078125},
            {"FFFuelCal.ST_FFsensorEnable",1.0},
            {"SAIAdap.X_cycleCompleted",1.0},
            {"SAIAdap.ST_status",1.0},
            {"SAIAdap.ST_lastMainState",1.0},
            {"PedalMapProt.X_Fac",0.0009765625},
            {"PedalMapProt.Trq_ForcedIdleMinReq",0.1},
            {"PedalMapProt.SportMode",1.0},
            {"TOAProt.n_EngDiff",1.0},
            {"TOAProt.Trq_P_part",0.1},
            {"TOAProt.Trq_D_part",0.1},
            {"TOAProt.X_D_partFac",0.0078125},
            {"TOAProt.n_EngDer",1.0},
            {"TOAProt.X_gain",0.0009765625},
            {"PedalMap.Trq_Request",0.1},
            {"PedalMap.Trq_ForcedIdleResReq",0.1},
            {"PedalMap.X_AccPedal",0.1},
            {"PedalMap.GainFactor",0.0078125},
            {"PedalMap.GainFactorGoal",0.0078125},
            {"PedalMap.GainFactorOld",0.0078125},
            {"PedalMap.X_GainPedal",0.1},
            {"PedalMap.ST_Gearshift",1.0},
            {"PedalMap.ST_PedalMode",1.0},
            {"TOA.Trq_Request",0.1},
            {"TOA.ST_Active",1.0},
            {"TOA.ST_Status",1.0},
            {"Immo.killInjection",1.0},
            {"Immo.freeStartActive",1.0},
            {"Immo.activeImmoErrorCodes",1.0},
            {"Immo.ST_PreReleaseActive",1.0},
            {"FuelAdapAdap.AdapMap",0.01},
            {"FCutProt.n_CombStartFCut",1.0},
            {"FCutProt.t_OpenMax",0.001},
            {"FCutProt.n_CombSinceFCut",1.0},
            {"FCutProt.n_EngineKill",1.0},
            {"FCutProt.n_EngineLimit",1.0},
            {"FCutProt.X_combAdjust",1.0},
            {"FCutProt.FCutMinTemp",1.0},
            {"FCutProt.n_DelayRelPedFCut",1.0},
            {"FCutProt.ST_AirmassGuard",1.0},
            {"FCutProt.ST_Timebased",1.0},
            {"FCutProt.AllCylFCut",1.0},
            {"FCutProt.ST_WaitForTimer",1.0},
            {"FCutProt.ST_DisableFCI",1.0},
            {"FCutProt.ST_IdleRevving",1.0},
            {"FCutProt.ST_EngTempHighLimGearShift",1.0},
            {"FCut.FuelFac",0.0009765625},
            {"FCut.A_Throttle",1.0},
            {"FCut.ST_FuelCut",1.0},
            {"FCut.CutStatus",1.0},
            {"FCut.FuelCutCyl",1.0},
            {"FCut.ST_ActivateFuelCutIgnition",1.0},
            {"FCut.ST_OpenThrottle",1.0},
            {"FCut.ST_EnrichAct",1.0},
            {"FCut.ST_PowerManagement",1.0},
            {"FCut.ST_Inhibit",1.0},
            {"FCut.ST_InhibitReq",1.0},
            {"FCut.ST_NotAllowed",1.0},
            {"FCut.ST_EngKillRpmLow",1.0},
            {"ManGrShftCal.t_RampUp",1.0},
            {"ManGrShftCal.t_MaxKeep",1.0},
            {"ManGrShftCal.n_RampKeep",1.0},
            {"ManGrShftCal.n_RampDown",1.0},
            {"ManGrShftCal.n_AimOffset",1.0},
            {"ManGrShftCal.GrShftRatioHigh",1.0},
            {"ManGrShftCal.GrShftRatioLow",1.0},
            {"ManGrShftCal.FiltFac",1.0},
            {"ManGrShftCal.ClutchMode",1.0},
            {"ManGrShftCal.ST_Enable",1.0},
            {"ManGrShftCal.ST_UseFCutFlag",1.0},
            {"FFRfuelAdap.V_FuelConsumed",1.0},
            {"FFRfuelAdap.ST_RefuelStartsInBladState",1.0},
            {"FFRfuelAdap.V_FuelTankVehStop",0.1},
            {"FFRfuelAdap.V_FuelTankVehStopOld",0.1},
            {"FFRfuelAdap.t_vehicleStopped",0.1},
            {"FFRfuelAdap.X_FFMaxLim",0.1},
            {"FFRfuelAdap.X_FFMinLim",0.1},
            {"FFRfuelAdap.X_FFMaxLimWithError",0.1},
            {"FFRfuelAdap.X_FFMinLimWithError",0.1},
            {"FFRfuelAdap.X_blendPrev",0.1},
            {"FFRfuelAdap.ST_TriggRefuel",1.0},
            {"FFAirCal.fi_offsetXSP",0.1},
            {"FFAirCal.m_maxAirmass",1.0},
            {"FFAirCal.m_MinLoadMAP",1.0},
            {"FFAirCal.Q_AirStartOffsetAutMAP",0.01},
            {"FFAirCal.Q_AirStartOffsetManMAP",0.01},
            {"FFAirCal.m_MinLoadIdleRevTAB",1.0},
            {"TMCProt.t_BrakeTimer",1.0},
            {"TMCProt.t_D2NDelay",1.0},
            {"TMCProt.Trq_FricReqRaw",0.1},
            {"TMCProt.Trq_FricReq",0.1},
            {"TMCProt.Trq_DNReqRaw",0.1},
            {"TMCProt.Trq_DNReq",0.1},
            {"TMCProt.Trq_PedalReq",0.1},
            {"TMCProt.nEngineFac",1.0},
            {"TMCProt.Trq_CruiseReq",0.1},
            {"TMCProt.Trq_TOAReq",0.1},
            {"TMCProt.Trq_PumpReq",0.1},
            {"TMCProt.Trq_ACReqRaw",0.1},
            {"TMCProt.Trq_ACReq",0.1},
            {"TMCProt.Trq_ACDynReq",0.1},
            {"TMCProt.Trq_MinReq",0.1},
            {"TMCProt.Trq_TipOutReq",0.1},
            {"TMCProt.Trq_Limit",0.1},
            {"TMCProt.Trq_LimitFilt",0.1},
            {"TMCProt.Trq_MBTActual",0.1},
            {"TMCProt.fi_IgnMBT",0.1},
            {"TMCProt.fi_IgnEffic",0.1},
            {"TMCProt.EngEfficiency",0.1},
            {"TMCProt.Trq_Actual",0.1},
            {"TMCProt.Trq_ActualLimit",0.1},
            {"TMCProt.Trq_ActualLimitFilt",0.1},
            {"TMCProt.Trq_Request",0.1},
            {"TMCProt.Trq_IdleRaw",0.1},
            {"TMCProt.Trq_MaxIdleRaw",0.1},
            {"TMCProt.Trq_Idle",0.1},
            {"TMCProt.PWM_FTermFilt",0.1},
            {"TMCProt.Trq_ElReq",0.1},
            {"TMCProt.Trq_PowerComp",0.1},
            {"TMCProt.Trq_BlockHeatComp",0.1},
            {"TMCProt.Trq_LimitFiltDelayed",0.1},
            {"TMCProt.Trq_TcsTcmMinLim",0.1},
            {"TMCProt.ST_CrsNotActive",1.0},
            {"TMC.Trq_Limit",0.1},
            {"TMC.Trq_ActualLimit",0.1},
            {"TMC.c_ReqErr",1.0},
            {"TMC.c_ActualErr",1.0},
            {"TMC.ST_ReqErr",1.0},
            {"TMC.ST_ReqFlt",1.0},
            {"TMC.ST_ActualErr",1.0},
            {"TMC.ST_ActualFlt",1.0},
            {"FrictionLoadCal.T_EngXSP",1.0},
            {"FrictionLoadCal.n_EngNomYSP",1.0},
            {"FrictionLoadCal.Trq_RequestT_EngMAP",0.1},
            {"FrictionLoadCal.p_AirAmbSP",0.1},
            {"FrictionLoadCal.Trq_Request_p_AirAmbTAB",0.1},
            {"FrictionLoadCal.T_AirAmbSP",1.0},
            {"FrictionLoadCal.Trq_RequestT_AirAmbTAB",0.1},
            {"GSTServiceA.t_100msCounterRuntime",0.1},
            {"GSTServiceA.t_100msCounterContIdle",0.1},
            {"GSTServiceA.t_CumulAboveSpdLim",0.1},
            {"GSTServiceA.t_CumulAboveSpdLimAux",0.1},
            {"GSTServiceA.ST_TimeEngRun",1.0},
            {"GSTServiceA.ST_CumulAboveSpdLim",1.0},
            {"GSTServiceA.ST_ContInIdle",1.0},
            {"obdFFSensorFreq.ST_OkStatus",1.0},
            {"obdFFSensorFreq.ST_FaultCode",1.0},
            {"RpmMast.n_EngineNominal",1.0},
            {"RpmMast.n_EngNomExlElevIdle",1.0},
            {"ThrotPos.X_filt",1.0},
            {"ThrotPos.X_CntrlSrcLimArb",0.1},
            {"ThrotPos.X_FailModeArb",0.1},
            {"ThrotPos.X_Desired",0.1},
            {"ThrotPos.X_FiltDesired",0.1},
            {"ThrotPos.ST_WOTDesired",1.0},
            {"ThrotPos.ST_LoFilterActive",1.0},
            {"ThrotPos.ST_HiFilterActive",1.0},
            {"ExhaustCal.t_FCutDelay",1.0},
            {"ExhaustCal.RampFactor",0.09765625},
            {"ExhaustCal.T_FCut",1.0},
            {"ExhaustCal.t_Tau1FCut",0.0625},
            {"ExhaustCal.t_Tau2FCut",0.0625},
            {"ExhaustCal.t_Tau3FCut",0.0625},
            {"ExhaustCal.t_Tau4FCut",0.0625},
            {"ExhaustCal.t_Tau1Still",0.0625},
            {"ExhaustCal.t_Tau2Still",0.0625},
            {"ExhaustCal.T_Max",1.0},
            {"ExhaustCal.t_Tau3",0.0625},
            {"ExhaustCal.t_Tau4",0.0625},
            {"ExhaustCal.X_WeightFac",0.78125},
            {"ExhaustCal.X_WeightFacIgn",0.78125},
            {"ExhaustCal.n_EngineLim",1.0},
            {"ExhaustCal.t_ShiftDelay",1.0},
            {"ExhaustCal.t_Tau2_Shift",0.0625},
            {"ExhaustCal.t_Tau1Start",0.0625},
            {"ExhaustCal.t_Tau2Start",0.0625},
            {"ExhaustCal.t_StartDelay",1.0},
            {"ExhaustCal.T_LimitSP",1.0},
            {"ExhaustCal.T_LimitTab",1.0},
            {"ExhaustCal.m_AirSP",1.0},
            {"ExhaustCal.t_mAirTau1Tab",0.0625},
            {"ExhaustCal.t_mAirTau2Tab",0.0625},
            {"ExhaustCal.fi_IgnSP",0.1},
            {"ExhaustCal.T_fiIgnMap",1.0},
            {"ExhaustCal.T_Lambda1Map",1.0},
            {"ExhaustCal.ST_Enable",1.0},
            {"ExhaustCal.X_Delay",1.0},
            {"obdBoostCtrl.t_pAirSlope",1.0},
            {"obdBoostCtrl.ST_OkStatus",1.0},
            {"obdBoostCtrl.ST_FaultCode",1.0},
            {"obdBoostCtrl.pBef_MAPMeanValue",0.1},
            {"obdBoostCtrl.p_Diff",0.1},
            {"obdBoostCtrl.p_StartPressure",0.1},
            {"obdBoostCtrl.pAirSlope",0.1},
            {"obdBoostCtrl.t_DiffBoostError",0.1},
            {"obdBoostCtrl.n_HighLim",1.0},
            {"obdBoostCtrl.ST_OkSlope",1.0},
            {"obdBoostCtrl.N_pBef_MAPMeanOK",1.0},
            {"obdBypass.ST_OkStatus",1.0},
            {"obdBypass.ST_FaultCode",1.0},
            {"obdBypass.p_DeltaMean",0.1},
            {"obdBypass.A_ThrMean",0.1},
            {"obdBypass.Q_DeltaMean",0.01},
            {"obdBypass.N_Ok",1.0},
            {"obdBypass.N_Fault",1.0},
            {"obdBypass.ST_PerformDiag",1.0},
            {"IgnTransCal.p_AirInletXSP",0.1},
            {"IgnTransCal.n_EngYSP",1.0},
            {"IgnTransCal.factorMAP",0.0009765625},
            {"IgnTransCal.n_hold",1.0},
            {"IgnTransCal.n_ramp",1.0},
            {"IgnTransCal.buffPoint1",1.0},
            {"IgnTransCal.buffPoint2",1.0},
            {"IgnTransCal.ST_Enable",1.0},
            {"IgnOffsCal.fi_Offs",0.1},
            {"IgnOffsCal.fi_OffsCyl",0.1},
            {"IgnKnkCal.X_KnockSP",1.0},
            {"IgnKnkCal.fi_RetardTAB",0.1},
            {"IgnKnkCal.fi_TransRetardTAB",0.1},
            {"IgnKnkCal.m_AirXSP",1.0},
            {"IgnKnkCal.n_EngYSP",1.0},
            {"IgnKnkCal.fi_Map1MaxOffset",0.1},
            {"IgnKnkCal.fi_Ramp",0.1},
            {"IgnKnkCal.ReduceTime",1.0},
            {"IgnKnkCal.m_AirIndexXSP",1.0},
            {"IgnKnkCal.n_EngIndexYSP",1.0},
            {"IgnKnkCal.RetardIndexMap",0.01},
            {"IgnKnkCal.ARetardIndexMap",0.01},
            {"IgnKnkCal.IndexMap",0.01},
            {"IgnKnkCal.n_EngHyst",1.0},
            {"IgnKnkCal.AdpHighLimTab",1.0},
            {"IgnKnkCal.AdpLowLimTab",1.0},
            {"IgnKnkCal.t_holdTrans",1.0},
            {"IgnKnkCal.p_AirDeltaLim",0.1},
            {"IgnKnkCal.fi_HighLimit",0.1},
            {"IgnKnkCal.fi_LowLimit",0.1},
            {"IgnKnkCal.K_RetardIndexTAB",0.0078125},
            {"IgnKnkCal.fi_MaxIncRetard",0.1},
            {"IgnKnkCal.ST_Enable",1.0},
            {"FailSafeCal.t_hold",1.0},
            {"FailSafeCal.n_hold",1.0},
            {"FailSafeCal.fi_diff",0.1},
            {"IgnTempCal.m_AirXSP",1.0},
            {"IgnTempCal.n_EngYSP",1.0},
            {"IgnTempCal.T_AirInletReferenceMap",1.0},
            {"IgnTempCal.T_AirInletHysteresis",1.0},
            {"IgnTempCal.fi_OffsetMaxAirInletMap",0.1},
            {"IgnTempCal.T_MaxAirInletMap",1.0},
            {"IgnTempCal.fi_OffsetMinAirInletMap",0.1},
            {"IgnTempCal.T_MinAirInletMap",1.0},
            {"IgnTempCal.T_EngReference",1.0},
            {"IgnTempCal.T_EngHysteresis",1.0},
            {"IgnTempCal.fi_OffsetMaxTEngMap",0.1},
            {"IgnTempCal.T_MaxTEng",1.0},
            {"IgnTempCal.fi_OffsetMinTEngMap",0.1},
            {"IgnTempCal.T_MinTEng",1.0},
            {"IgnTempCal.ST_Enable",1.0},
            {"IgnTempCal.ST_ActiveAtIdle",1.0},
            {"IgnJerkCal.fi_Basic",0.1},
            {"IgnJerkCal.n_DiffXSP",1.0},
            {"IgnJerkCal.fi_Tab",0.1},
            {"IgnJerkCal.n_LimTabSP",1.0},
            {"IgnJerkCal.n_LimTab",1.0},
            {"IgnJerkCal.N_CombPart1",1.0},
            {"IgnJerkCal.N_CombPart2",1.0},
            {"IgnJerkCal.fi_RampStep",0.1},
            {"IgnJerkCal.n_EnDelta",1.0},
            {"IgnJerkCal.X_PedalLim",0.1},
            {"IgnJerkCal.n_Comb",1.0},
            {"IgnJerkCal.T_EngLim",1.0},
            {"KnkSoundRedCal.fi_OffsMap",0.1},
            {"KnkSoundRedCal.T_LowLim",1.0},
            {"KnkSoundRedCal.T_HighLim",1.0},
            {"DigIDM.knockSignalEvalResult",1.0},
            {"DigIDM.Cnt_SampleKnockSignal",1.0},
            {"DigIDM.Cnt_HighKnockSignal",1.0},
            {"DigIDM.Cnt_LowKnockSignal",1.0},
            {"SensSwitch.t_OnTimeStamp",1.0},
            {"SensSwitch.t_ShrtRecvrTimeStamp",1.0},
            {"SensSwitch.t_OffTimeStamp",1.0},
            {"SensSwitch.t_ShortTime_1",1.0},
            {"SensSwitch.t_ShortTime_2",1.0},
            {"SensSwitch.c_TPSShortContFail",1.0},
            {"SensSwitch.c_TPSSwitchFail",1.0},
            {"SensSwitch.c_TPSSwitchSmpl",1.0},
            {"SensSwitch.c_IterationCntr",1.0},
            {"SensSwitch.X_TPS1PreOn",0.1},
            {"SensSwitch.X_TPS2PreOn",0.1},
            {"SensSwitch.X_TPS1_On",0.1},
            {"SensSwitch.X_TPS2_On",0.1},
            {"SensSwitch.X_TPS1_Off",0.1},
            {"SensSwitch.X_TPS1_OffToOnDiff",0.1},
            {"SensSwitch.X_TPS1_OnToOffDiff",0.1},
            {"SensSwitch.ST_TPS_ShortFlt",1.0},
            {"SensSwitch.ST_TPS_ShortErr",1.0},
            {"SensSwitch.ST_TPSSwitchFlt",1.0},
            {"SensSwitch.ST_TPS_SwitchErr",1.0},
            {"SensSwitch.ST_TPS_SW_OnErr",1.0},
            {"SensSwitch.ST_TPS_SW_OffErr",1.0},
            {"SensSwitch.ST_RunTestThisCycle",1.0},
            {"SensSwitch.ST_SnsrShrtDiagActive",1.0},
            {"SensSwitch.ST_SnsrPreSwitchValid",1.0},
            {"MAFCal.X_rgRatioMAP",0.0009765625},
            {"MAFCal.p_AirInletSP",0.1},
            {"MAFCal.p_AftTurbSP",0.1},
            {"MAFCal.ST_rgEnable",1.0},
            {"MAFCal.t_holdUseFromp",1.0},
            {"MAFCal.FilterConstAir",1.0},
            {"MAFCal.n_EngineXSP",1.0},
            {"MAFCal.p_InletGradYSP",1.0},
            {"MAFCal.t_NegTransFreezTab",1.0},
            {"MAFCal.t_PosTransFreezTab",1.0},
            {"MAFCal.X_RpmFiltConst",1.0},
            {"MAFCal.n_EngTEngFacSP",1.0},
            {"MAFCal.p_InlTEngFacSP",1.0},
            {"MAFCal.n_EngSP",1.0},
            {"MAFCal.FrompMulFacTab",0.01},
            {"MAFCal.FrompAddFacTab",1.0},
            {"MAFCal.T_EngineSP",1.0},
            {"MAFCal.T_AirInlSP",1.0},
            {"MAFCal.V_Cyl",1.0},
            {"MAFCal.m_AirNormAdjXSP",1.0},
            {"MAFCal.n_EngNormAdjYSP",1.0},
            {"MAFCal.p_DeltaTransMain",1.0},
            {"MAFCal.t_NegTransFreezMainTab",1.0},
            {"MAFCal.t_PosTransFreezMainTab",1.0},
            {"MAFCal.AreaFiltCoeff",1.0},
            {"MAFCal.X_pRatioSP",0.01},
            {"MAFCal.C_PosTransPredictorTab",1.0},
            {"MAFCal.C_NegTransPredictorTab",1.0},
            {"MAFCal.n_comb",1.0},
            {"MAFCal.X_k11",0.01},
            {"MAFCal.K_p_reqDelta",0.01},
            {"MAFCal.X_PredMaxDeviation",0.78125},
            {"MAFCal.WeightConstMap",1.0},
            {"MAFCal.f_FilterFuel",0.1},
            {"MAFCal.f_FilterMain",0.1},
            {"MAFCal.f_FilterHFM",0.1},
            {"MAFCal.f_FilterWeightFactor",0.1},
            {"MAFCal.f_CutOffFreqComb",0.1},
            {"MAFCal.f_CutOffFreqTime",0.1},
            {"MAFCal.T_EngineFactorMap",1.0},
            {"MAFCal.X_DecrStepLim",1.0},
            {"MAFCal.X_IncrStepLim",1.0},
            {"MAFCal.ST_MAFEnable",1.0},
            {"MAFCal.K_FrompTEngineTab",1.0},
            {"MAFCal.K_FrompTAirinletTab",1.0},
            {"MAFCal.NormAdjustFacMap",0.0078125},
            {"MAFCal.ST_AirInletNormHFM",1.0},
            {"MAFCal.ST_OneCylCell",1.0},
            {"MAFCal.ST_AirInletFuel",1.0},
            {"MAFCal.X_pAirInletBufferSize",1.0},
            {"MAFCal.X_pAirInletPredBufferSize",1.0},
            {"MAFCal.ST_AddPurge",1.0},
            {"MAFCal.ST_pAirInletPredActive",1.0},
            {"FrompAdapCal.p_AirInletDeltaLim",0.1},
            {"FrompAdapCal.m_AirFrompErrorLim",0.0078125},
            {"FrompAdapCal.t_inWindow",0.001},
            {"FrompAdapCal.t_BrakeRelHyst",0.1},
            {"FrompAdapCal.m_AirXSP",1.0},
            {"FrompAdapCal.n_EngYSP",1.0},
            {"FrompAdapCal.updateSpeed",0.78125},
            {"FrompAdapCal.m_adapMax",0.0078125},
            {"FrompAdapCal.m_adapMin",0.0078125},
            {"FrompAdapCal.T_EngLowLim",1.0},
            {"FrompAdapCal.ST_enable",1.0},
            {"fi_EnginePositionCal.CylOrder",1.0},
            {"fi_EnginePositionCal.X_RatioBefSync",1.0},
            {"fi_EnginePositionCal.X_RatioAftSync",1.0},
            {"VIOSCal.l_MeterPerPulse",1.0},
            {"VIOSCal.f_PurgeValve",1.0},
            {"VIOSCal.f_EGRValve",1.0},
            {"VIOSCal.fi_EndOfInletPhase",1.0},
            {"VIOSCal.t_InjectorMinOff",1.0},
            {"VIOSCal.fi_SyncTDCRef",1.0},
            {"VIOSCal.n_StartPeriod",1.0},
            {"VIOSCal.t_MinEST_OffPrd",1.0},
            {"VIOSCal.f_HeatO2SensFront",1.0},
            {"VIOSCal.f_HeatO2SensRear",1.0},
            {"VIOSCal.n_StartPosition",1.0},
            {"VIOSCal.l_WheelDiameter",1.0},
            {"VIOSCal.Cnt_TeethPerRev",1.0},
            {"VIOSCal.ST_Alpha3",1.0},
            {"VIOSCal.ST_RemoteDiag",1.0},
            {"VIOSCal.ST_FFMIUEnable",1.0},
            {"VIOSMAFCal.TicksSP",1.0},
            {"VIOSMAFCal.Q_AirInletTab",1.0},
            {"VIOSSensorCal.f_FFSensorSP",0.1},
            {"VIOSSensorCal.X_FFSensorTAB",0.1},
            {"VIOSSensorCal.f_FFSensorCircErrLim",0.1},
            {"VIOSSensorCal.f_FFSensorInternalErrLim",0.1},
            {"VIOSSensorCal.f_FFSensorFuelCondErrLim",0.1},
            {"VIOSSensorCal.t_FFSensorDelay",1.0},
            {"VIOSSensorCal.AD_pAirInletSP",1.0},
            {"VIOSSensorCal.p_AirInletTAB",0.1},
            {"VIOSSensorCal.AD_pAirBefThrottleSP",1.0},
            {"VIOSSensorCal.p_AirBefThrottleTAB",0.1},
            {"VIOSSensorCal.AD_pFuelTankSP",1.0},
            {"VIOSSensorCal.p_FuelTankTAB",1.0},
            {"VIOSSensorCal.T_ExhaustSP",1.0},
            {"VIOSSensorCal.T_ExhaustTAB",1.0},
            {"VIOSSensorCal.AD_pSAISP",1.0},
            {"VIOSSensorCal.p_SAITAB",0.1},
            {"VIOSSensorCal.AD_VFuelTankEUSP",1.0},
            {"VIOSSensorCal.AD_VFuelTankUSSP",1.0},
            {"VIOSSensorCal.AD_VFuelTankAWDPrimSP",1.0},
            {"VIOSSensorCal.AD_VFuelTankAWDSecSP",1.0},
            {"VIOSSensorCal.V_FuelTankEUTAB",0.1},
            {"VIOSSensorCal.V_FuelTankUSTAB",0.1},
            {"VIOSSensorCal.V_FuelTankAWDPrimTAB",0.1},
            {"VIOSSensorCal.V_FuelTankAWDSecTAB",0.1},
            {"VIOSSensorCal.V_MaxFuelTankEU",0.1},
            {"VIOSSensorCal.V_MaxFuelTankUS",0.1},
            {"VIOSSensorCal.V_MaxFuelTankAWD",0.1},
            {"VIOSSensorCal.AD_UBatteryRangeTAB",1.0},
            {"VIOSSensorCal.AD_UBatterySP",1.0},
            {"VIOSSensorCal.U_BatteryTAB",1.0},
            {"IgnAbsCal.EngEfficiencySP",0.1},
            {"IgnAbsCal.fi_etaIgnOffsetTAB",0.1},
            {"IgnAbsCal.m_AirMBTXSP",1.0},
            {"IgnAbsCal.n_EngMBTYSP",1.0},
            {"IgnAbsCal.fi_IgnMBTMAP",0.1},
            {"IgnAbsCal.fi_highOctanMAP",0.1},
            {"IgnAbsCal.fi_lowOctanMAP",0.1},
            {"IgnAbsCal.fi_NormalMAP",0.1},
            {"IgnAbsCal.m_AirNormXSP",1.0},
            {"IgnAbsCal.n_EngNormYSP",1.0},
            {"IgnAbsCal.o_highMap",0.01},
            {"IgnAbsCal.o_normalMap",0.01},
            {"IgnAbsCal.o_lowMap",0.01},
            {"IgnAbsCal.fi_adapLimLow",0.1},
            {"IgnAbsCal.fi_adapLimHigh",0.1},
            {"IgnAbsCal.o_step",0.01},
            {"IgnAbsCal.o_stepSlow",0.01},
            {"IgnAbsCal.t_OAdapTime",0.1},
            {"IgnAbsCal.t_OAdapTimeSlow",0.1},
            {"IgnAbsCal.T_EngFuelCutXSP",1.0},
            {"IgnAbsCal.n_EngFuelCutYSP",1.0},
            {"IgnAbsCal.fi_FuelCutMAP",0.1},
            {"IgnAbsCal.T_EngStartXSP",1.0},
            {"IgnAbsCal.n_EngStartYSP",1.0},
            {"IgnAbsCal.fi_StartMAP",0.1},
            {"IgnAbsCal.m_AirAdapLimit",1.0},
            {"IgnAbsCal.n_EngAdapLimit",1.0},
            {"IgnAbsCal.fi_diffAdap",0.1},
            {"IgnAbsCal.v_AdapLimit",0.1},
            {"IgnAbsCal.ST_EnableOctanMaps",1.0},
            {"FMastProt.V_FlInjRlCt",1.0},
            {"FMastProt.V_FlInjRlCt_100",1.0},
            {"FMastProt.t_InjMaxLimit",1.0},
            {"FMastProt.m_fuelActBefFDyn",0.01},
            {"FMastProt.m_FuelCalcFDYN",0.01},
            {"FMastProt.m_FuelCalcSAI",0.01},
            {"FMastProt.t_LocalInjBuf",1.0},
            {"FMastProt.t_LocalInjAdjBuf",1.0},
            {"FMastProt.m_fuelDelivered",0.01},
            {"FMastProt.m_AccFuelBuf1",0.01},
            {"FMastProt.m_AccFuelBuf2",0.01},
            {"FMastProt.m_FuelConsAdd",1.0},
            {"FMastProt.t_RollingCountResetOccured",1.0},
            {"FMastProt.combCounter",1.0},
            {"FMastProt.n_Combustion",1.0},
            {"FMastProt.n_Comb50ms",1.0},
            {"FMastProt.n_Comb25ms",1.0},
            {"FMastProt.n_Comb12ms5",1.0},
            {"FMastProt.n_Comb6ms25",1.0},
            {"FMastProt.X_injReq",0.1},
            {"FMastProt.CylMulFac",0.0009765625},
            {"FMastProt.CylMulFac25ms",0.0009765625},
            {"FMastProt.TotalMulFac",0.0009765625},
            {"FMastProt.Fac12_5",0.0009765625},
            {"FMastProt.Fac25",0.0009765625},
            {"FMastProt.Fac50",0.0009765625},
            {"FMastProt.m_TotalAddPart",0.01},
            {"FMastProt.LambdaSteady",0.00078125},
            {"FMastProt.LambdaTrans",0.00078125},
            {"FMastProt.Lambda_t_Inj",0.00078125},
            {"FMastProt.Lambda_t_InjSID",0.00078125},
            {"FMastProt.fi_InjectionStart",0.1},
            {"FMastProt.FuelCompCyl",0.0009765625},
            {"FMastProt.X_FuelConsFac",1.0},
            {"FMastProt.fuelCons",0.01},
            {"FMastProt.InjMode",1.0},
            {"FMastProt.ST_Buffer1",1.0},
            {"FMastProt.ST_RollingCountResetOccured",1.0},
            {"FMastProt.ST_FuelFacUsed",1.0},
            {"FMastProt.ST_FuelCut",1.0},
            {"FMast.m_FuelActual",0.01},
            {"FMast.fi_DurationFirstPulse",0.1},
            {"FMast.fi_DurationSecondPulse",0.1},
            {"FMast.LambdaCalc",0.0001},
            {"FMast.LambdaCalcFilt",0.0001},
            {"FMast.AFR",0.01},
            {"FMast.ST_CrankFuel",1.0},
            {"FMast.ST_FuelCutMisfire",1.0},
            {"FMast.n_CylinderInFuelCut",1.0},
            {"FFAirProt.m_maxAirmassBefComp",1.0},
            {"FFAirProt.m_maxAirmass",1.0},
            {"FFAirProt.m_nLowBefComp",1.0},
            {"FFAirProt.m_nLow",1.0},
            {"FFAirProt.Q_AirStartOffset",0.01},
            {"FFAirProt.Q_AirStartOffsetBefComp",0.01},
            {"FFAirProt.m_LowIdleRevvingBefComp",1.0},
            {"FFAirProt.m_LowIdleRevving",1.0},
            {"SystemAdap.t_SoakMinutes",0.1},
            {"EngKillAdap.T_Engine",1.0},
            {"EngKillAdap.T_AirInlet",1.0},
            {"EngKillAdap.X_FFSensor",0.1},
            {"EngKillAdap.X_FFblend",0.1},
            {"EngKillAdap.m_FuelSAI",0.01},
            {"EngKillAdap.X_BladHLFac",0.0009765625},
            {"EngKillAdap.ST_BladsubState",1.0},
            {"EngKillAdap.ST_BoffsubState",1.0},
            {"EngKillAdap.ST_SAIPresent",1.0},
            {"EngKillAdap.ST_SAI",1.0},
            {"EngKillAdap.V_FuelTank",0.1},
            {"EngKillAdap.V_Refuel",0.1},
            {"EngKillAdap.X_WCFTargetFac",0.0009765625},
            {"EngKillAdap.n_engDiffWCF",1.0},
            {"EngKillAdap.ST_FFSensor",1.0},
            {"EngKillAdap.ST_FCutStatus",1.0},
            {"EngKillAdap.ST_Lambda",1.0},
            {"EngKillAdap.ST_EngSync",1.0},
            {"EngKillAdap.ST_WCFuel",1.0},
            {"EngKillAdap.N_pointer",1.0},
            {"EngNotStartAdap.m_accFuel",1.0},
            {"EngNotStartAdap.m_FuelActual",0.01},
            {"EngNotStartAdap.t_TotalRunTime",0.1},
            {"EngNotStartAdap.factorTotal",0.01},
            {"EngNotStartAdap.T_Engine",1.0},
            {"EngNotStartAdap.X_FFSensor",0.1},
            {"EngNotStartAdap.X_FFblend",0.1},
            {"EngNotStartAdap.n_Runs",1.0},
            {"EngNotStartAdap.t_SoakMinutes",0.1},
            {"EngNotStartAdap.X_WCFTargetFac",0.0009765625},
            {"EngNotStartAdap.n_engDiffWCF",1.0},
            {"EngNotStartAdap.U_Battery",0.1},
            {"EngNotStartAdap.ST_BlkHeatStart",1.0},
            {"EngNotStartAdap.ST_FCutStatus",1.0},
            {"EngNotStartAdap.ST_WCFuel",1.0},
            {"EngNotStartAdap.N_pointer",1.0},
            {"AirCtrlProt.p_ThrRatioOld",1.0},
            {"AirCtrlProt.m_IBuff",1.0},
            {"AirCtrlProt.m_ReqFilt",1.0},
            {"AirCtrlProt.m_DiffBoostOld",1.0},
            {"AirCtrlProt.m_Delta",1.0},
            {"AirCtrlProt.m_AirInletCopy",1.0},
            {"AirCtrlProt.m_reqThr",1.0},
            {"AirCtrlProt.m_IpartThr",0.0078125},
            {"AirCtrlProt.P_BoostConst",0.01},
            {"AirCtrlProt.I_BoostConst",0.01},
            {"AirCtrlProt.D_BoostConst",0.01},
            {"AirCtrlProt.m_PID_Boost",1.0},
            {"AirCtrlProt.m_PID_and_mReq_Boost",1.0},
            {"AirCtrlProt.m_DiffFrMReqBoost",1.0},
            {"AirCtrlProt.m_DiffFrPReqBoost",1.0},
            {"AirCtrlProt.m_AirBasicPressure",1.0},
            {"AirCtrlProt.q_AirInletCorr",0.01},
            {"AirCtrlProt.p_ratioMaxEng",0.1},
            {"AirCtrlProt.p_ratioMaxTurbo",0.01},
            {"AirCtrlProt.m_deltaLim",1.0},
            {"AirCtrlProt.p_ThrRatio",0.001},
            {"AirCtrlProt.P_diffPrequest",0.1},
            {"AirCtrlProt.m_ThrIpartPosLim",0.0078125},
            {"AirCtrlProt.m_ThrIpartNegLim",0.0078125},
            {"AirCtrlProt.m_AirRequest",1.0},
            {"AirCtrlProt.Q_ReqSAM1",0.01},
            {"AirCtrlProt.Q_ReqSAM0",0.01},
            {"AirCtrlProt.p_AirInlReqSAM1",0.1},
            {"AirCtrlProt.p_AirInlReqSAM0",0.1},
            {"AirCtrlProt.p_BefThrRequest",0.1},
            {"AirCtrlProt.m_AirReqSAM1",1.0},
            {"AirCtrlProt.m_AirDurSAM1to0ramp",1.0},
            {"AirCtrlProt.m_AirBoostAdap",1.0},
            {"AirCtrlProt.m_AirTempOffs",1.0},
            {"AirCtrlProt.m_AirHighAltOffs",1.0},
            {"AirCtrlProt.TempCompFactor",0.0078125},
            {"AirCtrlProt.m_AirDelta",1.0},
            {"AirCtrlProt.m_ReqDelta",1.0},
            {"AirCtrlProt.m_IpartAdap",0.0078125},
            {"AirCtrlProt.m_IPartAdapDiff",0.0078125},
            {"AirCtrlProt.Ppart_BoostAirM1Tab",0.01},
            {"AirCtrlProt.P_BoostConstMAT",0.01},
            {"AirCtrlProt.I_BoostConstMAT",0.01},
            {"AirCtrlProt.D_BoostConstMAT",0.01},
            {"AirCtrlProt.ST_ActualPresBefThr",1.0},
            {"AirCtrlProt.ST_NoDiffP",1.0},
            {"AirCtrlProt.ST_HoldFzILim",1.0},
            {"AirCtrlProt.ST_PWM2Perc",1.0},
            {"AirCtrlProt.ST_InAdapTab",1.0},
            {"AirCtrlProt.ST_IPartAdapInProgress",1.0},
            {"AreaAdapProt.forcedAdapsDone",1.0},
            {"AreaAdapProt.t_inNormalWindow",0.001},
            {"AreaAdapProt.t_inForceWindow",0.001},
            {"AreaAdapProt.ST_normalAdapDone",1.0},
            {"AirCtrl.t_HoldFzI",1.0},
            {"AirCtrl.m_PFacBoost",1.0},
            {"AirCtrl.m_DFacBoost",1.0},
            {"AirCtrl.m_IFacBoost",1.0},
            {"AirCtrl.m_MaxTurbo",1.0},
            {"AirCtrl.m_DiffBoost",1.0},
            {"AirCtrl.Q_Request",0.01},
            {"AirCtrl.RegConValue",1.0},
            {"AirCtrl.p_BefComp",0.1},
            {"AirCtrl.p_AirInletRequest",0.1},
            {"AirCtrl.p_AirBefThrPred",0.1},
            {"AirCtrl.p_AfterTurbine",0.1},
            {"AirCtrl.p_AfterTurbineAct",0.1},
            {"AirCtrl.p_AfterTurbineRef",0.1},
            {"AirCtrl.p_ThrRatioFilt",0.001},
            {"AirCtrl.ThrFlowFac",1.0},
            {"AirCtrl.ThrTempFac",1.0},
            {"AirCtrl.ST_I_BoostEnable",1.0},
            {"AirCtrl.ST_P_BoostEnable",1.0},
            {"AirCtrl.FreezeIPart",1.0},
            {"AirCtrl.ST_PWM_isSaturated",1.0},
            {"AirCtrl.ST_AirMode",1.0},
            {"AreaData.A_Controller",0.1},
            {"AreaData.A_ThrottleDemand",0.1},
            {"AreaData.A_InThrottle",0.1},
            {"AreaData.A_OutThrottle",0.1},
            {"AreaData.Cd_Discharge",0.0009765625},
            {"Venturi.n_EngineNominal",1.0},
            {"ETCThrotCal.t_RtnDflt",1.0},
            {"ETCThrotCal.c_MinLrnStability",1.0},
            {"ETCThrotCal.c_MinLrnEnbld",1.0},
            {"ETCThrotCal.c_MinLrnExtend",1.0},
            {"ETCThrotCal.c_MinLrnStable",1.0},
            {"ETCThrotCal.c_CrankTimeMinLrn",1.0},
            {"ETCThrotCal.c_MinLrnLowVolt",1.0},
            {"ETCThrotCal.CorrThrsh",1.0},
            {"ETCThrotCal.X_CorrOffset",0.1},
            {"ETCThrotCal.X_Min_OOC_Thrsh",0.1},
            {"ETCThrotCal.c_OOC_Fail",1.0},
            {"ETCThrotCal.c_OOC_ContFail",1.0},
            {"ETCThrotCal.c_OOC_Smpl",1.0},
            {"ETCThrotCal.c_OOR1_Fail",1.0},
            {"ETCThrotCal.c_OOR1_ContFail",1.0},
            {"ETCThrotCal.c_OOR1_Smpl",1.0},
            {"ETCThrotCal.c_OOR2_Fail",1.0},
            {"ETCThrotCal.c_OOR2_ContFail",1.0},
            {"ETCThrotCal.c_OOR2_Smpl",1.0},
            {"ETCThrotCal.X_NormLim1Hi",0.1},
            {"ETCThrotCal.X_NormLim1Lo",0.1},
            {"ETCThrotCal.X_NormLim2Hi",0.1},
            {"ETCThrotCal.X_NormLim2Lo",0.1},
            {"ETCThrotCal.X_MinDeltNeg",0.1},
            {"ETCThrotCal.X_MinDeltPos",0.1},
            {"ETCThrotCal.X_MinInit",0.1},
            {"ETCThrotCal.X_MaxMin",0.1},
            {"ETCThrotCal.X_MinDelta",0.1},
            {"ETCThrotCal.X_MinMin",0.1},
            {"ETCThrotCal.X_Max1",0.1},
            {"ETCThrotCal.X_Max2",0.1},
            {"ETCThrotCal.X_PstnDefault",0.1},
            {"ETCThrotCal.X_RtnDfltMax",0.1},
            {"ETCThrotCal.U_MinLrnIgnThrsh",0.1},
            {"ETCThrotCal.n_CrankMinLrn",1.0},
            {"ETCThrotCal.p_CrankMinLrn",0.1},
            {"ETCThrotCal.c_Return",1.0},
            {"ETCThrotCal.ST_TPS1RawSlope",1.0},
            {"ETCThrotCal.ST_TPS2RawSlope",1.0},
            {"ETCThrotCal.ST_SingleTPSSupply",1.0},
            {"ActualIn.ST_GasModeActCyl1",1.0},
            {"ActualIn.ST_GasModeActCyl2",1.0},
            {"ActualIn.ST_GasModeActCyl3",1.0},
            {"ActualIn.ST_GasModeActCyl4",1.0},
            {"FrompAdapAdap.X_GasMulFac",1.0},
            {"FrompAdapCal.X_GasAdapMax",1.0},
            {"FrompAdapCal.X_GasAdapMin",1.0},


            /** tot hier **/
        /** tot hier **/
            {"END", 0}
        };

        public static double GetSymbolUnit(string word)
        {
            // Try to get the result in the static Dictionary
            double result;
            if (_dict.TryGetValue(word, out result))
            {
                return result;
            }
            else
            {
                return 0;
            }
        }
    }

}